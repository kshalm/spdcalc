(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    117592,       2720]
NotebookOptionsPosition[    114875,       2638]
NotebookOutlinePosition[    115229,       2654]
CellTagsIndexPosition[    115186,       2651]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CompleteSquare", "[", 
    RowBox[{"f_", ",", "x_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"c", ",", "b", ",", "a"}], "}"}], "=", 
       RowBox[{"CoefficientList", "[", 
        RowBox[{"f", ",", "x"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"a", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"x", "+", 
           RowBox[{
            RowBox[{"b", "/", "2"}], "/", "a"}]}], ")"}], "^", "2"}]}], "+", 
       RowBox[{"Simplify", "[", 
        RowBox[{"(", 
         RowBox[{"c", "-", 
          RowBox[{
           RowBox[{
            RowBox[{"b", "^", "2"}], "/", "4"}], "/", "a"}]}], ")"}], 
        "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Figure", " ", "out", " ", "the", " ", "rotation", " ", "that", " ", 
    "puts", " ", "the", " ", "signal", " ", "and", " ", "idler", " ", "into", 
    " ", "the", " ", "pump", " ", 
    RowBox[{"coordinates", ".", " ", "Here"}], " ", "\[Theta]", " ", "is", 
    " ", "the", " ", "opening", " ", "angle", " ", "and", " ", "\[Phi]", " ", 
    "is", " ", "the", " ", "azimuthal", " ", 
    RowBox[{"angle", "."}]}], "\[IndentingNewLine]", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"RotX", ":=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", " ", "0", ",", " ", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", " ", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"0", ",", " ", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", " ", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"RotZ", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}], ",", " ", "0"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", " ", 
      RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", " ", "0"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RotY", " ", ":=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Gamma]", "]"}], ",", "0", ",", " ", 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "\[Gamma]", "]"}]}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", "  ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Gamma]", "]"}], ",", "0", ",", "  ", 
       RowBox[{"Cos", "[", "\[Gamma]", "]"}]}], "}"}]}], "}"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"RotX", ":=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", " ", "0", ",", " ", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", " ", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"0", ",", " ", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}], ",", " ", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"RotZ", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", " ", "0"}], "}"}], ",", 
    " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Phi]", "]"}], ",", " ", 
      RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", " ", "0"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RotY", " ", ":=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Gamma]", "]"}], ",", "0", ",", " ", 
       RowBox[{"Sin", "[", "\[Gamma]", "]"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", "  ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sin", "[", "\[Gamma]", "]"}]}], ",", "0", ",", "  ", 
       RowBox[{"Cos", "[", "\[Gamma]", "]"}]}], "}"}]}], "}"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RotZLab", " ", ":=", " ", "RotY"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RotXLab", " ", ":=", " ", "RotZ"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RotYLab", " ", ":=", " ", "RotX"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"RotTrans", "=", 
  RowBox[{"RotX", " ", ".", " ", "RotZ"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RotPumpwrtXtal", " ", "=", " ", 
   RowBox[{"RotX", ".", "RotZ"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Expand", "[", 
  RowBox[{
   RowBox[{"RotXLab", ".", 
    RowBox[{"{", 
     RowBox[{"x1", ",", "y1", ",", "z1"}], "}"}]}], "//.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"z1", "\[Rule]", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Gamma]", "p"], "]"}], "*", "x"}], " ", "-", 
       RowBox[{
        RowBox[{"Sin", "[", 
         SubscriptBox["\[Gamma]", "p"], "]"}], "*", "z"}]}]}], ",", 
     RowBox[{"x1", "\[Rule]", " ", "y"}], ",", " ", 
     RowBox[{"y1", "\[Rule]", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Sin", "[", 
         SubscriptBox["\[Gamma]", "p"], "]"}], "*", "x"}], " ", "-", 
       RowBox[{
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Gamma]", "p"], "]"}], "*", "z"}]}]}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.582551082707974*^9, 3.582551243412228*^9}, {
   3.582552241600596*^9, 3.58255248525065*^9}, {3.5825530886487722`*^9, 
   3.582553091710619*^9}, {3.582581931220381*^9, 3.582581994221595*^9}, {
   3.582589736354864*^9, 3.58258979384231*^9}, {3.582589853214909*^9, 
   3.582589939808462*^9}, {3.582590073974887*^9, 3.5825900784620047`*^9}, {
   3.582591942003405*^9, 3.5825919557241173`*^9}, {3.582592064468408*^9, 
   3.582592070390641*^9}, {3.582592168312223*^9, 3.582592195349346*^9}, {
   3.582592537371162*^9, 3.5825925389767017`*^9}, {3.582592609833417*^9, 
   3.582592630132695*^9}, {3.582594727920084*^9, 3.5825947541563683`*^9}, {
   3.582594786928154*^9, 3.582594837727318*^9}, {3.582594872553235*^9, 
   3.5825948732121487`*^9}, 3.582594919516144*^9, {3.582595006307055*^9, 
   3.58259502779462*^9}, {3.582595382427409*^9, 3.5825953955679607`*^9}, {
   3.582595429725254*^9, 3.582595511584939*^9}, {3.582595567715238*^9, 
   3.58259556798405*^9}, {3.5825957007377663`*^9, 3.5825957096247883`*^9}, {
   3.582595744582691*^9, 3.582595792538672*^9}, {3.582596036605506*^9, 
   3.5825960731972313`*^9}, {3.582596118612314*^9, 3.58259612941899*^9}, {
   3.582596292204793*^9, 3.5825963567715073`*^9}, {3.582596404384987*^9, 
   3.5825964610317802`*^9}, {3.5825968755404663`*^9, 3.582596891139832*^9}, 
   3.582597031324554*^9, {3.582597263234353*^9, 3.582597287940269*^9}, {
   3.5825973900652647`*^9, 3.582597396723194*^9}, {3.582597641860304*^9, 
   3.582597661706188*^9}, 3.582597849090914*^9, 3.582597885135263*^9, {
   3.5826762909693413`*^9, 3.582676292040473*^9}, {3.589299275215334*^9, 
   3.589299276871471*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", 
     RowBox[{"-", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{"-", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
     RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.582552444028955*^9, {3.5825524768158484`*^9, 3.58255248583467*^9}, 
   3.582553092284441*^9, 3.5825618446706257`*^9, 3.582562059850234*^9, 
   3.5825639137479687`*^9, 3.5825646028075247`*^9, 3.582589879404048*^9, 
   3.5825899430288973`*^9, 3.5825900795342007`*^9, 3.582591956253748*^9, 
   3.582592071304824*^9, 3.582592198860856*^9, 3.582592540073839*^9, 
   3.582592631343177*^9, {3.582594730533414*^9, 3.5825947548183117`*^9}, {
   3.5825947953033247`*^9, 3.5825948399508038`*^9}, 3.582594874072584*^9, 
   3.582594920512519*^9, {3.582595009573421*^9, 3.5825950289301023`*^9}, 
   3.582595513334758*^9, 3.582595573438884*^9, 3.582595710901108*^9, 
   3.5825957955808153`*^9, 3.582596130526894*^9, {3.58259634392697*^9, 
   3.5825963601608133`*^9}, {3.5825964436037817`*^9, 3.5825964616825857`*^9}, 
   3.582596892086608*^9, 3.582597032157957*^9, {3.5825972667057037`*^9, 
   3.582597288407114*^9}, 3.582597397547275*^9, 3.5825976633763227`*^9, 
   3.582597850259058*^9, 3.582597885907909*^9, 3.582673481170102*^9, 
   3.589146138215351*^9, 3.5891619141542664`*^9, 3.589228456578177*^9, 
   3.589299277433147*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", 
     RowBox[{"-", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{"-", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
     RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.582552444028955*^9, {3.5825524768158484`*^9, 3.58255248583467*^9}, 
   3.582553092284441*^9, 3.5825618446706257`*^9, 3.582562059850234*^9, 
   3.5825639137479687`*^9, 3.5825646028075247`*^9, 3.582589879404048*^9, 
   3.5825899430288973`*^9, 3.5825900795342007`*^9, 3.582591956253748*^9, 
   3.582592071304824*^9, 3.582592198860856*^9, 3.582592540073839*^9, 
   3.582592631343177*^9, {3.582594730533414*^9, 3.5825947548183117`*^9}, {
   3.5825947953033247`*^9, 3.5825948399508038`*^9}, 3.582594874072584*^9, 
   3.582594920512519*^9, {3.582595009573421*^9, 3.5825950289301023`*^9}, 
   3.582595513334758*^9, 3.582595573438884*^9, 3.582595710901108*^9, 
   3.5825957955808153`*^9, 3.582596130526894*^9, {3.58259634392697*^9, 
   3.5825963601608133`*^9}, {3.5825964436037817`*^9, 3.5825964616825857`*^9}, 
   3.582596892086608*^9, 3.582597032157957*^9, {3.5825972667057037`*^9, 
   3.582597288407114*^9}, 3.582597397547275*^9, 3.5825976633763227`*^9, 
   3.582597850259058*^9, 3.582597885907909*^9, 3.582673481170102*^9, 
   3.589146138215351*^9, 3.5891619141542664`*^9, 3.589228456578177*^9, 
   3.589299277435499*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"y", " ", 
     RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "+", 
    RowBox[{"z", " ", 
     RowBox[{"Cos", "[", 
      SubscriptBox["\[Gamma]", "p"], "]"}], " ", 
     RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "-", 
    RowBox[{"x", " ", 
     RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
     RowBox[{"Sin", "[", 
      SubscriptBox["\[Gamma]", "p"], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "z"}], " ", 
     RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
     RowBox[{"Cos", "[", 
      SubscriptBox["\[Gamma]", "p"], "]"}]}], "+", 
    RowBox[{"y", " ", 
     RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "+", 
    RowBox[{"x", " ", 
     RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
     RowBox[{"Sin", "[", 
      SubscriptBox["\[Gamma]", "p"], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"x", " ", 
     RowBox[{"Cos", "[", 
      SubscriptBox["\[Gamma]", "p"], "]"}]}], "-", 
    RowBox[{"z", " ", 
     RowBox[{"Sin", "[", 
      SubscriptBox["\[Gamma]", "p"], "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.582552444028955*^9, {3.5825524768158484`*^9, 3.58255248583467*^9}, 
   3.582553092284441*^9, 3.5825618446706257`*^9, 3.582562059850234*^9, 
   3.5825639137479687`*^9, 3.5825646028075247`*^9, 3.582589879404048*^9, 
   3.5825899430288973`*^9, 3.5825900795342007`*^9, 3.582591956253748*^9, 
   3.582592071304824*^9, 3.582592198860856*^9, 3.582592540073839*^9, 
   3.582592631343177*^9, {3.582594730533414*^9, 3.5825947548183117`*^9}, {
   3.5825947953033247`*^9, 3.5825948399508038`*^9}, 3.582594874072584*^9, 
   3.582594920512519*^9, {3.582595009573421*^9, 3.5825950289301023`*^9}, 
   3.582595513334758*^9, 3.582595573438884*^9, 3.582595710901108*^9, 
   3.5825957955808153`*^9, 3.582596130526894*^9, {3.58259634392697*^9, 
   3.5825963601608133`*^9}, {3.5825964436037817`*^9, 3.5825964616825857`*^9}, 
   3.582596892086608*^9, 3.582597032157957*^9, {3.5825972667057037`*^9, 
   3.582597288407114*^9}, 3.582597397547275*^9, 3.5825976633763227`*^9, 
   3.582597850259058*^9, 3.582597885907909*^9, 3.582673481170102*^9, 
   3.589146138215351*^9, 3.5891619141542664`*^9, 3.589228456578177*^9, 
   3.589299277437401*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    SubscriptBox["x", "s"], " ", ":=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Phi]", "s"], "]"}], "*", "x"}], " ", "-", 
     RowBox[{
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Phi]", "s"], "]"}], "*", "y"}]}]}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["y", "s"], ":=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Theta]", "s"], "]"}], "*", 
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Phi]", "s"], "]"}], "*", "x"}], " ", "+", " ", 
     RowBox[{
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Theta]", "s"], "]"}], "*", 
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Phi]", "s"], "]"}], "*", "y"}], " ", "-", " ", 
     RowBox[{
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Theta]", "s"], "]"}], "*", "z"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["z", "s"], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Theta]", "s"], "]"}], "*", 
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Phi]", "s"], "]"}], "*", "x"}], " ", "+", " ", 
     RowBox[{
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Theta]", "s"], "]"}], "*", 
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Phi]", "s"], "]"}], "*", "y"}], " ", "+", " ", 
     RowBox[{
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Theta]", "s"], "]"}], "*", "z"}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"planarrules", " ", ":=", " ", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["\[Phi]", "s"], " ", "\[Rule]", " ", "0"}], "}"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"rulescoord", " ", ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Theta]", "s"], "\[Rule]", 
       SubscriptBox["\[Theta]", "i"]}], ",", "  ", 
      RowBox[{
       SubscriptBox["\[Phi]", "s"], " ", "\[Rule]", " ", "\[Pi]"}]}], " ", 
     "}"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["x", "i"], " ", "=", " ", 
     RowBox[{
      SubscriptBox["x", 
       RowBox[{"s", " "}]], "//.", "rulescoord"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["y", "i"], "=", " ", 
     RowBox[{
      SubscriptBox["y", 
       RowBox[{"s", " "}]], "//.", "rulescoord"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["z", "i"], "=", " ", 
     RowBox[{
      SubscriptBox["z", 
       RowBox[{"s", " "}]], "//.", "rulescoord"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["x", "s"], " ", "=", " ", 
     RowBox[{
      SubscriptBox["x", "s"], " ", "//.", " ", "planarrules"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["y", "s"], "=", " ", 
     RowBox[{
      SubscriptBox["y", 
       RowBox[{"s", " "}]], "//.", "planarrules"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["z", "s"], "=", " ", 
     RowBox[{
      SubscriptBox["z", 
       RowBox[{"s", " "}]], "//.", "planarrules"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     SubscriptBox["x", "p"], " ", ":=", " ", 
     RowBox[{
      RowBox[{"x", " ", "+", " ", 
       RowBox[{
        SubscriptBox["\[Rho]", "px"], "*", "z", "\[IndentingNewLine]", 
        SubscriptBox["y", "p"]}]}], ":=", " ", "y"}]}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["x", "p"], " ", "=", " ", "x"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["y", "p"], "=", " ", "y"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Introduce", " ", "the", " ", "assumption", " ", "that", " ", "the", " ", 
     "Rayleigh", " ", "range", " ", "is", " ", "much", " ", "longer", " ", 
     "than", " ", "the", " ", "crystal", " ", "length", " ", "and", " ", 
     "the", " ", "waist", " ", "can", " ", "be", " ", "treated", " ", "as", 
     " ", "a", " ", 
     RowBox[{"constant", ".", " ", "This"}], " ", "dramatically", " ", 
     "simplifies", " ", 
     RowBox[{"things", "."}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"rules2", " ", ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SubscriptBox["q", "p"], " ", "\[Rule]", " ", 
       SuperscriptBox[
        SubscriptBox["W", "p"], "2"]}], " ", ",", " ", 
      RowBox[{
       SubscriptBox["q", "s"], " ", "\[Rule]", " ", 
       SuperscriptBox[
        SubscriptBox["W", "s"], "2"]}], " ", ",", " ", 
      RowBox[{
       SubscriptBox["q", "i"], " ", "\[Rule]", " ", 
       SuperscriptBox[
        SubscriptBox["W", "i"], "2"]}], ",", "  ", 
      RowBox[{
       SubscriptBox["\[Theta]", "s"], " ", "\[Rule]", " ", 
       RowBox[{"0", "*", 
        RowBox[{"\[Pi]", "/", "180"}]}]}], ",", " ", 
      RowBox[{
       SubscriptBox["\[Theta]", "i"], " ", "\[Rule]", 
       RowBox[{"0", "*", 
        RowBox[{"\[Pi]", "/", "180"}]}]}]}], " ", "}"}]}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"rulesq", " ", ":=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SubscriptBox["q", "p"], " ", "\[Rule]", " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["W", "p"], "2"], " ", "+", " ", 
         RowBox[{"2", "*", "\[ImaginaryI]", "*", "z", "*", 
          SubscriptBox["k", "p"]}]}]}], " ", ",", " ", 
       RowBox[{
        SubscriptBox["q", "s"], " ", "\[Rule]", " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["W", "s"], "2"], "-", " ", 
         RowBox[{"2", "*", "\[ImaginaryI]", "*", "z", "*", 
          SubscriptBox["k", "s"]}]}]}], " ", ",", " ", 
       RowBox[{
        SubscriptBox["q", "i"], " ", "\[Rule]", " ", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["W", "i"], "2"], "-", " ", 
         RowBox[{"2", "*", "\[ImaginaryI]", "*", "z", "*", 
          SubscriptBox["k", "s"]}]}]}], ",", " ", 
       RowBox[{
        SubscriptBox["\[Theta]", "s"], "\[Rule]", "0"}], " ", ",", " ", 
       RowBox[{
        SubscriptBox["\[Theta]", "i"], "\[Rule]", "0"}]}], " ", "}"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"rulesq", " ", ":=", " ", 
     RowBox[{"{", " ", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Theta]", "s"], "\[Rule]", "0"}], " ", ",", " ", 
       RowBox[{
        SubscriptBox["\[Theta]", "i"], "\[Rule]", "0"}]}], " ", "}"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"rulesq", " ", ":=", " ", "rules2"}], "\[IndentingNewLine]", 
   RowBox[{"rulesanlge", " ", ":=", " ", 
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Theta]", "s"], " ", "\[Rule]", " ", 
       RowBox[{"0", "*", 
        RowBox[{"\[Pi]", "/", "180"}]}]}], ",", " ", 
      RowBox[{
       SubscriptBox["\[Theta]", "i"], " ", "\[Rule]", 
       RowBox[{"0", "*", 
        RowBox[{"\[Pi]", "/", "180"}]}]}]}], "}"}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.582553100047619*^9, 3.582553370588112*^9}, {
   3.5825820388549013`*^9, 3.582582169072603*^9}, {3.582587357577043*^9, 
   3.582587413066751*^9}, {3.582598276658927*^9, 3.582598320894418*^9}, {
   3.5825983892377157`*^9, 3.582598627247916*^9}, {3.58259866828645*^9, 
   3.582598704826029*^9}, {3.582600519865554*^9, 3.582600593785883*^9}, {
   3.582600716528623*^9, 3.5826007425499573`*^9}, {3.582672343066288*^9, 
   3.582672343360055*^9}, {3.582674823189691*^9, 3.5826748239251747`*^9}, 
   3.582676449697198*^9, {3.582676542418489*^9, 3.582676542619144*^9}, {
   3.589145806714732*^9, 3.58914605264056*^9}, {3.589146147816297*^9, 
   3.5891461584586277`*^9}, {3.58914618983179*^9, 3.5891461948141823`*^9}, {
   3.5891462325466146`*^9, 3.589146255351*^9}, {3.589299216852808*^9, 
   3.589299232760191*^9}, {3.589301719661069*^9, 3.5893017302735987`*^9}, {
   3.589301804143838*^9, 3.589301844275771*^9}, {3.589302288055282*^9, 
   3.5893022908150587`*^9}, {3.589302450799163*^9, 3.589302471677827*^9}, {
   3.589302512015456*^9, 3.5893025306207733`*^9}, {3.589302631172077*^9, 
   3.589302641039485*^9}, {3.589310504684217*^9, 3.589310517218457*^9}, {
   3.589310707003437*^9, 3.5893107081716413`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "These", " ", "are", " ", "the", " ", "normalization", " ", "coefficients",
     " ", "for", " ", "the", " ", "three", " ", "Gaussians"}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    SubscriptBox["n", "s"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["W", "s"], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{"\[Pi]", "*", "2"}], "]"}], "*", 
       SubscriptBox["q", "s"]}], ")"}]}]}], " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"//.", "rules2"}], ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["n", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["W", "i"], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{"\[Pi]", "*", "2"}], "]"}], "*", 
       SubscriptBox["q", "i"]}], ")"}]}]}], " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"//.", "rules2"}], ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["n", "p"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["W", "p"], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{"\[Pi]", "*", "2"}], "]"}], "*", 
       SubscriptBox["q", "p"]}], ")"}]}]}], " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"//.", " ", "rules2"}], ";"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.582676438761138*^9, 3.582676528731468*^9}, {
  3.582676729795623*^9, 3.5826767327704906`*^9}, {3.589231298763981*^9, 
  3.589231302850792*^9}, {3.589301582840025*^9, 3.589301588609139*^9}, {
  3.589301902546296*^9, 3.589301935466913*^9}, {3.5893022782276497`*^9, 
  3.5893022799150763`*^9}}],

Cell[BoxData[
 FractionBox[
  SubscriptBox["W", "s"], 
  RowBox[{
   SqrtBox[
    RowBox[{"2", " ", "\[Pi]"}]], " ", 
   SubscriptBox["q", "s"]}]]], "Output",
 CellChangeTimes->{
  3.589301589846518*^9, 3.5893022935106573`*^9, {3.589310738105459*^9, 
   3.5893107426903133`*^9}}],

Cell[BoxData[
 FractionBox[
  SubscriptBox["W", "i"], 
  RowBox[{
   SqrtBox[
    RowBox[{"2", " ", "\[Pi]"}]], " ", 
   SubscriptBox["q", "i"]}]]], "Output",
 CellChangeTimes->{
  3.589301589846518*^9, 3.5893022935106573`*^9, {3.589310738105459*^9, 
   3.589310742692672*^9}}],

Cell[BoxData[
 FractionBox[
  SubscriptBox["W", "p"], 
  RowBox[{
   SqrtBox[
    RowBox[{"2", " ", "\[Pi]"}]], " ", 
   SubscriptBox["q", "p"]}]]], "Output",
 CellChangeTimes->{
  3.589301589846518*^9, 3.5893022935106573`*^9, {3.589310738105459*^9, 
   3.589310742694212*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Here", " ", "is", " ", "the", " ", "argument", " ", "in", " ", "the", 
     " ", "exponential", " ", "that", " ", "we", " ", "will", " ", "want", 
     " ", "to", " ", "integrate", " ", "over", " ", "wrt", " ", "to", " ", 
     "x"}], ",", " ", "y", ",", " ", 
    RowBox[{"and", " ", 
     RowBox[{"z", "."}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Arg1", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "1"}], "/", 
       RowBox[{"(", 
        RowBox[{"2", "*", 
         SubscriptBox["q", "s"]}], ")"}]}], "*", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["x", "s"], "2"], "+", 
        SuperscriptBox[
         SubscriptBox["y", "s"], "2"]}], ")"}]}], "-", 
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{"2", "*", 
         SubscriptBox["q", "i"]}], ")"}]}], 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["x", "i"], "2"], "+", 
        SuperscriptBox[
         SubscriptBox["y", "i"], "2"]}], ")"}]}], "-", 
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{"2", "*", 
         SubscriptBox["q", "p"]}], ")"}]}], "*", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["x", "p"], "2"], "+", 
        SuperscriptBox[
         SubscriptBox["y", "p"], "2"]}], ")"}]}], " ", "-", " ", 
     RowBox[{"\[ImaginaryI]", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[CapitalDelta]K", "x"], "*", "x"}], " ", "+", " ", 
        RowBox[{
         SubscriptBox["\[CapitalDelta]K", "y"], "*", "y"}], "+", 
        RowBox[{
         SubscriptBox["\[CapitalDelta]K", "z"], "*", "z"}]}], ")"}]}]}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.5825533941941223`*^9, 3.5825535539588547`*^9}, {
   3.5825536033128633`*^9, 3.582553608767806*^9}, 3.582553712131874*^9, {
   3.582553783669939*^9, 3.58255382316961*^9}, {3.582561756372466*^9, 
   3.582561771923471*^9}, 3.582561807119581*^9, {3.582562474614017*^9, 
   3.582562499613974*^9}, {3.582582135209609*^9, 3.5825821366901712`*^9}, {
   3.582600600836162*^9, 3.5826006048984003`*^9}, {3.582676452509242*^9, 
   3.582676454063005*^9}, 3.589299256121154*^9, 3.589299487656785*^9, {
   3.589301942732774*^9, 3.58930196123344*^9}, {3.589302272043653*^9, 
   3.589302274307569*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     SuperscriptBox["x", "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "y"}], " ", 
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Theta]", "i"], "]"}]}], "-", 
        RowBox[{"z", " ", 
         RowBox[{"Sin", "[", 
          SubscriptBox["\[Theta]", "i"], "]"}]}]}], ")"}], "2"]}], 
    RowBox[{"2", " ", 
     SubscriptBox["q", "i"]}]]}], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["x", "2"], "+", 
    SuperscriptBox["y", "2"]}], 
   RowBox[{"2", " ", 
    SubscriptBox["q", "p"]}]], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["x", "2"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"y", " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "s"], "]"}]}], "-", 
       RowBox[{"z", " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["\[Theta]", "s"], "]"}]}]}], ")"}], "2"]}], 
   RowBox[{"2", " ", 
    SubscriptBox["q", "s"]}]], "-", 
  RowBox[{"\[ImaginaryI]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"x", " ", 
      SubscriptBox["\[CapitalDelta]K", "x"]}], "+", 
     RowBox[{"y", " ", 
      SubscriptBox["\[CapitalDelta]K", "y"]}], "+", 
     RowBox[{"z", " ", 
      SubscriptBox["\[CapitalDelta]K", "z"]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.589299488242174*^9, {3.5893000555344667`*^9, 3.5893000820739613`*^9}, 
   3.5893004350889397`*^9, 3.589301594050891*^9, {3.589301949215291*^9, 
   3.589301961964964*^9}, 3.589302295227172*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "First", " ", "we", " ", "complete", " ", "the", " ", "square", " ", "wrt",
     " ", "to", " ", 
    RowBox[{"x", ".", " ", "This"}], " ", "makes", " ", "it", " ", "easier", 
    " ", "to", " ", "analytically", " ", "carry", " ", "out", " ", "the", " ", 
    RowBox[{"integration", "."}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Arg1", " ", "=", " ", 
     RowBox[{"CompleteSquare", "[", 
      RowBox[{"Arg1", ",", " ", "x"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"cx", ",", "bx", ",", "ax"}], "}"}], "=", 
     RowBox[{"CoefficientList", "[", 
      RowBox[{"Arg1", ",", "x"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"yzcoeff", " ", "=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{"(", 
       RowBox[{"cx", "-", 
        RowBox[{
         RowBox[{
          RowBox[{"bx", "^", "2"}], "/", "4"}], "/", "ax"}]}], ")"}], "]"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"coeffx", " ", "=", "ax"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Now", " ", "complete", " ", "the", " ", "square", " ", "for", " ", "yz", 
     " ", "remainder", " ", "with", " ", "respect", " ", "to", " ", "y"}], 
    "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Arg2", " ", "=", " ", 
     RowBox[{"CompleteSquare", "[", 
      RowBox[{"yzcoeff", ",", " ", "y"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"cy", ",", "by", ",", "ay"}], "}"}], "=", 
     RowBox[{"CoefficientList", "[", 
      RowBox[{"Arg2", ",", "y"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"coeffy", " ", "=", " ", "ay"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"zint", " ", "=", "  ", 
     RowBox[{"Simplify", "[", 
      RowBox[{"(", 
       RowBox[{"cy", "-", 
        RowBox[{
         RowBox[{
          RowBox[{"by", "^", "2"}], "/", "4"}], "/", "ay"}]}], ")"}], "]"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Assuming", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox["q", "i"], ">", "0"}], " ", "&&", " ", 
       RowBox[{
        SubscriptBox["q", "s"], ">", "0"}], " ", "&&", " ", 
       RowBox[{
        SubscriptBox["q", "p"], ">", "0"}], " ", "&&", " ", 
       RowBox[{
        SubscriptBox["\[Theta]", "i"], ">", "0"}], " ", "&&", " ", 
       RowBox[{
        SubscriptBox["\[Theta]", "s"], ">", "0"}], " ", "&&", " ", 
       RowBox[{
        SubscriptBox["\[CapitalDelta]K", "x"], " ", ">", "0"}], " ", "&&", 
       " ", 
       RowBox[{
        SubscriptBox["\[CapitalDelta]K", "y"], " ", ">", "0"}], " ", "&&", 
       " ", 
       RowBox[{
        SubscriptBox["\[CapitalDelta]K", "z"], ">", "0"}], " ", "&&", 
       RowBox[{"y", ">", "0"}], " ", "&&", 
       RowBox[{"z", ">", "0"}]}], ",", " ", 
      RowBox[{"Integrate", "[", " ", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{"-", "zint"}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"z", ",", " ", 
          RowBox[{"-", "\[Infinity]"}], ",", " ", "\[Infinity]"}], "}"}]}], 
       "]"}]}], "]"}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.5825537185392857`*^9, 3.582553738312705*^9}, {
  3.582582174512424*^9, 3.582582196639732*^9}, {3.589299359249379*^9, 
  3.58929940769029*^9}, {3.589299706788805*^9, 3.589299953474846*^9}, {
  3.589300074213222*^9, 3.5893001254984083`*^9}, {3.589300366692685*^9, 
  3.589300470243595*^9}, {3.589300526730879*^9, 3.589300583491335*^9}, {
  3.5893006199514933`*^9, 3.589300807810451*^9}, {3.589300973245274*^9, 
  3.5893010229373007`*^9}, {3.5893025507863827`*^9, 3.589302556458641*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.5892997322432404`*^9, 3.589299732949974*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "The", " ", "x", " ", "and", " ", "y", " ", "integrals", " ", "reduce", 
    " ", "to", " ", "the", " ", "following", " ", "constants"}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"xconst", "=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Sqrt]", "\[Pi]"}], "/", 
        RowBox[{"\[Sqrt]", 
         RowBox[{"(", 
          RowBox[{"-", "coeffx"}], ")"}]}]}], " ", "//.", "rules2"}], "]"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"yconst", "=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Sqrt]", "\[Pi]"}], "/", 
        RowBox[{"\[Sqrt]", 
         RowBox[{"(", 
          RowBox[{"-", "coeffy"}], ")"}]}]}], " ", "//.", "rules2"}], "]"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xonst", " ", "=", " ", 
     RowBox[{"xconst", " ", "/.", " ", "rulesq"}]}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"yconst", " ", "=", " ", 
     RowBox[{"yconst", " ", "/.", "rulesq"}]}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"zint", " ", "=", 
     RowBox[{"Simplify", "[", " ", 
      RowBox[{"zint", " ", "/.", " ", "rulesq"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Zexpress", " ", "=", 
     RowBox[{"Exp", "[", "zint", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "This", " ", "leaves", " ", "us", " ", "with", " ", "just", " ", "the", 
     " ", "z", " ", 
     RowBox[{"integral", ".", " ", "Find"}], " ", "the", " ", "coefficients", 
     " ", "so", " ", "we", " ", "can", " ", "plug", " ", "it", " ", "into", 
     " ", "our", " ", "solved", " ", "integral", " ", "form"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"cz", ",", "bz"}], "}"}], "=", 
     RowBox[{"CoefficientList", "[", " ", 
      RowBox[{"zint", ",", "z"}], "]"}]}], " ", ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"AA", " ", "=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{"-", "az"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AA", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"BB", " ", "=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{"-", "bz"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CC", " ", "=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{"-", "cz"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.5825538416732683`*^9, 3.5825540262026253`*^9}, {
   3.582554070185461*^9, 3.58255407764716*^9}, 3.5825618686585283`*^9, 
   3.5825619031644173`*^9, {3.582582212811741*^9, 3.5825822216126223`*^9}, {
   3.582598740623023*^9, 3.5825987588152237`*^9}, 3.582598791694824*^9, 
   3.5826007798659353`*^9, {3.582600814519813*^9, 3.5826010290448103`*^9}, 
   3.582601333150104*^9, 3.5826014723118773`*^9, {3.582672389928055*^9, 
   3.5826724027171583`*^9}, {3.582674796730681*^9, 3.5826747992116013`*^9}, 
   3.5891463574943027`*^9, {3.5892291069528646`*^9, 3.5892291279266253`*^9}, 
   3.589299315272929*^9, {3.5892994199671593`*^9, 3.589299433917345*^9}, {
   3.589300836392149*^9, 3.589300943644602*^9}, {3.589301033831832*^9, 
   3.589301125570545*^9}, {3.589301176199456*^9, 3.5893011811906357`*^9}, {
   3.58930126916422*^9, 3.5893013256175747`*^9}, {3.589301359370359*^9, 
   3.589301389325317*^9}, {3.589302013723062*^9, 3.589302017465081*^9}, {
   3.589302076689983*^9, 3.589302138029945*^9}, {3.589302168188575*^9, 
   3.589302250597705*^9}, 3.589302338688246*^9, {3.589302401133462*^9, 
   3.589302409057458*^9}, {3.589302686030478*^9, 3.5893027019333267`*^9}, {
   3.589302734154758*^9, 3.5893027372989063`*^9}, {3.589302777895915*^9, 
   3.589302795645793*^9}, {3.589302948609424*^9, 3.58930297384866*^9}, {
   3.589303285661346*^9, 3.589303363589128*^9}, {3.589303473996633*^9, 
   3.589303482212236*^9}, {3.589303735528884*^9, 3.589303740601049*^9}, {
   3.589303947560666*^9, 3.589303953147936*^9}, 3.5893040110316067`*^9, {
   3.589310529899806*^9, 3.5893105385782003`*^9}, {3.5893105908829403`*^9, 
   3.589310687782134*^9}, {3.589310768063574*^9, 3.589310891354974*^9}, {
   3.589310960638303*^9, 3.589310990026972*^9}, 3.5893112701563873`*^9}],

Cell[BoxData[
 RowBox[{"\[ImaginaryI]", " ", 
  SubscriptBox["\[CapitalDelta]K", "z"]}]], "Output",
 CellChangeTimes->{3.5893112708803997`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"While", " ", "AA"}], ",", " ", "BB", ",", " ", 
    RowBox[{"and", " ", "CC", " ", "look", " ", "initially", " ", "ugly"}], 
    ",", " ", 
    RowBox[{"they", " ", "simplify", " ", "down", " ", 
     RowBox[{"somewhat", ".", " ", "This"}], " ", "leaves", " ", "us", " ", 
     "with", " ", "real", " ", "coefficients", " ", "for", " ", 
     RowBox[{"z", "^", "2"}], " ", "and", " ", "imaginary", " ", 
     "coefficents", " ", "for", " ", 
     RowBox[{"z", ".", " ", "Now"}]}], ",", " ", 
    RowBox[{
    "this", " ", "integral", " ", "leads", " ", "to", " ", "error", " ", 
     RowBox[{"functions", ".", " ", "Instead"}]}], ",", " ", 
    RowBox[{
    "look", " ", "at", " ", "Taylor", " ", "expanding", " ", "what", " ", 
     "is", " ", "in", " ", "the", " ", "integrand", " ", "and", " ", "then", 
     " ", "carry", " ", "out", " ", "the", " ", 
     RowBox[{"integral", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"IntResult", "=", 
     RowBox[{"Normal", "[", 
      RowBox[{"Assuming", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"R", ">", 
          RowBox[{"-", "inf"}]}], " ", "&&", " ", 
         RowBox[{"S", ">", 
          RowBox[{"-", "inf"}]}], " ", "&&", " ", 
         RowBox[{"T", ">", 
          RowBox[{"-", "inf"}]}]}], " ", ",", " ", 
        RowBox[{"Integrate", "[", 
         RowBox[{
          RowBox[{"Series", "[", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"z", "^", "2"}]}], " ", "*", 
               RowBox[{"(", "R", " ", ")"}]}], " ", "-", 
              RowBox[{"z", " ", "*", 
               RowBox[{"(", 
                RowBox[{"\[ImaginaryI]", "*", "S"}], ")"}]}], " ", "-", " ", 
              "T"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"z", ",", "0", ",", "15"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"z", ",", "0", ",", "L"}], "}"}]}], "]"}]}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"IntResultExact", " ", "=", 
    RowBox[{"Normal", "[", 
     RowBox[{"Assuming", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"R", ">", 
         RowBox[{"-", "inf"}]}], " ", "&&", " ", 
        RowBox[{"S", ">", 
         RowBox[{"-", "inf"}]}], " ", "&&", " ", 
        RowBox[{"T", ">", 
         RowBox[{"-", "inf"}]}]}], " ", ",", " ", 
       RowBox[{"Integrate", "[", 
        RowBox[{
         RowBox[{"Exp", "[", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "z"}], " ", "*", 
            RowBox[{"(", 
             RowBox[{"\[ImaginaryI]", "*", "S"}], ")"}]}], " ", "-", " ", 
           "T"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"z", ",", "0", ",", "L"}], "}"}]}], "]"}]}], "]"}], "]"}]}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"IntResultExact", " ", "/.", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"R", " ", "\[Rule]", " ", "AA"}], ",", " ", 
       RowBox[{"S", " ", "\[Rule]", " ", "BB"}], ",", " ", 
       RowBox[{"T", " ", "\[Rule]", " ", "CC"}]}], "}"}]}], "  ", 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.5825541447325993`*^9, 3.582554218173704*^9}, {
   3.582554311787928*^9, 3.582554332788763*^9}, 3.582562009349558*^9, 
   3.582598942001313*^9, 3.582599220705217*^9, 3.582601424927206*^9, {
   3.5826019630624943`*^9, 3.582601984307494*^9}, 3.5826724646779633`*^9, 
   3.5891464228443213`*^9, 3.589301227499234*^9, 3.589301370740279*^9, {
   3.5893014329726353`*^9, 3.5893015115305567`*^9}, {3.589302039289466*^9, 
   3.589302042950698*^9}, {3.589302889573372*^9, 3.58930290480516*^9}, 
   3.5893110584640427`*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[ImaginaryI]", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", "T"}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "L", " ", "S"}]]}], ")"}]}], 
  "S"]], "Output",
 CellChangeTimes->{{3.58930149852104*^9, 3.589301513184278*^9}, 
   3.589301611362764*^9, 3.589301977167297*^9, {3.589302024141033*^9, 
   3.589302044428524*^9}, 3.589302850635663*^9, {3.589302891470963*^9, 
   3.5893029069855623`*^9}, 3.589303743834991*^9, 3.589303958720764*^9, 
   3.589311006406465*^9, 3.589311061153949*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.582554782936783*^9, 3.582554879991461*^9}, {
  3.582561583029579*^9, 3.582561640762952*^9}, {3.582561709843975*^9, 
  3.582561728675111*^9}, {3.5825621373940763`*^9, 3.582562190880147*^9}, {
  3.582562223501135*^9, 3.5825623913615503`*^9}, {3.582562435870626*^9, 
  3.582562439376598*^9}, {3.582562521558365*^9, 3.5825625801356792`*^9}, {
  3.582563110806714*^9, 3.58256311328623*^9}, {3.582566065536174*^9, 
  3.5825661004693317`*^9}, {3.5892292429502087`*^9, 3.5892292435101557`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.58256349132627*^9, 3.582563495110099*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.582599863339098*^9, 3.582599863349024*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "That", " ", "worked", " ", "out", " ", "nicer", " ", "than", " ", 
    RowBox[{"expected", "!"}], " ", "Now", " ", 
    RowBox[{"let", "'"}], "s", " ", "try", " ", "the", " ", "ratio", " ", 
    "of", " ", "the", " ", "series", " ", "expansion", " ", "of", " ", "the", 
    " ", "two", " ", 
    RowBox[{"integrals", "."}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"rules2a", " ", ":=", " ", 
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Theta]", "s"], " ", "\[Rule]", " ", 
       RowBox[{"0.000001", "*", 
        RowBox[{"\[Pi]", "/", "180"}]}]}], ",", " ", 
      RowBox[{
       SubscriptBox["\[Theta]", "i"], " ", "\[Rule]", 
       RowBox[{"0", "*", 
        RowBox[{"\[Pi]", "/", "180"}]}]}], " ", ",", " ", 
      RowBox[{
       SubscriptBox["W", "s"], " ", "\[Rule]", " ", ".0006"}], ",", " ", 
      RowBox[{
       SubscriptBox["W", "i"], " ", "\[Rule]", " ", ".0006"}], ",", " ", 
      RowBox[{
       SubscriptBox["W", "p"], "\[Rule]", " ", ".001"}], ",", "   ", 
      RowBox[{
       SubscriptBox["\[CapitalDelta]K", "x"], " ", "\[Rule]", "0"}], ",", 
      "  ", 
      RowBox[{
       SubscriptBox["\[CapitalDelta]K", "y"], " ", "\[Rule]", "0"}], ",", " ", 
      RowBox[{
       SubscriptBox["\[CapitalDelta]K", "z"], "\[Rule]", ".01"}], ",", " ", 
      RowBox[{"L", " ", "\[Rule]", " ", ".01"}]}], "}"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"rulesc", " ", ":=", " ", 
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Theta]", "s"], " ", "\[Rule]", " ", 
       RowBox[{"0.00", "*", 
        RowBox[{"\[Pi]", "/", "180"}]}]}], ",", " ", 
      RowBox[{
       SubscriptBox["\[Theta]", "i"], " ", "\[Rule]", " ", 
       RowBox[{"0.00", "*", 
        RowBox[{"\[Pi]", "/", "180"}]}]}], ",", " ", 
      RowBox[{
       SubscriptBox["\[CapitalDelta]K", "x"], " ", "\[Rule]", "0"}], ",", " ", 
      RowBox[{
       SubscriptBox["\[CapitalDelta]K", "z"], "\[Rule]", "0"}], " ", ",", " ", 
      RowBox[{
       SubscriptBox["\[CapitalDelta]K", "y"], " ", "\[Rule]", " ", "0"}]}], 
     "}"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      SubscriptBox["P", "coinc"], " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"xconst", "*", "yconst", "*", 
           SubscriptBox["n", "i"], "*", 
           SubscriptBox["n", "s"], "*", 
           SubscriptBox["n", "p"], "*", "IntResultExact"}], "]"}], "^", "2"}],
         " ", "/.", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"R", " ", "\[Rule]", " ", "AA"}], ",", " ", 
          RowBox[{"S", " ", "\[Rule]", " ", "BB"}], ",", " ", 
          RowBox[{"T", " ", "\[Rule]", " ", "CC"}]}], "}"}]}], "  ", "/.", 
       "rulesq"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["P", "coinc"], " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", "IntResultExact", "]"}], "^", "2"}], " ", "/.", 
       " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"R", " ", "\[Rule]", " ", "AA"}], "  ", ",", " ", 
         RowBox[{"S", " ", "\[Rule]", " ", "BB"}], "  ", ",", " ", 
         RowBox[{"T", " ", "\[Rule]", " ", "CC"}]}], " ", "}"}]}], "  ", "/.",
       "rulesq"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"zint", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"zc", ",", "zb", ",", "za"}], "}"}], "=", 
     RowBox[{"CoefficientList", "[", 
      RowBox[{"zint", ",", " ", "z"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "zb", "\[IndentingNewLine]", "za", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{"Exp", "[", 
      RowBox[{"-", "\[ImaginaryI]z"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"z", ",", 
       RowBox[{
        RowBox[{"-", "L"}], "/", "2"}], ",", 
       RowBox[{"L", "/", "2"}]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GaussTerm", " ", "=", " ", 
     RowBox[{"Exp", "[", "zc", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"GaussTerm", " ", "/.", "rules2a"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["P", "coinc"], " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"GaussTerm", "*", " ", "IntResultExact"}], "]"}], "^", "2"}],
        " ", "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"R", " ", "\[Rule]", " ", "AA"}], "  ", ",", " ", 
         RowBox[{"S", " ", "\[Rule]", " ", "BB"}], "  ", ",", " ", 
         RowBox[{"T", " ", "\[Rule]", "0"}]}], " ", "}"}]}], "  ", "/.", 
      "rulesq"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Take", " ", "out", " ", "the", " ", "constant", " ", "term"}], 
     ",", " ", 
     RowBox[{"leaving", " ", "only", " ", 
      RowBox[{"z", "^", "2"}], " ", "and", " ", "z"}]}], 
    "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Zexpress", " ", "*", "1."}], "/.", "rules2a"}], " ", "/.", " ", 
    
    RowBox[{"{", 
     RowBox[{"z", "\[Rule]", "0"}], "}"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"\"\<coinc\>\"", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["P", "coinc"], "/", 
     RowBox[{"L", "^", "2"}]}], " ", "/.", "rules2a"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.582569425920869*^9, 3.5825696338585043`*^9}, {
   3.5825701049369793`*^9, 3.58257013172652*^9}, {3.582581682138384*^9, 
   3.582581696816908*^9}, {3.582672926435391*^9, 3.582672969493376*^9}, 
   3.5826730590357122`*^9, {3.582673630467607*^9, 3.582673641219104*^9}, {
   3.582673939896338*^9, 3.5826741631619053`*^9}, {3.582674211487598*^9, 
   3.5826742375756207`*^9}, {3.582674324196042*^9, 3.582674325082368*^9}, {
   3.5826745785791197`*^9, 3.582674768747527*^9}, {3.5826748402281837`*^9, 
   3.582674848320345*^9}, {3.582676563250276*^9, 3.582676598509592*^9}, {
   3.5826767007783546`*^9, 3.5826767193737507`*^9}, {3.582677042395626*^9, 
   3.582677047054591*^9}, {3.5891532431981173`*^9, 3.589153334366681*^9}, {
   3.589153937038446*^9, 3.5891539492981377`*^9}, {3.589154153010461*^9, 
   3.589154179661923*^9}, {3.589155317005013*^9, 3.589155325479734*^9}, {
   3.589156627706032*^9, 3.5891566502135897`*^9}, {3.589157826668106*^9, 
   3.589157880100156*^9}, {3.589157951283845*^9, 3.589158001013797*^9}, {
   3.5891580416857367`*^9, 3.5891580420846853`*^9}, {3.589158092496931*^9, 
   3.589158241031499*^9}, {3.589158600611247*^9, 3.589158638096024*^9}, {
   3.589158675574966*^9, 3.58915874869798*^9}, {3.589158806021665*^9, 
   3.589158880207719*^9}, {3.589158939556984*^9, 3.589158940108856*^9}, {
   3.5891589846145563`*^9, 3.589159001231635*^9}, {3.589159085915511*^9, 
   3.589159115584244*^9}, {3.5891591568161163`*^9, 3.5891592356847553`*^9}, {
   3.589159292304716*^9, 3.589159442165369*^9}, {3.5891595281992407`*^9, 
   3.589159528823045*^9}, {3.589159576959828*^9, 3.589159644329967*^9}, {
   3.5891601539717607`*^9, 3.589160208678763*^9}, {3.5891602404064913`*^9, 
   3.589160365267049*^9}, {3.589160401722396*^9, 3.589160483570478*^9}, {
   3.589160514087223*^9, 3.589160605500618*^9}, {3.5891606372610083`*^9, 
   3.5891606544094763`*^9}, {3.589160686428739*^9, 3.589160701564342*^9}, {
   3.5891607399099827`*^9, 3.589160761256093*^9}, {3.589160860691533*^9, 
   3.589160988094215*^9}, {3.589161080755043*^9, 3.5891611249474363`*^9}, {
   3.589161211963291*^9, 3.589161212276353*^9}, 3.5891612568535833`*^9, {
   3.589161455487368*^9, 3.589161459685523*^9}, {3.589161519036232*^9, 
   3.589161576235293*^9}, {3.589161622138089*^9, 3.5891616482750196`*^9}, 
   3.589161716718768*^9, {3.589161791943503*^9, 3.589161896045944*^9}, {
   3.589162575388196*^9, 3.589162772123802*^9}, {3.589162811699679*^9, 
   3.589162853671826*^9}, {3.5891628873016148`*^9, 3.589162897780089*^9}, {
   3.589163032629395*^9, 3.58916303562201*^9}, {3.589163143770659*^9, 
   3.589163253689801*^9}, {3.589163313156631*^9, 3.589163313820606*^9}, {
   3.589163356097204*^9, 3.589163393684507*^9}, {3.589163440713049*^9, 
   3.589163453199238*^9}, {3.5891634961363487`*^9, 3.589163537214642*^9}, {
   3.589168405075304*^9, 3.5891685132938623`*^9}, {3.5891685801385517`*^9, 
   3.5891685808208113`*^9}, {3.58916897585096*^9, 3.589169050290517*^9}, {
   3.589169110380064*^9, 3.589169241980283*^9}, {3.5891692874335833`*^9, 
   3.589169337775983*^9}, {3.5891696842178173`*^9, 3.589169701151493*^9}, {
   3.589169739702095*^9, 3.589169813812231*^9}, {3.5891698868091393`*^9, 
   3.589169994822295*^9}, {3.5891700269912786`*^9, 3.5891701246304502`*^9}, 
   3.589170169504209*^9, 3.589170282296586*^9, {3.589170327961761*^9, 
   3.5891703568427896`*^9}, {3.589170456369104*^9, 3.589170502029262*^9}, {
   3.5891705363531303`*^9, 3.58917054144496*^9}, {3.589170574687524*^9, 
   3.589170591996751*^9}, {3.589229362805522*^9, 3.5892293926482983`*^9}, {
   3.5892294237459908`*^9, 3.5892295031430407`*^9}, {3.589229541483672*^9, 
   3.589229620674686*^9}, {3.5892296527503033`*^9, 3.589229707890884*^9}, {
   3.589229785806171*^9, 3.589229999517687*^9}, {3.589230029532621*^9, 
   3.589230035349491*^9}, {3.589230201469915*^9, 3.589230236809811*^9}, {
   3.589230321948854*^9, 3.5892303763879023`*^9}, {3.5892313643734827`*^9, 
   3.589231376724577*^9}, {3.589231442795197*^9, 3.589231447680438*^9}, 
   3.5892314872182703`*^9, {3.58923152697246*^9, 3.589231578223029*^9}, 
   3.589231647125949*^9, {3.5892316772462997`*^9, 3.5892316816048107`*^9}, {
   3.589231758927093*^9, 3.589231787076186*^9}, {3.589231821558991*^9, 
   3.589231884206897*^9}, {3.589231971117025*^9, 3.589232037233964*^9}, {
   3.589303435309944*^9, 3.5893034569177513`*^9}, {3.589303522011732*^9, 
   3.5893037164337807`*^9}, {3.5893037497536993`*^9, 3.589303797888784*^9}, {
   3.5893038825691357`*^9, 3.589303932818758*^9}, {3.589303969498559*^9, 
   3.589303970230893*^9}, {3.5893040302391043`*^9, 3.589304033759424*^9}, {
   3.589304087271832*^9, 3.589304087799521*^9}, {3.589304145775009*^9, 
   3.589304149062793*^9}, {3.5893043025127497`*^9, 3.589304514984291*^9}, {
   3.589305097417087*^9, 3.589305194769526*^9}, {3.589306711055941*^9, 
   3.589306862744622*^9}, {3.589306943541304*^9, 3.589306987100559*^9}, {
   3.589307023005899*^9, 3.589307126577189*^9}, {3.5893072165574703`*^9, 
   3.5893072183091803`*^9}, {3.589308491910363*^9, 3.589308518262466*^9}, {
   3.589308646349938*^9, 3.589309070925112*^9}, {3.589309120751752*^9, 
   3.589309148276587*^9}, {3.5893094561072598`*^9, 3.589309565641467*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       SubscriptBox["\[Theta]", "s"]}], "]"}], " ", 
     SubsuperscriptBox["W", "i", "2"], " ", 
     SubsuperscriptBox["W", "p", "2"], " ", 
     SubscriptBox["\[CapitalDelta]K", "y"]}], 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
        SubsuperscriptBox["W", "p", "2"], " ", 
        SubsuperscriptBox["W", "s", "2"]}], "+", 
       RowBox[{
        SubsuperscriptBox["W", "i", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
           SubsuperscriptBox["W", "p", "2"]}], "+", 
          SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}], ")"}]}]]}], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", 
      SubscriptBox["\[Theta]", "i"]}], "]"}], " ", 
    SubsuperscriptBox["W", "p", "2"], " ", 
    SubsuperscriptBox["W", "s", "2"], " ", 
    SubscriptBox["\[CapitalDelta]K", "y"]}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
       SubsuperscriptBox["W", "p", "2"], " ", 
       SubsuperscriptBox["W", "s", "2"]}], "+", 
      RowBox[{
       SubsuperscriptBox["W", "i", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
          SubsuperscriptBox["W", "p", "2"]}], "+", 
         SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}], ")"}]}]], "-", 
  RowBox[{"\[ImaginaryI]", " ", 
   SubscriptBox["\[CapitalDelta]K", "z"]}]}]], "Output",
 CellChangeTimes->{
  3.5891705034223213`*^9, 3.589170543594245*^9, 3.5891705943238087`*^9, 
   3.589228474625073*^9, 3.58922929715233*^9, 3.589229397323263*^9, 
   3.589229437718466*^9, {3.589229479467857*^9, 3.5892295041244993`*^9}, {
   3.589229543198606*^9, 3.5892295985968657`*^9}, 3.589229628740848*^9, {
   3.58922966429095*^9, 3.589229709718603*^9}, {3.589229814148316*^9, 
   3.589229841498925*^9}, {3.58922987160826*^9, 3.5892299196144457`*^9}, {
   3.5892299745729103`*^9, 3.589230001359622*^9}, 3.589230036456449*^9, {
   3.589230208789027*^9, 3.589230237944112*^9}, 3.58923032882548*^9, 
   3.589230377942834*^9, 3.589231056338314*^9, 3.589231323411833*^9, 
   3.5892313821700563`*^9, 3.589231448710328*^9, 3.589231488211689*^9, {
   3.589231536223584*^9, 3.5892315925143433`*^9}, 3.589231648236465*^9, 
   3.589231682741846*^9, {3.589231776743471*^9, 3.589231794377118*^9}, {
   3.589231824796137*^9, 3.5892318483445272`*^9}, 3.589231885201357*^9, {
   3.5892319723379593`*^9, 3.589232041882937*^9}, {3.5893034405899973`*^9, 
   3.589303457458866*^9}, 3.589303544271523*^9, {3.589303577125038*^9, 
   3.589303799001203*^9}, {3.589303891348263*^9, 3.58930397119461*^9}, 
   3.5893040346841097`*^9, 3.589304088325039*^9, 3.589304150404533*^9, {
   3.589304312622707*^9, 3.589304351861372*^9}, {3.589304384498247*^9, 
   3.589304515833806*^9}, {3.589305122021112*^9, 3.58930517674946*^9}, {
   3.58930671531361*^9, 3.589306863351611*^9}, {3.5893069729733973`*^9, 
   3.589306992004743*^9}, {3.589307027393774*^9, 3.589307097151433*^9}, 
   3.589307127475045*^9, 3.5893072199185047`*^9, {3.5893084929425783`*^9, 
   3.589308519002639*^9}, 3.5893086550527353`*^9, {3.589308734748457*^9, 
   3.5893087725708437`*^9}, {3.589308815259431*^9, 3.589308833641979*^9}, {
   3.589308878899212*^9, 3.589309071475863*^9}, {3.589309121319646*^9, 
   3.589309149406254*^9}, {3.589309501423503*^9, 3.589309566218771*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    SuperscriptBox[
     RowBox[{"Sin", "[", 
      SubscriptBox["\[Theta]", "i"], "]"}], "2"], 
    RowBox[{"2", " ", 
     SubsuperscriptBox["W", "i", "2"]}]]}], "-", 
  FractionBox[
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     SubscriptBox["\[Theta]", "s"], "]"}], "2"], 
   RowBox[{"2", " ", 
    SubsuperscriptBox["W", "s", "2"]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", 
      SubscriptBox["\[Theta]", "i"]}], "]"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", 
      SubscriptBox["\[Theta]", "s"]}], "]"}], " ", 
    SubsuperscriptBox["W", "p", "2"]}], 
   RowBox[{"4", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
       SubsuperscriptBox["W", "p", "2"], " ", 
       SubsuperscriptBox["W", "s", "2"]}], "+", 
      RowBox[{
       SubsuperscriptBox["W", "i", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
          SubsuperscriptBox["W", "p", "2"]}], "+", 
         SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       SubscriptBox["\[Theta]", "s"]}], "]"}], "2"], " ", 
    SubsuperscriptBox["W", "i", "2"], " ", 
    SubsuperscriptBox["W", "p", "2"]}], 
   RowBox[{"8", " ", 
    SubsuperscriptBox["W", "s", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
       SubsuperscriptBox["W", "p", "2"], " ", 
       SubsuperscriptBox["W", "s", "2"]}], "+", 
      RowBox[{
       SubsuperscriptBox["W", "i", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
          SubsuperscriptBox["W", "p", "2"]}], "+", 
         SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       SubscriptBox["\[Theta]", "i"]}], "]"}], "2"], " ", 
    SubsuperscriptBox["W", "p", "2"], " ", 
    SubsuperscriptBox["W", "s", "2"]}], 
   RowBox[{"8", " ", 
    SubsuperscriptBox["W", "i", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
       SubsuperscriptBox["W", "p", "2"], " ", 
       SubsuperscriptBox["W", "s", "2"]}], "+", 
      RowBox[{
       SubsuperscriptBox["W", "i", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
          SubsuperscriptBox["W", "p", "2"]}], "+", 
         SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}], ")"}]}]]}]], "Output",\

 CellChangeTimes->{
  3.5891705034223213`*^9, 3.589170543594245*^9, 3.5891705943238087`*^9, 
   3.589228474625073*^9, 3.58922929715233*^9, 3.589229397323263*^9, 
   3.589229437718466*^9, {3.589229479467857*^9, 3.5892295041244993`*^9}, {
   3.589229543198606*^9, 3.5892295985968657`*^9}, 3.589229628740848*^9, {
   3.58922966429095*^9, 3.589229709718603*^9}, {3.589229814148316*^9, 
   3.589229841498925*^9}, {3.58922987160826*^9, 3.5892299196144457`*^9}, {
   3.5892299745729103`*^9, 3.589230001359622*^9}, 3.589230036456449*^9, {
   3.589230208789027*^9, 3.589230237944112*^9}, 3.58923032882548*^9, 
   3.589230377942834*^9, 3.589231056338314*^9, 3.589231323411833*^9, 
   3.5892313821700563`*^9, 3.589231448710328*^9, 3.589231488211689*^9, {
   3.589231536223584*^9, 3.5892315925143433`*^9}, 3.589231648236465*^9, 
   3.589231682741846*^9, {3.589231776743471*^9, 3.589231794377118*^9}, {
   3.589231824796137*^9, 3.5892318483445272`*^9}, 3.589231885201357*^9, {
   3.5892319723379593`*^9, 3.589232041882937*^9}, {3.5893034405899973`*^9, 
   3.589303457458866*^9}, 3.589303544271523*^9, {3.589303577125038*^9, 
   3.589303799001203*^9}, {3.589303891348263*^9, 3.58930397119461*^9}, 
   3.5893040346841097`*^9, 3.589304088325039*^9, 3.589304150404533*^9, {
   3.589304312622707*^9, 3.589304351861372*^9}, {3.589304384498247*^9, 
   3.589304515833806*^9}, {3.589305122021112*^9, 3.58930517674946*^9}, {
   3.58930671531361*^9, 3.589306863351611*^9}, {3.5893069729733973`*^9, 
   3.589306992004743*^9}, {3.589307027393774*^9, 3.589307097151433*^9}, 
   3.589307127475045*^9, 3.5893072199185047`*^9, {3.5893084929425783`*^9, 
   3.589308519002639*^9}, 3.5893086550527353`*^9, {3.589308734748457*^9, 
   3.5893087725708437`*^9}, {3.589308815259431*^9, 3.589308833641979*^9}, {
   3.589308878899212*^9, 3.589309071475863*^9}, {3.589309121319646*^9, 
   3.589309149406254*^9}, {3.589309501423503*^9, 3.589309566222507*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"-", "\[ImaginaryI]z"}]], " ", "L"}]], "Output",
 CellChangeTimes->{
  3.5891705034223213`*^9, 3.589170543594245*^9, 3.5891705943238087`*^9, 
   3.589228474625073*^9, 3.58922929715233*^9, 3.589229397323263*^9, 
   3.589229437718466*^9, {3.589229479467857*^9, 3.5892295041244993`*^9}, {
   3.589229543198606*^9, 3.5892295985968657`*^9}, 3.589229628740848*^9, {
   3.58922966429095*^9, 3.589229709718603*^9}, {3.589229814148316*^9, 
   3.589229841498925*^9}, {3.58922987160826*^9, 3.5892299196144457`*^9}, {
   3.5892299745729103`*^9, 3.589230001359622*^9}, 3.589230036456449*^9, {
   3.589230208789027*^9, 3.589230237944112*^9}, 3.58923032882548*^9, 
   3.589230377942834*^9, 3.589231056338314*^9, 3.589231323411833*^9, 
   3.5892313821700563`*^9, 3.589231448710328*^9, 3.589231488211689*^9, {
   3.589231536223584*^9, 3.5892315925143433`*^9}, 3.589231648236465*^9, 
   3.589231682741846*^9, {3.589231776743471*^9, 3.589231794377118*^9}, {
   3.589231824796137*^9, 3.5892318483445272`*^9}, 3.589231885201357*^9, {
   3.5892319723379593`*^9, 3.589232041882937*^9}, {3.5893034405899973`*^9, 
   3.589303457458866*^9}, 3.589303544271523*^9, {3.589303577125038*^9, 
   3.589303799001203*^9}, {3.589303891348263*^9, 3.58930397119461*^9}, 
   3.5893040346841097`*^9, 3.589304088325039*^9, 3.589304150404533*^9, {
   3.589304312622707*^9, 3.589304351861372*^9}, {3.589304384498247*^9, 
   3.589304515833806*^9}, {3.589305122021112*^9, 3.58930517674946*^9}, {
   3.58930671531361*^9, 3.589306863351611*^9}, {3.5893069729733973`*^9, 
   3.589306992004743*^9}, {3.589307027393774*^9, 3.589307097151433*^9}, 
   3.589307127475045*^9, 3.5893072199185047`*^9, {3.5893084929425783`*^9, 
   3.589308519002639*^9}, 3.5893086550527353`*^9, {3.589308734748457*^9, 
   3.5893087725708437`*^9}, {3.589308815259431*^9, 3.589308833641979*^9}, {
   3.589308878899212*^9, 3.589309071475863*^9}, {3.589309121319646*^9, 
   3.589309149406254*^9}, {3.589309501423503*^9, 3.58930956622397*^9}}],

Cell[BoxData["1.`"], "Output",
 CellChangeTimes->{
  3.5891705034223213`*^9, 3.589170543594245*^9, 3.5891705943238087`*^9, 
   3.589228474625073*^9, 3.58922929715233*^9, 3.589229397323263*^9, 
   3.589229437718466*^9, {3.589229479467857*^9, 3.5892295041244993`*^9}, {
   3.589229543198606*^9, 3.5892295985968657`*^9}, 3.589229628740848*^9, {
   3.58922966429095*^9, 3.589229709718603*^9}, {3.589229814148316*^9, 
   3.589229841498925*^9}, {3.58922987160826*^9, 3.5892299196144457`*^9}, {
   3.5892299745729103`*^9, 3.589230001359622*^9}, 3.589230036456449*^9, {
   3.589230208789027*^9, 3.589230237944112*^9}, 3.58923032882548*^9, 
   3.589230377942834*^9, 3.589231056338314*^9, 3.589231323411833*^9, 
   3.5892313821700563`*^9, 3.589231448710328*^9, 3.589231488211689*^9, {
   3.589231536223584*^9, 3.5892315925143433`*^9}, 3.589231648236465*^9, 
   3.589231682741846*^9, {3.589231776743471*^9, 3.589231794377118*^9}, {
   3.589231824796137*^9, 3.5892318483445272`*^9}, 3.589231885201357*^9, {
   3.5892319723379593`*^9, 3.589232041882937*^9}, {3.5893034405899973`*^9, 
   3.589303457458866*^9}, 3.589303544271523*^9, {3.589303577125038*^9, 
   3.589303799001203*^9}, {3.589303891348263*^9, 3.58930397119461*^9}, 
   3.5893040346841097`*^9, 3.589304088325039*^9, 3.589304150404533*^9, {
   3.589304312622707*^9, 3.589304351861372*^9}, {3.589304384498247*^9, 
   3.589304515833806*^9}, {3.589305122021112*^9, 3.58930517674946*^9}, {
   3.58930671531361*^9, 3.589306863351611*^9}, {3.5893069729733973`*^9, 
   3.589306992004743*^9}, {3.589307027393774*^9, 3.589307097151433*^9}, 
   3.589307127475045*^9, 3.5893072199185047`*^9, {3.5893084929425783`*^9, 
   3.589308519002639*^9}, 3.5893086550527353`*^9, {3.589308734748457*^9, 
   3.5893087725708437`*^9}, {3.589308815259431*^9, 3.589308833641979*^9}, {
   3.589308878899212*^9, 3.589309071475863*^9}, {3.589309121319646*^9, 
   3.589309149406254*^9}, {3.589309501423503*^9, 3.58930956622537*^9}}],

Cell[BoxData["1.`"], "Output",
 CellChangeTimes->{
  3.5891705034223213`*^9, 3.589170543594245*^9, 3.5891705943238087`*^9, 
   3.589228474625073*^9, 3.58922929715233*^9, 3.589229397323263*^9, 
   3.589229437718466*^9, {3.589229479467857*^9, 3.5892295041244993`*^9}, {
   3.589229543198606*^9, 3.5892295985968657`*^9}, 3.589229628740848*^9, {
   3.58922966429095*^9, 3.589229709718603*^9}, {3.589229814148316*^9, 
   3.589229841498925*^9}, {3.58922987160826*^9, 3.5892299196144457`*^9}, {
   3.5892299745729103`*^9, 3.589230001359622*^9}, 3.589230036456449*^9, {
   3.589230208789027*^9, 3.589230237944112*^9}, 3.58923032882548*^9, 
   3.589230377942834*^9, 3.589231056338314*^9, 3.589231323411833*^9, 
   3.5892313821700563`*^9, 3.589231448710328*^9, 3.589231488211689*^9, {
   3.589231536223584*^9, 3.5892315925143433`*^9}, 3.589231648236465*^9, 
   3.589231682741846*^9, {3.589231776743471*^9, 3.589231794377118*^9}, {
   3.589231824796137*^9, 3.5892318483445272`*^9}, 3.589231885201357*^9, {
   3.5892319723379593`*^9, 3.589232041882937*^9}, {3.5893034405899973`*^9, 
   3.589303457458866*^9}, 3.589303544271523*^9, {3.589303577125038*^9, 
   3.589303799001203*^9}, {3.589303891348263*^9, 3.58930397119461*^9}, 
   3.5893040346841097`*^9, 3.589304088325039*^9, 3.589304150404533*^9, {
   3.589304312622707*^9, 3.589304351861372*^9}, {3.589304384498247*^9, 
   3.589304515833806*^9}, {3.589305122021112*^9, 3.58930517674946*^9}, {
   3.58930671531361*^9, 3.589306863351611*^9}, {3.5893069729733973`*^9, 
   3.589306992004743*^9}, {3.589307027393774*^9, 3.589307097151433*^9}, 
   3.589307127475045*^9, 3.5893072199185047`*^9, {3.5893084929425783`*^9, 
   3.589308519002639*^9}, 3.5893086550527353`*^9, {3.589308734748457*^9, 
   3.5893087725708437`*^9}, {3.589308815259431*^9, 3.589308833641979*^9}, {
   3.589308878899212*^9, 3.589309071475863*^9}, {3.589309121319646*^9, 
   3.589309149406254*^9}, {3.589309501423503*^9, 3.5893095662267323`*^9}}],

Cell[BoxData["1.000000021448467`"], "Output",
 CellChangeTimes->{
  3.5891705034223213`*^9, 3.589170543594245*^9, 3.5891705943238087`*^9, 
   3.589228474625073*^9, 3.58922929715233*^9, 3.589229397323263*^9, 
   3.589229437718466*^9, {3.589229479467857*^9, 3.5892295041244993`*^9}, {
   3.589229543198606*^9, 3.5892295985968657`*^9}, 3.589229628740848*^9, {
   3.58922966429095*^9, 3.589229709718603*^9}, {3.589229814148316*^9, 
   3.589229841498925*^9}, {3.58922987160826*^9, 3.5892299196144457`*^9}, {
   3.5892299745729103`*^9, 3.589230001359622*^9}, 3.589230036456449*^9, {
   3.589230208789027*^9, 3.589230237944112*^9}, 3.58923032882548*^9, 
   3.589230377942834*^9, 3.589231056338314*^9, 3.589231323411833*^9, 
   3.5892313821700563`*^9, 3.589231448710328*^9, 3.589231488211689*^9, {
   3.589231536223584*^9, 3.5892315925143433`*^9}, 3.589231648236465*^9, 
   3.589231682741846*^9, {3.589231776743471*^9, 3.589231794377118*^9}, {
   3.589231824796137*^9, 3.5892318483445272`*^9}, 3.589231885201357*^9, {
   3.5892319723379593`*^9, 3.589232041882937*^9}, {3.5893034405899973`*^9, 
   3.589303457458866*^9}, 3.589303544271523*^9, {3.589303577125038*^9, 
   3.589303799001203*^9}, {3.589303891348263*^9, 3.58930397119461*^9}, 
   3.5893040346841097`*^9, 3.589304088325039*^9, 3.589304150404533*^9, {
   3.589304312622707*^9, 3.589304351861372*^9}, {3.589304384498247*^9, 
   3.589304515833806*^9}, {3.589305122021112*^9, 3.58930517674946*^9}, {
   3.58930671531361*^9, 3.589306863351611*^9}, {3.5893069729733973`*^9, 
   3.589306992004743*^9}, {3.589307027393774*^9, 3.589307097151433*^9}, 
   3.589307127475045*^9, 3.5893072199185047`*^9, {3.5893084929425783`*^9, 
   3.589308519002639*^9}, 3.5893086550527353`*^9, {3.589308734748457*^9, 
   3.5893087725708437`*^9}, {3.589308815259431*^9, 3.589308833641979*^9}, {
   3.589308878899212*^9, 3.589309071475863*^9}, {3.589309121319646*^9, 
   3.589309149406254*^9}, {3.589309501423503*^9, 3.589309566227901*^9}}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.589304133588716*^9, 3.5893041394363623`*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Let", "'"}], "s", " ", "test", " ", "how", " ", "accurate", " ", 
    "the", " ", "order", " ", "of", " ", "the", " ", "expansions", " ", "is", 
    " ", "of", " ", "the", " ", "integral"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{"inttest", ":=", " ", 
    RowBox[{
     RowBox[{"N", "*", 
      RowBox[{"Exp", "[", 
       RowBox[{"-", "T"}], "]"}], "*", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"z", "^", "2"}]}], " ", "*", 
         RowBox[{"(", "R", " ", ")"}]}], " ", "-", 
        RowBox[{"z", " ", "*", 
         RowBox[{"(", 
          RowBox[{"\[ImaginaryI]", "*", "S"}], ")"}]}]}], "]"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "IntResultExact"}], " ", 
     "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Assuming", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"R", ">", 
           RowBox[{"-", "inf"}]}], " ", "&&", " ", 
          RowBox[{"S", ">", 
           RowBox[{"-", "inf"}]}], " ", "&&", " ", 
          RowBox[{"T", ">", 
           RowBox[{"-", "inf"}]}]}], " ", ",", " ", 
         RowBox[{"Integrate", "[", 
          RowBox[{"inttest", ",", 
           RowBox[{"{", 
            RowBox[{"z", ",", "0", ",", "L"}], "}"}]}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"IntResult5E", " ", ":=", " ", 
         RowBox[{"Normal", "[", 
          RowBox[{
           RowBox[{"Series", "[", 
            RowBox[{"IntResultExact", ",", 
             RowBox[{"{", 
              RowBox[{"S", ",", "0", ",", "10"}], "}"}]}], "]"}], " ", "//.", 
           " ", 
           RowBox[{"{", " ", 
            RowBox[{
             RowBox[{"Erf", "[", 
              RowBox[{"L", " ", 
               SqrtBox["R"]}], "]"}], " ", "\[Rule]", " ", 
             RowBox[{"Series", "[", " ", 
              RowBox[{
               RowBox[{"Erf", "[", 
                RowBox[{"L", " ", 
                 SqrtBox["R"]}], "]"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"L", ",", "0", ",", "10"}], "}"}]}], "]"}]}], "}"}]}],
           "]"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"IntResult15", " ", ":=", " ", 
         RowBox[{"Assuming", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"R", ">", 
             RowBox[{"-", "inf"}]}], " ", "&&", " ", 
            RowBox[{"S", ">", 
             RowBox[{"-", "inf"}]}], " ", "&&", " ", 
            RowBox[{"T", ">", 
             RowBox[{"-", "inf"}]}]}], " ", ",", " ", 
           RowBox[{"Integrate", "[", 
            RowBox[{
             RowBox[{"Normal", "[", 
              RowBox[{"Series", "[", 
               RowBox[{
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"z", "^", "2"}]}], " ", "*", 
                   RowBox[{"(", "R", " ", ")"}]}], " ", "-", 
                  RowBox[{"z", " ", "*", 
                   RowBox[{"(", 
                    RowBox[{"\[ImaginaryI]", "*", "S"}], ")"}]}], " ", "-", 
                  " ", "T"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"z", ",", "0", ",", "15"}], "}"}]}], "]"}], "]"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"z", ",", "0", ",", "L"}], "}"}]}], "]"}]}], "]"}]}], 
        "*)"}], "\[IndentingNewLine]", "IntResult5"}], " ", ":=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Assuming", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"R", ">", 
            RowBox[{"-", "inf"}]}], " ", "&&", " ", 
           RowBox[{"S", ">", 
            RowBox[{"-", "inf"}]}], " ", "&&", " ", 
           RowBox[{"T", ">", 
            RowBox[{"-", "inf"}]}]}], " ", ",", " ", 
          RowBox[{"Integrate", "[", 
           RowBox[{
            RowBox[{"Normal", "[", 
             RowBox[{"Series", "[", 
              RowBox[{"inttest", ",", 
               RowBox[{"{", 
                RowBox[{"z", ",", "0", ",", "5"}], "}"}]}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"z", ",", "0", ",", "L"}], "}"}]}], "]"}]}], "]"}], 
        "\[IndentingNewLine]", "IntResult3"}], " ", ":=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Assuming", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"R", ">", 
             RowBox[{"-", "inf"}]}], " ", "&&", " ", 
            RowBox[{"S", ">", 
             RowBox[{"-", "inf"}]}], " ", "&&", " ", 
            RowBox[{"T", ">", 
             RowBox[{"-", "inf"}]}]}], " ", ",", " ", 
           RowBox[{"Integrate", "[", 
            RowBox[{
             RowBox[{"Normal", "[", 
              RowBox[{"Series", "[", 
               RowBox[{"inttest", ",", 
                RowBox[{"{", 
                 RowBox[{"z", ",", "0", ",", "3"}], "}"}]}], "]"}], "]"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"z", ",", "0", ",", "L"}], "}"}]}], "]"}]}], "]"}], 
         "\[IndentingNewLine]", "IntResult1"}], " ", ":=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Assuming", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"R", ">", 
              RowBox[{"-", "inf"}]}], " ", "&&", " ", 
             RowBox[{"S", ">", 
              RowBox[{"-", "inf"}]}], " ", "&&", " ", 
             RowBox[{"T", ">", 
              RowBox[{"-", "inf"}]}]}], " ", ",", " ", 
            RowBox[{"Integrate", "[", 
             RowBox[{
              RowBox[{"Normal", "[", 
               RowBox[{"Series", "[", 
                RowBox[{"inttest", ",", 
                 RowBox[{"{", 
                  RowBox[{"z", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"z", ",", "0", ",", "L"}], "}"}]}], "]"}]}], "]"}], 
          "\[IndentingNewLine]", "IntResult7"}], " ", ":=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Assuming", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"R", ">", 
               RowBox[{"-", "inf"}]}], " ", "&&", " ", 
              RowBox[{"S", ">", 
               RowBox[{"-", "inf"}]}], " ", "&&", " ", 
              RowBox[{"T", ">", 
               RowBox[{"-", "inf"}]}]}], " ", ",", " ", 
             RowBox[{"Integrate", "[", 
              RowBox[{
               RowBox[{"Normal", "[", 
                RowBox[{"Series", "[", 
                 RowBox[{"inttest", ",", 
                  RowBox[{"{", 
                   RowBox[{"z", ",", "0", ",", "7"}], "}"}]}], "]"}], "]"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"z", ",", "0", ",", "L"}], "}"}]}], "]"}]}], "]"}], 
           "\[IndentingNewLine]", "IntResult9"}], " ", ":=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Assuming", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"R", ">", 
                RowBox[{"-", "inf"}]}], " ", "&&", " ", 
               RowBox[{"S", ">", 
                RowBox[{"-", "inf"}]}], " ", "&&", " ", 
               RowBox[{"T", ">", 
                RowBox[{"-", "inf"}]}]}], " ", ",", " ", 
              RowBox[{"Integrate", "[", 
               RowBox[{
                RowBox[{"Normal", "[", 
                 RowBox[{"Series", "[", 
                  RowBox[{"inttest", ",", 
                   RowBox[{"{", 
                    RowBox[{"z", ",", "0", ",", "9"}], "}"}]}], "]"}], "]"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"z", ",", "0", ",", "L"}], "}"}]}], "]"}]}], "]"}], 
            "\[IndentingNewLine]", "IntResult15"}], " ", ":=", " ", 
           RowBox[{"Assuming", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"R", ">", 
               RowBox[{"-", "inf"}]}], " ", "&&", " ", 
              RowBox[{"S", ">", 
               RowBox[{"-", "inf"}]}], " ", "&&", " ", 
              RowBox[{"T", ">", 
               RowBox[{"-", "inf"}]}]}], " ", ",", " ", 
             RowBox[{"Integrate", "[", 
              RowBox[{
               RowBox[{"Normal", "[", 
                RowBox[{"Series", "[", 
                 RowBox[{"inttest", ",", 
                  RowBox[{"{", 
                   RowBox[{"z", ",", "0", ",", "15"}], "}"}]}], "]"}], "]"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"z", ",", "0", ",", "L"}], "}"}]}], "]"}]}], 
            "]"}]}]}]}]}]}]}]}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.582572205761004*^9, 3.582572206837862*^9}, {
   3.582572892523479*^9, 3.5825728929466352`*^9}, {3.5825730267270813`*^9, 
   3.5825730776157846`*^9}, 3.582573159248851*^9, {3.582574803934189*^9, 
   3.582574811885477*^9}, {3.5825748919450703`*^9, 3.58257491225194*^9}, {
   3.582574943344674*^9, 3.582574956820031*^9}, {3.582574996989943*^9, 
   3.582575003605554*^9}, {3.582575205414709*^9, 3.582575225406925*^9}, {
   3.582575305419675*^9, 3.5825753055625563`*^9}, 3.58257534908139*^9, {
   3.582575417899432*^9, 3.582575522713881*^9}, {3.582575586709717*^9, 
   3.58257559175743*^9}, {3.582575635733961*^9, 3.582575639725006*^9}, {
   3.582575678287434*^9, 3.582575717350861*^9}, {3.582575904920251*^9, 
   3.582575939439159*^9}, {3.582576107030368*^9, 3.582576120006235*^9}, {
   3.582576269360463*^9, 3.5825764044161987`*^9}, {3.582577907486704*^9, 
   3.582577908964764*^9}, {3.582577939933519*^9, 3.582577941173113*^9}, {
   3.582578081868434*^9, 3.5825780830357122`*^9}, {3.582578132562628*^9, 
   3.582578212352865*^9}, {3.582578244359088*^9, 3.5825783979413977`*^9}, {
   3.582581650656002*^9, 3.582581669552266*^9}, {3.5825827775671177`*^9, 
   3.582582778886656*^9}, {3.582599991894372*^9, 3.5826000088696938`*^9}, 
   3.582604066534835*^9, {3.5826045676380367`*^9, 3.582604594346463*^9}, {
   3.58260466808491*^9, 3.582604668614315*^9}, {3.5826047238398237`*^9, 
   3.582604724304657*^9}, {3.5826048197985764`*^9, 3.5826048488434963`*^9}, {
   3.582604880920669*^9, 3.5826048815143003`*^9}, {3.5826049273340387`*^9, 
   3.5826049285137053`*^9}, {3.5826049684814863`*^9, 3.582604971468669*^9}, {
   3.5826053374966297`*^9, 3.582605424304006*^9}, {3.5826766056657*^9, 
   3.582676606800818*^9}, {3.589158346445582*^9, 3.589158361382627*^9}, 
   3.589158652586523*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Consider", " ", "a", " ", "collinear"}], ",", " ", 
    RowBox[{
    "perfectly", " ", "phasematched", " ", "system", " ", "with", " ", "the", 
     " ", "signal", " ", "and", " ", "pump", " ", "waists", " ", "as", " ", 
     "100", " ", "microns"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"rulessamle", " ", ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SubscriptBox["W", "i"], "  ", "\[Rule]", " ", 
       SubscriptBox["W", "s"]}], " ", ",", "  ", 
      RowBox[{
       SubscriptBox["\[Theta]", "i"], "\[Rule]", " ", 
       SubscriptBox["\[Theta]", "s"]}], ",", " ", 
      RowBox[{
       SubscriptBox["\[Theta]", "s"], " ", "\[Rule]", 
       RowBox[{"0", "*", 
        RowBox[{"\[Pi]", "/", "180"}]}]}], ",", " ", 
      RowBox[{
       SubscriptBox["W", "s"], "  ", "\[Rule]", " ", ".01"}], ",", "  ", 
      RowBox[{
       SubscriptBox["W", "p"], "  ", "\[Rule]", " ", ".01"}], ",", "  ", 
      RowBox[{
       SubscriptBox["\[CapitalDelta]K", "x"], " ", "\[Rule]", "0"}], ",", 
      "  ", 
      RowBox[{
       SubscriptBox["\[CapitalDelta]K", "y"], " ", "\[Rule]", "0"}], ",", 
      "  ", 
      RowBox[{
       SubscriptBox["\[CapitalDelta]K", "z"], " ", "\[Rule]", "0"}], ",", 
      "  ", 
      RowBox[{
       SubscriptBox["\[Rho]", "px"], " ", "\[Rule]", " ", 
       RowBox[{"0", "*", 
        RowBox[{"\[Pi]", "/", "180"}]}]}], ",", " ", 
      RowBox[{
       SubscriptBox["\[Phi]", "s"], "\[Rule]", "0"}]}], "}"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"AAtest", " ", ":=", " ", 
    RowBox[{
     SubscriptBox["AA", "singles"], " ", "//.", "rulessamle"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"BBtest", " ", ":=", " ", 
    RowBox[{
     SubscriptBox["BB", "singles"], " ", "//.", "rulessamle"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"CCtest", " ", ":=", " ", 
    RowBox[{
     SubscriptBox["CC", "singles"], " ", "//.", "rulessamle"}]}], 
   "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Crystal", " ", "length", " ", "in", " ", "meters"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Lxtal", " ", ":=", " ", "l"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"isvalidapprox", " ", "should", " ", "be"}], " ", "<", " ", 
     RowBox[{
     "1", " ", "to", " ", "keep", " ", "the", " ", "errors", " ", "in", " ", 
      "check", " ", "with", " ", "a", " ", "5", "th", " ", "order", " ", 
      "series", " ", "expansion"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"isvalidapprox", " ", "=", " ", 
     RowBox[{"Lxtal", " ", "*", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"Abs", "[", "AAtest", "]"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"\"\<normalizations\>\"", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NN", " ", "=", " ", 
     RowBox[{
      RowBox[{
       SubscriptBox["n", "s"], "*", 
       SubscriptBox["n", "p"], "*", "xconsts", "*", "yconsts"}], " ", "//.", 
      "rulessamle"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NY", "=", " ", 
     RowBox[{
      RowBox[{
       SubscriptBox["n", "s"], "*", 
       SubscriptBox["n", "i"], "*", 
       SubscriptBox["n", "p"], "*", "xconst", "*", "yconst"}], " ", "//.", 
      "rulessamle"}]}], ";"}], "\[IndentingNewLine]", "\"\<coincidence\>\"", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Abs", "[", 
       SubscriptBox["P", "coinc"], "]"}], "^", "2"}], " ", "//.", 
     "rulessamle"}], " ", "//.", 
    RowBox[{"{", " ", 
     RowBox[{"L", " ", "\[Rule]", " ", "Lxtal"}], "}"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"rulessub", " ", ":=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"R", " ", "\[Rule]", "AAtest"}], ",", " ", 
      RowBox[{"S", " ", "\[Rule]", " ", "BBtest"}], ",", " ", 
      RowBox[{"T", " ", "\[Rule]", " ", "CCtest"}], ",", " ", 
      RowBox[{"L", " ", "\[Rule]", " ", "Lxtal"}], ",", " ", 
      RowBox[{"N", " ", "\[Rule]", " ", "1"}]}], "}"}]}], 
   "\[IndentingNewLine]", "\"\<efficiency\>\"", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Eff", "//.", "rulessamle"}], " ", "//.", 
    RowBox[{"{", " ", 
     RowBox[{"L", " ", "\[Rule]", " ", "Lxtal"}], "}"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"InE", "=", " ", 
     RowBox[{"IntResultExact", " ", "//.", " ", "rulessub"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"InE", " ", "/", " ", "Lxtal"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Eff1", " ", "=", " ", 
     RowBox[{"Eff", "//.", " ", "rulessamle"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Eff1", " ", "//.", " ", 
    RowBox[{"{", " ", 
     RowBox[{"L", " ", "\[Rule]", " ", "Lxtal"}], "}"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["n", "s"], "*", 
       SubscriptBox["n", "i"], "*", 
       SubscriptBox["n", "p"], "*", "xconst", " ", "*", " ", 
       RowBox[{"yconst", " ", "/", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["n", "s"], "*", 
          SubscriptBox["n", "p"], "*", "xconsts", " ", "*", " ", "yconsts"}], 
         ")"}]}]}], " ", "//.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[Theta]", "s"], "\[Rule]", "0"}], ",", " ", 
        RowBox[{
         SubscriptBox["\[Theta]", "i"], "\[Rule]", "0"}]}], "}"}]}], "]"}], 
    " ", "//.", "rulessamle"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"diff7", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"IntResult7", "-", "IntResult15"}], ")"}], " ", "/", 
         "IntResult15"}], "/", "L"}], " ", "//.", " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"R", " ", "\[Rule]", "AAtest"}], ",", " ", 
          RowBox[{"S", " ", "\[Rule]", " ", "BBtest"}], ",", " ", 
          RowBox[{"T", " ", "\[Rule]", " ", "CCtest"}], ",", " ", 
          RowBox[{"L", " ", "\[Rule]", " ", "0.001"}]}], "}"}], 
        "\[IndentingNewLine]", "diff9"}]}], "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"IntResult9", "-", "IntResult15"}], ")"}], " ", "/", 
         "IntResult15"}], "/", "L"}], " ", "//.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"R", " ", "\[Rule]", "AAtest"}], ",", " ", 
         RowBox[{"S", " ", "\[Rule]", " ", "BBtest"}], ",", " ", 
         RowBox[{"T", " ", "\[Rule]", " ", "CCtest"}], ",", " ", 
         RowBox[{"L", " ", "\[Rule]", " ", "0.001"}]}], "}"}]}]}]}], 
    "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.582570147920722*^9, 3.582570195741336*^9}, {
   3.5825702266473207`*^9, 3.582570352770815*^9}, {3.582570389152195*^9, 
   3.582570829808344*^9}, {3.5825708774230013`*^9, 3.58257102271488*^9}, {
   3.58257108718158*^9, 3.5825710876703444`*^9}, {3.5825711378520947`*^9, 
   3.582571194081362*^9}, {3.5825713211028957`*^9, 3.582571372749744*^9}, {
   3.5825714424096603`*^9, 3.582571461090166*^9}, {3.582571582032125*^9, 
   3.5825715845259132`*^9}, {3.582571654423809*^9, 3.5825716965358133`*^9}, 
   3.582571742091448*^9, {3.582571805219578*^9, 3.582571810611225*^9}, {
   3.582571855855719*^9, 3.582571869979395*^9}, {3.5825719294603567`*^9, 
   3.582571935293085*^9}, {3.582571976150963*^9, 3.582571978900481*^9}, {
   3.5825720142934093`*^9, 3.5825720378953953`*^9}, {3.582572069752479*^9, 
   3.582572092116683*^9}, {3.582572138326789*^9, 3.5825721680930433`*^9}, {
   3.5825722010110197`*^9, 3.582572272679966*^9}, {3.582572322893197*^9, 
   3.582572323053734*^9}, {3.582572386711502*^9, 3.5825724191907997`*^9}, {
   3.582572476653902*^9, 3.582572531114415*^9}, {3.582572563448111*^9, 
   3.582572597284574*^9}, 3.582572641775893*^9, {3.582572724360796*^9, 
   3.58257274159832*^9}, {3.582572790372628*^9, 3.582572822861246*^9}, {
   3.582573085488145*^9, 3.58257314104458*^9}, {3.582573177702846*^9, 
   3.582573191653015*^9}, {3.58257322478185*^9, 3.582573239973515*^9}, {
   3.582573273300521*^9, 3.58257328128799*^9}, {3.582573315689685*^9, 
   3.582573349042635*^9}, {3.582573385841503*^9, 3.58257345374396*^9}, {
   3.582573554499343*^9, 3.58257358045148*^9}, {3.5825736478524446`*^9, 
   3.582573663924012*^9}, {3.582574224783668*^9, 3.582574226260107*^9}, {
   3.582575527216473*^9, 3.58257553416681*^9}, 3.582575613021126*^9, {
   3.5825757339284153`*^9, 3.582575736659645*^9}, {3.582575769237528*^9, 
   3.582575878597967*^9}, {3.582576011241189*^9, 3.58257603819661*^9}, {
   3.582576139818922*^9, 3.582576163767682*^9}, {3.582576451830208*^9, 
   3.5825765756405077`*^9}, {3.582576619437772*^9, 3.582576746994718*^9}, {
   3.582576801086635*^9, 3.582576864601396*^9}, {3.582576967220229*^9, 
   3.582576972890451*^9}, {3.582577032137899*^9, 3.582577035976838*^9}, {
   3.582577370329324*^9, 3.5825774899346857`*^9}, 3.5825775241645203`*^9, {
   3.5825779855988417`*^9, 3.582578051825473*^9}, {3.582578097861334*^9, 
   3.582578101350016*^9}, 3.582578196413332*^9, {3.582578418547887*^9, 
   3.582578477190527*^9}, {3.58258138558496*^9, 3.582581416914439*^9}, {
   3.5825815036507807`*^9, 3.5825816333940077`*^9}, {3.582599949146933*^9, 
   3.582599965336502*^9}, {3.582600044394148*^9, 3.5826000807046623`*^9}, {
   3.582600116461185*^9, 3.5826001495913153`*^9}, {3.582602884138761*^9, 
   3.582602947869776*^9}, {3.582603087199744*^9, 3.5826030907698936`*^9}, {
   3.5826031999940653`*^9, 3.5826032359815407`*^9}, 3.582603296793651*^9, {
   3.582603458919821*^9, 3.5826034789806757`*^9}, {3.582603511056388*^9, 
   3.582603688543826*^9}, {3.582604584019965*^9, 3.5826045870444508`*^9}, {
   3.582604621354341*^9, 3.5826046446333017`*^9}, {3.582604788564949*^9, 
   3.5826047890544662`*^9}, {3.582604995006014*^9, 3.582605000751871*^9}, {
   3.582605031409931*^9, 3.582605311859332*^9}, {3.582673091236546*^9, 
   3.582673100783592*^9}, {3.582673132544013*^9, 3.582673258871689*^9}, {
   3.5826732951300783`*^9, 3.58267332418362*^9}, {3.582673517296598*^9, 
   3.582673523285928*^9}, {3.582673559825186*^9, 3.58267357808424*^9}, 
   3.5826737173027153`*^9, {3.582673799568041*^9, 3.5826738831694098`*^9}, 
   3.582674198046418*^9, {3.582674342546062*^9, 3.582674389475952*^9}, {
   3.582674452403171*^9, 3.582674540487863*^9}, 3.582674855781835*^9, {
   3.58267489572344*^9, 3.582674909054782*^9}, {3.582674948260013*^9, 
   3.582675028787796*^9}, {3.582676748612762*^9, 3.582676765579796*^9}, {
   3.582676872504282*^9, 3.582676934474944*^9}, {3.5826769747436237`*^9, 
   3.582677005626507*^9}, {3.5826770854932203`*^9, 3.582677116111795*^9}, {
   3.589153356110106*^9, 3.589153377164576*^9}, {3.5891534428390217`*^9, 
   3.58915351492083*^9}, {3.589153588821274*^9, 3.589153696060603*^9}, {
   3.589153998135046*^9, 3.589154019181926*^9}, {3.589154534141698*^9, 
   3.589154556818372*^9}, {3.5891549316710377`*^9, 3.589154944526208*^9}, {
   3.589154995426688*^9, 3.589155032781412*^9}, {3.589155208999354*^9, 
   3.589155232798279*^9}, {3.5891552855066032`*^9, 3.589155286921804*^9}, {
   3.589155347835034*^9, 3.589155480958825*^9}, {3.589155516629587*^9, 
   3.5891555926201353`*^9}, {3.589155826545381*^9, 3.58915592916153*^9}, {
   3.5891560194084797`*^9, 3.5891561295364437`*^9}, {3.589156356971319*^9, 
   3.589156387741671*^9}, {3.5891565663310738`*^9, 3.589156571383554*^9}, {
   3.589156703552775*^9, 3.589156771740507*^9}, {3.589158453299594*^9, 
   3.589158495376669*^9}}],

Cell[BoxData["\<\"coincidence\"\>"], "Output",
 CellChangeTimes->{{3.589153638575555*^9, 3.589153696879279*^9}, 
   3.5891539636418047`*^9, {3.5891539988873987`*^9, 3.589154019633039*^9}, 
   3.589154144561503*^9, 3.5891545651652946`*^9, 3.589154718127551*^9, 
   3.589154767388908*^9, 3.589154844456225*^9, {3.589154936261013*^9, 
   3.589154945691699*^9}, {3.5891549966955767`*^9, 3.589155033592531*^9}, 
   3.589155234174719*^9, {3.589155279573002*^9, 3.589155289123665*^9}, 
   3.589155333209495*^9, {3.5891553679188833`*^9, 3.589155481367324*^9}, {
   3.589155518031846*^9, 3.5891555937806377`*^9}, {3.589155828649741*^9, 
   3.589155929676157*^9}, {3.589156023612947*^9, 3.589156039894643*^9}, {
   3.589156073466248*^9, 3.589156130793469*^9}, {3.5891563583245897`*^9, 
   3.589156388369214*^9}, {3.589156567231132*^9, 3.5891565718118353`*^9}, {
   3.589156631470087*^9, 3.5891566569745493`*^9}, {3.589156704019106*^9, 
   3.589156772060663*^9}, 3.5891584203335457`*^9, {3.589158454722052*^9, 
   3.589158496249914*^9}, {3.589158656340477*^9, 3.589158659685629*^9}, 
   3.589161932919894*^9, 3.589228474883321*^9}],

Cell[BoxData[
 RowBox[{"2.530172645627287`*^-9", " ", 
  SuperscriptBox[
   RowBox[{"Abs", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
     RowBox[{"1.`", " ", "l"}]}], "]"}], "4"]}]], "Output",
 CellChangeTimes->{{3.589153638575555*^9, 3.589153696879279*^9}, 
   3.5891539636418047`*^9, {3.5891539988873987`*^9, 3.589154019633039*^9}, 
   3.589154144561503*^9, 3.5891545651652946`*^9, 3.589154718127551*^9, 
   3.589154767388908*^9, 3.589154844456225*^9, {3.589154936261013*^9, 
   3.589154945691699*^9}, {3.5891549966955767`*^9, 3.589155033592531*^9}, 
   3.589155234174719*^9, {3.589155279573002*^9, 3.589155289123665*^9}, 
   3.589155333209495*^9, {3.5891553679188833`*^9, 3.589155481367324*^9}, {
   3.589155518031846*^9, 3.5891555937806377`*^9}, {3.589155828649741*^9, 
   3.589155929676157*^9}, {3.589156023612947*^9, 3.589156039894643*^9}, {
   3.589156073466248*^9, 3.589156130793469*^9}, {3.5891563583245897`*^9, 
   3.589156388369214*^9}, {3.589156567231132*^9, 3.5891565718118353`*^9}, {
   3.589156631470087*^9, 3.5891566569745493`*^9}, {3.589156704019106*^9, 
   3.589156772060663*^9}, 3.5891584203335457`*^9, {3.589158454722052*^9, 
   3.589158496249914*^9}, {3.589158656340477*^9, 3.589158659685629*^9}, 
   3.589161932919894*^9, 3.589228474884527*^9}],

Cell[BoxData["\<\"efficiency\"\>"], "Output",
 CellChangeTimes->{{3.589153638575555*^9, 3.589153696879279*^9}, 
   3.5891539636418047`*^9, {3.5891539988873987`*^9, 3.589154019633039*^9}, 
   3.589154144561503*^9, 3.5891545651652946`*^9, 3.589154718127551*^9, 
   3.589154767388908*^9, 3.589154844456225*^9, {3.589154936261013*^9, 
   3.589154945691699*^9}, {3.5891549966955767`*^9, 3.589155033592531*^9}, 
   3.589155234174719*^9, {3.589155279573002*^9, 3.589155289123665*^9}, 
   3.589155333209495*^9, {3.5891553679188833`*^9, 3.589155481367324*^9}, {
   3.589155518031846*^9, 3.5891555937806377`*^9}, {3.589155828649741*^9, 
   3.589155929676157*^9}, {3.589156023612947*^9, 3.589156039894643*^9}, {
   3.589156073466248*^9, 3.589156130793469*^9}, {3.5891563583245897`*^9, 
   3.589156388369214*^9}, {3.589156567231132*^9, 3.5891565718118353`*^9}, {
   3.589156631470087*^9, 3.5891566569745493`*^9}, {3.589156704019106*^9, 
   3.589156772060663*^9}, 3.5891584203335457`*^9, {3.589158454722052*^9, 
   3.589158496249914*^9}, {3.589158656340477*^9, 3.589158659685629*^9}, 
   3.589161932919894*^9, 3.589228474885948*^9}],

Cell[BoxData["0.000012575205380100372`"], "Output",
 CellChangeTimes->{{3.589153638575555*^9, 3.589153696879279*^9}, 
   3.5891539636418047`*^9, {3.5891539988873987`*^9, 3.589154019633039*^9}, 
   3.589154144561503*^9, 3.5891545651652946`*^9, 3.589154718127551*^9, 
   3.589154767388908*^9, 3.589154844456225*^9, {3.589154936261013*^9, 
   3.589154945691699*^9}, {3.5891549966955767`*^9, 3.589155033592531*^9}, 
   3.589155234174719*^9, {3.589155279573002*^9, 3.589155289123665*^9}, 
   3.589155333209495*^9, {3.5891553679188833`*^9, 3.589155481367324*^9}, {
   3.589155518031846*^9, 3.5891555937806377`*^9}, {3.589155828649741*^9, 
   3.589155929676157*^9}, {3.589156023612947*^9, 3.589156039894643*^9}, {
   3.589156073466248*^9, 3.589156130793469*^9}, {3.5891563583245897`*^9, 
   3.589156388369214*^9}, {3.589156567231132*^9, 3.5891565718118353`*^9}, {
   3.589156631470087*^9, 3.5891566569745493`*^9}, {3.589156704019106*^9, 
   3.589156772060663*^9}, 3.5891584203335457`*^9, {3.589158454722052*^9, 
   3.589158496249914*^9}, {3.589158656340477*^9, 3.589158659685629*^9}, 
   3.589161932919894*^9, 3.589228474886806*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Power", "::", "infy"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Infinite expression \[NoBreak]\\!\\(1\\/0.`\\)\[NoBreak] \
encountered. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/infy\\\", ButtonNote -> \
\\\"Power::infy\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.589156731493305*^9, 3.589156772066766*^9}, 
   3.589158420338091*^9, {3.589158454728462*^9, 3.589158496254464*^9}, {
   3.589158656342115*^9, 3.589158659687673*^9}, 3.589161932921555*^9, 
   3.5892284749295797`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Infinity", "::", "indet"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Indeterminate expression \[NoBreak]\\!\\(0.`\\\\ \
ComplexInfinity\\)\[NoBreak] encountered. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/indet\\\", ButtonNote -> \
\\\"Infinity::indet\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.589156731493305*^9, 3.589156772066766*^9}, 
   3.589158420338091*^9, {3.589158454728462*^9, 3.589158496254464*^9}, {
   3.589158656342115*^9, 3.589158659687673*^9}, 3.589161932921555*^9, 
   3.589228474980076*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Power", "::", "infy"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Infinite expression \
\[NoBreak]\\!\\(1\\/\\@0.`\\)\[NoBreak] encountered. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/infy\\\", ButtonNote -> \
\\\"Power::infy\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.589156731493305*^9, 3.589156772066766*^9}, 
   3.589158420338091*^9, {3.589158454728462*^9, 3.589158496254464*^9}, {
   3.589158656342115*^9, 3.589158659687673*^9}, 3.589161932921555*^9, 
   3.589228474981681*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Power", "::", "infy"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Infinite expression \
\[NoBreak]\\!\\(1\\/\\@0.`\\)\[NoBreak] encountered. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/infy\\\", ButtonNote -> \
\\\"Power::infy\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.589156731493305*^9, 3.589156772066766*^9}, 
   3.589158420338091*^9, {3.589158454728462*^9, 3.589158496254464*^9}, {
   3.589158656342115*^9, 3.589158659687673*^9}, 3.589161932921555*^9, 
   3.5892284749840927`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \[NoBreak]\\!\\(\\*StyleBox[\\(Power :: \
infy\\), \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.589156731493305*^9, 3.589156772066766*^9}, 
   3.589158420338091*^9, {3.589158454728462*^9, 3.589158496254464*^9}, {
   3.589158656342115*^9, 3.589158659687673*^9}, 3.589161932921555*^9, 
   3.589228474985054*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Infinity", "::", "indet"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Indeterminate expression \[NoBreak]\\!\\(\\(\\((\\(\\(0.` \
\[VeryThinSpace]\\)\\) + \\(\\(0.`\\\\ \[ImaginaryI]\\)\\))\\)\\)\\\\ \
ComplexInfinity\\)\\n\[NoBreak] encountered. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/indet\\\", ButtonNote -> \
\\\"Infinity::indet\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.589156731493305*^9, 3.589156772066766*^9}, 
   3.589158420338091*^9, {3.589158454728462*^9, 3.589158496254464*^9}, {
   3.589158656342115*^9, 3.589158659687673*^9}, 3.589161932921555*^9, 
   3.5892284749882593`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Infinity", "::", "indet"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Indeterminate expression \[NoBreak]\\!\\(0.`\\\\ \
ComplexInfinity\\)\[NoBreak] encountered. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/indet\\\", ButtonNote -> \
\\\"Infinity::indet\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.589156731493305*^9, 3.589156772066766*^9}, 
   3.589158420338091*^9, {3.589158454728462*^9, 3.589158496254464*^9}, {
   3.589158656342115*^9, 3.589158659687673*^9}, 3.589161932921555*^9, 
   3.589228474989314*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \[NoBreak]\\!\\(\\*StyleBox[\\(Infinity \
:: indet\\), \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.589156731493305*^9, 3.589156772066766*^9}, 
   3.589158420338091*^9, {3.589158454728462*^9, 3.589158496254464*^9}, {
   3.589158656342115*^9, 3.589158659687673*^9}, 3.589161932921555*^9, 
   3.58922847499024*^9}],

Cell[BoxData["0.000012575205380100372`"], "Output",
 CellChangeTimes->{{3.589153638575555*^9, 3.589153696879279*^9}, 
   3.5891539636418047`*^9, {3.5891539988873987`*^9, 3.589154019633039*^9}, 
   3.589154144561503*^9, 3.5891545651652946`*^9, 3.589154718127551*^9, 
   3.589154767388908*^9, 3.589154844456225*^9, {3.589154936261013*^9, 
   3.589154945691699*^9}, {3.5891549966955767`*^9, 3.589155033592531*^9}, 
   3.589155234174719*^9, {3.589155279573002*^9, 3.589155289123665*^9}, 
   3.589155333209495*^9, {3.5891553679188833`*^9, 3.589155481367324*^9}, {
   3.589155518031846*^9, 3.5891555937806377`*^9}, {3.589155828649741*^9, 
   3.589155929676157*^9}, {3.589156023612947*^9, 3.589156039894643*^9}, {
   3.589156073466248*^9, 3.589156130793469*^9}, {3.5891563583245897`*^9, 
   3.589156388369214*^9}, {3.589156567231132*^9, 3.5891565718118353`*^9}, {
   3.589156631470087*^9, 3.5891566569745493`*^9}, {3.589156704019106*^9, 
   3.589156772060663*^9}, 3.5891584203335457`*^9, {3.589158454722052*^9, 
   3.589158496249914*^9}, {3.589158656340477*^9, 3.589158659685629*^9}, 
   3.589161932919894*^9, 3.5892284749917107`*^9}],

Cell[BoxData["0.0035461536035682906`"], "Output",
 CellChangeTimes->{{3.589153638575555*^9, 3.589153696879279*^9}, 
   3.5891539636418047`*^9, {3.5891539988873987`*^9, 3.589154019633039*^9}, 
   3.589154144561503*^9, 3.5891545651652946`*^9, 3.589154718127551*^9, 
   3.589154767388908*^9, 3.589154844456225*^9, {3.589154936261013*^9, 
   3.589154945691699*^9}, {3.5891549966955767`*^9, 3.589155033592531*^9}, 
   3.589155234174719*^9, {3.589155279573002*^9, 3.589155289123665*^9}, 
   3.589155333209495*^9, {3.5891553679188833`*^9, 3.589155481367324*^9}, {
   3.589155518031846*^9, 3.5891555937806377`*^9}, {3.589155828649741*^9, 
   3.589155929676157*^9}, {3.589156023612947*^9, 3.589156039894643*^9}, {
   3.589156073466248*^9, 3.589156130793469*^9}, {3.5891563583245897`*^9, 
   3.589156388369214*^9}, {3.589156567231132*^9, 3.5891565718118353`*^9}, {
   3.589156631470087*^9, 3.5891566569745493`*^9}, {3.589156704019106*^9, 
   3.589156772060663*^9}, 3.5891584203335457`*^9, {3.589158454722052*^9, 
   3.589158496249914*^9}, {3.589158656340477*^9, 3.589158659685629*^9}, 
   3.589161932919894*^9, 3.589228474992539*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.582677107278851*^9, 3.5826771085437727`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.582604717680066*^9, 3.5826047176921797`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Now", " ", 
     RowBox[{"let", "'"}], "s", " ", "try", " ", "to", " ", "plot", " ", 
     "the", " ", "error", " ", "for", " ", "5", "th", " ", "order", " ", 
     "expansion", " ", "as", " ", "a", " ", "function", " ", "of", " ", "L", 
     "*", 
     RowBox[{"R", ".", " ", "When"}], " ", "there", " ", "is", " ", "perfect",
      " ", "phasematching"}], ",", " ", 
    RowBox[{
     RowBox[{
     "then", " ", "S", " ", "and", " ", "T", " ", "go", " ", "to", " ", "0.", 
      " ", "I", " ", "am", " ", "also", " ", "setting", " ", "L"}], "=", 
     RowBox[{
     "1", " ", "to", " ", "get", " ", "a", " ", "feel", " ", "for", " ", 
      "how", " ", "things", " ", 
      RowBox[{"scale", ".", " ", "It"}], " ", "should", " ", "really", " ", 
      "be", " ", "L", "*", "sqrt", 
      RowBox[{"(", "R", ")"}], " ", "that", " ", "I", " ", 
      RowBox[{"investigate", "."}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{"rulesplot", " ", ":=", 
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{"S", " ", "\[Rule]", " ", "0"}], ",", " ", 
      RowBox[{"T", " ", "\[Rule]", " ", "0"}], ",", 
      RowBox[{"L", "\[Rule]", "1"}], ",", "  ", 
      RowBox[{"N", " ", "\[Rule]", " ", "1"}]}], "}"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"IE", ":=", 
    RowBox[{"IntResultExact", " ", "//.", "rulesplot"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"diff5plot", " ", ":=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"IntResult9", "-", "IE"}], ")"}], "/", "IE"}], " ", "//.", 
     "rulesplot"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"data", " ", "=", " ", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"diff3plot", "*", "100"}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"R", ",", ".1", ",", " ", "1", ",", " ", ".3"}], "}"}], ",", 
        " ", 
        RowBox[{"{", 
         RowBox[{"L", ",", "1", ",", " ", "2", ",", ".5"}], "}"}]}], "]"}], 
      "\[IndentingNewLine]", 
      RowBox[{"ListDensityPlot", "[", "data", "]"}]}]}], 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{",", "  ", 
       RowBox[{"DataRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{".1", ",", "1"}], "}"}]}]}], "]"}], "*)"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"data", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"diff5plot", "*", "100"}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"R", ",", ".1", ",", " ", "2", ",", " ", ".4"}], "}"}]}], 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{"data", ",", " ", 
     RowBox[{"DataRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{".1", ",", "1"}], "}"}]}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"diff3plot", "*", "100"}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"R", ",", " ", ".1", ",", " ", "2"}], "}"}]}], "]"}], "*)"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.582571514461753*^9, 3.582571551456332*^9}, {
   3.582578503345278*^9, 3.58257872440841*^9}, {3.582578780921651*^9, 
   3.582578883845438*^9}, {3.582578970661623*^9, 3.5825789710615797`*^9}, {
   3.582579131654023*^9, 3.582579200204801*^9}, {3.582579243741954*^9, 
   3.5825792459243107`*^9}, {3.5825793019633627`*^9, 3.582579371951651*^9}, {
   3.582579457175651*^9, 3.5825794845162363`*^9}, {3.582579540760523*^9, 
   3.582579570935811*^9}, {3.582579607016583*^9, 3.5825796095915947`*^9}, {
   3.582579643985656*^9, 3.5825796473228292`*^9}, {3.582579712051264*^9, 
   3.58257971848114*^9}, {3.5825797686854067`*^9, 3.5825798082418137`*^9}, {
   3.582579873379818*^9, 3.582579903872665*^9}, {3.582580063163332*^9, 
   3.582580068888425*^9}, {3.582580160070561*^9, 3.582580310148143*^9}, {
   3.5825803507792*^9, 3.582580379041741*^9}, 3.582580457517507*^9, {
   3.582580497564616*^9, 3.5825805027078733`*^9}, {3.582580538025709*^9, 
   3.5825805902668457`*^9}, {3.582580630656403*^9, 3.582580655723983*^9}, 
   3.5825808355668917`*^9, {3.582580875974682*^9, 3.582580933715579*^9}, {
   3.582580993168611*^9, 3.5825810254619913`*^9}, {3.582581096198348*^9, 
   3.582581198438293*^9}, {3.582581299535063*^9, 3.5825813460732594`*^9}, 
   3.582600172444182*^9, {3.5826038389114437`*^9, 3.582603839741509*^9}, {
   3.582603984803568*^9, 3.582603990923452*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"103.34386513520954`", " ", 
    RowBox[{"Abs", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "0.9676433126355917`"}], "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "+", "IntResult9"}], 
     "]"}]}], ",", 
   RowBox[{"116.87371345136334`", " ", 
    RowBox[{"Abs", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "0.8556243918921487`"}], "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "+", "IntResult9"}], 
     "]"}]}], ",", 
   RowBox[{"130.49991167837644`", " ", 
    RowBox[{"Abs", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "0.7662840435206961`"}], "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "+", "IntResult9"}], 
     "]"}]}], ",", 
   RowBox[{"144.04858677380918`", " ", 
    RowBox[{"Abs", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "0.6942102122600062`"}], "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "+", "IntResult9"}], 
     "]"}]}], ",", 
   RowBox[{"157.3834831239151`", " ", 
    RowBox[{"Abs", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "0.6353906904021528`"}], "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "+", "IntResult9"}], 
     "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.5825810991036158`*^9, 3.5825811058004313`*^9}, {
   3.582581136013298*^9, 3.582581164420209*^9}, 3.582581203090735*^9, 
   3.582600158676648*^9, 3.5826001916288757`*^9, 3.58260379195722*^9, 
   3.582603895092568*^9, 3.58260401860787*^9, 3.582673541566701*^9, 
   3.589161954810891*^9, 3.589228475090229*^9}],

Cell[BoxData[
 GraphicsBox[{},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesOrigin->{0, 0},
  PlotRange->{{0., 0.}, {0., 0.}},
  PlotRangeClipping->True,
  PlotRangePadding->{
    Scaled[0.02], 
    Scaled[0.02]}]], "Output",
 CellChangeTimes->{{3.5825810991036158`*^9, 3.5825811058004313`*^9}, {
   3.582581136013298*^9, 3.582581164420209*^9}, 3.582581203090735*^9, 
   3.582600158676648*^9, 3.5826001916288757`*^9, 3.58260379195722*^9, 
   3.582603895092568*^9, 3.58260401860787*^9, 3.582673541566701*^9, 
   3.589161954810891*^9, 3.589228475091963*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.582579558603568*^9, 3.582579564021964*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "So", " ", "it", " ", "looks", " ", "like", " ", "the", " ", "5", "th", " ",
    "order", " ", "expansion", " ", "is", " ", "fine", " ", "as", " ", "long",
    " ", "as", " ", "L", "*", 
   RowBox[{"R", "^", "0.5"}], " ", 
   RowBox[{"<<", " ", "1."}], " ", "Is", " ", "there", " ", "a", " ", 
   "better", " ", "way", " ", "to", " ", "expand", " ", "this", " ", 
   "without", " ", "needing", " ", "to", " ", "go", " ", "to", " ", "a", " ", 
   "ton", " ", "of", " ", 
   RowBox[{"terms", "?", " ", "I"}], " ", "tried", " ", "it", " ", "with", 
   " ", "the", " ", "third", " ", "order", " ", "expansion", " ", "and", " ", 
   "9", "th", " ", "order", " ", 
   RowBox[{"expansion", "."}]}], " ", "\[IndentingNewLine]", "*)"}]], "Input",\

 CellChangeTimes->{{3.5825812218049498`*^9, 3.582581286524527*^9}, {
  3.5825813519982986`*^9, 3.582581365413608*^9}}],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{{3.5825793967420473`*^9, 3.5825794457035847`*^9}, 
   3.582581214804072*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.582581217412138*^9, 3.582581217435742*^9}}]
},
WindowSize->{1440, 852},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (October 5, \
2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 7697, 194, 378, "Input"],
Cell[8279, 218, 2025, 43, 27, "Output"],
Cell[10307, 263, 2025, 43, 27, "Output"],
Cell[12335, 308, 2201, 49, 34, "Output"]
}, Open  ]],
Cell[14551, 360, 8435, 222, 518, "Input"],
Cell[CellGroupData[{
Cell[23011, 586, 1735, 49, 124, "Input"],
Cell[24749, 637, 279, 9, 50, "Output"],
Cell[25031, 648, 277, 9, 50, "Output"],
Cell[25311, 659, 277, 9, 54, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25625, 673, 2475, 67, 79, "Input"],
Cell[28103, 742, 1580, 50, 54, "Output"]
}, Open  ]],
Cell[29698, 795, 4000, 103, 302, "Input"],
Cell[33701, 900, 94, 1, 27, "Input"],
Cell[CellGroupData[{
Cell[33820, 905, 4459, 97, 309, "Input"],
Cell[38282, 1004, 143, 3, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38462, 1012, 3828, 92, 133, "Input"],
Cell[42293, 1106, 667, 16, 52, "Output"]
}, Open  ]],
Cell[42975, 1125, 535, 7, 27, "Input"],
Cell[43513, 1134, 91, 1, 27, "Input"],
Cell[43607, 1137, 92, 1, 27, "Input"],
Cell[CellGroupData[{
Cell[43724, 1142, 10931, 216, 463, "Input"],
Cell[54658, 1360, 3920, 85, 59, "Output"],
Cell[58581, 1447, 5086, 126, 59, "Output"],
Cell[63670, 1575, 2037, 30, 30, "Output"],
Cell[65710, 1607, 1947, 27, 27, "Output"],
Cell[67660, 1636, 1950, 27, 27, "Output"],
Cell[69613, 1665, 1963, 27, 27, "Output"]
}, Open  ]],
Cell[71591, 1695, 94, 1, 27, "Input"],
Cell[71688, 1698, 10498, 249, 264, "Input"],
Cell[CellGroupData[{
Cell[82211, 1951, 11769, 244, 566, "Input"],
Cell[93983, 2197, 1120, 15, 27, "Output"],
Cell[95106, 2214, 1370, 23, 30, "Output"],
Cell[96479, 2239, 1119, 15, 27, "Output"],
Cell[97601, 2256, 1125, 15, 27, "Output"],
Cell[98729, 2273, 643, 13, 40, "Message"],
Cell[99375, 2288, 671, 13, 23, "Message"],
Cell[100049, 2303, 644, 13, 43, "Message"],
Cell[100696, 2318, 646, 13, 43, "Message"],
Cell[101345, 2333, 722, 14, 23, "Message"],
Cell[102070, 2349, 757, 14, 40, "Message"],
Cell[102830, 2365, 671, 13, 23, "Message"],
Cell[103504, 2380, 725, 14, 23, "Message"],
Cell[104232, 2396, 1127, 15, 27, "Output"],
Cell[105362, 2413, 1123, 15, 27, "Output"]
}, Open  ]],
Cell[106500, 2431, 94, 1, 27, "Input"],
Cell[106597, 2434, 94, 1, 27, "Input"],
Cell[CellGroupData[{
Cell[106716, 2439, 4596, 102, 223, "Input"],
Cell[111315, 2543, 1707, 47, 43, "Output"],
Cell[113025, 2592, 591, 14, 239, "Output"]
}, Open  ]],
Cell[113631, 2609, 92, 1, 27, "Input"],
Cell[113726, 2612, 906, 17, 58, "Input"],
Cell[114635, 2631, 141, 2, 43, "Input"],
Cell[114779, 2635, 92, 1, 27, "Input"]
}
]
*)

(* End of internal cache information *)
