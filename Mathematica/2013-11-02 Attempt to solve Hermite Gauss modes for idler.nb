(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    155349,       4296]
NotebookOptionsPosition[    151125,       4166]
NotebookOutlinePosition[    151580,       4184]
CellTagsIndexPosition[    151537,       4181]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 StyleBox["Introduction", "Section",
  FontWeight->"Bold"],
 StyleBox["\n\n",
  FontWeight->"Bold"],
 "The approach I am following closely matches that of R. Bennik (PHYSICAL \
REVIEW A 81, 053805 (2010)), as well as earlier work from A. U\
\[CloseCurlyQuote]ren and W. Grice. The calculation can be split into the \
pump spectral function, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"S", "(", 
    SubscriptBox["\[Omega]", "p"], ")"}], TraditionalForm]]],
 " as well as a phasematching function \[CapitalPhi](",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Omega]", "p"], TraditionalForm]]],
 ",",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Omega]", "s"], TraditionalForm]]],
 ",",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Omega]", "i"], TraditionalForm]]],
 "). When fiber coupling is NOT enabled in my program, then the solutions \
proceed as usual, reducing to the standard Sinc() function for the \
phasematching. However, when dealing with fibercoupling, I instead take the \
Bennink approach and try to solve as many of the integrals analytically as \
possible. In particular, I attempt to analytically solve the integral over \
the volume. I don\[CloseCurlyQuote]t transform to momentum space, rather I \
choose to work in x,y,z coordinates. I can analytically solve the x and y \
integrals, and then numerically evaluate the z integral. I can then perform \
the integrals over ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Omega]", "s"], ",", " ", 
    SubscriptBox["\[Omega]", "i"]}], TraditionalForm]]],
 ". \n\nN",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Integral]", 
    RowBox[{"\[Integral]", 
     RowBox[{
      SubscriptBox["d\[Omega]", "s"], " ", 
      SubscriptBox["d\[Omega]", "i"], 
      RowBox[{"\[Integral]", 
       RowBox[{"\[Integral]", 
        SuperscriptBox[
         SubscriptBox["\[Integral]", 
          RowBox[{
           RowBox[{"-", "L"}], "/", "2"}]], 
         RowBox[{"L", "/", "2"}]]}]}]}]}]}], TraditionalForm]]],
 " dx dy dz (",
 Cell[BoxData[
  FormBox[
   SubscriptBox["W", "p"], TraditionalForm]]],
 Cell[BoxData[
  FormBox[
   SubscriptBox["W", "i"], TraditionalForm]]],
 Cell[BoxData[
  FormBox[
   SubscriptBox["W", "s"], TraditionalForm]]],
 " ) (",
 Cell[BoxData[
  FormBox[
   SubscriptBox["q", 
    RowBox[{"p", " "}]], TraditionalForm]]],
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    SubscriptBox["q", "i"], "*"], TraditionalForm]]],
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    SubscriptBox["q", "s"], "*"], TraditionalForm]]],
 ") ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["e", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "/", 
      RowBox[{"(", 
       RowBox[{"2", 
        SubscriptBox["q", "s"]}], ")"}]}], "*", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["x", "s"], "2"], " ", "+", " ", 
       SuperscriptBox[
        SubscriptBox["y", "s"], "2"]}], ")"}]}]], TraditionalForm]]],
 " * ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["e", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "/", 
      RowBox[{"(", 
       RowBox[{"2", 
        SuperscriptBox[
         SubscriptBox["q", "i"], "*"]}], ")"}]}], "*", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["x", "i"], "2"], " ", "+", " ", 
       SuperscriptBox[
        SubscriptBox["y", "i"], "2"]}], ")"}]}]], TraditionalForm]]],
 " * ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["e", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "1"}], "/", 
       RowBox[{"(", 
        RowBox[{"2", 
         SuperscriptBox[
          SubscriptBox["q", "p"], "*"]}], ")"}]}], "*", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["x", "p"], "2"], " ", "+", " ", 
        SuperscriptBox[
         SubscriptBox["y", "p"], "2"]}], ")"}]}]], " "}], TraditionalForm]]],
 "* ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["e", 
    RowBox[{"-", 
     RowBox[{"\[ImaginaryI]", "(", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[CapitalDelta]k", "z"], "z"}], "+", 
       RowBox[{
        SubscriptBox["\[CapitalDelta]k", "x"], "x"}], "+", 
       RowBox[{
        SubscriptBox["\[CapitalDelta]k", "y"], "y"}]}], ")"}]}]], 
   TraditionalForm]]],
 ".  [1]\n\nHere ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["q", "j"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "= ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["W", "j"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "+ \[ImaginaryI]z/k is related to the Gaussian beam waist, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Omega]", "j"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " is the frequency, and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", "j"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["y", "j"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["z", "j"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " are the coordinate systems for the pump, signal, and idler beams. I have \
gone ahead and simplified the \[CapitalDelta]k terms already.\n\nTo calculate \
the coincidences, the first order of business is to transform the coordinate \
sytems of the signal and idler to that of the pump. We will also include pump \
walkoff. Here I use the rotation matrices to obtain the correct coordinate \
transforms in terms of the opening angle ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Theta]", 
    RowBox[{"s", ",", "i"}]], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "for the signal and idler and the azimuthal angle, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Phi]", 
     RowBox[{"s", ",", "i"}]], " "}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ", around the cone. These values for the coordinate system get substituted \
into equation 1, leading to a messy expression. To solve the integrals over x \
then y, we must complete the square. Much of the work here is on trying to \
complete this square and carry out the integration. This leaves us with an \
even messier integral over z, but at least we have dropped two integrals from \
the equation.  All that remains is to integrate over all ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Omega]", "s"], TraditionalForm]]],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Omega]", "i"], TraditionalForm]]],
 "."
}], "Text",
 CellChangeTimes->{{3.592311447583029*^9, 3.592312397684001*^9}, {
  3.59231245561298*^9, 3.592312492583014*^9}, {3.5923535364943027`*^9, 
  3.592353600383497*^9}, {3.592353655472157*^9, 3.592354157462791*^9}, {
  3.592354279313077*^9, 3.59235427946924*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Setting up needed functions", "Section"]], "Title",
 CellChangeTimes->{{3.5923541922430973`*^9, 3.592354246771482*^9}, 
   3.592354288739841*^9, {3.5923543337010307`*^9, 3.592354357288374*^9}, {
   3.592354388988369*^9, 3.592354390730309*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
   "Define", " ", "a", " ", "function", " ", "to", " ", "complete", " ", 
    "the", " ", 
    RowBox[{"square", ".", " ", "Will"}], " ", "save", " ", "us", " ", "some",
     " ", 
    RowBox[{"time", "."}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CompleteSquare", "[", 
     RowBox[{"f_", ",", "x_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "b", ",", "c"}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"c", ",", "b", ",", "a"}], "}"}], "=", 
        RowBox[{"CoefficientList", "[", 
         RowBox[{"f", ",", "x"}], "]"}]}], ";", 
       RowBox[{
        RowBox[{"a", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"x", "+", 
            FractionBox["b", 
             RowBox[{"2", " ", "a"}]]}], ")"}], "2"]}], "+", 
        RowBox[{"Simplify", "[", 
         RowBox[{"c", "-", 
          FractionBox[
           SuperscriptBox["b", "2"], 
           RowBox[{"4", " ", "a"}]]}], "]"}]}]}]}], "]"}]}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "Define", " ", "rotation", " ", "matrices", " ", "around", " ", "x"}], 
     ",", " ", "y", ",", " ", 
     RowBox[{"and", " ", 
      RowBox[{"z", "."}]}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Rx", "[", 
     RowBox[{"\[Theta]_", ",", "V_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "S", "}"}], ",", 
      RowBox[{
       RowBox[{"RotX", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
            RowBox[{"-", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}], ",", 
            RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}], "}"}]}], ";", 
       RowBox[{"RotX", ".", "V"}]}]}], "]"}]}], "\n", 
   RowBox[{
    RowBox[{"Ry", "[", 
     RowBox[{"\[Theta]_", ",", "V_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "S", "}"}], ",", 
      RowBox[{
       RowBox[{"RotY", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", "0", ",", 
            RowBox[{"+", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", "0", ",", 
            RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}], "}"}]}], ";", 
       RowBox[{"RotY", ".", "V"}]}]}], "]"}]}], "\n", 
   RowBox[{
    RowBox[{"Rz", "[", 
     RowBox[{"\[Theta]_", ",", "V_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "S", "}"}], ",", 
      RowBox[{
       RowBox[{"RotZ", ":=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
            RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
       RowBox[{"RotZ", ".", "V"}]}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.582551082707974*^9, 3.582551243412228*^9}, {
   3.582552241600596*^9, 3.58255248525065*^9}, {3.5825530886487722`*^9, 
   3.582553091710619*^9}, {3.582581931220381*^9, 3.582581994221595*^9}, {
   3.582589736354864*^9, 3.58258979384231*^9}, {3.582589853214909*^9, 
   3.582589939808462*^9}, {3.582590073974887*^9, 3.5825900784620047`*^9}, {
   3.582591942003405*^9, 3.5825919557241173`*^9}, {3.582592064468408*^9, 
   3.582592070390641*^9}, {3.582592168312223*^9, 3.582592195349346*^9}, {
   3.582592537371162*^9, 3.5825925389767017`*^9}, {3.582592609833417*^9, 
   3.582592630132695*^9}, {3.582594727920084*^9, 3.5825947541563683`*^9}, {
   3.582594786928154*^9, 3.582594837727318*^9}, {3.582594872553235*^9, 
   3.5825948732121487`*^9}, 3.582594919516144*^9, {3.582595006307055*^9, 
   3.58259502779462*^9}, {3.582595382427409*^9, 3.5825953955679607`*^9}, {
   3.582595429725254*^9, 3.582595511584939*^9}, {3.582595567715238*^9, 
   3.58259556798405*^9}, {3.5825957007377663`*^9, 3.5825957096247883`*^9}, {
   3.582595744582691*^9, 3.582595792538672*^9}, {3.582596036605506*^9, 
   3.5825960731972313`*^9}, {3.582596118612314*^9, 3.58259612941899*^9}, {
   3.582596292204793*^9, 3.5825963567715073`*^9}, {3.582596404384987*^9, 
   3.5825964610317802`*^9}, {3.5825968755404663`*^9, 3.582596891139832*^9}, 
   3.582597031324554*^9, {3.582597263234353*^9, 3.582597287940269*^9}, {
   3.5825973900652647`*^9, 3.582597396723194*^9}, {3.582597641860304*^9, 
   3.582597661706188*^9}, 3.582597849090914*^9, 3.582597885135263*^9, {
   3.5826762909693413`*^9, 3.582676292040473*^9}, {3.589299275215334*^9, 
   3.589299276871471*^9}, {3.5894735627453117`*^9, 3.589473747565434*^9}, {
   3.5894737984212646`*^9, 3.589473800825018*^9}, 3.589473836508107*^9, {
   3.58947389839431*^9, 3.5894740827498093`*^9}, {3.589475328368573*^9, 
   3.589475346401663*^9}, {3.590522057342185*^9, 3.590522057548717*^9}, {
   3.592354291079329*^9, 3.5923543319416018`*^9}, {3.592354392636649*^9, 
   3.592354412695652*^9}, {3.592354478879201*^9, 3.592354499951008*^9}}],

Cell[CellGroupData[{

Cell["\<\
Setting the coordinate systems up\
\>", "Section",
 CellChangeTimes->{{3.592357563620294*^9, 3.592357569353045*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "To", " ", "find", " ", "the", " ", "singal", " ", "photon", " ", 
     "direction", " ", "in", " ", "terms", " ", "of", " ", "the", " ", "pump",
      " ", "coordinates"}], ",", " ", 
    RowBox[{
    "we", " ", "first", " ", "rotate", " ", "the", " ", "pump", " ", "vector",
      " ", "about", " ", "X", " ", "by", " ", 
     SubscriptBox["\[Theta]", "s"]}], ",", " ", 
    RowBox[{"then", " ", "about", " ", "Z", " ", "by", " ", 
     SubscriptBox["\[Phi]", "s"]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"xs", " ", "=", " ", 
     RowBox[{"Rz", "[", 
      RowBox[{
       SubscriptBox["\[Phi]", "s"], ",", 
       RowBox[{"Rx", "[", 
        RowBox[{
         SubscriptBox["\[Theta]", "s"], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ys", " ", "=", " ", 
     RowBox[{"Rz", "[", 
      RowBox[{
       SubscriptBox["\[Phi]", "s"], ",", 
       RowBox[{"Rx", "[", 
        RowBox[{
         SubscriptBox["\[Theta]", "s"], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"zs", " ", "=", " ", 
     RowBox[{"Rz", "[", 
      RowBox[{
       SubscriptBox["\[Phi]", "s"], ",", 
       RowBox[{"Rx", "[", 
        RowBox[{
         SubscriptBox["\[Theta]", "s"], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vect", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["x", "s"], "=", 
     RowBox[{"xs", ".", "vect"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["y", "s"], "=", " ", 
     RowBox[{"ys", ".", "vect"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["z", "s"], "=", 
     RowBox[{"zs", ".", "vect"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "Now", " ", "we", " ", "can", " ", "figure", " ", "out", " ", "the", " ",
       "idler", " ", "coordinates", " ", "with", " ", "a", " ", "simple", " ", 
      RowBox[{"subsitution", ".", " ", "We"}], " ", "use", " ", "the", " ", 
      "fact", " ", "that", " ", 
      SubscriptBox["\[Phi]", "i"]}], " ", "=", " ", 
     RowBox[{
      SubscriptBox["\[Phi]", "s"], "+", 
      RowBox[{"\[Pi]", "."}]}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rulescoord", " ", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Theta]", "s"], "\[Rule]", 
        SubscriptBox["\[Theta]", "i"]}], ",", "  ", 
       RowBox[{
        SubscriptBox["\[Phi]", "s"], " ", "\[Rule]", "  ", 
        RowBox[{
         SubscriptBox["\[Phi]", "s"], "+", "\[Pi]"}]}]}], " ", "}"}]}], ";"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["x", "i"], " ", "=", " ", 
     RowBox[{
      SubscriptBox["x", 
       RowBox[{"s", " "}]], "/.", "rulescoord"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["y", "i"], "=", " ", 
     RowBox[{
      SubscriptBox["y", 
       RowBox[{"s", " "}]], "/.", "rulescoord"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["z", "i"], "=", " ", 
     RowBox[{
      SubscriptBox["z", 
       RowBox[{"s", " "}]], "/.", "rulescoord"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{"Finally", ",", " ", 
     RowBox[{"we", " ", "have", " ", "the", " ", "pump", " ", 
      RowBox[{"coordinates", ".", " ", "Include"}], " ", 
      RowBox[{"walkoff", ".", " ", "Assume"}], " ", "that", " ", "the", " ", 
      "walkoff", " ", "angle"}], ",", " ", 
     SubscriptBox["\[Rho]", "px"], ",", " ", 
     RowBox[{"is", " ", 
      RowBox[{"small", "."}]}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["x", "p"], " ", "=", " ", 
     RowBox[{"x", " ", "+", " ", 
      RowBox[{
       SubscriptBox["\[Rho]", "px"], "*", "z"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["y", "p"], "=", " ", "y"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Introduce", " ", "the", " ", "assumption", " ", "that", " ", "the", " ",
       "Rayleigh", " ", "range", " ", "is", " ", "much", " ", "longer", " ", 
      "than", " ", "the", " ", "crystal", " ", "length", " ", "and", " ", 
      "the", " ", "waist", " ", "can", " ", "be", " ", "treated", " ", "as", 
      " ", "a", " ", 
      RowBox[{"constant", ".", " ", "This"}], " ", "dramatically", " ", 
      "simplifies", " ", 
      RowBox[{"things", ".", " ", "We"}], " ", "wont", " ", "add", " ", 
      "this", " ", "in", " ", "until", " ", "later"}], ",", " ", 
     RowBox[{
     "but", " ", "here", " ", "is", " ", "the", " ", "definition", " ", "we", 
      " ", "will", " ", "use", " ", "for", " ", "the", " ", 
      RowBox[{"substitution", "."}]}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
   RowBox[{"rules2", " ", ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SubscriptBox["q", "ppp"], " ", "\[Rule]", " ", 
       SuperscriptBox[
        SubscriptBox["W", "ppp"], "2"]}], " ", ",", " ", 
      RowBox[{
       SubscriptBox["q", "s"], " ", "\[Rule]", " ", 
       SuperscriptBox[
        SubscriptBox["W", "s"], "2"]}], " ", ",", " ", 
      RowBox[{
       SubscriptBox["q", "i"], " ", "\[Rule]", " ", 
       SuperscriptBox[
        SubscriptBox["W", "i"], "2"]}]}], " ", "}"}]}], "\[IndentingNewLine]", 
   RowBox[{"rulesq", " ", ":=", " ", "rules2"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
    "Now", " ", "set", " ", "up", " ", "the", " ", "Gaussian", " ", 
     "normalizaton", " ", 
     RowBox[{"coefficients", "."}]}], " ", "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["n", "s"], " ", "=", " ", 
     RowBox[{
      RowBox[{
       SubscriptBox["W", "s"], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"\[Pi]", "*", "2"}], "]"}], "*", 
         SubscriptBox["q", "s"]}], ")"}]}], " ", "//.", "rules2"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["n", "i"], " ", "=", " ", 
     RowBox[{
      RowBox[{
       SubscriptBox["W", "i"], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"\[Pi]", "*", "2"}], "]"}], "*", 
         SubscriptBox["q", "i"]}], ")"}]}], " ", "//.", "rules2"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["n", "ppp"], " ", "=", " ", 
     RowBox[{
      RowBox[{
       SubscriptBox["W", "ppp"], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"\[Pi]", "*", "2"}], "]"}], "*", 
         SubscriptBox["q", "ppp"]}], ")"}]}], " ", "//.", " ", "rules2"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.582676438761138*^9, 3.582676528731468*^9}, {
   3.582676729795623*^9, 3.5826767327704906`*^9}, {3.589231298763981*^9, 
   3.589231302850792*^9}, {3.589301582840025*^9, 3.589301588609139*^9}, {
   3.589301902546296*^9, 3.589301935466913*^9}, {3.5893022782276497`*^9, 
   3.5893022799150763`*^9}, {3.589687578090417*^9, 3.589687579149075*^9}, {
   3.590521728478033*^9, 3.5905217643020144`*^9}, {3.590521800795985*^9, 
   3.590521909782888*^9}, {3.590522130031143*^9, 3.590522170299871*^9}, {
   3.590522299406642*^9, 3.590522487105804*^9}, 3.590522523544599*^9, {
   3.590522563902389*^9, 3.590522620237356*^9}, {3.590522657840081*^9, 
   3.590522738247343*^9}, {3.5905228769892*^9, 3.5905228809800663`*^9}, {
   3.590523000355813*^9, 3.590523004506609*^9}, {3.590523561758151*^9, 
   3.59052357123062*^9}, {3.590524142763977*^9, 3.590524235646515*^9}, {
   3.590524266636819*^9, 3.59052431042937*^9}, {3.590525182345914*^9, 
   3.590525193486434*^9}, {3.590526011602631*^9, 3.5905260146674767`*^9}, {
   3.5905307140862923`*^9, 3.590530718259025*^9}, 3.591532968535356*^9, {
   3.592354510318543*^9, 3.5923548758943863`*^9}, {3.59239573608435*^9, 
   3.592395879044458*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Carry out the integration over x and y\
\>", "Section",
 CellChangeTimes->{{3.592357591144606*^9, 3.592357597092271*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
     "Now", " ", "we", " ", "examine", " ", "the", " ", "term", " ", "in", 
      " ", "the", " ", "exponential", " ", "from", " ", 
      RowBox[{"equation", " ", "[", "1", "]"}], " ", "in", " ", "the", " ", 
      RowBox[{"introduction", ".", " ", "We"}], " ", "first", " ", "need", 
      " ", "to", " ", "complete", " ", "the", " ", "square", " ", "with", " ",
       "respect", " ", "to", " ", 
      RowBox[{"x", ".", " ", "This"}], " ", "will", " ", "give", " ", "us", 
      " ", "something", " ", "with", " ", "the", " ", "form", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", "*", "x"}], " ", "+", " ", "b"}], ")"}], "^", "2"}]}], 
     " ", "+", "c"}], ",", " ", 
    RowBox[{"where", " ", "c", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"y", ",", "z"}], ")"}], ".", " ", "Then"}], " ", "we", " ", 
     "can", " ", "evaluate", " ", "the", " ", "integral", " ", "over", " ", 
     "x"}], ",", " ", 
    RowBox[{"which", " ", "has", " ", "a", " ", "nice", " ", 
     RowBox[{"solution", ":", " ", "\[IndentingNewLine]", 
      RowBox[{"\[Integral]", 
       RowBox[{"dx", " ", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"ax", "+", "b"}], ")"}], "^", "2"}]}], " ", "=", " ", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"\[Pi]", "/", "a"}], "]"}]}], 
         "\[IndentingNewLine]"}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Arg1", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "1"}], "/", 
       RowBox[{"(", 
        RowBox[{"2", "*", 
         SubscriptBox["q", "s"]}], ")"}]}], "*", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["x", "s"], "2"], "+", 
        SuperscriptBox[
         SubscriptBox["y", "s"], "2"]}], ")"}]}], "-", 
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{"2", "*", 
         SubscriptBox["q", "i"]}], ")"}]}], 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["x", "i"], "2"], "+", 
        SuperscriptBox[
         SubscriptBox["y", "i"], "2"]}], ")"}]}], "-", 
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{"2", "*", 
         SubscriptBox["q", "ppp"]}], ")"}]}], "*", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["x", "p"], "2"], "+", 
        SuperscriptBox[
         SubscriptBox["y", "p"], "2"]}], ")"}]}], " ", "-", " ", 
     RowBox[{"\[ImaginaryI]", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[CapitalDelta]K", "x"], "*", "x"}], " ", "+", " ", 
        RowBox[{
         SubscriptBox["\[CapitalDelta]K", "y"], "*", "y"}], "+", 
        RowBox[{
         SubscriptBox["\[CapitalDelta]K", "z"], "*", "z"}]}], ")"}]}]}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.5825533941941223`*^9, 3.5825535539588547`*^9}, {
   3.5825536033128633`*^9, 3.582553608767806*^9}, 3.582553712131874*^9, {
   3.582553783669939*^9, 3.58255382316961*^9}, {3.582561756372466*^9, 
   3.582561771923471*^9}, 3.582561807119581*^9, {3.582562474614017*^9, 
   3.582562499613974*^9}, {3.582582135209609*^9, 3.5825821366901712`*^9}, {
   3.582600600836162*^9, 3.5826006048984003`*^9}, {3.582676452509242*^9, 
   3.582676454063005*^9}, 3.589299256121154*^9, 3.589299487656785*^9, {
   3.589301942732774*^9, 3.58930196123344*^9}, {3.589302272043653*^9, 
   3.589302274307569*^9}, 3.5905228696729*^9, {3.590522953456752*^9, 
   3.590522994943686*^9}, {3.592354892629015*^9, 3.592354981813205*^9}, {
   3.592355308824877*^9, 3.592355423732871*^9}, {3.592355460980516*^9, 
   3.592355476320713*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "x"}], " ", 
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Phi]", "s"], "]"}]}], "+", 
        RowBox[{"y", " ", 
         RowBox[{"Sin", "[", 
          SubscriptBox["\[Phi]", "s"], "]"}]}]}], ")"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "y"}], " ", 
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Theta]", "i"], "]"}], " ", 
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Phi]", "s"], "]"}]}], "+", 
        RowBox[{"z", " ", 
         RowBox[{"Sin", "[", 
          SubscriptBox["\[Theta]", "i"], "]"}]}], "-", 
        RowBox[{"x", " ", 
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Theta]", "i"], "]"}], " ", 
         RowBox[{"Sin", "[", 
          SubscriptBox["\[Phi]", "s"], "]"}]}]}], ")"}], "2"]}], 
    RowBox[{"2", " ", 
     SubscriptBox["q", "i"]}]]}], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"x", " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Phi]", "s"], "]"}]}], "-", 
       RowBox[{"y", " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["\[Phi]", "s"], "]"}]}]}], ")"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"y", " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "s"], "]"}], " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Phi]", "s"], "]"}]}], "+", 
       RowBox[{"z", " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["\[Theta]", "s"], "]"}]}], "+", 
       RowBox[{"x", " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "s"], "]"}], " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["\[Phi]", "s"], "]"}]}]}], ")"}], "2"]}], 
   RowBox[{"2", " ", 
    SubscriptBox["q", "s"]}]], "-", 
  RowBox[{"\[ImaginaryI]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"x", " ", 
      SubscriptBox["\[CapitalDelta]K", "x"]}], "+", 
     RowBox[{"y", " ", 
      SubscriptBox["\[CapitalDelta]K", "y"]}], "+", 
     RowBox[{"z", " ", 
      SubscriptBox["\[CapitalDelta]K", "z"]}]}], ")"}]}], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["y", "2"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"x", "+", 
       RowBox[{"z", " ", 
        SubscriptBox["\[Rho]", "px"]}]}], ")"}], "2"]}], 
   RowBox[{"2", " ", 
    SubscriptBox["q", "ppp"]}]]}]], "Output",
 CellChangeTimes->{{3.590522910768602*^9, 3.590523012386057*^9}, 
   3.5905243407346573`*^9, 3.590524383798437*^9, 3.5905251996470623`*^9, 
   3.5905260225081387`*^9, 3.590530724903821*^9, 3.592354953251843*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "First", " ", "we", " ", "complete", " ", "the", " ", "square", " ", "wrt",
     " ", "to", " ", 
    RowBox[{"x", "."}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Arg1", " ", "=", " ", 
     RowBox[{"CompleteSquare", "[", 
      RowBox[{"Arg1", ",", " ", "x"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "Use", " ", "CoefficientList", " ", "to", " ", "get", " ", "the", " ", 
      "constant"}], ",", " ", "x", ",", " ", 
     RowBox[{"and", " ", 
      RowBox[{"x", "^", "2"}], " ", "coeffients", " ", "from", " ", "Arg1", 
      " ", "after", " ", "completing", " ", "the", " ", 
      RowBox[{"square", "."}]}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"cx", ",", "bx", ",", "ax"}], "}"}], "=", 
     RowBox[{"CoefficientList", "[", 
      RowBox[{"Arg1", ",", "x"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "The", " ", "result", " ", "of", " ", "the", " ", "integral", " ", 
      "over", " ", "x"}], " ", "=", " ", 
     RowBox[{"Sqrt", "[", 
      RowBox[{"\[Pi]", "/", "ax"}], "]"}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"coeffx", " ", "=", "ax"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"xconst", "=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"\[Sqrt]", "\[Pi]"}], "/", 
      RowBox[{"\[Sqrt]", 
       RowBox[{"(", 
        RowBox[{"-", "coeffx"}], ")"}]}]}], " ", "]"}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.5825537185392857`*^9, 3.582553738312705*^9}, {
   3.582582174512424*^9, 3.582582196639732*^9}, {3.589299359249379*^9, 
   3.58929940769029*^9}, {3.589299706788805*^9, 3.589299953474846*^9}, {
   3.589300074213222*^9, 3.5893001254984083`*^9}, {3.589300366692685*^9, 
   3.589300470243595*^9}, {3.589300526730879*^9, 3.589300583491335*^9}, {
   3.5893006199514933`*^9, 3.589300807810451*^9}, {3.589300973245274*^9, 
   3.5893010229373007`*^9}, {3.5893025507863827`*^9, 3.589302556458641*^9}, 
   3.5905230261463614`*^9, {3.590523088364869*^9, 3.5905231894911213`*^9}, {
   3.59052336261027*^9, 3.590523375831769*^9}, 3.590523584110681*^9, {
   3.592341145778749*^9, 3.592341146952448*^9}, {3.592355498475273*^9, 
   3.592355589447836*^9}, {3.5923556212424383`*^9, 3.592355747376404*^9}, {
   3.592355779785378*^9, 3.592355810783331*^9}}],

Cell[BoxData[
 FractionBox[
  SqrtBox[
   RowBox[{"2", " ", "\[Pi]"}]], 
  SqrtBox[
   RowBox[{
    FractionBox[
     RowBox[{
      SuperscriptBox[
       RowBox[{"Cos", "[", 
        SubscriptBox["\[Phi]", "s"], "]"}], "2"], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", 
         SubscriptBox["\[Phi]", "s"], "]"}], "2"]}]}], 
     SubscriptBox["q", "i"]], "+", 
    FractionBox["1", 
     SubscriptBox["q", "ppp"]], "+", 
    FractionBox[
     RowBox[{
      SuperscriptBox[
       RowBox[{"Cos", "[", 
        SubscriptBox["\[Phi]", "s"], "]"}], "2"], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", 
         SubscriptBox["\[Phi]", "s"], "]"}], "2"]}]}], 
     SubscriptBox["q", "s"]]}]]]], "Output",
 CellChangeTimes->{3.59235581117741*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Now", " ", "complete", " ", "the", " ", "square", " ", "for", " ", "the",
      " ", "remaing", " ", "y"}], ",", 
    RowBox[{
    "z", " ", "terms", " ", "with", " ", "respect", " ", "to", " ", "y", " ", 
     "now", " ", "that", " ", "the", " ", "integration", " ", "over", " ", 
     "x", " ", "has", " ", "taken", " ", 
     RowBox[{"place", ".", " ", "yzcoeff"}], " ", "is", " ", "the", " ", 
     "term", " ", "that", " ", 
     RowBox[{"remains", "."}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"yzcoeff", " ", "=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{"(", 
       RowBox[{"cx", "-", 
        RowBox[{
         RowBox[{
          RowBox[{"bx", "^", "2"}], "/", "4"}], "/", "ax"}]}], ")"}], "]"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{"Complete", " ", "the", " ", "square", " ", "wrt", " ", "to", " ", 
     RowBox[{"y", "."}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Arg2", " ", "=", " ", 
     RowBox[{"CompleteSquare", "[", 
      RowBox[{"yzcoeff", ",", " ", "y"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"cy", ",", "by", ",", "ay"}], "}"}], "=", 
     RowBox[{"CoefficientList", "[", 
      RowBox[{"Arg2", ",", "y"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "The", " ", "result", " ", "of", " ", "the", " ", "integral", " ", 
      "over", " ", "y"}], " ", "=", " ", 
     RowBox[{"Sqrt", "[", 
      RowBox[{"\[Pi]", "/", "ay"}], "]"}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"coeffy", " ", "=", " ", "ay"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"yconst", "=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"\[Sqrt]", "\[Pi]"}], "/", 
      RowBox[{"\[Sqrt]", 
       RowBox[{"(", 
        RowBox[{"-", "coeffy"}], ")"}]}]}], " ", "]"}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.592355760071685*^9, 3.592355760662122*^9}, {
  3.592355829933074*^9, 3.5923559668443003`*^9}, {3.5923560079583178`*^9, 
  3.59235604529187*^9}}],

Cell[BoxData[
 FractionBox[
  SqrtBox[
   RowBox[{"2", " ", "\[Pi]"}]], 
  SqrtBox[
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["q", "ppp"], " ", 
        SubscriptBox["q", "s"]}], "+", 
       RowBox[{
        SubscriptBox["q", "i"], " ", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["q", "ppp"], "+", 
          SubscriptBox["q", "s"]}], ")"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
        SubscriptBox["q", "ppp"], " ", 
        SubscriptBox["q", "s"]}], "+", 
       RowBox[{
        SubscriptBox["q", "i"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
           SubscriptBox["q", "ppp"]}], "+", 
          SubscriptBox["q", "s"]}], ")"}]}]}], ")"}]}], 
    RowBox[{
     SubscriptBox["q", "i"], " ", 
     SubscriptBox["q", "ppp"], " ", 
     SubscriptBox["q", "s"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Phi]", "s"], "]"}], "2"], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", 
             SubscriptBox["\[Phi]", "s"], "]"}], "2"]}]}], ")"}], " ", 
        SubscriptBox["q", "ppp"], " ", 
        SubscriptBox["q", "s"]}], "+", 
       RowBox[{
        SubscriptBox["q", "i"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"Cos", "[", 
               SubscriptBox["\[Phi]", "s"], "]"}], "2"], "+", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"Cos", "[", 
                SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
              SuperscriptBox[
               RowBox[{"Sin", "[", 
                SubscriptBox["\[Phi]", "s"], "]"}], "2"]}]}], ")"}], " ", 
           SubscriptBox["q", "ppp"]}], "+", 
          SubscriptBox["q", "s"]}], ")"}]}]}], ")"}]}]]]]], "Output",
 CellChangeTimes->{3.5923560039955683`*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.5892997322432404`*^9, 3.589299732949974*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"After", " ", "the", " ", "integration", " ", "over", " ", "y"}], 
    ",", " ", 
    RowBox[{
    "we", " ", "are", " ", "only", " ", "left", " ", "with", " ", "terms", 
     " ", "in", " ", "z", " ", "which", " ", "we", " ", "call", " ", 
     RowBox[{"zint", "."}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"zint", " ", "=", "  ", 
     RowBox[{"Simplify", "[", 
      RowBox[{"(", 
       RowBox[{"cy", "-", 
        RowBox[{
         RowBox[{
          RowBox[{"by", "^", "2"}], "/", "4"}], "/", "ay"}]}], ")"}], "]"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
      "zint", " ", "has", " ", "the", " ", "general", " ", "form", " ", "c", 
       "*", 
       RowBox[{"z", "^", "2"}]}], " ", "+", 
      RowBox[{"\[ImaginaryI]", "*", "b", "*", "z"}], " ", "+", " ", 
      RowBox[{
       RowBox[{"a", ".", " ", "The"}], " ", "integral", " ", "over", " ", "z",
        " ", "cannot", " ", "be", " ", "solved", " ", "analytically", " ", 
       "as", " ", "far", " ", "as", " ", "I", " ", "can", " ", 
       RowBox[{"tell", ".", " ", "It"}], " ", "results", " ", "in", " ", 
       "Error", " ", 
       RowBox[{"functions", ".", " ", "We"}], " ", "will", " ", "have", " ", 
       "to", " ", "numerically", " ", "solve", " ", 
       RowBox[{"this", ".", "\[IndentingNewLine]", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["\[Integral]", 
           RowBox[{
            RowBox[{"-", "L"}], "/", "2"}]], 
          RowBox[{"L", "/", "2"}]], 
         RowBox[{"dz", " ", 
          SuperscriptBox["e", 
           RowBox[{" ", 
            RowBox[{
             RowBox[{"c", "*", 
              RowBox[{"z", "^", "2"}]}], " ", "+", 
             RowBox[{"\[ImaginaryI]", "*", "b", "*", "z"}], " ", "+", " ", 
             "a"}]}]], "\[IndentingNewLine]", 
          RowBox[{"Let", "'"}], "s", " ", "figure", " ", "out", " ", "what", 
          " ", "the", " ", "a"}]}]}]}]}], ",", "b", ",", 
     RowBox[{
     "and", " ", "c", " ", "coefficients", " ", "are", " ", "using", " ", 
      "coefficient", " ", 
      RowBox[{"list", "."}]}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"az", ",", " ", "bz", ",", "cz"}], "}"}], "=", 
     RowBox[{"CoefficientList", "[", " ", 
      RowBox[{"zint", ",", "z"}], "]"}]}], " ", ";"}], "\[IndentingNewLine]", 
   "\"\<a -> the constant term\>\"", "\[IndentingNewLine]", 
   RowBox[{"a", " ", "=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{"-", "az"}], "]"}]}], "\[IndentingNewLine]", 
   "\"\<b -> the \[ImaginaryI]z coefficient\>\"", "\[IndentingNewLine]", 
   RowBox[{"b", " ", "=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{"-", "bz"}], "]"}]}], "\[IndentingNewLine]", 
   "\"\<c -> the z^2 coefficient\>\"", "\[IndentingNewLine]", 
   RowBox[{"c", " ", "=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{"-", "cz"}], "]"}]}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.5825538416732683`*^9, 3.5825540262026253`*^9}, {
   3.582554070185461*^9, 3.58255407764716*^9}, 3.5825618686585283`*^9, 
   3.5825619031644173`*^9, {3.582582212811741*^9, 3.5825822216126223`*^9}, {
   3.582598740623023*^9, 3.5825987588152237`*^9}, 3.582598791694824*^9, 
   3.5826007798659353`*^9, {3.582600814519813*^9, 3.5826010290448103`*^9}, 
   3.582601333150104*^9, 3.5826014723118773`*^9, {3.582672389928055*^9, 
   3.5826724027171583`*^9}, {3.582674796730681*^9, 3.5826747992116013`*^9}, 
   3.5891463574943027`*^9, {3.5892291069528646`*^9, 3.5892291279266253`*^9}, 
   3.589299315272929*^9, {3.5892994199671593`*^9, 3.589299433917345*^9}, {
   3.589300836392149*^9, 3.589300943644602*^9}, {3.589301033831832*^9, 
   3.589301125570545*^9}, {3.589301176199456*^9, 3.5893011811906357`*^9}, {
   3.58930126916422*^9, 3.5893013256175747`*^9}, {3.589301359370359*^9, 
   3.589301389325317*^9}, {3.589302013723062*^9, 3.589302017465081*^9}, {
   3.589302076689983*^9, 3.589302138029945*^9}, {3.589302168188575*^9, 
   3.589302250597705*^9}, 3.589302338688246*^9, {3.589302401133462*^9, 
   3.589302409057458*^9}, {3.589302686030478*^9, 3.5893027019333267`*^9}, {
   3.589302734154758*^9, 3.5893027372989063`*^9}, {3.589302777895915*^9, 
   3.589302795645793*^9}, {3.589302948609424*^9, 3.58930297384866*^9}, {
   3.589303285661346*^9, 3.589303363589128*^9}, {3.589303473996633*^9, 
   3.589303482212236*^9}, {3.589303735528884*^9, 3.589303740601049*^9}, {
   3.589303947560666*^9, 3.589303953147936*^9}, 3.5893040110316067`*^9, {
   3.589310529899806*^9, 3.5893105385782003`*^9}, {3.5893105908829403`*^9, 
   3.589310687782134*^9}, {3.589310768063574*^9, 3.589310891354974*^9}, {
   3.589310960638303*^9, 3.589310990026972*^9}, 3.5893112701563873`*^9, {
   3.590523413863852*^9, 3.590523415430471*^9}, {3.5905239933074703`*^9, 
   3.5905240292587843`*^9}, {3.590524432754696*^9, 3.590524439607706*^9}, {
   3.590524976308745*^9, 3.5905249835840483`*^9}, {3.5905250784201393`*^9, 
   3.590525091618764*^9}, {3.590537426599852*^9, 3.590537465847196*^9}, {
   3.591532942233149*^9, 3.591532943862817*^9}, {3.592356050843577*^9, 
   3.592356070878357*^9}, {3.5923561271460543`*^9, 3.592356223375842*^9}, {
   3.592356256139473*^9, 3.592356444180459*^9}, {3.5923565034848433`*^9, 
   3.592356504945348*^9}, {3.592356600938752*^9, 3.592356695801572*^9}}],

Cell[BoxData["\<\"a -> the constant term\"\>"], "Output",
 CellChangeTimes->{3.592356650467545*^9, 3.592356696507867*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    SubscriptBox["q", "i"], " ", 
    SubscriptBox["q", "ppp"], " ", 
    SubscriptBox["q", "s"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["q", "ppp"], " ", 
       SubscriptBox["q", "s"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"6", "+", 
            RowBox[{"2", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", 
               SubscriptBox["\[Theta]", "i"]}], "]"}]}], "+", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["\[Theta]", "i"], "-", 
                SubscriptBox["\[Phi]", "s"]}], ")"}]}], "]"}], "-", 
            RowBox[{"2", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", 
               SubscriptBox["\[Phi]", "s"]}], "]"}]}], "+", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["\[Theta]", "i"], "+", 
                SubscriptBox["\[Phi]", "s"]}], ")"}]}], "]"}]}], ")"}], " ", 
          SubsuperscriptBox["\[CapitalDelta]K", "x", "2"]}], "+", 
         RowBox[{"8", " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", 
            SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", 
            SubscriptBox["\[Phi]", "s"]}], "]"}], " ", 
          SubscriptBox["\[CapitalDelta]K", "x"], " ", 
          SubscriptBox["\[CapitalDelta]K", "y"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"6", "+", 
            RowBox[{"2", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", 
               SubscriptBox["\[Theta]", "i"]}], "]"}]}], "-", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["\[Theta]", "i"], "-", 
                SubscriptBox["\[Phi]", "s"]}], ")"}]}], "]"}], "+", 
            RowBox[{"2", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", 
               SubscriptBox["\[Phi]", "s"]}], "]"}]}], "-", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["\[Theta]", "i"], "+", 
                SubscriptBox["\[Phi]", "s"]}], ")"}]}], "]"}]}], ")"}], " ", 
          SubsuperscriptBox["\[CapitalDelta]K", "y", "2"]}]}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["q", "i"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"8", " ", 
          SubscriptBox["q", "s"], " ", 
          RowBox[{"(", 
           RowBox[{
            SubsuperscriptBox["\[CapitalDelta]K", "x", "2"], "+", 
            SubsuperscriptBox["\[CapitalDelta]K", "y", "2"]}], ")"}]}], "+", 
         RowBox[{
          SubscriptBox["q", "ppp"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"6", "+", 
               RowBox[{"2", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"2", " ", 
                  SubscriptBox["\[Theta]", "s"]}], "]"}]}], "+", 
               RowBox[{"Cos", "[", 
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["\[Theta]", "s"], "-", 
                   SubscriptBox["\[Phi]", "s"]}], ")"}]}], "]"}], "-", 
               RowBox[{"2", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"2", " ", 
                  SubscriptBox["\[Phi]", "s"]}], "]"}]}], "+", 
               RowBox[{"Cos", "[", 
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["\[Theta]", "s"], "+", 
                   SubscriptBox["\[Phi]", "s"]}], ")"}]}], "]"}]}], ")"}], 
             " ", 
             SubsuperscriptBox["\[CapitalDelta]K", "x", "2"]}], "+", 
            RowBox[{"8", " ", 
             SuperscriptBox[
              RowBox[{"Sin", "[", 
               SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"2", " ", 
               SubscriptBox["\[Phi]", "s"]}], "]"}], " ", 
             SubscriptBox["\[CapitalDelta]K", "x"], " ", 
             SubscriptBox["\[CapitalDelta]K", "y"]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"6", "+", 
               RowBox[{"2", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"2", " ", 
                  SubscriptBox["\[Theta]", "s"]}], "]"}]}], "-", 
               RowBox[{"Cos", "[", 
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["\[Theta]", "s"], "-", 
                   SubscriptBox["\[Phi]", "s"]}], ")"}]}], "]"}], "+", 
               RowBox[{"2", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"2", " ", 
                  SubscriptBox["\[Phi]", "s"]}], "]"}]}], "-", 
               RowBox[{"Cos", "[", 
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["\[Theta]", "s"], "+", 
                   SubscriptBox["\[Phi]", "s"]}], ")"}]}], "]"}]}], ")"}], 
             " ", 
             SubsuperscriptBox["\[CapitalDelta]K", "y", "2"]}]}], ")"}]}]}], 
        ")"}]}]}], ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{"16", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["q", "ppp"], " ", 
       SubscriptBox["q", "s"]}], "+", 
      RowBox[{
       SubscriptBox["q", "i"], " ", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["q", "ppp"], "+", 
         SubscriptBox["q", "s"]}], ")"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
       SubscriptBox["q", "ppp"], " ", 
       SubscriptBox["q", "s"]}], "+", 
      RowBox[{
       SubscriptBox["q", "i"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
          SubscriptBox["q", "ppp"]}], "+", 
         SubscriptBox["q", "s"]}], ")"}]}]}], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.592356650467545*^9, 3.592356696513606*^9}],

Cell[BoxData["\<\"b -> the \[ImaginaryI]z coefficient\"\>"], "Output",
 CellChangeTimes->{3.592356650467545*^9, 3.592356696519211*^9}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "8"}], " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "i"], "]"}], " ", 
        SubsuperscriptBox["q", "ppp", "2"], " ", 
        SubsuperscriptBox["q", "s", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Sin", "[", 
            SubscriptBox["\[Theta]", "i"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            SubscriptBox["\[Phi]", "s"], "]"}], " ", 
           SubscriptBox["\[CapitalDelta]K", "x"]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Phi]", "s"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            SubscriptBox["\[Theta]", "i"], "]"}], " ", 
           SubscriptBox["\[CapitalDelta]K", "y"]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "i"], "]"}], " ", 
           SubscriptBox["\[CapitalDelta]K", "z"]}]}], ")"}]}], "+", 
       RowBox[{
        SubscriptBox["q", "i"], " ", 
        SubscriptBox["q", "ppp"], " ", 
        SubscriptBox["q", "s"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "4"}], " ", 
           SubscriptBox["q", "ppp"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Sin", "[", 
                 RowBox[{"2", " ", 
                  SubscriptBox["\[Theta]", "i"]}], "]"}], "-", 
                RowBox[{"Sin", "[", 
                 RowBox[{"2", " ", 
                  SubscriptBox["\[Theta]", "s"]}], "]"}]}], ")"}], " ", 
              RowBox[{"Sin", "[", 
               SubscriptBox["\[Phi]", "s"], "]"}], " ", 
              SubscriptBox["\[CapitalDelta]K", "x"]}], "+", 
             RowBox[{
              RowBox[{"Cos", "[", 
               SubscriptBox["\[Phi]", "s"], "]"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Sin", "[", 
                 RowBox[{"2", " ", 
                  SubscriptBox["\[Theta]", "i"]}], "]"}], "-", 
                RowBox[{"Sin", "[", 
                 RowBox[{"2", " ", 
                  SubscriptBox["\[Theta]", "s"]}], "]"}]}], ")"}], " ", 
              SubscriptBox["\[CapitalDelta]K", "y"]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"2", "+", 
                RowBox[{"Cos", "[", 
                 RowBox[{"2", " ", 
                  SubscriptBox["\[Theta]", "i"]}], "]"}], "+", 
                RowBox[{"Cos", "[", 
                 RowBox[{"2", " ", 
                  SubscriptBox["\[Theta]", "s"]}], "]"}]}], ")"}], " ", 
              SubscriptBox["\[CapitalDelta]K", "z"]}]}], ")"}]}], "+", 
          RowBox[{
           SubscriptBox["q", "s"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "4"}], " ", 
              RowBox[{"(", 
               RowBox[{"3", "+", 
                RowBox[{"Cos", "[", 
                 RowBox[{"2", " ", 
                  SubscriptBox["\[Theta]", "i"]}], "]"}]}], ")"}], " ", 
              SubscriptBox["\[CapitalDelta]K", "z"]}], "+", 
             RowBox[{
              SubscriptBox["\[CapitalDelta]K", "x"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "4"}], " ", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"2", " ", 
                   SubscriptBox["\[Theta]", "i"]}], "]"}], " ", 
                 RowBox[{"Sin", "[", 
                  SubscriptBox["\[Phi]", "s"], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"6", "+", 
                   RowBox[{"2", " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", 
                    SubscriptBox["\[Theta]", "i"]}], "]"}]}], "+", 
                   RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["\[Theta]", "i"], "-", 
                    SubscriptBox["\[Phi]", "s"]}], ")"}]}], "]"}], "-", 
                   RowBox[{"2", " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", 
                    SubscriptBox["\[Phi]", "s"]}], "]"}]}], "+", 
                   RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["\[Theta]", "i"], "+", 
                    SubscriptBox["\[Phi]", "s"]}], ")"}]}], "]"}]}], ")"}], 
                 " ", 
                 SubscriptBox["\[Rho]", "px"]}]}], ")"}]}], "+", 
             RowBox[{"8", " ", 
              RowBox[{"Cos", "[", 
               SubscriptBox["\[Phi]", "s"], "]"}], " ", 
              RowBox[{"Sin", "[", 
               SubscriptBox["\[Theta]", "i"], "]"}], " ", 
              SubscriptBox["\[CapitalDelta]K", "y"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"Cos", "[", 
                  SubscriptBox["\[Theta]", "i"], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"Sin", "[", 
                  SubscriptBox["\[Theta]", "i"], "]"}], " ", 
                 RowBox[{"Sin", "[", 
                  SubscriptBox["\[Phi]", "s"], "]"}], " ", 
                 SubscriptBox["\[Rho]", "px"]}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}], "+", 
       RowBox[{
        SubsuperscriptBox["q", "i", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", 
           SubsuperscriptBox["q", "ppp", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Sin", "[", 
               RowBox[{"2", " ", 
                SubscriptBox["\[Theta]", "s"]}], "]"}], " ", 
              RowBox[{"Sin", "[", 
               SubscriptBox["\[Phi]", "s"], "]"}], " ", 
              SubscriptBox["\[CapitalDelta]K", "x"]}], "+", 
             RowBox[{
              RowBox[{"Cos", "[", 
               SubscriptBox["\[Phi]", "s"], "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"2", " ", 
                SubscriptBox["\[Theta]", "s"]}], "]"}], " ", 
              SubscriptBox["\[CapitalDelta]K", "y"]}], "-", 
             RowBox[{"2", " ", 
              SuperscriptBox[
               RowBox[{"Cos", "[", 
                SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
              SubscriptBox["\[CapitalDelta]K", "z"]}]}], ")"}]}], "-", 
          RowBox[{"8", " ", 
           SubsuperscriptBox["q", "s", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["\[CapitalDelta]K", "z"], "-", 
             RowBox[{
              SubscriptBox["\[CapitalDelta]K", "x"], " ", 
              SubscriptBox["\[Rho]", "px"]}]}], ")"}]}], "+", 
          RowBox[{
           SubscriptBox["q", "ppp"], " ", 
           SubscriptBox["q", "s"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "4"}], " ", 
              RowBox[{"(", 
               RowBox[{"3", "+", 
                RowBox[{"Cos", "[", 
                 RowBox[{"2", " ", 
                  SubscriptBox["\[Theta]", "s"]}], "]"}]}], ")"}], " ", 
              SubscriptBox["\[CapitalDelta]K", "z"]}], "+", 
             RowBox[{
              SubscriptBox["\[CapitalDelta]K", "x"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"4", " ", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"2", " ", 
                   SubscriptBox["\[Theta]", "s"]}], "]"}], " ", 
                 RowBox[{"Sin", "[", 
                  SubscriptBox["\[Phi]", "s"], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"6", "+", 
                   RowBox[{"2", " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", 
                    SubscriptBox["\[Theta]", "s"]}], "]"}]}], "+", 
                   RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["\[Theta]", "s"], "-", 
                    SubscriptBox["\[Phi]", "s"]}], ")"}]}], "]"}], "-", 
                   RowBox[{"2", " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", 
                    SubscriptBox["\[Phi]", "s"]}], "]"}]}], "+", 
                   RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["\[Theta]", "s"], "+", 
                    SubscriptBox["\[Phi]", "s"]}], ")"}]}], "]"}]}], ")"}], 
                 " ", 
                 SubscriptBox["\[Rho]", "px"]}]}], ")"}]}], "+", 
             RowBox[{"8", " ", 
              RowBox[{"Cos", "[", 
               SubscriptBox["\[Phi]", "s"], "]"}], " ", 
              RowBox[{"Sin", "[", 
               SubscriptBox["\[Theta]", "s"], "]"}], " ", 
              SubscriptBox["\[CapitalDelta]K", "y"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Cos", "[", 
                 SubscriptBox["\[Theta]", "s"], "]"}], "+", 
                RowBox[{
                 RowBox[{"Sin", "[", 
                  SubscriptBox["\[Theta]", "s"], "]"}], " ", 
                 RowBox[{"Sin", "[", 
                  SubscriptBox["\[Phi]", "s"], "]"}], " ", 
                 SubscriptBox["\[Rho]", "px"]}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}]}], ")"}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{"4", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["q", "ppp"], " ", 
        SubscriptBox["q", "s"]}], "+", 
       RowBox[{
        SubscriptBox["q", "i"], " ", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["q", "ppp"], "+", 
          SubscriptBox["q", "s"]}], ")"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
        SubscriptBox["q", "ppp"], " ", 
        SubscriptBox["q", "s"]}], "+", 
       RowBox[{"2", " ", 
        SubscriptBox["q", "i"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
           SubscriptBox["q", "ppp"]}], "+", 
          SubscriptBox["q", "s"]}], ")"}]}]}], ")"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.592356650467545*^9, 3.59235669652214*^9}],

Cell[BoxData["\<\"c -> the z^2 coefficient\"\>"], "Output",
 CellChangeTimes->{3.592356650467545*^9, 3.592356696531988*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"4", " ", 
     SubscriptBox["q", "ppp"], " ", 
     SubscriptBox["q", "s"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", 
          RowBox[{
           SubscriptBox["\[Theta]", "i"], "+", 
           SubscriptBox["\[Theta]", "s"]}], "]"}], "2"], " ", 
        SubscriptBox["q", "ppp"]}], "+", 
       RowBox[{"2", " ", 
        SubscriptBox["q", "s"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Sin", "[", 
            SubscriptBox["\[Theta]", "i"], "]"}], "2"], "+", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", 
             SubscriptBox["\[Theta]", "i"]}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            SubscriptBox["\[Phi]", "s"], "]"}], " ", 
           SubscriptBox["\[Rho]", "px"]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
           SubsuperscriptBox["\[Rho]", "px", "2"]}]}], ")"}]}]}], ")"}]}], 
    "+", 
    RowBox[{
     SubscriptBox["q", "i"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"8", " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", 
          RowBox[{
           SubscriptBox["\[Theta]", "i"], "+", 
           SubscriptBox["\[Theta]", "s"]}], "]"}], "2"], " ", 
        SubsuperscriptBox["q", "ppp", "2"]}], "-", 
       RowBox[{"4", " ", 
        SubscriptBox["q", "ppp"], " ", 
        SubscriptBox["q", "s"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "3"}], "+", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", 
            SubscriptBox["\[Theta]", "i"]}], "]"}], "+", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", 
            SubscriptBox["\[Theta]", "s"]}], "]"}], "+", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["\[Theta]", "i"], "+", 
              SubscriptBox["\[Theta]", "s"]}], ")"}]}], "]"}], "-", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"2", " ", 
               SubscriptBox["\[Theta]", "i"]}], "]"}], "-", 
             RowBox[{"Sin", "[", 
              RowBox[{"2", " ", 
               SubscriptBox["\[Theta]", "s"]}], "]"}]}], ")"}], " ", 
           RowBox[{"Sin", "[", 
            SubscriptBox["\[Phi]", "s"], "]"}], " ", 
           SubscriptBox["\[Rho]", "px"]}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"2", "+", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", 
               SubscriptBox["\[Theta]", "i"]}], "]"}], "+", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", 
               SubscriptBox["\[Theta]", "s"]}], "]"}]}], ")"}], " ", 
           SubsuperscriptBox["\[Rho]", "px", "2"]}]}], ")"}]}], "+", 
       RowBox[{
        SubsuperscriptBox["q", "s", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"8", " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", 
             SubscriptBox["\[Theta]", "i"], "]"}], "2"]}], "+", 
          RowBox[{"8", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", 
             SubscriptBox["\[Theta]", "i"]}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            SubscriptBox["\[Phi]", "s"], "]"}], " ", 
           SubscriptBox["\[Rho]", "px"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"6", "+", 
             RowBox[{"2", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", 
                SubscriptBox["\[Theta]", "i"]}], "]"}]}], "-", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["\[Theta]", "i"], "-", 
                 SubscriptBox["\[Phi]", "s"]}], ")"}]}], "]"}], "+", 
             RowBox[{"2", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", 
                SubscriptBox["\[Phi]", "s"]}], "]"}]}], "-", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["\[Theta]", "i"], "+", 
                 SubscriptBox["\[Phi]", "s"]}], ")"}]}], "]"}]}], ")"}], " ", 
           
           SubsuperscriptBox["\[Rho]", "px", "2"]}]}], ")"}]}]}], ")"}]}], 
    "+", 
    RowBox[{
     SubsuperscriptBox["q", "i", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"8", " ", 
        SubscriptBox["q", "ppp"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Sin", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}], "2"], "-", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", 
             SubscriptBox["\[Theta]", "s"]}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            SubscriptBox["\[Phi]", "s"], "]"}], " ", 
           SubscriptBox["\[Rho]", "px"]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
           SubsuperscriptBox["\[Rho]", "px", "2"]}]}], ")"}]}], "+", 
       RowBox[{
        SubscriptBox["q", "s"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"8", " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", 
             SubscriptBox["\[Theta]", "s"], "]"}], "2"]}], "-", 
          RowBox[{"8", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", 
             SubscriptBox["\[Theta]", "s"]}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            SubscriptBox["\[Phi]", "s"], "]"}], " ", 
           SubscriptBox["\[Rho]", "px"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"6", "+", 
             RowBox[{"2", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", 
                SubscriptBox["\[Theta]", "s"]}], "]"}]}], "-", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["\[Theta]", "s"], "-", 
                 SubscriptBox["\[Phi]", "s"]}], ")"}]}], "]"}], "+", 
             RowBox[{"2", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", 
                SubscriptBox["\[Phi]", "s"]}], "]"}]}], "-", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["\[Theta]", "s"], "+", 
                 SubscriptBox["\[Phi]", "s"]}], ")"}]}], "]"}]}], ")"}], " ", 
           
           SubsuperscriptBox["\[Rho]", "px", "2"]}]}], ")"}]}]}], ")"}]}]}], 
   ")"}], "/", 
  RowBox[{"(", 
   RowBox[{"8", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["q", "ppp"], " ", 
       SubscriptBox["q", "s"]}], "+", 
      RowBox[{
       SubscriptBox["q", "i"], " ", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["q", "ppp"], "+", 
         SubscriptBox["q", "s"]}], ")"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
       SubscriptBox["q", "ppp"], " ", 
       SubscriptBox["q", "s"]}], "+", 
      RowBox[{"2", " ", 
       SubscriptBox["q", "i"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
          SubscriptBox["q", "ppp"]}], "+", 
         SubscriptBox["q", "s"]}], ")"}]}]}], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.592356650467545*^9, 3.592356696534658*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.592356459807116*^9, 3.592356461514735*^9}, {
  3.592356706726708*^9, 3.5923567949848747`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"We", " ", "can", " ", "simplify", " ", "the", " ", 
     RowBox[{"z", "^", "2"}], " ", "coefficient", " ", "somewhat", " ", "by", 
     " ", "using", " ", "the", " ", "small", " ", "angle", " ", 
     "approximation", " ", "to", " ", "set", " ", "all", " ", "terms", " ", 
     "with", " ", 
     SuperscriptBox[
      SubscriptBox["\[Rho]", "px"], "2"]}], "=", 
    RowBox[{"0", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"the", " ", "pump", " ", "walkoff"}], ")"}], "."}]}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"gga", ",", " ", "ggb", ",", " ", "ggc"}], "}"}], " ", "=", " ", 
     RowBox[{"CoefficientList", "[", 
      RowBox[{"CC", ",", 
       SubscriptBox["\[Rho]", "px"]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{"c", " ", "=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{"CC", " ", "-", " ", 
      RowBox[{"ggc", "*", " ", 
       SubsuperscriptBox["\[Rho]", "px", "2"]}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.590531679794528*^9, 3.5905316916060266`*^9}, {
   3.590531738706449*^9, 3.590531740375141*^9}, {3.590531836794589*^9, 
   3.5905318403045607`*^9}, {3.590537470833169*^9, 3.590537472305791*^9}, {
   3.590537509093202*^9, 3.590537535076665*^9}, {3.5905375765292597`*^9, 
   3.590537583318849*^9}, {3.590586298973214*^9, 3.5905863767121267`*^9}, 
   3.590689214372458*^9, {3.592356789097865*^9, 3.592356810367423*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["\[Theta]", "i"], "+", 
       SubscriptBox["\[Theta]", "s"]}], "]"}], "2"], " ", 
    SubscriptBox["q", "ppp"]}], "+", 
   RowBox[{
    SubscriptBox["q", "s"], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"Sin", "[", 
        SubscriptBox["\[Theta]", "i"], "]"}], "2"], "+", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", 
         SubscriptBox["\[Theta]", "i"]}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        SubscriptBox["\[Phi]", "s"], "]"}], " ", 
       SubscriptBox["\[Rho]", "px"]}]}], ")"}]}], "+", 
   RowBox[{
    SubscriptBox["q", "i"], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"Sin", "[", 
        SubscriptBox["\[Theta]", "s"], "]"}], "2"], "-", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", 
         SubscriptBox["\[Theta]", "s"]}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        SubscriptBox["\[Phi]", "s"], "]"}], " ", 
       SubscriptBox["\[Rho]", "px"]}]}], ")"}]}]}], 
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"Cos", "[", 
        SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
      SubscriptBox["q", "ppp"], " ", 
      SubscriptBox["q", "s"]}], "+", 
     RowBox[{
      SubscriptBox["q", "i"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"Cos", "[", 
           SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
         SubscriptBox["q", "ppp"]}], "+", 
        SubscriptBox["q", "s"]}], ")"}]}]}], ")"}]}]]], "Output",
 CellChangeTimes->{{3.590531684262251*^9, 3.5905316920017853`*^9}, 
   3.590531741004756*^9, 3.590531840910904*^9, 3.5905374730101957`*^9, {
   3.59053751212352*^9, 3.590537535486936*^9}, {3.590537577119635*^9, 
   3.5905375836193447`*^9}, {3.59058630111788*^9, 3.590586345472505*^9}, 
   3.5905863776033907`*^9, 3.5923568128996477`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Now", " ", "we", " ", "can", " ", "use", " ", "the", " ", 
     "approximation", " ", "that", " ", "the", " ", "Rayleigh", " ", "range", 
     " ", "of", " ", "the", " ", "three", " ", "Gaussians", " ", "is", " ", 
     "much", " ", "larger", " ", "than", " ", "the", " ", "length", " ", "of",
      " ", "the", " ", 
     RowBox[{"crystal", "/", "interaction"}], " ", 
     RowBox[{"region", ".", " ", "Replace"}], " ", 
     SubscriptBox["q", "j"], " ", "with", " ", 
     RowBox[{
      SuperscriptBox[
       SubscriptBox["W", "j"], "2"], ".", "  ", "I"}], " ", "am", " ", 
     "working", " ", "on", " ", "some", " ", "code", " ", "in", " ", "my", 
     " ", "program", " ", "to", " ", "let", " ", "me", " ", "handle", " ", 
     "more", " ", "advanced", " ", "functions", " ", "with", " ", "complex", 
     " ", "numbers", " ", 
     RowBox[{"better", ".", " ", "When"}], " ", "this", " ", "is", " ", 
     "finished"}], ",", " ", 
    RowBox[{"I", " ", 
     RowBox[{"won", "'"}], "t", " ", "need", " ", "to", " ", "make", " ", 
     "this", " ", 
     RowBox[{"approximation", ".", " ", "But"}], " ", "for", " ", "now"}], 
    ",", " ", 
    RowBox[{"this", " ", "is", " ", "what", " ", "I", " ", "am", " ", 
     RowBox[{"doing", "."}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{"Gaussian", " ", "mode", " ", "normalization"}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   SubscriptBox["n", "s"], "\[IndentingNewLine]", 
   SubscriptBox["n", "i"], "\[IndentingNewLine]", 
   SubscriptBox["n", "ppp"], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
    "Constants", " ", "left", " ", "over", " ", "from", " ", "the", " ", 
     "integration", " ", "over", " ", "x", " ", "and", " ", 
     RowBox[{"y", "."}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"xconstW", " ", "=", " ", 
    RowBox[{"xconst", " ", "/.", " ", 
     RowBox[{"{", "rules2", "}"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"yconstW", " ", "=", " ", 
    RowBox[{"yconst", " ", "/.", " ", 
     RowBox[{"{", "rules2", "}"}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Coefficients", " ", "in", " ", "the", " ", "exponential", " ", "from", 
     " ", "the", " ", "z", " ", "integral", " ", "that", " ", 
     RowBox[{"remains", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"aW", " ", "=", " ", 
    RowBox[{"a", " ", "/.", " ", 
     RowBox[{"{", "rules2", "}"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    StyleBox[
     RowBox[{
      StyleBox["b",
       FontWeight->"Plain"], "W"}]], " ", "=", " ", 
    RowBox[{"b", " ", "/.", " ", 
     RowBox[{"{", "rules2", "}"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"cW", " ", "=", " ", 
    RowBox[{"c", " ", "/.", " ", 
     RowBox[{"{", "rules2", "}"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.592356838384511*^9, 3.59235722227565*^9}}],

Cell[BoxData[
 FractionBox["1", 
  RowBox[{
   SqrtBox[
    RowBox[{"2", " ", "\[Pi]"}]], " ", 
   SubscriptBox["W", "s"]}]]], "Output",
 CellChangeTimes->{{3.59235706506317*^9, 3.592357100701055*^9}, 
   3.592357224263479*^9}],

Cell[BoxData[
 FractionBox["1", 
  RowBox[{
   SqrtBox[
    RowBox[{"2", " ", "\[Pi]"}]], " ", 
   SubscriptBox["W", "i"]}]]], "Output",
 CellChangeTimes->{{3.59235706506317*^9, 3.592357100701055*^9}, 
   3.5923572242673607`*^9}],

Cell[BoxData[
 FractionBox["1", 
  RowBox[{
   SqrtBox[
    RowBox[{"2", " ", "\[Pi]"}]], " ", 
   SubscriptBox["W", "ppp"]}]]], "Output",
 CellChangeTimes->{{3.59235706506317*^9, 3.592357100701055*^9}, 
   3.592357224270342*^9}],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   SqrtBox[
    RowBox[{"2", " ", "\[Pi]"}]], 
   SqrtBox[
    RowBox[{
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Phi]", "s"], "]"}], "2"], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", 
          SubscriptBox["\[Phi]", "s"], "]"}], "2"]}]}], 
      SubsuperscriptBox["W", "i", "2"]], "+", 
     FractionBox["1", 
      SubsuperscriptBox["W", "ppp", "2"]], "+", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Phi]", "s"], "]"}], "2"], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", 
          SubscriptBox["\[Phi]", "s"], "]"}], "2"]}]}], 
      SubsuperscriptBox["W", "s", "2"]]}]]], "}"}]], "Output",
 CellChangeTimes->{{3.59235706506317*^9, 3.592357100701055*^9}, 
   3.5923572242737103`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   SqrtBox[
    RowBox[{"2", " ", "\[Pi]"}]], 
   SqrtBox[
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubsuperscriptBox["W", "ppp", "2"], " ", 
         SubsuperscriptBox["W", "s", "2"]}], "+", 
        RowBox[{
         SubsuperscriptBox["W", "i", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           SubsuperscriptBox["W", "ppp", "2"], "+", 
           SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"Cos", "[", 
           SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
         SubsuperscriptBox["W", "ppp", "2"], " ", 
         SubsuperscriptBox["W", "s", "2"]}], "+", 
        RowBox[{
         SubsuperscriptBox["W", "i", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
            SubsuperscriptBox["W", "ppp", "2"]}], "+", 
           SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}], ")"}]}], 
     RowBox[{
      SubsuperscriptBox["W", "i", "2"], " ", 
      SubsuperscriptBox["W", "ppp", "2"], " ", 
      SubsuperscriptBox["W", "s", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Phi]", "s"], "]"}], "2"], "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              SubscriptBox["\[Phi]", "s"], "]"}], "2"]}]}], ")"}], " ", 
         SubsuperscriptBox["W", "ppp", "2"], " ", 
         SubsuperscriptBox["W", "s", "2"]}], "+", 
        RowBox[{
         SubsuperscriptBox["W", "i", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"Cos", "[", 
                SubscriptBox["\[Phi]", "s"], "]"}], "2"], "+", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"Cos", "[", 
                 SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
               SuperscriptBox[
                RowBox[{"Sin", "[", 
                 SubscriptBox["\[Phi]", "s"], "]"}], "2"]}]}], ")"}], " ", 
            SubsuperscriptBox["W", "ppp", "2"]}], "+", 
           SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}], ")"}]}]]]], 
  "}"}]], "Output",
 CellChangeTimes->{{3.59235706506317*^9, 3.592357100701055*^9}, 
   3.592357224279244*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     SubsuperscriptBox["W", "i", "2"], " ", 
     SubsuperscriptBox["W", "ppp", "2"], " ", 
     SubsuperscriptBox["W", "s", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubsuperscriptBox["W", "ppp", "2"], " ", 
        SubsuperscriptBox["W", "s", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"6", "+", 
             RowBox[{"2", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", 
                SubscriptBox["\[Theta]", "i"]}], "]"}]}], "+", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["\[Theta]", "i"], "-", 
                 SubscriptBox["\[Phi]", "s"]}], ")"}]}], "]"}], "-", 
             RowBox[{"2", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", 
                SubscriptBox["\[Phi]", "s"]}], "]"}]}], "+", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["\[Theta]", "i"], "+", 
                 SubscriptBox["\[Phi]", "s"]}], ")"}]}], "]"}]}], ")"}], " ", 
           
           SubsuperscriptBox["\[CapitalDelta]K", "x", "2"]}], "+", 
          RowBox[{"8", " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", 
             SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", 
             SubscriptBox["\[Phi]", "s"]}], "]"}], " ", 
           SubscriptBox["\[CapitalDelta]K", "x"], " ", 
           SubscriptBox["\[CapitalDelta]K", "y"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"6", "+", 
             RowBox[{"2", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", 
                SubscriptBox["\[Theta]", "i"]}], "]"}]}], "-", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["\[Theta]", "i"], "-", 
                 SubscriptBox["\[Phi]", "s"]}], ")"}]}], "]"}], "+", 
             RowBox[{"2", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", 
                SubscriptBox["\[Phi]", "s"]}], "]"}]}], "-", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["\[Theta]", "i"], "+", 
                 SubscriptBox["\[Phi]", "s"]}], ")"}]}], "]"}]}], ")"}], " ", 
           
           SubsuperscriptBox["\[CapitalDelta]K", "y", "2"]}]}], ")"}]}], "+", 
       
       RowBox[{
        SubsuperscriptBox["W", "i", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"8", " ", 
           SubsuperscriptBox["W", "s", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             SubsuperscriptBox["\[CapitalDelta]K", "x", "2"], "+", 
             SubsuperscriptBox["\[CapitalDelta]K", "y", "2"]}], ")"}]}], "+", 
          
          RowBox[{
           SubsuperscriptBox["W", "ppp", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"6", "+", 
                RowBox[{"2", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"2", " ", 
                   SubscriptBox["\[Theta]", "s"]}], "]"}]}], "+", 
                RowBox[{"Cos", "[", 
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["\[Theta]", "s"], "-", 
                    SubscriptBox["\[Phi]", "s"]}], ")"}]}], "]"}], "-", 
                RowBox[{"2", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"2", " ", 
                   SubscriptBox["\[Phi]", "s"]}], "]"}]}], "+", 
                RowBox[{"Cos", "[", 
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["\[Theta]", "s"], "+", 
                    SubscriptBox["\[Phi]", "s"]}], ")"}]}], "]"}]}], ")"}], 
              " ", 
              SubsuperscriptBox["\[CapitalDelta]K", "x", "2"]}], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox[
               RowBox[{"Sin", "[", 
                SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"2", " ", 
                SubscriptBox["\[Phi]", "s"]}], "]"}], " ", 
              SubscriptBox["\[CapitalDelta]K", "x"], " ", 
              SubscriptBox["\[CapitalDelta]K", "y"]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"6", "+", 
                RowBox[{"2", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"2", " ", 
                   SubscriptBox["\[Theta]", "s"]}], "]"}]}], "-", 
                RowBox[{"Cos", "[", 
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["\[Theta]", "s"], "-", 
                    SubscriptBox["\[Phi]", "s"]}], ")"}]}], "]"}], "+", 
                RowBox[{"2", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"2", " ", 
                   SubscriptBox["\[Phi]", "s"]}], "]"}]}], "-", 
                RowBox[{"Cos", "[", 
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["\[Theta]", "s"], "+", 
                    SubscriptBox["\[Phi]", "s"]}], ")"}]}], "]"}]}], ")"}], 
              " ", 
              SubsuperscriptBox["\[CapitalDelta]K", "y", "2"]}]}], ")"}]}]}], 
         ")"}]}]}], ")"}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{"16", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubsuperscriptBox["W", "ppp", "2"], " ", 
        SubsuperscriptBox["W", "s", "2"]}], "+", 
       RowBox[{
        SubsuperscriptBox["W", "i", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SubsuperscriptBox["W", "ppp", "2"], "+", 
          SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
        SubsuperscriptBox["W", "ppp", "2"], " ", 
        SubsuperscriptBox["W", "s", "2"]}], "+", 
       RowBox[{
        SubsuperscriptBox["W", "i", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
           SubsuperscriptBox["W", "ppp", "2"]}], "+", 
          SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}], ")"}]}], ")"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.59235706506317*^9, 3.592357100701055*^9}, 
   3.592357224287389*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "8"}], " ", 
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Theta]", "i"], "]"}], " ", 
         SubsuperscriptBox["W", "ppp", "4"], " ", 
         SubsuperscriptBox["W", "s", "4"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Sin", "[", 
             SubscriptBox["\[Theta]", "i"], "]"}], " ", 
            RowBox[{"Sin", "[", 
             SubscriptBox["\[Phi]", "s"], "]"}], " ", 
            SubscriptBox["\[CapitalDelta]K", "x"]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Phi]", "s"], "]"}], " ", 
            RowBox[{"Sin", "[", 
             SubscriptBox["\[Theta]", "i"], "]"}], " ", 
            SubscriptBox["\[CapitalDelta]K", "y"]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "i"], "]"}], " ", 
            SubscriptBox["\[CapitalDelta]K", "z"]}]}], ")"}]}], "+", 
        RowBox[{
         SubsuperscriptBox["W", "i", "2"], " ", 
         SubsuperscriptBox["W", "ppp", "2"], " ", 
         SubsuperscriptBox["W", "s", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "4"}], " ", 
            SubsuperscriptBox["W", "ppp", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Sin", "[", 
                  RowBox[{"2", " ", 
                   SubscriptBox["\[Theta]", "i"]}], "]"}], "-", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"2", " ", 
                   SubscriptBox["\[Theta]", "s"]}], "]"}]}], ")"}], " ", 
               RowBox[{"Sin", "[", 
                SubscriptBox["\[Phi]", "s"], "]"}], " ", 
               SubscriptBox["\[CapitalDelta]K", "x"]}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                SubscriptBox["\[Phi]", "s"], "]"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Sin", "[", 
                  RowBox[{"2", " ", 
                   SubscriptBox["\[Theta]", "i"]}], "]"}], "-", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"2", " ", 
                   SubscriptBox["\[Theta]", "s"]}], "]"}]}], ")"}], " ", 
               SubscriptBox["\[CapitalDelta]K", "y"]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"2", "+", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"2", " ", 
                   SubscriptBox["\[Theta]", "i"]}], "]"}], "+", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"2", " ", 
                   SubscriptBox["\[Theta]", "s"]}], "]"}]}], ")"}], " ", 
               SubscriptBox["\[CapitalDelta]K", "z"]}]}], ")"}]}], "+", 
           RowBox[{
            SubsuperscriptBox["W", "s", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "4"}], " ", 
               RowBox[{"(", 
                RowBox[{"3", "+", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"2", " ", 
                   SubscriptBox["\[Theta]", "i"]}], "]"}]}], ")"}], " ", 
               SubscriptBox["\[CapitalDelta]K", "z"]}], "+", 
              RowBox[{
               SubscriptBox["\[CapitalDelta]K", "x"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "4"}], " ", 
                  RowBox[{"Sin", "[", 
                   RowBox[{"2", " ", 
                    SubscriptBox["\[Theta]", "i"]}], "]"}], " ", 
                  RowBox[{"Sin", "[", 
                   SubscriptBox["\[Phi]", "s"], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"6", "+", 
                    RowBox[{"2", " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", 
                    SubscriptBox["\[Theta]", "i"]}], "]"}]}], "+", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["\[Theta]", "i"], "-", 
                    SubscriptBox["\[Phi]", "s"]}], ")"}]}], "]"}], "-", 
                    RowBox[{"2", " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", 
                    SubscriptBox["\[Phi]", "s"]}], "]"}]}], "+", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["\[Theta]", "i"], "+", 
                    SubscriptBox["\[Phi]", "s"]}], ")"}]}], "]"}]}], ")"}], 
                  " ", 
                  SubscriptBox["\[Rho]", "px"]}]}], ")"}]}], "+", 
              RowBox[{"8", " ", 
               RowBox[{"Cos", "[", 
                SubscriptBox["\[Phi]", "s"], "]"}], " ", 
               RowBox[{"Sin", "[", 
                SubscriptBox["\[Theta]", "i"], "]"}], " ", 
               SubscriptBox["\[CapitalDelta]K", "y"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"Cos", "[", 
                   SubscriptBox["\[Theta]", "i"], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"Sin", "[", 
                   SubscriptBox["\[Theta]", "i"], "]"}], " ", 
                  RowBox[{"Sin", "[", 
                   SubscriptBox["\[Phi]", "s"], "]"}], " ", 
                  SubscriptBox["\[Rho]", "px"]}]}], ")"}]}]}], ")"}]}]}], 
          ")"}]}], "+", 
        RowBox[{
         SubsuperscriptBox["W", "i", "4"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", 
            SubsuperscriptBox["W", "ppp", "4"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"2", " ", 
                 SubscriptBox["\[Theta]", "s"]}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                SubscriptBox["\[Phi]", "s"], "]"}], " ", 
               SubscriptBox["\[CapitalDelta]K", "x"]}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                SubscriptBox["\[Phi]", "s"], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"2", " ", 
                 SubscriptBox["\[Theta]", "s"]}], "]"}], " ", 
               SubscriptBox["\[CapitalDelta]K", "y"]}], "-", 
              RowBox[{"2", " ", 
               SuperscriptBox[
                RowBox[{"Cos", "[", 
                 SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
               SubscriptBox["\[CapitalDelta]K", "z"]}]}], ")"}]}], "-", 
           RowBox[{"8", " ", 
            SubsuperscriptBox["W", "s", "4"], " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["\[CapitalDelta]K", "z"], "-", 
              RowBox[{
               SubscriptBox["\[CapitalDelta]K", "x"], " ", 
               SubscriptBox["\[Rho]", "px"]}]}], ")"}]}], "+", 
           RowBox[{
            SubsuperscriptBox["W", "ppp", "2"], " ", 
            SubsuperscriptBox["W", "s", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "4"}], " ", 
               RowBox[{"(", 
                RowBox[{"3", "+", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"2", " ", 
                   SubscriptBox["\[Theta]", "s"]}], "]"}]}], ")"}], " ", 
               SubscriptBox["\[CapitalDelta]K", "z"]}], "+", 
              RowBox[{
               SubscriptBox["\[CapitalDelta]K", "x"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"4", " ", 
                  RowBox[{"Sin", "[", 
                   RowBox[{"2", " ", 
                    SubscriptBox["\[Theta]", "s"]}], "]"}], " ", 
                  RowBox[{"Sin", "[", 
                   SubscriptBox["\[Phi]", "s"], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"6", "+", 
                    RowBox[{"2", " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", 
                    SubscriptBox["\[Theta]", "s"]}], "]"}]}], "+", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["\[Theta]", "s"], "-", 
                    SubscriptBox["\[Phi]", "s"]}], ")"}]}], "]"}], "-", 
                    RowBox[{"2", " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", 
                    SubscriptBox["\[Phi]", "s"]}], "]"}]}], "+", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["\[Theta]", "s"], "+", 
                    SubscriptBox["\[Phi]", "s"]}], ")"}]}], "]"}]}], ")"}], 
                  " ", 
                  SubscriptBox["\[Rho]", "px"]}]}], ")"}]}], "+", 
              RowBox[{"8", " ", 
               RowBox[{"Cos", "[", 
                SubscriptBox["\[Phi]", "s"], "]"}], " ", 
               RowBox[{"Sin", "[", 
                SubscriptBox["\[Theta]", "s"], "]"}], " ", 
               SubscriptBox["\[CapitalDelta]K", "y"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Cos", "[", 
                  SubscriptBox["\[Theta]", "s"], "]"}], "+", 
                 RowBox[{
                  RowBox[{"Sin", "[", 
                   SubscriptBox["\[Theta]", "s"], "]"}], " ", 
                  RowBox[{"Sin", "[", 
                   SubscriptBox["\[Phi]", "s"], "]"}], " ", 
                  SubscriptBox["\[Rho]", "px"]}]}], ")"}]}]}], ")"}]}]}], 
          ")"}]}]}], ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"4", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubsuperscriptBox["W", "ppp", "2"], " ", 
         SubsuperscriptBox["W", "s", "2"]}], "+", 
        RowBox[{
         SubsuperscriptBox["W", "i", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           SubsuperscriptBox["W", "ppp", "2"], "+", 
           SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"Cos", "[", 
           SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
         SubsuperscriptBox["W", "ppp", "2"], " ", 
         SubsuperscriptBox["W", "s", "2"]}], "+", 
        RowBox[{"2", " ", 
         SubsuperscriptBox["W", "i", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
            SubsuperscriptBox["W", "ppp", "2"]}], "+", 
           SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}], ")"}]}], ")"}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.59235706506317*^9, 3.592357100701055*^9}, 
   3.5923572243089113`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"Sin", "[", 
       RowBox[{
        SubscriptBox["\[Theta]", "i"], "+", 
        SubscriptBox["\[Theta]", "s"]}], "]"}], "2"], " ", 
     SubsuperscriptBox["W", "ppp", "2"]}], "+", 
    RowBox[{
     SubsuperscriptBox["W", "s", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"Sin", "[", 
         SubscriptBox["\[Theta]", "i"], "]"}], "2"], "+", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", 
          SubscriptBox["\[Theta]", "i"]}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["\[Phi]", "s"], "]"}], " ", 
        SubscriptBox["\[Rho]", "px"]}]}], ")"}]}], "+", 
    RowBox[{
     SubsuperscriptBox["W", "i", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"Sin", "[", 
         SubscriptBox["\[Theta]", "s"], "]"}], "2"], "-", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", 
          SubscriptBox["\[Theta]", "s"]}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["\[Phi]", "s"], "]"}], " ", 
        SubscriptBox["\[Rho]", "px"]}]}], ")"}]}]}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
       SubsuperscriptBox["W", "ppp", "2"], " ", 
       SubsuperscriptBox["W", "s", "2"]}], "+", 
      RowBox[{
       SubsuperscriptBox["W", "i", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
          SubsuperscriptBox["W", "ppp", "2"]}], "+", 
         SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}], ")"}]}]], 
  "}"}]], "Output",
 CellChangeTimes->{{3.59235706506317*^9, 3.592357100701055*^9}, 
   3.592357224339498*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.592357267117301*^9, 3.5923574947882566`*^9}, 
   3.592359006636922*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.5923573444644814`*^9, 3.5923573467903843`*^9}}],

Cell[TextData[{
 Cell[BoxData[{
  RowBox[{
   RowBox[{
    RowBox[{
    "This", " ", "leaves", " ", "the", " ", "following", " ", "integral", " ",
      "that", " ", "needs", " ", "to", " ", "be", " ", "evaluated", " ", 
     RowBox[{"numerically", ":", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"F", 
       RowBox[{"(", 
        RowBox[{"x", ",", "y", ",", "z"}], ")"}]}]}]}], " ", "=", " ", 
    RowBox[{
    "ns", " ", "*", "ni", " ", "*", "np", " ", "*", "xconst", " ", "*", 
     "yconst", " ", "*", 
     RowBox[{"Exp", "[", "a", "]"}], " ", "*", " ", 
     RowBox[{
      SuperscriptBox[
       SubscriptBox["\[Integral]", 
        RowBox[{
         RowBox[{"-", "L"}], "/", "2"}]], 
       RowBox[{"L", "/", "2"}]], 
      RowBox[{"dz", " ", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"c", "*", 
          RowBox[{"z", "^", "2"}]}], " ", "+", " ", 
         RowBox[{"\[ImaginaryI]", "*", "b", "*", "z"}]}], "]"}]}]}]}]}], 
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"To", " ", "calculate", " ", "the", " ", "join", " ", "spectrum"}],
    ",", " ", 
   RowBox[{"F", 
    RowBox[{"(", 
     RowBox[{"x", ",", "y", ",", "z"}], ")"}], " ", "is", " ", "integrated", 
    " ", "over", " ", 
    SubscriptBox["\[Omega]", "s"], " ", "and", " ", 
    RowBox[{
     SubscriptBox["\[Omega]", "i"], ":", "\[IndentingNewLine]", 
     RowBox[{"\[Integral]", 
      RowBox[{
       SubscriptBox["d\[Omega]", "s"], " ", 
       RowBox[{"\[Integral]", 
        RowBox[{
         SubscriptBox["\[Omega]", "i"], " ", "F", 
         RowBox[{"(", 
          RowBox[{"x", ",", "y", ",", "z"}], ")"}], 
         "\[IndentingNewLine]"}]}]}]}]}]}]}]}],
  CellChangeTimes->{{3.592357267117301*^9, 3.5923574947882566`*^9}}],
 "\nIn my program when fiber coupling is enabled as an option, this is the \
equation that is used. Note: because I am assuming a fixed waist, for \
collinear geometries changing the focus does not change the joint spectrum. \
This is one of the motivating reasons for me attempting to develop my own \
complex number library in javascript so that I can handle Gaussian beams with \
a varying waist along z."
}], "Text",
 CellChangeTimes->{{3.592358996964122*^9, 3.59235913236346*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Singles calculation", "Section",
 CellChangeTimes->{{3.592357609964521*^9, 3.592357614657125*^9}, {
  3.5923576563669157`*^9, 3.592357658028727*^9}}],

Cell[TextData[{
 "Now comes the hard part: the calculation of the singles rate for the idler \
given that the signal photon has been succefully coupled into a fiber mode. \
The tricky thing is that I am no longer integrating over a Gaussian mode for \
the idler, rather I must integrate over ",
 StyleBox["every",
  FontSlant->"Italic"],
 " spatial mode. Ideally, I could follow the approach of Bennink and replace \
the Gaussian mode for the idler in the calculation above with a sum over all \
the Laguerre-Gauss modes. Bennink only considers the collinear case which is \
considerably easier. When things become noncollinear, the coordinate \
transforms make everything much more difficult. Difficult enought that I \
cannot find an analytical solution. If you know of an approach to solve this \
analytically, it would be of a great benefit. \n\nOne approach I have \
considered is instead of trying to do the sum over all possible spatial \
modes, to instead only include the first 10-20 Laguerre Gausse modes. The \
thinking is that most of the extra projected light from the idler that isn\
\[CloseCurlyQuote]t coupled into the fundamental mode will be distributed \
amongst the next few higher order modes. Of course, for a very multimodal \
source this will break down. It is something to consider, though.\n\nWhat I \
am doing now in the program with the \[OpenCurlyDoubleQuote]Mode Solver\
\[CloseCurlyDoubleQuote] routine is to instead take a hybrid approach. I used \
the coincience result from above, but I set the idler waist to infinity. Now \
the idler behaves like a plane wave. I then calculate the intensity over all \
of the transverse Idler momentum components at the end surface of the crystal \
to get the singles rate.\n\n ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["F", "s"], TraditionalForm]]],
 "(x,y,z) =  F(x,y,z) with ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["W", "i"], "\[Rule]", " ", "\[Infinity]"}], 
   TraditionalForm]]],
 "    [2]\n\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["P", "s"], "="}], TraditionalForm]]],
 Cell[BoxData[
  RowBox[{
   RowBox[{"\[Integral]", 
    RowBox[{
     SubscriptBox["d\[Omega]", "s"], " ", 
     RowBox[{"\[Integral]", 
      RowBox[{
       SubscriptBox["\[Omega]", "i"], " ", 
       RowBox[{"\[Integral]", 
        RowBox[{
         SubscriptBox["k", "x"], " ", 
         RowBox[{"\[Integral]", 
          SubscriptBox["k", "y"]}]}]}]}]}]}]}], " ", "|", " ", 
   RowBox[{
    SubscriptBox["F", "s"], 
    RowBox[{"(", 
     RowBox[{"x", ",", "y", ",", "z"}], ")"}]}], 
   SuperscriptBox["|", "2"]}]],
  CellChangeTimes->{{3.592357267117301*^9, 3.5923574947882566`*^9}}],
 "   [3]\n\nTo get the coincidence rate, I then find the overlap with the \
intensity distribution with the idler Gaussian collection mode at the surface \
of the crystal:\n\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["P", "c"], "="}], TraditionalForm]]],
 Cell[BoxData[
  RowBox[{
   RowBox[{"\[Integral]", 
    RowBox[{
     SubscriptBox["d\[Omega]", "s"], " ", 
     RowBox[{"\[Integral]", 
      RowBox[{
       SubscriptBox["\[Omega]", "i"], " ", 
       RowBox[{"\[Integral]", 
        RowBox[{
         SubscriptBox["k", "x"], " ", 
         RowBox[{"\[Integral]", 
          SubscriptBox["k", "y"]}]}]}]}]}]}]}], " ", "|", " ", 
   RowBox[{
    SubscriptBox["F", "s"], 
    RowBox[{"(", 
     RowBox[{"x", ",", "y", ",", "z"}], ")"}], "*", "u", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["k", "ix"], ",", " ", 
       SubscriptBox["k", "iy"]}], ")"}], "*"]}], 
   SuperscriptBox["|", "2"]}]],
  CellChangeTimes->{{3.592357267117301*^9, 3.5923574947882566`*^9}}],
 ",   [4]\n\nwhere ",
 Cell[BoxData[
  RowBox[{"u", 
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["k", "ix"], ",", " ", 
     SubscriptBox["k", "iy"]}], ")"}]}]],
  CellChangeTimes->{{3.592357267117301*^9, 3.5923574947882566`*^9}}],
 " is the Gaussian mode of the idler in momentum space. Now the heralding \
efficiency ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Eta]", "i"], "=", " ", 
    RowBox[{
     SubscriptBox["P", "c"], "/", 
     RowBox[{
      SubscriptBox["P", "s"], ".", " "}]}]}], TraditionalForm]]],
 " \n\nI am pretty sure the calculation is not correct, though (or at least \
my implementation of it). I keep getting very high coupling efficiencies. For \
most sources it is almost trival to get near 100% coupling efficiency. This \
does not agree with anything I have seen in the literature, though. I think \
there may be some problems with the way I am transforming from real space to \
momentum for the calculation. The projected spatial mode for the idler, given \
from equation 3, is what I plot in the \[OpenCurlyDoubleQuote]Mode Solver\
\[CloseCurlyDoubleQuote] option of my plot. In this plot the x and y axes are \
not directly ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["k", "ix"], TraditionalForm]]],
 "and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["k", "iy"], TraditionalForm]]],
 ", but rather the angle of emission along the surface of the crystal in lab \
coordinates. \n\nI am still trying to figure out the correct way to calculate \
the efficiency correctly, but need some help!"
}], "Text",
 CellChangeTimes->{{3.592357675339229*^9, 3.592358944366269*^9}, {
  3.592359176149929*^9, 3.592359326990259*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Work", " ", "on", " ", "Hermite", " ", "Gauss", " ", "Modes"}], 
   " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"HG1exp", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "a"}], "*", 
       RowBox[{"x", "^", "2"}]}], " ", "-", " ", 
      RowBox[{"\[ImaginaryI]b", "*", "x"}], " ", "-", "c"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"HG1exp", " ", "=", 
     RowBox[{"CompleteSquare", "[", 
      RowBox[{"HG1exp", ",", " ", "x"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"intx", " ", "=", " ", 
    RowBox[{"Assuming", " ", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"a", ">", "0"}], " ", "&&", " ", 
       RowBox[{"b", ">", "0"}], " ", "&&", " ", 
       RowBox[{"c", ">", "0"}], "  ", "&&", 
       RowBox[{"d", ">", "0"}], " ", "&&", " ", 
       RowBox[{"n", ">", "0"}], " ", "&&", " ", 
       RowBox[{
        RowBox[{"Re", "[", "\[ImaginaryI]b", "]"}], ">", "0"}]}], ",", " ", 
      RowBox[{"Integrate", "[", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"d", "*", "x"}], ")"}], "^", "n"}], "*", 
         RowBox[{"Exp", "[", "HG1exp", "]"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}]}], 
       "]"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.592415748279933*^9, 3.5924160426408243`*^9}, {
  3.592416076013693*^9, 3.592416078900839*^9}, {3.592416111359272*^9, 
  3.5924161672961493`*^9}, {3.592416205806699*^9, 3.592416216043335*^9}, {
  3.592416269967763*^9, 3.592416271018547*^9}, {3.592416450478842*^9, 
  3.592416464180223*^9}, {3.592416616845969*^9, 3.592416627644641*^9}, {
  3.592416975899543*^9, 3.5924169810489693`*^9}, {3.5924170277020073`*^9, 
  3.592417065565769*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  SuperscriptBox["a", 
   RowBox[{
    RowBox[{"-", "1"}], "-", 
    FractionBox["n", "2"]}]], " ", 
  SuperscriptBox["d", "n"], " ", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"-", "c"}]], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], "n"]}], ")"}], " ", "\[ImaginaryI]b", " ", 
     RowBox[{"Gamma", "[", 
      RowBox[{"1", "+", 
       FractionBox["n", "2"]}], "]"}], " ", 
     RowBox[{"Hypergeometric1F1", "[", 
      RowBox[{
       RowBox[{"1", "+", 
        FractionBox["n", "2"]}], ",", 
       FractionBox["3", "2"], ",", 
       FractionBox[
        SuperscriptBox["\[ImaginaryI]b", "2"], 
        RowBox[{"4", " ", "a"}]]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], "n"]}], ")"}], " ", 
     SqrtBox["a"], " ", 
     RowBox[{"Gamma", "[", 
      FractionBox[
       RowBox[{"1", "+", "n"}], "2"], "]"}], " ", 
     RowBox[{"Hypergeometric1F1", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"1", "+", "n"}], "2"], ",", 
       FractionBox["1", "2"], ",", 
       FractionBox[
        SuperscriptBox["\[ImaginaryI]b", "2"], 
        RowBox[{"4", " ", "a"}]]}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.592416011920471*^9, 3.59241604318718*^9}, {
   3.5924160795697727`*^9, 3.592416136070816*^9}, 3.592416168031774*^9, {
   3.592416219259557*^9, 3.592416226684752*^9}, 3.5924162839319477`*^9, 
   3.592416465809917*^9, 3.592416633624422*^9, 3.592416986722156*^9, {
   3.59241703153006*^9, 3.592417066599351*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"h0", " ", "=", " ", 
  RowBox[{"intx", " ", "/.", " ", 
   RowBox[{"{", 
    RowBox[{"n", "\[Rule]", " ", "0"}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"h1", " ", "=", " ", 
  RowBox[{"intx", " ", "/.", " ", 
   RowBox[{"{", 
    RowBox[{"n", "\[Rule]", " ", "1"}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"h2", " ", "=", " ", 
  RowBox[{"intx", " ", "/.", " ", 
   RowBox[{"{", 
    RowBox[{"n", "\[Rule]", " ", "2"}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"h3", " ", "=", " ", 
  RowBox[{"intx", " ", "/.", " ", 
   RowBox[{"{", 
    RowBox[{"n", "\[Rule]", " ", "3"}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"h4", " ", "=", " ", 
  RowBox[{"intx", " ", "/.", " ", 
   RowBox[{"{", 
    RowBox[{"n", "\[Rule]", " ", "4"}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"h5", " ", "=", " ", 
  RowBox[{"intx", " ", "/.", " ", 
   RowBox[{"{", 
    RowBox[{"n", "\[Rule]", " ", "5"}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"h6", " ", "=", " ", 
  RowBox[{"intx", " ", "/.", " ", 
   RowBox[{"{", 
    RowBox[{"n", "\[Rule]", " ", "6"}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"h7", " ", "=", " ", 
  RowBox[{"intx", " ", "/.", " ", 
   RowBox[{"{", 
    RowBox[{"n", "\[Rule]", " ", "7"}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"h8", " ", "=", " ", 
  RowBox[{"intx", " ", "/.", " ", 
   RowBox[{"{", 
    RowBox[{"n", "\[Rule]", " ", "8"}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"h9", " ", "=", " ", 
  RowBox[{"intx", " ", "/.", " ", 
   RowBox[{"{", 
    RowBox[{"n", "\[Rule]", " ", "9"}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"h10", " ", "=", " ", 
  RowBox[{"intx", " ", "/.", " ", 
   RowBox[{"{", 
    RowBox[{"n", "\[Rule]", " ", "10"}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"h11", "  ", "=", " ", 
  RowBox[{"intx", " ", "/.", " ", 
   RowBox[{"{", 
    RowBox[{"n", "\[Rule]", " ", "11"}], "}"}]}]}], "\[IndentingNewLine]"}], \
"Input",
 CellChangeTimes->{
  3.592415858298173*^9, 3.5924160505912113`*^9, {3.5924164797391768`*^9, 
   3.5924165347685328`*^9}, {3.592417086143353*^9, 3.5924171607722816`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", "c"}], "+", 
     FractionBox[
      SuperscriptBox["\[ImaginaryI]b", "2"], 
      RowBox[{"4", " ", "a"}]]}]], " ", 
   SqrtBox["\[Pi]"]}], 
  SqrtBox["a"]]], "Output",
 CellChangeTimes->{
  3.592416491200554*^9, 3.5924165375020723`*^9, {3.5924166366058207`*^9, 
   3.5924166506176443`*^9}, 3.5924170344329453`*^9, 3.5924170708343983`*^9, {
   3.592417156396976*^9, 3.5924171615640182`*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"d", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "c"}], "+", 
      FractionBox[
       SuperscriptBox["\[ImaginaryI]b", "2"], 
       RowBox[{"4", " ", "a"}]]}]], " ", 
    SqrtBox["\[Pi]"], " ", "\[ImaginaryI]b"}], 
   RowBox[{"2", " ", 
    SuperscriptBox["a", 
     RowBox[{"3", "/", "2"}]]}]]}]], "Output",
 CellChangeTimes->{
  3.592416491200554*^9, 3.5924165375020723`*^9, {3.5924166366058207`*^9, 
   3.5924166506176443`*^9}, 3.5924170344329453`*^9, 3.5924170708343983`*^9, {
   3.592417156396976*^9, 3.592417161565806*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["d", "2"], " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", "c"}], "+", 
     FractionBox[
      SuperscriptBox["\[ImaginaryI]b", "2"], 
      RowBox[{"4", " ", "a"}]]}]], " ", 
   SqrtBox["\[Pi]"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     FractionBox[
      SuperscriptBox["\[ImaginaryI]b", "2"], 
      RowBox[{"2", " ", "a"}]]}], ")"}]}], 
  RowBox[{"2", " ", 
   SuperscriptBox["a", 
    RowBox[{"3", "/", "2"}]]}]]], "Output",
 CellChangeTimes->{
  3.592416491200554*^9, 3.5924165375020723`*^9, {3.5924166366058207`*^9, 
   3.5924166506176443`*^9}, 3.5924170344329453`*^9, 3.5924170708343983`*^9, {
   3.592417156396976*^9, 3.592417161567212*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"3", " ", 
    SuperscriptBox["d", "3"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "c"}], "+", 
      FractionBox[
       SuperscriptBox["\[ImaginaryI]b", "2"], 
       RowBox[{"4", " ", "a"}]]}]], " ", 
    SqrtBox["\[Pi]"], " ", "\[ImaginaryI]b", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      FractionBox[
       SuperscriptBox["\[ImaginaryI]b", "2"], 
       RowBox[{"6", " ", "a"}]]}], ")"}]}], 
   RowBox[{"4", " ", 
    SuperscriptBox["a", 
     RowBox[{"5", "/", "2"}]]}]]}]], "Output",
 CellChangeTimes->{
  3.592416491200554*^9, 3.5924165375020723`*^9, {3.5924166366058207`*^9, 
   3.5924166506176443`*^9}, 3.5924170344329453`*^9, 3.5924170708343983`*^9, {
   3.592417156396976*^9, 3.592417161569049*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"3", " ", 
   SuperscriptBox["d", "4"], " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", "c"}], "+", 
     FractionBox[
      SuperscriptBox["\[ImaginaryI]b", "2"], 
      RowBox[{"4", " ", "a"}]]}]], " ", 
   SqrtBox["\[Pi]"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     FractionBox[
      SuperscriptBox["\[ImaginaryI]b", "2"], "a"], "+", 
     FractionBox[
      SuperscriptBox["\[ImaginaryI]b", "4"], 
      RowBox[{"12", " ", 
       SuperscriptBox["a", "2"]}]]}], ")"}]}], 
  RowBox[{"4", " ", 
   SuperscriptBox["a", 
    RowBox[{"5", "/", "2"}]]}]]], "Output",
 CellChangeTimes->{
  3.592416491200554*^9, 3.5924165375020723`*^9, {3.5924166366058207`*^9, 
   3.5924166506176443`*^9}, 3.5924170344329453`*^9, 3.5924170708343983`*^9, {
   3.592417156396976*^9, 3.592417161572489*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"15", " ", 
    SuperscriptBox["d", "5"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "c"}], "+", 
      FractionBox[
       SuperscriptBox["\[ImaginaryI]b", "2"], 
       RowBox[{"4", " ", "a"}]]}]], " ", 
    SqrtBox["\[Pi]"], " ", "\[ImaginaryI]b", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      FractionBox[
       SuperscriptBox["\[ImaginaryI]b", "2"], 
       RowBox[{"3", " ", "a"}]], "+", 
      FractionBox[
       SuperscriptBox["\[ImaginaryI]b", "4"], 
       RowBox[{"60", " ", 
        SuperscriptBox["a", "2"]}]]}], ")"}]}], 
   RowBox[{"8", " ", 
    SuperscriptBox["a", 
     RowBox[{"7", "/", "2"}]]}]]}]], "Output",
 CellChangeTimes->{
  3.592416491200554*^9, 3.5924165375020723`*^9, {3.5924166366058207`*^9, 
   3.5924166506176443`*^9}, 3.5924170344329453`*^9, 3.5924170708343983`*^9, {
   3.592417156396976*^9, 3.592417161575925*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"15", " ", 
   SuperscriptBox["d", "6"], " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", "c"}], "+", 
     FractionBox[
      SuperscriptBox["\[ImaginaryI]b", "2"], 
      RowBox[{"4", " ", "a"}]]}]], " ", 
   SqrtBox["\[Pi]"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     FractionBox[
      RowBox[{"3", " ", 
       SuperscriptBox["\[ImaginaryI]b", "2"]}], 
      RowBox[{"2", " ", "a"}]], "+", 
     FractionBox[
      SuperscriptBox["\[ImaginaryI]b", "4"], 
      RowBox[{"4", " ", 
       SuperscriptBox["a", "2"]}]], "+", 
     FractionBox[
      SuperscriptBox["\[ImaginaryI]b", "6"], 
      RowBox[{"120", " ", 
       SuperscriptBox["a", "3"]}]]}], ")"}]}], 
  RowBox[{"8", " ", 
   SuperscriptBox["a", 
    RowBox[{"7", "/", "2"}]]}]]], "Output",
 CellChangeTimes->{
  3.592416491200554*^9, 3.5924165375020723`*^9, {3.5924166366058207`*^9, 
   3.5924166506176443`*^9}, 3.5924170344329453`*^9, 3.5924170708343983`*^9, {
   3.592417156396976*^9, 3.592417161579108*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"105", " ", 
    SuperscriptBox["d", "7"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "c"}], "+", 
      FractionBox[
       SuperscriptBox["\[ImaginaryI]b", "2"], 
       RowBox[{"4", " ", "a"}]]}]], " ", 
    SqrtBox["\[Pi]"], " ", "\[ImaginaryI]b", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      FractionBox[
       SuperscriptBox["\[ImaginaryI]b", "2"], 
       RowBox[{"2", " ", "a"}]], "+", 
      FractionBox[
       SuperscriptBox["\[ImaginaryI]b", "4"], 
       RowBox[{"20", " ", 
        SuperscriptBox["a", "2"]}]], "+", 
      FractionBox[
       SuperscriptBox["\[ImaginaryI]b", "6"], 
       RowBox[{"840", " ", 
        SuperscriptBox["a", "3"]}]]}], ")"}]}], 
   RowBox[{"16", " ", 
    SuperscriptBox["a", 
     RowBox[{"9", "/", "2"}]]}]]}]], "Output",
 CellChangeTimes->{
  3.592416491200554*^9, 3.5924165375020723`*^9, {3.5924166366058207`*^9, 
   3.5924166506176443`*^9}, 3.5924170344329453`*^9, 3.5924170708343983`*^9, {
   3.592417156396976*^9, 3.592417161581151*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"105", " ", 
   SuperscriptBox["d", "8"], " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", "c"}], "+", 
     FractionBox[
      SuperscriptBox["\[ImaginaryI]b", "2"], 
      RowBox[{"4", " ", "a"}]]}]], " ", 
   SqrtBox["\[Pi]"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     FractionBox[
      RowBox[{"2", " ", 
       SuperscriptBox["\[ImaginaryI]b", "2"]}], "a"], "+", 
     FractionBox[
      SuperscriptBox["\[ImaginaryI]b", "4"], 
      RowBox[{"2", " ", 
       SuperscriptBox["a", "2"]}]], "+", 
     FractionBox[
      SuperscriptBox["\[ImaginaryI]b", "6"], 
      RowBox[{"30", " ", 
       SuperscriptBox["a", "3"]}]], "+", 
     FractionBox[
      SuperscriptBox["\[ImaginaryI]b", "8"], 
      RowBox[{"1680", " ", 
       SuperscriptBox["a", "4"]}]]}], ")"}]}], 
  RowBox[{"16", " ", 
   SuperscriptBox["a", 
    RowBox[{"9", "/", "2"}]]}]]], "Output",
 CellChangeTimes->{
  3.592416491200554*^9, 3.5924165375020723`*^9, {3.5924166366058207`*^9, 
   3.5924166506176443`*^9}, 3.5924170344329453`*^9, 3.5924170708343983`*^9, {
   3.592417156396976*^9, 3.592417161583271*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"945", " ", 
    SuperscriptBox["d", "9"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "c"}], "+", 
      FractionBox[
       SuperscriptBox["\[ImaginaryI]b", "2"], 
       RowBox[{"4", " ", "a"}]]}]], " ", 
    SqrtBox["\[Pi]"], " ", "\[ImaginaryI]b", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      FractionBox[
       RowBox[{"2", " ", 
        SuperscriptBox["\[ImaginaryI]b", "2"]}], 
       RowBox[{"3", " ", "a"}]], "+", 
      FractionBox[
       SuperscriptBox["\[ImaginaryI]b", "4"], 
       RowBox[{"10", " ", 
        SuperscriptBox["a", "2"]}]], "+", 
      FractionBox[
       SuperscriptBox["\[ImaginaryI]b", "6"], 
       RowBox[{"210", " ", 
        SuperscriptBox["a", "3"]}]], "+", 
      FractionBox[
       SuperscriptBox["\[ImaginaryI]b", "8"], 
       RowBox[{"15120", " ", 
        SuperscriptBox["a", "4"]}]]}], ")"}]}], 
   RowBox[{"32", " ", 
    SuperscriptBox["a", 
     RowBox[{"11", "/", "2"}]]}]]}]], "Output",
 CellChangeTimes->{
  3.592416491200554*^9, 3.5924165375020723`*^9, {3.5924166366058207`*^9, 
   3.5924166506176443`*^9}, 3.5924170344329453`*^9, 3.5924170708343983`*^9, {
   3.592417156396976*^9, 3.592417161585153*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"945", " ", 
   SuperscriptBox["d", "10"], " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", "c"}], "+", 
     FractionBox[
      SuperscriptBox["\[ImaginaryI]b", "2"], 
      RowBox[{"4", " ", "a"}]]}]], " ", 
   SqrtBox["\[Pi]"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     FractionBox[
      RowBox[{"5", " ", 
       SuperscriptBox["\[ImaginaryI]b", "2"]}], 
      RowBox[{"2", " ", "a"}]], "+", 
     FractionBox[
      RowBox[{"5", " ", 
       SuperscriptBox["\[ImaginaryI]b", "4"]}], 
      RowBox[{"6", " ", 
       SuperscriptBox["a", "2"]}]], "+", 
     FractionBox[
      SuperscriptBox["\[ImaginaryI]b", "6"], 
      RowBox[{"12", " ", 
       SuperscriptBox["a", "3"]}]], "+", 
     FractionBox[
      SuperscriptBox["\[ImaginaryI]b", "8"], 
      RowBox[{"336", " ", 
       SuperscriptBox["a", "4"]}]], "+", 
     FractionBox[
      SuperscriptBox["\[ImaginaryI]b", "10"], 
      RowBox[{"30240", " ", 
       SuperscriptBox["a", "5"]}]]}], ")"}]}], 
  RowBox[{"32", " ", 
   SuperscriptBox["a", 
    RowBox[{"11", "/", "2"}]]}]]], "Output",
 CellChangeTimes->{
  3.592416491200554*^9, 3.5924165375020723`*^9, {3.5924166366058207`*^9, 
   3.5924166506176443`*^9}, 3.5924170344329453`*^9, 3.5924170708343983`*^9, {
   3.592417156396976*^9, 3.592417161624886*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"10395", " ", 
    SuperscriptBox["d", "11"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "c"}], "+", 
      FractionBox[
       SuperscriptBox["\[ImaginaryI]b", "2"], 
       RowBox[{"4", " ", "a"}]]}]], " ", 
    SqrtBox["\[Pi]"], " ", "\[ImaginaryI]b", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      FractionBox[
       RowBox[{"5", " ", 
        SuperscriptBox["\[ImaginaryI]b", "2"]}], 
       RowBox[{"6", " ", "a"}]], "+", 
      FractionBox[
       SuperscriptBox["\[ImaginaryI]b", "4"], 
       RowBox[{"6", " ", 
        SuperscriptBox["a", "2"]}]], "+", 
      FractionBox[
       SuperscriptBox["\[ImaginaryI]b", "6"], 
       RowBox[{"84", " ", 
        SuperscriptBox["a", "3"]}]], "+", 
      FractionBox[
       SuperscriptBox["\[ImaginaryI]b", "8"], 
       RowBox[{"3024", " ", 
        SuperscriptBox["a", "4"]}]], "+", 
      FractionBox[
       SuperscriptBox["\[ImaginaryI]b", "10"], 
       RowBox[{"332640", " ", 
        SuperscriptBox["a", "5"]}]]}], ")"}]}], 
   RowBox[{"64", " ", 
    SuperscriptBox["a", 
     RowBox[{"13", "/", "2"}]]}]]}]], "Output",
 CellChangeTimes->{
  3.592416491200554*^9, 3.5924165375020723`*^9, {3.5924166366058207`*^9, 
   3.5924166506176443`*^9}, 3.5924170344329453`*^9, 3.5924170708343983`*^9, {
   3.592417156396976*^9, 3.5924171616271763`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"h2", "/", "h0"}]], "Input",
 CellChangeTimes->{{3.592417165676845*^9, 3.592417168997696*^9}, {
  3.5924172759120607`*^9, 3.592417276423395*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["d", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     FractionBox[
      SuperscriptBox["\[ImaginaryI]b", "2"], 
      RowBox[{"2", " ", "a"}]]}], ")"}]}], 
  RowBox[{"2", " ", "a"}]]], "Output",
 CellChangeTimes->{3.592417169777548*^9, 3.592417277277721*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"h4", "/", "h2"}]], "Input",
 CellChangeTimes->{{3.592417182012164*^9, 3.592417189530313*^9}, {
  3.592417233677267*^9, 3.592417234197433*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"3", " ", 
   SuperscriptBox["d", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     FractionBox[
      SuperscriptBox["\[ImaginaryI]b", "2"], "a"], "+", 
     FractionBox[
      SuperscriptBox["\[ImaginaryI]b", "4"], 
      RowBox[{"12", " ", 
       SuperscriptBox["a", "2"]}]]}], ")"}]}], 
  RowBox[{"2", " ", "a", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     FractionBox[
      SuperscriptBox["\[ImaginaryI]b", "2"], 
      RowBox[{"2", " ", "a"}]]}], ")"}]}]]], "Output",
 CellChangeTimes->{3.592417190062003*^9, 3.5924172347933607`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"h6", "/", "h4"}]], "Input",
 CellChangeTimes->{{3.592417246204534*^9, 3.592417250482149*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"5", " ", 
   SuperscriptBox["d", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     FractionBox[
      RowBox[{"3", " ", 
       SuperscriptBox["\[ImaginaryI]b", "2"]}], 
      RowBox[{"2", " ", "a"}]], "+", 
     FractionBox[
      SuperscriptBox["\[ImaginaryI]b", "4"], 
      RowBox[{"4", " ", 
       SuperscriptBox["a", "2"]}]], "+", 
     FractionBox[
      SuperscriptBox["\[ImaginaryI]b", "6"], 
      RowBox[{"120", " ", 
       SuperscriptBox["a", "3"]}]]}], ")"}]}], 
  RowBox[{"2", " ", "a", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     FractionBox[
      SuperscriptBox["\[ImaginaryI]b", "2"], "a"], "+", 
     FractionBox[
      SuperscriptBox["\[ImaginaryI]b", "4"], 
      RowBox[{"12", " ", 
       SuperscriptBox["a", "2"]}]]}], ")"}]}]]], "Output",
 CellChangeTimes->{3.592417251477154*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"h3", "/", "h1"}], "\[IndentingNewLine]", 
 RowBox[{"h5", "/", "h3"}], "\[IndentingNewLine]", 
 RowBox[{"h7", "/", "h5"}]}], "Input",
 CellChangeTimes->{{3.592417390179525*^9, 3.5924173996871033`*^9}, {
  3.59241746449644*^9, 3.5924174813819427`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"3", " ", 
   SuperscriptBox["d", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     FractionBox[
      SuperscriptBox["\[ImaginaryI]b", "2"], 
      RowBox[{"6", " ", "a"}]]}], ")"}]}], 
  RowBox[{"2", " ", "a"}]]], "Output",
 CellChangeTimes->{3.592417400703005*^9, 3.5924174828411427`*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"5", " ", 
   SuperscriptBox["d", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     FractionBox[
      SuperscriptBox["\[ImaginaryI]b", "2"], 
      RowBox[{"3", " ", "a"}]], "+", 
     FractionBox[
      SuperscriptBox["\[ImaginaryI]b", "4"], 
      RowBox[{"60", " ", 
       SuperscriptBox["a", "2"]}]]}], ")"}]}], 
  RowBox[{"2", " ", "a", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     FractionBox[
      SuperscriptBox["\[ImaginaryI]b", "2"], 
      RowBox[{"6", " ", "a"}]]}], ")"}]}]]], "Output",
 CellChangeTimes->{3.592417400703005*^9, 3.592417482842527*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"7", " ", 
   SuperscriptBox["d", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     FractionBox[
      SuperscriptBox["\[ImaginaryI]b", "2"], 
      RowBox[{"2", " ", "a"}]], "+", 
     FractionBox[
      SuperscriptBox["\[ImaginaryI]b", "4"], 
      RowBox[{"20", " ", 
       SuperscriptBox["a", "2"]}]], "+", 
     FractionBox[
      SuperscriptBox["\[ImaginaryI]b", "6"], 
      RowBox[{"840", " ", 
       SuperscriptBox["a", "3"]}]]}], ")"}]}], 
  RowBox[{"2", " ", "a", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     FractionBox[
      SuperscriptBox["\[ImaginaryI]b", "2"], 
      RowBox[{"3", " ", "a"}]], "+", 
     FractionBox[
      SuperscriptBox["\[ImaginaryI]b", "4"], 
      RowBox[{"60", " ", 
       SuperscriptBox["a", "2"]}]]}], ")"}]}]]], "Output",
 CellChangeTimes->{3.592417400703005*^9, 3.5924174828439903`*^9}]
}, Open  ]],

Cell[BoxData[
 FormBox[
  RowBox[{
   StyleBox[
    RowBox[{"E", 
     RowBox[{"(", 
      RowBox[{"x", ",", "y", ",", "z"}], ")"}]}],
    FontSize->12], 
   StyleBox["=",
    FontSize->12], 
   RowBox[{
    FormBox[
     SubscriptBox["E", "0"],
     TraditionalForm], 
    StyleBox[" ",
     FontSize->12], 
    RowBox[{
     FormBox[
      SubscriptBox["H", "m"],
      TraditionalForm], 
     StyleBox["(",
      FontSize->12], 
     FormBox[
      RowBox[{
       SqrtBox["2"], 
       FractionBox["x", 
        RowBox[{"w", "(", "z", ")"}]]}],
      TraditionalForm], 
     StyleBox[")",
      FontSize->12]}], 
    StyleBox[" ",
     FontSize->12], 
    RowBox[{
     FormBox[
      SubscriptBox["H", "n"],
      TraditionalForm], 
     StyleBox["(",
      FontSize->12], 
     FormBox[
      RowBox[{
       SqrtBox["2"], 
       FractionBox["y", 
        RowBox[{"w", "(", "z", ")"}]]}],
      TraditionalForm], 
     StyleBox[")",
      FontSize->12]}], 
    StyleBox[" ",
     FontSize->12], 
    FormBox[
     SuperscriptBox["e", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"]}], ")"}]}], "/", 
       RowBox[{
        SuperscriptBox["w", "2"], "(", "z", ")"}]}]],
     TraditionalForm], 
    StyleBox[" ",
     FontSize->12], 
    FormBox[
     SuperscriptBox["e", 
      RowBox[{"i", " ", 
       RowBox[{"\[CapitalPhi]", "(", 
        RowBox[{"(", "z", ")"}]}]}]],
     TraditionalForm]}]}], TraditionalForm]], "Input"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    SubscriptBox["E", "0"], "=", 
    RowBox[{
     SqrtBox[
      FractionBox["2", "\[Pi]"]], 
     FractionBox["1", 
      RowBox[{
       SuperscriptBox["2", 
        RowBox[{"m", "+", "n"}]], 
       RowBox[{"m", "!"}], 
       RowBox[{"n", "!"}]}]]}]}], ","}], TraditionalForm]], "Input",
 CellChangeTimes->{{3.592420090834922*^9, 3.592420090837041*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"P", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubsuperscriptBox["\[Integral]", 
       RowBox[{"-", "\[Infinity]"}], 
       RowBox[{"+", "\[Infinity]"}]], 
      SubsuperscriptBox["\[Integral]", 
       RowBox[{"-", "\[Infinity]"}], 
       RowBox[{"+", "\[Infinity]"}]]}], "|", 
     RowBox[{"E", "(", 
      RowBox[{"x", ",", "y", ",", "z"}], ")"}], 
     FormBox[
      SuperscriptBox["|", "2"],
      TraditionalForm], 
     RowBox[{
     "d", "\[InvisibleSpace]", "x", " ", "d", "\[InvisibleSpace]", "y"}]}], 
    "=", "1."}]}], TraditionalForm]], "Input",
 CellChangeTimes->{{3.592420101227551*^9, 3.5924201034958477`*^9}}],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.592420105995331*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"HermiteGauss", "[", 
     RowBox[{
     "n_", ",", " ", "x_", ",", " ", "q_", ",", " ", "a_", ",", " ", "b_", 
      ",", " ", "c_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"norm", " ", "=", 
        RowBox[{"Sqrt", "[", " ", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "^", "n"}], " ", "*", 
             RowBox[{"n", "!"}]}], ")"}]}], " ", "*", " ", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"1", "/", "\[Pi]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"hn", " ", "=", " ", 
        RowBox[{
         RowBox[{"HermiteH", "[", 
          RowBox[{"n", ",", 
           RowBox[{"c", "*", 
            RowBox[{"x", "/", 
             RowBox[{"Sqrt", "[", "q", "]"}]}]}]}], " ", "]"}], "/", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"Sqrt", "[", "q", "]"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"hg", " ", "=", " ", 
        RowBox[{"Simplify", "[", 
         RowBox[{"norm", "*", "hn", " ", "*", " ", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "1"}], "/", 
             RowBox[{"(", 
              RowBox[{"2", "*", "q"}], ")"}]}], " ", "*", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"a", "*", "x"}], "-", "b"}], ")"}], "^", "2"}]}], 
           "]"}]}], "]"}]}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]",
      "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"hgx", " ", "=", " ", 
     RowBox[{"HermiteGauss", "[", 
      RowBox[{"2", ",", " ", "x", ",", " ", "5."}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"hgy", " ", "=", " ", 
     RowBox[{"HermiteGauss", "[", 
      RowBox[{"2", ",", " ", "y", ",", " ", "5."}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"hgx", "*", "hgx"}], ")"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "\[Infinity]"}], ",", " ", "\[Infinity]"}], "}"}]}], 
    "]"}], "\[IndentingNewLine]", 
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{"Integrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"hgx", "*", "hgy"}], ")"}], "^", "2"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"-", "\[Infinity]"}], ",", " ", "\[Infinity]"}], "}"}]}], 
      "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"-", "\[Infinity]"}], ",", " ", "\[Infinity]"}], "}"}]}], 
    "]"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.592420155762364*^9, 3.592420168808025*^9}, {
  3.5924202479042063`*^9, 3.592420493208996*^9}, {3.592420529052105*^9, 
  3.592420707917679*^9}, {3.592420740760234*^9, 3.592420903197647*^9}, {
  3.5924209401929407`*^9, 3.592420977419032*^9}, {3.5924210209396057`*^9, 
  3.592421156176949*^9}, {3.592422005176491*^9, 3.5924220847905407`*^9}, {
  3.592422289824235*^9, 3.5924222906800137`*^9}, {3.593830304824869*^9, 
  3.593830304957634*^9}, {3.5938312017533207`*^9, 3.593831227510807*^9}, {
  3.593831274732668*^9, 3.593831278907669*^9}, {3.59383167022359*^9, 
  3.593831682804685*^9}}],

Cell[BoxData["0.9999999999999994`"], "Output",
 CellChangeTimes->{
  3.592420977824481*^9, 3.592421038688588*^9, {3.5924210752263517`*^9, 
   3.592421157682808*^9}, {3.592422008308935*^9, 3.592422086268856*^9}, 
   3.5924222943426733`*^9, 3.593830308231189*^9, 3.5938312855203667`*^9, 
   3.59383168367479*^9}],

Cell[BoxData["0.9999999999999989`"], "Output",
 CellChangeTimes->{
  3.592420977824481*^9, 3.592421038688588*^9, {3.5924210752263517`*^9, 
   3.592421157682808*^9}, {3.592422008308935*^9, 3.592422086268856*^9}, 
   3.5924222943426733`*^9, 3.593830308231189*^9, 3.5938312855203667`*^9, 
   3.5938316838186693`*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.592420211033283*^9, 3.592420232937604*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", " ", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hgxn", " ", "=", " ", 
   RowBox[{"HermiteGauss", "[", 
    RowBox[{"n", ",", "x", ",", "q"}], "]"}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{"hgyn", " ", "=", "  ", 
    RowBox[{"HermiteGauss", "[", 
     RowBox[{"n", ",", 
      RowBox[{"y", "+", "10"}], ",", "q"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"fcn", " ", "=", " ", 
     RowBox[{"hgxn", " ", "*", " ", "hgyn", " ", "*", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"\[ImaginaryI]", " ", "*", 
         RowBox[{"(", " ", 
          RowBox[{
           RowBox[{
            SubscriptBox["b", "x"], " ", "*", "x"}], " ", "+", " ", 
           RowBox[{
            SubscriptBox["b", "y"], "*", "y"}]}], ")"}]}], " ", "+", " ", 
        "c"}], "]"}]}]}], ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fcn", " ", "=", " ", 
   RowBox[{"hgxn", " ", "*", " ", "hgyn"}]}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"inthgx", " ", "=", " ", 
   RowBox[{"Assuming", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Re", "[", "q", "]"}], ">", "0"}], " ", "&&", " ", 
          RowBox[{
           RowBox[{"Re", "[", "y", "]"}], ">", "0"}], "&&", " ", 
          RowBox[{
           SubscriptBox["b", "x"], ">", "0"}], " ", "&&", " ", 
          RowBox[{"a", ">", "0"}]}], " ", "&"}], " ", 
        SubscriptBox["b", "y"]}], ">", "0"}], " ", "&&", " ", 
      RowBox[{"c", ">", "0"}]}], ",", " ", 
     RowBox[{"Integrate", "[", 
      RowBox[{"fcn", ",", " ", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"-", "\[Infinity]"}], ",", " ", "\[Infinity]"}], "}"}]}], 
      "]"}]}], "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"inthgy", " ", "=", " ", 
  RowBox[{"Assuming", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Re", "[", "q", "]"}], ">", "0"}], ",", " ", 
    RowBox[{"Integrate", "[", 
     RowBox[{"inthgx", " ", ",", " ", 
      RowBox[{"{", 
       RowBox[{"y", ",", 
        RowBox[{"-", "\[Infinity]"}], ",", " ", "\[Infinity]"}], "}"}]}], 
     "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.592421211557458*^9, 3.592421310464087*^9}, {
   3.592421364535768*^9, 3.592421369861041*^9}, {3.592421400368191*^9, 
   3.59242140996165*^9}, {3.592421461862064*^9, 3.592421531636948*^9}, {
   3.592421583947639*^9, 3.592421684597986*^9}, {3.592421731153491*^9, 
   3.592421766051133*^9}, {3.5924218072702913`*^9, 3.5924219279265633`*^9}, 
   3.592421965182386*^9, {3.5924221020809793`*^9, 3.5924222221687517`*^9}, 
   3.593830480683877*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox["x", "2"], 
       RowBox[{"2", " ", "q"}]]}], "-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"10", "+", "y"}], ")"}], "2"], 
      RowBox[{"2", " ", "q"}]]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "3"}], " ", "q", " ", "x"}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["x", "3"]}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"10", "+", "y"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "3"}], " ", "q"}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"10", "+", "y"}], ")"}], "2"]}]}], ")"}]}], 
  RowBox[{"3", " ", 
   SqrtBox["\[Pi]"], " ", 
   SuperscriptBox["q", 
    RowBox[{"7", "/", "2"}]]}]]], "Output",
 CellChangeTimes->{{3.5924213515375338`*^9, 3.592421373879526*^9}, {
   3.5924214069052343`*^9, 3.5924214175988398`*^9}, {3.5924214722874804`*^9, 
   3.592421492449066*^9}, 3.5924215383829527`*^9, {3.592421666727633*^9, 
   3.592421685369615*^9}, 3.592421738706895*^9, {3.592421790204482*^9, 
   3.592421807921501*^9}, {3.59242186037634*^9, 3.592421931053008*^9}, {
   3.592421964225314*^9, 3.592421969279711*^9}, {3.592422094805735*^9, 
   3.5924221257735643`*^9}, {3.592422156975957*^9, 3.592422225746813*^9}, 
   3.5924223144339123`*^9, 3.5938304812063007`*^9, 3.593831293002408*^9}],

Cell[BoxData[
 RowBox[{"ConditionalExpression", "[", 
  RowBox[{"0", ",", 
   RowBox[{
    RowBox[{"Re", "[", "q", "]"}], ">", "0"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.5924213515375338`*^9, 3.592421373879526*^9}, {
   3.5924214069052343`*^9, 3.5924214175988398`*^9}, {3.5924214722874804`*^9, 
   3.592421492449066*^9}, 3.5924215383829527`*^9, {3.592421666727633*^9, 
   3.592421685369615*^9}, 3.592421738706895*^9, {3.592421790204482*^9, 
   3.592421807921501*^9}, {3.59242186037634*^9, 3.592421931053008*^9}, {
   3.592421964225314*^9, 3.592421969279711*^9}, {3.592422094805735*^9, 
   3.5924221257735643`*^9}, {3.592422156975957*^9, 3.592422225746813*^9}, 
   3.5924223144339123`*^9, 3.5938304812063007`*^9, 3.593831296192481*^9}],

Cell[BoxData[
 RowBox[{"ConditionalExpression", "[", 
  RowBox[{"0", ",", 
   RowBox[{
    RowBox[{"Re", "[", "q", "]"}], ">", "0"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.5924213515375338`*^9, 3.592421373879526*^9}, {
   3.5924214069052343`*^9, 3.5924214175988398`*^9}, {3.5924214722874804`*^9, 
   3.592421492449066*^9}, 3.5924215383829527`*^9, {3.592421666727633*^9, 
   3.592421685369615*^9}, 3.592421738706895*^9, {3.592421790204482*^9, 
   3.592421807921501*^9}, {3.59242186037634*^9, 3.592421931053008*^9}, {
   3.592421964225314*^9, 3.592421969279711*^9}, {3.592422094805735*^9, 
   3.5924221257735643`*^9}, {3.592422156975957*^9, 3.592422225746813*^9}, 
   3.5924223144339123`*^9, 3.5938304812063007`*^9, 3.593831296223901*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", " ", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"m", " ", "=", " ", "1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hgx", " ", "=", " ", 
   RowBox[{"HermiteGauss", "[", 
    RowBox[{"n", ",", " ", 
     RowBox[{
      SubscriptBox["x", "i"], "/", 
      SubscriptBox["q", "i"]}], ",", " ", 
     SubscriptBox["q", "i"]}], "]"}]}], " ", ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Is", " ", 
    RowBox[{
     SubscriptBox["x", "i"], "/", 
     SubscriptBox["q", "i"]}], " ", 
    RowBox[{"right", "?"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"hgy", " ", "=", " ", 
   RowBox[{"HermiteGauss", "[", 
    RowBox[{"m", ",", " ", 
     RowBox[{
      SubscriptBox["y", "i"], "/", 
      SubscriptBox["q", "i"]}], ",", " ", 
     SubscriptBox["q", "i"]}], "]"}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expfactor", " ", "=", " ", 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["x", "i"], "^", "2"}], " ", "+", 
        RowBox[{
         SubscriptBox["y", "i"], "^", "2"}]}], ")"}]}], "/", 
     RowBox[{"(", 
      RowBox[{"2", "*", 
       SubscriptBox["q", "i"]}], ")"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"idlerNM", " ", "=", " ", 
    RowBox[{"hgx", " ", "*", " ", "hgy", " ", "*", "expfactor"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Arg1", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "1"}], "/", 
       RowBox[{"(", 
        RowBox[{"2", "*", 
         SubscriptBox["q", "s"]}], ")"}]}], "*", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["x", "s"], "2"], "+", 
        SuperscriptBox[
         SubscriptBox["y", "s"], "2"]}], ")"}]}], "-", 
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{"2", "*", 
         SubscriptBox["q", "ppp"]}], ")"}]}], "*", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["x", "p"], "2"], "+", 
        SuperscriptBox[
         SubscriptBox["y", "p"], "2"]}], ")"}]}], " ", "-", " ", 
     RowBox[{"\[ImaginaryI]", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[CapitalDelta]K", "x"], "*", "x"}], " ", "+", " ", 
        RowBox[{
         SubscriptBox["\[CapitalDelta]K", "y"], "*", "y"}], "+", 
        RowBox[{
         SubscriptBox["\[CapitalDelta]K", "z"], "*", "z"}]}], ")"}]}]}]}], 
   ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.593830615155025*^9, 3.593830793328994*^9}, {
  3.593830849578999*^9, 3.593830924386343*^9}, {3.593830955588339*^9, 
  3.5938310308816977`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Try", " ", "some", " ", "test", " ", "integrals"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"n", " ", "=", " ", "10"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"m", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"hgxn", " ", "=", " ", 
     RowBox[{"HermiteGauss", "[", 
      RowBox[{
      "n", ",", "x", ",", " ", "q", ",", " ", "a", ",", " ", "b", ",", " ", 
       "c"}], "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"intoverx", " ", "=", " ", 
    RowBox[{"Assuming", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Re", "[", "q", "]"}], ">", "0"}], " ", "&&", " ", 
       RowBox[{
        SubscriptBox["q", "i"], ">", "0"}], "&&", " ", 
       RowBox[{"a", ">", "0"}], " ", "&&", " ", 
       RowBox[{"b", ">", "0"}], "  ", "&&", " ", 
       RowBox[{"c", ">", "0"}], " ", "&&", " ", 
       RowBox[{"d", ">", "0"}]}], ",", " ", 
      RowBox[{"Integrate", "[", 
       RowBox[{"hgxn", ",", " ", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"-", "\[Infinity]"}], ",", " ", "\[Infinity]"}], "}"}]}], 
       "]"}]}], "]"}]}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.5938310325951138`*^9, 3.593831053793511*^9}, {
  3.593831091993*^9, 3.593831163289263*^9}, {3.59383130567303*^9, 
  3.593831322477141*^9}, {3.5938316895092916`*^9, 3.593831770246539*^9}, {
  3.59383180094482*^9, 3.593831903263177*^9}, {3.593831984685408*^9, 
  3.5938319886039343`*^9}, {3.593832033103537*^9, 3.5938320352555847`*^9}, {
  3.5938320789357643`*^9, 3.593832079254318*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[Pi]", 
    RowBox[{"1", "/", "4"}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"32", " ", 
      SuperscriptBox["b", "10"], " ", 
      SuperscriptBox["c", "10"]}], "-", 
     RowBox[{"720", " ", 
      SuperscriptBox["b", "8"], " ", 
      SuperscriptBox["c", "8"], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["a", "2"], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox["c", "2"]}]}], ")"}], " ", "q"}], "+", 
     RowBox[{"5040", " ", 
      SuperscriptBox["b", "6"], " ", 
      SuperscriptBox["c", "6"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["a", "2"], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["c", "2"]}]}], ")"}], "2"], " ", 
      SuperscriptBox["q", "2"]}], "-", 
     RowBox[{"12600", " ", 
      SuperscriptBox["b", "4"], " ", 
      SuperscriptBox["c", "4"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["a", "2"], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["c", "2"]}]}], ")"}], "3"], " ", 
      SuperscriptBox["q", "3"]}], "+", 
     RowBox[{"9450", " ", 
      SuperscriptBox["b", "2"], " ", 
      SuperscriptBox["c", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["a", "2"], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["c", "2"]}]}], ")"}], "4"], " ", 
      SuperscriptBox["q", "4"]}], "-", 
     RowBox[{"945", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["a", "2"], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["c", "2"]}]}], ")"}], "5"], " ", 
      SuperscriptBox["q", "5"]}]}], ")"}]}], 
  RowBox[{"360", " ", 
   SqrtBox["14"], " ", 
   SuperscriptBox["a", "11"], " ", 
   SuperscriptBox["q", 
    RowBox[{"19", "/", "4"}]]}]]], "Output",
 CellChangeTimes->{{3.5938311408563633`*^9, 3.593831163905476*^9}, 
   3.593831324231696*^9, 3.5938316872188873`*^9, 3.593831813296637*^9, {
   3.593831844164575*^9, 3.593831852520187*^9}, {3.593831891556394*^9, 
   3.5938319068990307`*^9}, 3.593831994975724*^9, 3.593832043639076*^9, 
   3.59383212546045*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1440, 852},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>FEPrivate`If[
  FEPrivate`Equal[FEPrivate`$VersionNumber, 6.], 1.25, 1.25 Inherited],
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (October 5, \
2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 6700, 208, 335, "Text"],
Cell[CellGroupData[{
Cell[7282, 232, 267, 3, 75, "Title"],
Cell[7552, 237, 5941, 139, 254, "Input"],
Cell[CellGroupData[{
Cell[13518, 380, 126, 3, 83, "Section"],
Cell[13647, 385, 8941, 227, 966, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22625, 617, 131, 3, 83, "Section"],
Cell[CellGroupData[{
Cell[22781, 624, 3832, 96, 180, "Input"],
Cell[26616, 722, 2770, 84, 118, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29423, 811, 2648, 60, 306, "Input"],
Cell[32074, 873, 1019, 34, 91, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33130, 912, 2385, 61, 363, "Input"],
Cell[35518, 975, 2442, 76, 105, "Output"]
}, Open  ]],
Cell[37975, 1054, 94, 1, 33, "Input"],
Cell[CellGroupData[{
Cell[38094, 1059, 5523, 108, 366, "Input"],
Cell[43620, 1169, 121, 1, 33, "Output"],
Cell[43744, 1172, 6565, 176, 125, "Output"],
Cell[50312, 1350, 134, 1, 33, "Output"],
Cell[50449, 1353, 10823, 273, 173, "Output"],
Cell[61275, 1628, 123, 1, 33, "Output"],
Cell[61401, 1631, 7948, 223, 182, "Output"]
}, Open  ]],
Cell[69364, 1857, 143, 2, 33, "Input"],
Cell[CellGroupData[{
Cell[69532, 1863, 1566, 35, 129, "Input"],
Cell[71101, 1900, 2055, 61, 68, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[73193, 1966, 3130, 68, 460, "Input"],
Cell[76326, 2036, 227, 7, 59, "Output"],
Cell[76556, 2045, 229, 7, 59, "Output"],
Cell[76788, 2054, 229, 7, 62, "Output"],
Cell[77020, 2063, 1156, 36, 105, "Output"],
Cell[78179, 2101, 2769, 79, 105, "Output"],
Cell[80951, 2182, 7015, 183, 154, "Output"],
Cell[87969, 2367, 11288, 276, 181, "Output"],
Cell[99260, 2645, 1969, 60, 69, "Output"]
}, Open  ]],
Cell[101244, 2708, 120, 2, 33, "Input"],
Cell[101367, 2712, 96, 1, 33, "Input"],
Cell[101466, 2715, 2262, 55, 201, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[103765, 2775, 155, 2, 83, "Section"],
Cell[103923, 2779, 5365, 129, 564, "Text"],
Cell[CellGroupData[{
Cell[109313, 2912, 1933, 47, 129, "Input"],
Cell[111249, 2961, 1767, 52, 63, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[113053, 3018, 2098, 52, 262, "Input"],
Cell[115154, 3072, 500, 14, 77, "Output"],
Cell[115657, 3088, 621, 17, 74, "Output"],
Cell[116281, 3107, 745, 22, 83, "Output"],
Cell[117029, 3131, 813, 23, 83, "Output"],
Cell[117845, 3156, 860, 25, 83, "Output"],
Cell[118708, 3183, 950, 27, 83, "Output"],
Cell[119661, 3212, 1048, 31, 83, "Output"],
Cell[120712, 3245, 1089, 31, 83, "Output"],
Cell[121804, 3278, 1156, 34, 83, "Output"],
Cell[122963, 3314, 1258, 36, 83, "Output"],
Cell[124224, 3352, 1348, 40, 83, "Output"],
Cell[125575, 3394, 1401, 40, 83, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[127013, 3439, 168, 3, 33, "Input"],
Cell[127184, 3444, 324, 10, 72, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[127545, 3459, 166, 3, 33, "Input"],
Cell[127714, 3464, 592, 18, 92, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[128343, 3487, 117, 2, 33, "Input"],
Cell[128463, 3491, 860, 27, 92, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[129360, 3523, 275, 5, 72, "Input"],
Cell[129638, 3530, 336, 10, 72, "Output"],
Cell[129977, 3542, 617, 19, 92, "Output"],
Cell[130597, 3563, 884, 27, 92, "Output"]
}, Open  ]],
Cell[131496, 3593, 1540, 66, 58, "Input"],
Cell[133039, 3661, 406, 14, 81, "Input"],
Cell[133448, 3677, 674, 20, 55, "Input"],
Cell[134125, 3699, 87, 1, 53, "Input"],
Cell[CellGroupData[{
Cell[134237, 3704, 3482, 89, 281, "Input"],
Cell[137722, 3795, 310, 5, 33, "Output"],
Cell[138035, 3802, 313, 5, 33, "Output"]
}, Open  ]],
Cell[138363, 3810, 92, 1, 33, "Input"],
Cell[CellGroupData[{
Cell[138480, 3815, 2754, 73, 179, "Input"],
Cell[141237, 3890, 1502, 41, 84, "Output"],
Cell[142742, 3933, 740, 12, 33, "Output"],
Cell[143485, 3947, 740, 12, 33, "Output"]
}, Open  ]],
Cell[144240, 3962, 2861, 88, 250, "Input"],
Cell[CellGroupData[{
Cell[147126, 4054, 1733, 40, 186, "Input"],
Cell[148862, 4096, 2223, 65, 67, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
