(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     70069,       2022]
NotebookOptionsPosition[     68061,       1953]
NotebookOutlinePosition[     68441,       1970]
CellTagsIndexPosition[     68398,       1967]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Fiber-Coupled SPDC", "Title",
 CellChangeTimes->{{3.593478343405889*^9, 3.5934783764866133`*^9}}],

Cell["Pump Beam:", "Subtitle",
 CellChangeTimes->{{3.593479538414673*^9, 3.593479543557622*^9}, {
  3.593479584884583*^9, 3.593479585804221*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GB", 
    RowBox[{"(", 
     RowBox[{"x", ",", "y", ",", "z"}], ")"}]}], " ", "=", " ", 
   RowBox[{
    FractionBox["1", 
     SqrtBox[
      RowBox[{"1", "+", 
       RowBox[{"I", 
        FractionBox["z1", "zRx"]}]}]]], 
    FractionBox["1", 
     SqrtBox[
      RowBox[{"1", "+", 
       RowBox[{"I", 
        FractionBox[
         RowBox[{" ", "z1"}], "zRy"]}]}]]], 
    RowBox[{"Exp", "[", 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         SuperscriptBox["x1", "2"], 
         RowBox[{
          SuperscriptBox["wox", "2"], 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", 
             FractionBox[
              RowBox[{" ", "z1"}], "zRx"]}]}], ")"}]}]], "+", 
        FractionBox[
         SuperscriptBox["y1", "2"], 
         RowBox[{
          SuperscriptBox["woy", "2"], 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", 
             FractionBox[
              RowBox[{" ", "z1"}], "zRy"]}]}], ")"}]}]]}], ")"}]}], "]"}], 
    RowBox[{"Exp", "[", 
     RowBox[{"I", " ", 
      FractionBox[
       RowBox[{"2", " ", "\[Pi]"}], "\[CapitalLambda]"], " ", "z"}], 
     "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.593479552587785*^9, 3.59347957004463*^9}},
 EmphasizeSyntaxErrors->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{"z1", "=", 
   RowBox[{"z", "-", 
    RowBox[{"(", 
     RowBox[{"zo", "-", 
      RowBox[{"L", "/", "2"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y1", "=", 
   RowBox[{"y", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"z", "+", "L"}], ")"}], "\[Rho]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x1", "=", "x"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"\[Rho]", "=", 
    RowBox[{"Tan", "[", "\[Rho]", "]"}]}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"GB", "[", 
     RowBox[{"kx", ",", "ky", ",", "z"}], "]"}], "=", 
    RowBox[{"InverseFourierTransform", "[", 
     RowBox[{
      RowBox[{
       FractionBox["1", 
        SqrtBox[
         RowBox[{"1", "+", 
          RowBox[{"I", 
           FractionBox["z1", "zRx"]}]}]]], 
       FractionBox["1", 
        SqrtBox[
         RowBox[{"1", "+", 
          RowBox[{"I", 
           FractionBox[
            RowBox[{" ", "z1"}], "zRy"]}]}]]], 
       RowBox[{"Exp", "[", 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            SuperscriptBox["x1", "2"], 
            RowBox[{
             SuperscriptBox["wox", "2"], 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"I", 
                FractionBox[
                 RowBox[{" ", "z1"}], "zRx"]}]}], ")"}]}]], "+", 
           FractionBox[
            SuperscriptBox["y1", "2"], 
            RowBox[{
             SuperscriptBox["woy", "2"], 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"I", 
                FractionBox[
                 RowBox[{" ", "z1"}], "zRy"]}]}], ")"}]}]]}], ")"}]}], "]"}], 
       RowBox[{"Exp", "[", 
        RowBox[{"I", " ", 
         FractionBox[
          RowBox[{"2", " ", "\[Pi]"}], "\[CapitalLambda]"], " ", "z"}], 
        "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"kx", ",", "ky"}], "}"}]}], "]"}]}], ";"}]}]}], "Input",
 CellChangeTimes->{{3.593478671000082*^9, 3.5934787084819613`*^9}, {
  3.593478753895425*^9, 3.593478768332193*^9}, {3.593491297516683*^9, 
  3.593491329179533*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GB", "[", 
    RowBox[{"kx", ",", "ky"}], "]"}], "=", 
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"GB", "[", 
       RowBox[{"kx", ",", "ky", ",", "z"}], "]"}], " ", 
      RowBox[{"Exp", "[", 
       RowBox[{"I", " ", 
        RowBox[{"(", 
         RowBox[{"kp", "-", "kz"}], ")"}], " ", "z"}], "]"}], " ", 
      RowBox[{"Exp", "[", 
       RowBox[{"I", " ", "kp", " ", "L"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"z", ",", 
       RowBox[{"-", "L"}], ",", "0"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5934788173931*^9, 3.5934788878137693`*^9}, 
   3.593491287975994*^9}],

Cell[TextData[StyleBox["\nAfter several simplifications: ",
 FontSize->18]], "Text",
 CellChangeTimes->{{3.593478936496505*^9, 3.593478940949327*^9}, {
  3.593478995503044*^9, 3.593479004027788*^9}, {3.593479041357134*^9, 
  3.5934790555935307`*^9}, {3.593479095727888*^9, 3.593479146182969*^9}, {
  3.593491247502215*^9, 3.5934912934536133`*^9}}],

Cell[CellGroupData[{

Cell["Joint Function", "Subtitle",
 CellChangeTimes->{{3.593479153327503*^9, 3.593479156150659*^9}, 
   3.593479598532007*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"F", "[", 
    RowBox[{
     OverscriptBox["ks", "\[Rule]"], ",", 
     OverscriptBox["ki", "\[Rule]"]}], "]"}], "=", "  ", 
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "4"]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["kx", "2"], " ", 
         SuperscriptBox["wox", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["ky", "2"], " ", 
         SuperscriptBox["woy", "2"]}]}], ")"}]}], "]"}], 
    RowBox[{"Exp", "[", 
     RowBox[{"I", " ", 
      RowBox[{"(", 
       FractionBox[
        RowBox[{
         SuperscriptBox["kx", "2"], "+", 
         SuperscriptBox["ky", "2"], " "}], 
        RowBox[{"2", " ", "kp"}]], ")"}], "zo"}], "]"}], 
    RowBox[{"Exp", "[", 
     RowBox[{"I", 
      FractionBox[
       RowBox[{" ", "L"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{"kp", " ", "+", 
        RowBox[{"ky", " ", "\[Rho]"}], "+", "kz", " ", "-", 
        FractionBox[
         RowBox[{"2", "  ", "\[Pi]"}], "\[CapitalLambda]"]}], ")"}]}], "]"}], 
    FractionBox[
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{
        FractionBox["L", "2"], "\[CapitalDelta]k"}], "]"}], "  "}], 
     RowBox[{
      FractionBox["L", "2"], "\[CapitalDelta]k"}]]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalDelta]k", "=", 
   RowBox[{"kp", " ", "-", 
    FractionBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["kx", "2"], "+", 
       SuperscriptBox["ky", "2"]}], ")"}], 
     RowBox[{"2", " ", "kp"}]], " ", "+", " ", 
    FractionBox[
     RowBox[{"2", " ", "\[Pi]"}], 
     RowBox[{" ", "\[CapitalLambda]"}]], "-", "kz", " ", "+", 
    RowBox[{"ky", "  ", "\[Rho]"}]}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.593479174030829*^9, 3.5934792644853497`*^9}, 
   3.5934825632509108`*^9},
 EmphasizeSyntaxErrors->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fiber Collection mode", "Subtitle",
 CellChangeTimes->{{3.593479483924552*^9, 3.593479514598991*^9}, {
  3.6289652099152737`*^9, 3.6289652107862673`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"For", " ", "\[Mu]"}], "=", "s"}], ",", 
  RowBox[{"i", ";", " ", 
   RowBox[{"\[Phi]\[Mu]", "=", 
    SuperscriptBox[
     RowBox[{"Sec", "[", 
      SubscriptBox["\[Theta]", "\[Mu]0"], "]"}], "2"]}], ";", 
   RowBox[{"\[Psi]\[Mu]", "=", 
    RowBox[{
     SubscriptBox["k", "\[Mu]"], 
     RowBox[{"Sin", "[", 
      SubscriptBox["\[Theta]", "\[Mu]0"], "]"}]}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.593479743620039*^9, 3.593479749164538*^9}, {
  3.5934797873727417`*^9, 3.593479868802166*^9}},
 EmphasizeSyntaxErrors->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"u", "[", 
     SubscriptBox["k", "\[Mu]"], "]"}], "=", 
    RowBox[{
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox["Wf\[Mu]", "2"], "4"]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Phi]\[Mu]", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"k\[Mu]x", "-", "\[Psi]\[Mu]"}], ")"}], "2"]}], "+", 
         SuperscriptBox["k\[Mu]y", "2"]}], ")"}]}], "]"}], 
     RowBox[{"Exp", "[", 
      RowBox[{"I", " ", "h\[Mu]", " ", "k\[Mu]x"}], "]"}]}]}], ";"}], " ", 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.593479637018016*^9, 3.593479741103834*^9}}],

Cell[CellGroupData[{

Cell["Assumptions", "Subsubtitle",
 CellChangeTimes->{{3.593480222309266*^9, 3.593480225444133*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ksz", "=", 
   RowBox[{"ks", "-", 
    FractionBox[
     SuperscriptBox["ksx", "2"], 
     RowBox[{"2", " ", "ks"}]], "-", 
    FractionBox[
     SuperscriptBox["ksy", "2"], 
     RowBox[{"2", " ", "ks"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kiz", "=", 
   RowBox[{"ki", "-", 
    FractionBox[
     SuperscriptBox["kix", "2"], 
     RowBox[{"2", " ", "ki"}]], "-", 
    FractionBox[
     SuperscriptBox["kiy", "2"], 
     RowBox[{"2", " ", "ki"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Sinc", "[", "x", "]"}], "=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{
     SubsuperscriptBox["\[Integral]", 
      RowBox[{"-", "1"}], "1"], 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "x\[Xi]"}]], 
      RowBox[{"\[DifferentialD]", "\[Xi]"}]}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.593479388837566*^9, 3.5934794435863333`*^9}, 
   3.5934802109000196`*^9, {3.593480243415847*^9, 3.593480244554221*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Set", "::", "write"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Tag \[NoBreak]\\!\\(Sinc\\)\[NoBreak] in \
\[NoBreak]\\!\\(Sinc[x]\\)\[NoBreak] is Protected. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/write\\\", ButtonNote -> \
\\\"Set::write\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.62896521665982*^9, 3.6289765806435003`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Fiber-Coupled Joint Spectral Amplitude F(\[Omega]s,\[Omega]i)\
\>", "Subtitle",
 CellChangeTimes->{{3.593480313244083*^9, 3.593480331976787*^9}, {
  3.5945107675041037`*^9, 3.594510778112327*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"g", "[", 
    RowBox[{"\[Omega]s", ",", "\[Omega]i"}], "]"}], "=", 
   RowBox[{
    SubsuperscriptBox["\[Integral]", 
     RowBox[{"-", "1"}], "1"], 
    RowBox[{
     SubsuperscriptBox["\[Integral]", 
      RowBox[{"-", "\[Infinity]"}], "\[Infinity]"], 
     RowBox[{
      SubsuperscriptBox["\[Integral]", 
       RowBox[{"-", "\[Infinity]"}], "\[Infinity]"], 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "4"]}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["Wx", "2"], 
            SuperscriptBox["kx", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["Wy", "2"], 
            SuperscriptBox["ky", "2"]}]}], ")"}]}], "]"}], 
       RowBox[{"Exp", "[", 
        RowBox[{"I", 
         FractionBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["kx", "2"], "+", 
            SuperscriptBox["ky", "2"]}], ")"}], 
          RowBox[{"2", " ", "kp"}]], "z0"}], "]"}], 
       RowBox[{"Exp", "[", 
        RowBox[{"I", 
         FractionBox[
          RowBox[{" ", "L"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{"kp", " ", "+", 
           RowBox[{"ky", " ", "\[Rho]"}], "+", "kz", " ", "-", 
           FractionBox[
            RowBox[{"2", "  ", "\[Pi]"}], "\[CapitalLambda]"]}], ")"}]}], 
        "]"}], 
       RowBox[{"Exp", "[", 
        RowBox[{"I", 
         FractionBox["L", "2"], "\[CapitalDelta]k", " ", "\[Xi]"}], "]"}], 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           SuperscriptBox["Wfs", "2"], "4"]}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Phi]s", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"ksx", "-", "\[Psi]s"}], ")"}], "2"]}], "+", 
           SuperscriptBox["ksy", "2"]}], ")"}]}], "]"}], 
       RowBox[{"Exp", "[", 
        RowBox[{"I", " ", "hs", " ", "ksx"}], "]"}], 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           SuperscriptBox["Wfi", "2"], "4"]}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Phi]i", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"kix", "-", "\[Psi]i"}], ")"}], "2"]}], "+", 
           SuperscriptBox["kiy", "2"]}], ")"}]}], "]"}], 
       RowBox[{"Exp", "[", 
        RowBox[{"I", " ", "hi", " ", "kix"}], "]"}], 
       RowBox[{
        SuperscriptBox["\[DifferentialD]", "2"], "ks"}], 
       RowBox[{
        SuperscriptBox["\[DifferentialD]", "2"], "ki"}], 
       RowBox[{"\[DifferentialD]", "\[Xi]"}]}]}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5934803674462748`*^9, 3.593480374040406*^9}, {
   3.593480418131495*^9, 3.593480596890566*^9}, {3.593480823280754*^9, 
   3.593480869341483*^9}, 3.594510762662912*^9},
 EmphasizeSyntaxErrors->True],

Cell["After integrating and simplifying:", "Text",
 CellChangeTimes->{{3.593480876135694*^9, 3.593480898998961*^9}, {
  3.593481779316588*^9, 3.5934817837396*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"g", "[", 
    RowBox[{"\[Omega]s", ",", "\[Omega]i"}], "]"}], "=", 
   RowBox[{
    SubsuperscriptBox["\[Integral]", 
     RowBox[{"-", "1"}], "1"], 
    RowBox[{
     FractionBox[
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox["1", "4"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", "A10"}], "-", 
          FractionBox[
           SuperscriptBox["A5", "2"], "A1"], "-", 
          FractionBox[
           SuperscriptBox["A6", "2"], "A2"], "-", 
          FractionBox[
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "A1", " ", "A7"}], "+", 
              RowBox[{"A5", " ", "A8"}]}], ")"}], "2"], 
           RowBox[{"A1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", " ", "A1", " ", "A3"}], "-", 
              SuperscriptBox["A8", "2"]}], ")"}]}]], "-", 
          FractionBox[
           RowBox[{
            SuperscriptBox["A6", "2"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], " ", "A2"}], "+", "A9"}], ")"}], "2"]}], 
           RowBox[{"A2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", " ", "A2", " ", "A4"}], "-", 
              SuperscriptBox["A9", "2"]}], ")"}]}]]}], ")"}]}]], 
      RowBox[{
       SqrtBox[
        RowBox[{"A1", " ", "A2", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "4"}], " ", "A3"}], "+", 
           FractionBox[
            SuperscriptBox["A8", "2"], "A1"]}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "4"}], " ", "A4"}], "+", 
           FractionBox[
            SuperscriptBox["A9", "2"], "A2"]}], ")"}]}]], " "}]], 
     RowBox[{"\[DifferentialD]", "\[Xi]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"F", "[", 
     RowBox[{"\[Omega]s", ",", "\[Omega]i"}], "]"}], "=", 
    RowBox[{"\[Alpha]", 
     RowBox[{"(", 
      RowBox[{"\[Omega]s", "+", "\[Omega]i"}], ")"}], 
     RowBox[{"g", "[", 
      RowBox[{"\[Omega]s", ",", "\[Omega]i"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A1", "=", 
   RowBox[{"As", "+", " ", 
    RowBox[{"\[ImaginaryI]", " ", "Cs"}], "+", " ", 
    RowBox[{"\[ImaginaryI]", " ", "Ds", " ", "\[Xi]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A3", "=", 
   RowBox[{"Ai", "+", " ", 
    RowBox[{"\[ImaginaryI]", " ", "Ci"}], "+", " ", 
    RowBox[{"\[ImaginaryI]", " ", "Di", " ", "\[Xi]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A2", "=", 
   RowBox[{"Bs", "+", " ", 
    RowBox[{"\[ImaginaryI]", " ", "Cs"}], "+", " ", 
    RowBox[{"\[ImaginaryI]", " ", "Ds", " ", "\[Xi]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A4", "=", 
   RowBox[{"Bi", "+", " ", 
    RowBox[{"\[ImaginaryI]", " ", "Ci"}], "+", " ", 
    RowBox[{"\[ImaginaryI]", " ", "Di", " ", "\[Xi]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A5", "=", 
   RowBox[{"Es", " ", "+", 
    RowBox[{"\[ImaginaryI]", " ", "hs"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A7", "=", 
   RowBox[{"Ei", " ", "+", 
    RowBox[{"\[ImaginaryI]", " ", "hi"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A6", "=", 
   RowBox[{"\[ImaginaryI]", " ", "n", 
    RowBox[{"(", 
     RowBox[{"1", "+", "\[Xi]"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A8", "=", 
   RowBox[{"mx", "-", 
    RowBox[{"\[ImaginaryI]", " ", "m", " ", "\[Xi]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A9", "=", 
   RowBox[{"my", "-", 
    RowBox[{"\[ImaginaryI]", " ", "m", " ", "\[Xi]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A10", "=", 
   RowBox[{"hh", "+", 
    RowBox[{"\[ImaginaryI]", " ", "ee"}], " ", "+", 
    RowBox[{"\[ImaginaryI]", " ", "ff", " ", "\[Xi]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.593480905500355*^9, 3.593480937365046*^9}, {
   3.593481014089375*^9, 3.593481016389872*^9}, 3.593481422403699*^9, {
   3.5934816563337*^9, 3.5934816620544157`*^9}, {3.593481722730949*^9, 
   3.5934817247069693`*^9}, {3.593482943473866*^9, 3.593482981357664*^9}, {
   3.594510764955003*^9, 3.594510790160095*^9}, {3.5945108235357513`*^9, 
   3.594510831387899*^9}, {3.594511131168844*^9, 3.594511172042025*^9}, {
   3.5945113511636477`*^9, 3.5945113545624104`*^9}, {3.594511420240685*^9, 
   3.594511462033812*^9}, {3.594511594857723*^9, 3.594511601699339*^9}, 
   3.594511675503271*^9}],

Cell[TextData[StyleBox["For \[Mu]=s,i; \[Nu]=x,y",
 FontSize->16]], "Text",
 CellChangeTimes->{{3.59348181222587*^9, 3.593481820722126*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"A\[Mu]", "=", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "4"]}], " ", 
    RowBox[{"(", " ", 
     RowBox[{
      SuperscriptBox["Wx", "2"], "+", " ", 
      RowBox[{
       SuperscriptBox["Wf\[Mu]", "2"], " ", "\[Phi]\[Mu]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B\[Mu]", "=", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "4"]}], " ", 
    RowBox[{"(", " ", 
     RowBox[{
      SuperscriptBox["Wf\[Mu]", "2"], "+", " ", 
      SuperscriptBox["Wy", "2"]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C\[Mu]", "=", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "4"]}], "  ", 
    RowBox[{"(", 
     FractionBox[
      RowBox[{
       RowBox[{"kp", " ", "L"}], "-", 
       RowBox[{"2", "k\[Mu]", " ", "z0"}]}], 
      RowBox[{"k\[Mu]", " ", "kp"}]], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"D\[Mu]", "=", 
   RowBox[{
    FractionBox["1", "4"], "  ", "L", " ", 
    RowBox[{"(", 
     FractionBox[
      RowBox[{"kp", "-", "k\[Mu]"}], 
      RowBox[{"kp", " ", "k\[Mu]"}]], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E\[Mu]", "=", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    SuperscriptBox["Wf\[Mu]", "2"], " ", "\[Phi]\[Mu]", " ", 
    "\[Psi]\[Mu]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m\[Nu]", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], " ", 
     SuperscriptBox["W\[Nu]", "2"]}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     FractionBox["z0", 
      RowBox[{" ", "kp"}]]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m", "=", 
   FractionBox["L", 
    RowBox[{"2", "kp"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", 
   RowBox[{
    FractionBox["1", "2"], "  ", "L", "  ", "\[Rho]"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ee", "=", 
   RowBox[{
    FractionBox["1", "2"], "  ", "L", 
    RowBox[{"(", 
     RowBox[{"kp", "+", "ks", "+", "ki", "-", 
      FractionBox[
       RowBox[{"2", " ", "\[Pi]"}], "\[CapitalLambda]"]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ff", "=", 
   RowBox[{
    FractionBox["1", "2"], "  ", "L", 
    RowBox[{"(", 
     RowBox[{"kp", "-", "ks", "+", "ki", "+", 
      FractionBox[
       RowBox[{"2", " ", "\[Pi]"}], "\[CapitalLambda]"]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hh", "=", 
   RowBox[{
    RowBox[{"-", " ", 
     FractionBox["1", "4"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["Wfi", "2"], " ", "\[Phi]i", " ", 
       SuperscriptBox["\[Psi]i", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["Wfs", "2"], " ", "\[Phi]s", " ", 
       SuperscriptBox["\[Psi]s", "2"]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.593481105331017*^9, 3.5934811163022947`*^9}, {
   3.5934811559890127`*^9, 3.593481243472909*^9}, {3.5934812824369497`*^9, 
   3.593481299032423*^9}, 3.593481413778369*^9, {3.593481493173691*^9, 
   3.593481576897399*^9}, {3.5934816235927877`*^9, 3.59348163932045*^9}, {
   3.593481674390018*^9, 3.593481675182948*^9}, 3.593481727517075*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Signal-Mode Detection Rate", "Title",
 CellChangeTimes->{{3.593482126299857*^9, 3.593482153456346*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Rs", "=", 
   RowBox[{
    SubscriptBox["\[Eta]", "s"], 
    RowBox[{"\[Integral]", 
     RowBox[{"\[Integral]", 
      RowBox[{
       RowBox[{"l", "[", 
        RowBox[{"ws", ",", "wi"}], "]"}], 
       RowBox[{
        SubscriptBox["F", "s"], "[", 
        RowBox[{"\[Omega]s", ",", "\[Omega]i"}], "]"}], 
       RowBox[{"\[DifferentialD]", "\[Omega]s"}], 
       RowBox[{"\[DifferentialD]", "\[Omega]i"}]}]}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["F", "s"], "[", 
    RowBox[{"\[Omega]s", ",", "\[Omega]i"}], "]"}], "=", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"Abs", "[", 
      RowBox[{"\[Alpha]", 
       RowBox[{"(", 
        RowBox[{"\[Omega]s", "+", "\[Omega]i"}], ")"}]}], "]"}], "2"], 
    RowBox[{"h", "[", 
     RowBox[{"\[Omega]s", ",", "\[Omega]i"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"h", "[", 
    RowBox[{"\[Omega]s", ",", "\[Omega]i"}], "]"}], "=", 
   RowBox[{"\[Integral]", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"\[LeftBracketingBar]", 
       RowBox[{"\[Integral]", 
        RowBox[{
         RowBox[{"\[Phi]", "[", 
          RowBox[{
           SubscriptBox[
            OverscriptBox["k", "\[Rule]"], "s"], ",", 
           SubscriptBox[
            OverscriptBox["k", "\[Rule]"], "i"]}], "]"}], 
         RowBox[{"u", "[", 
          SubscriptBox[
           OverscriptBox["k", "\[Rule]"], "s"], "]"}], 
         RowBox[{
          SuperscriptBox["\[DifferentialD]", "2"], "ks"}]}]}], 
       "\[RightBracketingBar]"}], "2"], 
     RowBox[{
      SuperscriptBox["\[DifferentialD]", "2"], "ki"}]}]}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.5934821780797987`*^9, 3.5934821799450893`*^9}, {
   3.59348223730681*^9, 3.5934824074429617`*^9}, {3.593482438185268*^9, 
   3.5934824421296177`*^9}, {3.593482473075459*^9, 3.5934825341672153`*^9}, {
   3.593482586203027*^9, 3.59348262524501*^9}, {3.594511750215151*^9, 
   3.594511816823724*^9}, 3.5946100577161617`*^9}],

Cell["After integrating and simplifying:", "Text",
 CellChangeTimes->{{3.5934827880296783`*^9, 3.5934828243863363`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"h", "[", 
    RowBox[{"\[Omega]s", ",", "\[Omega]i"}], "]"}], "=", 
   RowBox[{
    SubsuperscriptBox["\[Integral]", 
     RowBox[{"-", "1"}], "1"], 
    RowBox[{
     SubsuperscriptBox["\[Integral]", 
      RowBox[{"-", "1"}], "1"], 
     RowBox[{
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           SuperscriptBox["GG", "2"], 
           RowBox[{"4", " ", "EE"}]]}], "-", 
         FractionBox[
          SuperscriptBox["HH", "2"], 
          RowBox[{"4", " ", "FF"}]], "+", "II"}]], 
       RowBox[{"8", " ", 
        SqrtBox[
         RowBox[{
         "AA1", " ", "BB1", " ", "AA2", " ", "BB2", " ", "EE", " ", "FF"}]], 
        " "}]], 
      RowBox[{"\[DifferentialD]", "\[Xi]1"}], 
      RowBox[{"\[DifferentialD]", "\[Xi]2"}]}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.593482831518146*^9, 3.5934829112227716`*^9}, 
   3.593483089948633*^9, 3.594511826468989*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"EE", "=", 
    RowBox[{
     FractionBox["1", "4"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", 
        SuperscriptBox["Wx", "2"]}], "+", 
       RowBox[{"\[ImaginaryI]", " ", "L", " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox["1", "ki"], "-", 
          FractionBox["1", "kp"]}], ")"}], 
        RowBox[{"(", 
         RowBox[{"\[Xi]1", "-", "\[Xi]2"}], ")"}]}], "+", 
       RowBox[{
        FractionBox["ks", "kp"], 
        RowBox[{"(", " ", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kp", " ", 
               SuperscriptBox["Wx", "2"]}], "+", 
              RowBox[{"\[ImaginaryI]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", "z0"}], "-", 
                 RowBox[{"L", " ", "\[Xi]2"}]}], ")"}]}]}], ")"}], "2"], "/", 
           " ", 
           RowBox[{
            RowBox[{"\[ImaginaryI]", " ", "ks", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "z0"}], "-", 
               RowBox[{"L", " ", "\[Xi]2"}]}], ")"}]}], "+", 
            RowBox[{"kp", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"ks", " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["Wx", "2"], "+", 
                  RowBox[{
                   SuperscriptBox["Wfs", "2"], " ", "\[Phi]s"}]}], ")"}]}], 
               "-", 
               RowBox[{"\[ImaginaryI]", " ", "L", " ", 
                RowBox[{"(", 
                 RowBox[{"1", "-", "\[Xi]2"}], ")"}]}]}], ")"}]}]}]}], "-", 
          " ", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", " ", 
             RowBox[{
              RowBox[{"kp", " ", 
               SuperscriptBox["Wx", "2"]}], "-", 
              RowBox[{"\[ImaginaryI]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", "z0"}], "-", " ", 
                 RowBox[{"L", " ", "\[Xi]1"}]}], ")"}]}]}], ")"}], "2"], "/", 
           " ", 
           RowBox[{
            RowBox[{"\[ImaginaryI]", " ", "ks", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "z0"}], "-", 
               RowBox[{"L", " ", "\[Xi]1"}]}], ")"}]}], "-", 
            RowBox[{"kp", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"ks", " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["Wx", "2"], "+", 
                  RowBox[{
                   SuperscriptBox["Wfs", "2"], " ", "\[Phi]s"}]}], ")"}]}], 
               "+", 
               RowBox[{"\[ImaginaryI]", " ", "L", " ", 
                RowBox[{"(", 
                 RowBox[{"1", "-", "\[Xi]1"}], ")"}]}]}], ")"}]}]}]}]}], 
         ")"}]}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FF", "=", 
   RowBox[{
    FractionBox["1", "4"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       SuperscriptBox["Wy", "2"]}], "+", 
      RowBox[{"\[ImaginaryI]", " ", "L", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "ki"], "-", 
         FractionBox["1", "kp"]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"\[Xi]1", "-", "\[Xi]2"}], ")"}]}], "+", 
      RowBox[{
       FractionBox["ks", "kp"], 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", " ", 
            RowBox[{
             RowBox[{"kp", " ", 
              SuperscriptBox["Wy", "2"]}], "+", 
             RowBox[{"\[ImaginaryI]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", "z0"}], "-", 
                RowBox[{"L", " ", "\[Xi]2"}]}], ")"}]}]}], ")"}], "2"], "/", 
          " ", 
          RowBox[{
           RowBox[{"\[ImaginaryI]", " ", "ks", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "z0"}], "-", 
              RowBox[{"L", " ", "\[Xi]2"}]}], ")"}]}], "+", 
           RowBox[{"kp", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"ks", " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["Wy", "2"], "+", 
                 SuperscriptBox["Wfs", "2"]}], ")"}]}], "-", 
              RowBox[{"\[ImaginaryI]", " ", "L", " ", 
               RowBox[{"(", 
                RowBox[{"1", "-", "\[Xi]2"}], ")"}]}]}], ")"}]}]}]}], "-", 
         " ", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"kp", " ", 
              SuperscriptBox["Wy", "2"]}], "-", 
             RowBox[{"\[ImaginaryI]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", "z0"}], "-", 
                RowBox[{"L", " ", "\[Xi]1"}]}], ")"}]}]}], ")"}], "2"], "/", 
          " ", 
          RowBox[{
           RowBox[{"\[ImaginaryI]", " ", "ks", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "z0"}], "-", 
              RowBox[{"L", " ", "\[Xi]1"}]}], ")"}]}], "-", 
           RowBox[{"kp", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"ks", " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["Wy", "2"], "+", 
                 SuperscriptBox["Wfs", "2"]}], ")"}]}], "+", 
              RowBox[{"\[ImaginaryI]", " ", "L", " ", 
               RowBox[{"(", 
                RowBox[{"1", "-", "\[Xi]1"}], ")"}]}]}], ")"}]}]}]}]}], 
        ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GG", "=", 
    RowBox[{
     FractionBox["1", "4"], 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", " ", 
          RowBox[{
           RowBox[{"kp", " ", 
            SuperscriptBox["Wx", "2"]}], "-", 
           RowBox[{"\[ImaginaryI]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "z0"}], "-", 
              RowBox[{"L", " ", "\[Xi]1"}]}], ")"}]}]}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "  ", "ks", " ", 
            SuperscriptBox["Wfs", "2"], " ", "\[Phi]s", " ", "\[Psi]s"}], "+", 
           RowBox[{"\[ImaginaryI]", " ", "4", " ", "hs", " ", "ks"}]}], 
          ")"}]}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[ImaginaryI]", " ", "ks", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "z0"}], "-", 
             RowBox[{"L", " ", "\[Xi]1"}]}], ")"}]}], "-", 
          RowBox[{"kp", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ks", " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["Wx", "2"], "+", 
                RowBox[{
                 SuperscriptBox["Wfs", "2"], " ", "\[Phi]s"}]}], ")"}]}], "+", 
             RowBox[{"\[ImaginaryI]", " ", "L", " ", 
              RowBox[{"(", 
               RowBox[{"1", "-", "\[Xi]1"}], ")"}]}]}], ")"}]}]}], ")"}]}], 
       "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"kp", " ", 
             SuperscriptBox["Wx", "2"]}], "+", 
            RowBox[{"\[ImaginaryI]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", "  ", "z0"}], "-", 
               RowBox[{"L", " ", "\[Xi]2"}]}], ")"}]}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "ks", " ", 
             SuperscriptBox["Wfs", "2"], " ", "\[Phi]s", " ", "\[Psi]s"}], 
            "-", 
            RowBox[{"4", " ", "\[ImaginaryI]", " ", "hs", " ", "ks"}]}], 
           ")"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[ImaginaryI]", " ", "ks", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "z0"}], "-", 
             RowBox[{"L", " ", "\[Xi]2"}]}], ")"}]}], "+", 
          RowBox[{"kp", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ks", " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["Wx", "2"], "+", 
                RowBox[{
                 SuperscriptBox["Wfs", "2"], " ", "\[Phi]s"}]}], ")"}]}], "-", 
             RowBox[{"\[ImaginaryI]", " ", "L", " ", 
              RowBox[{"(", 
               RowBox[{"1", "-", "\[Xi]2"}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
      ")"}]}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HH", "=", 
    RowBox[{
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "L", " ", "\[Rho]", " "}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Xi]1", "-", "\[Xi]2"}], ")"}], "+", 
       FractionBox[
        RowBox[{" ", 
         RowBox[{"ks", "  ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Xi]1"}], ")"}], " ", 
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{"kp", " ", 
             SuperscriptBox["Wy", "2"]}], "-", 
            RowBox[{"\[ImaginaryI]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "z0"}], "-", 
               RowBox[{"L", " ", "\[Xi]1"}]}], ")"}]}]}], ")"}]}]}], 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", "ks", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "z0"}], "-", 
            RowBox[{"L", " ", "\[Xi]1"}]}], ")"}]}], "-", 
         RowBox[{"kp", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ks", " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["Wfs", "2"], "+", 
               SuperscriptBox["Wy", "2"]}], ")"}]}], "+", 
            RowBox[{"\[ImaginaryI]", " ", "L", " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Xi]1"}], ")"}]}]}], ")"}]}]}]], "+", 
       FractionBox[
        RowBox[{" ", 
         RowBox[{"ks", "  ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Xi]2"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"kp", " ", 
             SuperscriptBox["Wy", "2"]}], "+", 
            RowBox[{"\[ImaginaryI]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "z0"}], "-", 
               RowBox[{"L", " ", "\[Xi]2"}]}], ")"}]}]}], ")"}], " "}]}], 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", "ks", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "z0"}], "-", 
            RowBox[{"L", " ", "\[Xi]2"}]}], ")"}]}], "+", 
         RowBox[{"kp", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ks", " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["Wfs", "2"], "+", 
               SuperscriptBox["Wy", "2"]}], ")"}]}], "-", 
            RowBox[{"\[ImaginaryI]", " ", "L", " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Xi]2"}], ")"}]}]}], ")"}]}]}]]}], 
      ")"}]}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"II", "=", 
    RowBox[{
     FractionBox["1", "4"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "L", " ", 
        RowBox[{"(", 
         RowBox[{"kp", "-", "ks", "-", "ki", "+", 
          FractionBox[
           RowBox[{"2", " ", "\[Pi]"}], "\[CapitalLambda]"]}], " ", ")"}], 
        " ", 
        RowBox[{"(", 
         RowBox[{"\[Xi]1", "-", "\[Xi]2"}], ")"}]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["Wfs", "2"], " ", "\[Phi]s", " ", 
        SuperscriptBox["\[Psi]s", "2"]}], "+", 
       FractionBox[
        RowBox[{"kp", " ", "ks", " ", 
         SuperscriptBox["L", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Xi]1"}], ")"}], "2"], " ", 
         SuperscriptBox["\[Rho]", "2"]}], 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", "ks", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "z0"}], "-", 
            RowBox[{"L", " ", "\[Xi]1"}]}], ")"}]}], "-", 
         RowBox[{"kp", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ks", " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["Wfs", "2"], "+", 
               SuperscriptBox["Wy", "2"]}], ")"}]}], "+", 
            RowBox[{"\[ImaginaryI]", " ", "L", " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Xi]1"}], ")"}]}]}], ")"}]}]}]], "-", 
       FractionBox[
        RowBox[{"kp", " ", "ks", " ", 
         SuperscriptBox["L", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Xi]2"}], ")"}], "2"], " ", 
         SuperscriptBox["\[Rho]", "2"]}], 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", "ks", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "z0"}], "-", 
            RowBox[{"L", " ", "\[Xi]2"}]}], ")"}]}], "+", 
         RowBox[{"kp", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ks", " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["Wfs", "2"], "+", 
               SuperscriptBox["Wy", "2"]}], ")"}]}], "-", 
            RowBox[{"\[ImaginaryI]", " ", "L", " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Xi]2"}], ")"}]}]}], ")"}]}]}]], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"kp", " ", "ks", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "hs"}], "-", 
             RowBox[{"\[ImaginaryI]", " ", 
              SuperscriptBox["Wfs", "2"], " ", "\[Phi]s", " ", "\[Psi]s"}]}], 
            ")"}], "2"]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[ImaginaryI]", " ", "ks", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "z0"}], "-", 
             RowBox[{"L", " ", "\[Xi]1"}]}], ")"}]}], "-", 
          RowBox[{"kp", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ks", " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["Wx", "2"], "+", 
                RowBox[{
                 SuperscriptBox["Wfs", "2"], " ", "\[Phi]s"}]}], ")"}]}], "+", 
             RowBox[{"\[ImaginaryI]", " ", "L", " ", 
              RowBox[{"(", 
               RowBox[{"1", "-", "\[Xi]1"}], ")"}]}]}], ")"}]}]}], ")"}]}], 
       "-", " ", 
       RowBox[{
        RowBox[{"kp", " ", "ks", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "hs"}], "+", 
            RowBox[{"\[ImaginaryI]", " ", 
             SuperscriptBox["Wfs", "2"], " ", "\[Phi]s", " ", "\[Psi]s"}]}], 
           ")"}], "2"]}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[ImaginaryI]", " ", "ks", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "z0"}], "-", 
             RowBox[{"L", " ", "\[Xi]2"}]}], ")"}]}], "+", 
          RowBox[{"kp", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ks", " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["Wx", "2"], "+", 
                RowBox[{
                 SuperscriptBox["Wfs", "2"], " ", "\[Phi]s"}]}], ")"}]}], "-", 
             RowBox[{"\[ImaginaryI]", " ", "L", " ", 
              RowBox[{"(", 
               RowBox[{"1", "-", "\[Xi]2"}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
      ")"}]}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AA1", "=", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "L"}], 
      RowBox[{"4", " ", "ks"}]]}], "-", 
    FractionBox[
     SuperscriptBox["Wx", "2"], "4"], "+", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "z0"}], 
     RowBox[{"2", " ", "kp"}]], "-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "L", " ", "\[Xi]1"}], 
     RowBox[{"4", " ", "kp"}]], "+", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "L", " ", "\[Xi]1"}], 
     RowBox[{"4", " ", "ks"}]], "-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["Wfs", "2"], " ", "\[Phi]s"}], "4"]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BB1", "=", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "L"}], 
      RowBox[{"4", " ", "ks"}]]}], "-", 
    FractionBox[
     SuperscriptBox["Wfs", "2"], "4"], "-", 
    FractionBox[
     SuperscriptBox["Wy", "2"], "4"], "+", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "z0"}], 
     RowBox[{"2", " ", "kp"}]], "-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "L", " ", "\[Xi]1"}], 
     RowBox[{"4", " ", "kp"}]], "+", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "L", " ", "\[Xi]1"}], 
     RowBox[{"4", " ", "ks"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AA2", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "L"}], 
     RowBox[{"4", " ", "ks"}]], "-", 
    FractionBox[
     SuperscriptBox["Wx", "2"], "4"], "-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "z0"}], 
     RowBox[{"2", " ", "kp"}]], "+", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "L", " ", "\[Xi]2"}], 
     RowBox[{"4", " ", "kp"}]], "-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "L", " ", "\[Xi]2"}], 
     RowBox[{"4", " ", "ks"}]], "-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["Wfs", "2"], " ", "\[Phi]s"}], "4"]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BB2", "=", 
    RowBox[{
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "L"}], 
      RowBox[{"4", " ", "ks"}]], "-", 
     FractionBox[
      SuperscriptBox["Wfs", "2"], "4"], "-", 
     FractionBox[
      SuperscriptBox["Wy", "2"], "4"], "-", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "z0"}], 
      RowBox[{"2", " ", "kp"}]], "+", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "L", " ", "\[Xi]2"}], 
      RowBox[{"4", " ", "kp"}]], "-", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "L", " ", "\[Xi]2"}], 
      RowBox[{"4", " ", "ks"}]]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", "AA1", " ", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", "AA2", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", "BB1", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", "BB2", "]"}], "\[IndentingNewLine]", 
 RowBox[{"\[AliasDelimiter]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}]}], "Input",
 CellChangeTimes->{{3.59349045299746*^9, 3.593490508688817*^9}, {
   3.593490545239665*^9, 3.593490612808927*^9}, {3.5934906922707644`*^9, 
   3.593490722693268*^9}, {3.593490778610648*^9, 3.5934908627871037`*^9}, {
   3.62518912369306*^9, 3.6251891237906713`*^9}, {3.6251891710845537`*^9, 
   3.625189217727219*^9}, {3.62518926956472*^9, 3.62518929537068*^9}, {
   3.6251893745764112`*^9, 3.625189388834886*^9}, {3.6251894210346813`*^9, 
   3.625189421404682*^9}, {3.6251896460442038`*^9, 3.625189653216724*^9}, {
   3.625190198519165*^9, 3.625190213908011*^9}, {3.625190247915996*^9, 
   3.625190248419059*^9}, 3.625190664206924*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[ImaginaryI]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"ks", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "z0"}], "-", 
        RowBox[{"L", " ", "\[Xi]1"}]}], ")"}]}], "+", 
     RowBox[{"kp", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"L", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Xi]1"}], ")"}]}], "+", 
        RowBox[{"\[ImaginaryI]", " ", "ks", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["Wx", "2"], "+", 
           RowBox[{
            SuperscriptBox["Wfs", "2"], " ", "\[Phi]s"}]}], ")"}]}]}], 
       ")"}]}]}], ")"}]}], 
  RowBox[{"4", " ", "kp", " ", "ks"}]]], "Output",
 CellChangeTimes->{{3.6251892094097013`*^9, 3.625189218488344*^9}, 
   3.6251892962900143`*^9, {3.6251893796264467`*^9, 3.625189389341151*^9}, 
   3.625189423033276*^9, 3.625189480885599*^9, 3.625189653874284*^9, 
   3.6251902151142683`*^9, 3.6289652406754723`*^9, 3.6289768351963*^9}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"ks", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "z0"}], "-", 
         RowBox[{"L", " ", "\[Xi]2"}]}], ")"}]}], "+", 
      RowBox[{"kp", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"L", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Xi]2"}], ")"}]}], "-", 
         RowBox[{"\[ImaginaryI]", " ", "ks", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["Wx", "2"], "+", 
            RowBox[{
             SuperscriptBox["Wfs", "2"], " ", "\[Phi]s"}]}], ")"}]}]}], 
        ")"}]}]}], ")"}]}], 
   RowBox[{"4", " ", "kp", " ", "ks"}]]}]], "Output",
 CellChangeTimes->{{3.6251892094097013`*^9, 3.625189218488344*^9}, 
   3.6251892962900143`*^9, {3.6251893796264467`*^9, 3.625189389341151*^9}, 
   3.625189423033276*^9, 3.625189480885599*^9, 3.625189653874284*^9, 
   3.6251902151142683`*^9, 3.6289652406754723`*^9, 3.628976835241679*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[ImaginaryI]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"kp", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[ImaginaryI]", " ", "ks", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["Wfs", "2"], "+", 
           SuperscriptBox["Wy", "2"]}], ")"}]}], "+", 
        RowBox[{"L", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Xi]1"}], ")"}]}]}], ")"}]}], "+", 
     RowBox[{"ks", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "z0"}], "-", 
        RowBox[{"L", " ", "\[Xi]1"}]}], ")"}]}]}], ")"}]}], 
  RowBox[{"4", " ", "kp", " ", "ks"}]]], "Output",
 CellChangeTimes->{{3.6251892094097013`*^9, 3.625189218488344*^9}, 
   3.6251892962900143`*^9, {3.6251893796264467`*^9, 3.625189389341151*^9}, 
   3.625189423033276*^9, 3.625189480885599*^9, 3.625189653874284*^9, 
   3.6251902151142683`*^9, 3.6289652406754723`*^9, 3.628976835243074*^9}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"kp", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "ks", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["Wfs", "2"], "+", 
            SuperscriptBox["Wy", "2"]}], ")"}]}], "+", 
         RowBox[{"L", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Xi]2"}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{"ks", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "z0"}], "-", 
         RowBox[{"L", " ", "\[Xi]2"}]}], ")"}]}]}], ")"}]}], 
   RowBox[{"4", " ", "kp", " ", "ks"}]]}]], "Output",
 CellChangeTimes->{{3.6251892094097013`*^9, 3.625189218488344*^9}, 
   3.6251892962900143`*^9, {3.6251893796264467`*^9, 3.625189389341151*^9}, 
   3.625189423033276*^9, 3.625189480885599*^9, 3.625189653874284*^9, 
   3.6251902151142683`*^9, 3.6289652406754723`*^9, 3.628976835244465*^9}],

Cell[BoxData["\[AliasDelimiter]"], "Output",
 CellChangeTimes->{{3.6251892094097013`*^9, 3.625189218488344*^9}, 
   3.6251892962900143`*^9, {3.6251893796264467`*^9, 3.625189389341151*^9}, 
   3.625189423033276*^9, 3.625189480885599*^9, 3.625189653874284*^9, 
   3.6251902151142683`*^9, 3.6289652406754723`*^9, 3.628976835245819*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", " ", "OUTSIDE"}]}]}]}], " ", "ALL", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"LOOPS", " ", "--"}], "--"}], "--"}], "--"}], "--"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "Real", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"C1", "  ", "=", " ", 
     RowBox[{"kp", " ", "*", "ks", 
      RowBox[{"(", " ", 
       RowBox[{
        SuperscriptBox["Wx", "2"], "+", 
        RowBox[{
         SuperscriptBox["Wfs", "2"], " ", "\[Phi]s"}]}], ")"}]}]}], " ", 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"C2", " ", "=", " ", 
     RowBox[{
      SuperscriptBox["Wfs", "2"], " ", "\[Phi]s", " ", "\[Psi]s"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"C3", " ", "=", " ", 
     RowBox[{"L", " ", 
      RowBox[{"(", 
       RowBox[{"kp", "-", "ks", "-", "ki", "+", 
        FractionBox[
         RowBox[{"2", " ", "\[Pi]"}], "\[CapitalLambda]"]}], " ", ")"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"C4", " ", "=", " ", 
     RowBox[{"L", " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", "ki"], "-", 
        FractionBox["1", "kp"]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"C5", " ", "=", " ", 
     FractionBox["ks", "kp"]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"C6", " ", "=", " ", 
     RowBox[{"kp", " ", "*", "ks", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["Wfs", "2"], "+", 
        SuperscriptBox["Wy", "2"]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"C9", " ", "=", " ", 
     RowBox[{"kp", " ", 
      SuperscriptBox["Wx", "2"]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"C10", " ", "=", " ", 
     RowBox[{"kp", " ", 
      SuperscriptBox["Wy", "2"]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "Imaginary", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"M1", " ", "=", " ", 
     RowBox[{
      RowBox[{"2", " ", "hs"}], "-", 
      RowBox[{"\[ImaginaryI]", " ", "C2"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"M2", " ", "=", " ", 
     RowBox[{
      RowBox[{"2", " ", "hs"}], "+", 
      RowBox[{"\[ImaginaryI]", " ", "C2"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"M1sq", " ", "=", " ", 
     SuperscriptBox["M1", "2"]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"M2sq", " ", "=", " ", 
     SuperscriptBox["M2", "2"]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", " ", "FIRST"}]}]}]}], " ", "LOOP", " ", "FOR", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\[Xi]1", " ", "--"}], "--"}], "--"}], "--"}], "--"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "Real", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A1", " ", "=", " ", 
     RowBox[{
      RowBox[{"2", " ", "z0"}], "-", 
      RowBox[{"L", " ", "\[Xi]1"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"B1", " ", "=", " ", 
     RowBox[{"L", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Xi]1"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"B3", " ", "=", " ", 
     RowBox[{"L", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "\[Xi]1"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "Imaginary", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"D1", " ", "=", " ", 
     RowBox[{"C9", "-", " ", 
      RowBox[{"\[ImaginaryI]", " ", "A1"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"D3", " ", "=", " ", 
     RowBox[{"C10", "-", " ", 
      RowBox[{"\[ImaginaryI]", " ", "A1"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"G1", " ", "=", " ", 
     RowBox[{"C1", " ", "+", " ", 
      RowBox[{"\[ImaginaryI]", " ", "B1", " ", "kp"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"G3", " ", "=", " ", 
     RowBox[{"C6", "+", " ", 
      RowBox[{"\[ImaginaryI]", " ", "B1", " ", "kp"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"H1", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "ks", " ", "A1"}], "+", "G1"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"H3", " ", "=", " ", 
     RowBox[{"G3", " ", "-", 
      RowBox[{"\[ImaginaryI]", " ", "ks", " ", "A1"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"P1", " ", "=", " ", 
     RowBox[{"D1", "/", "H1"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"P3", " ", "=", " ", 
     RowBox[{"D3", "/", " ", "H3"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q1", " ", "=", " ", 
     RowBox[{"M1sq", " ", "/", " ", "H1"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q3", " ", "=", " ", 
     RowBox[{
      SuperscriptBox["B3", "2"], " ", "/", " ", "H3"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", " ", "SECOND"}]}]}]}], " ", "LOOP", " ", "FOR", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\[Xi]2", " ", "--"}], "--"}], "--"}], "--"}], "--"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "Real", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A2", " ", "=", 
     RowBox[{
      RowBox[{"2", " ", "z0"}], "-", 
      RowBox[{"L", " ", "\[Xi]2"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"B2", " ", "=", " ", 
     RowBox[{"L", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Xi]2"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"B4", " ", "=", " ", 
     RowBox[{"L", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "\[Xi]2"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"B6", " ", "=", " ", 
     RowBox[{"B2", " ", "-", " ", "B1"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"B6a", " ", "=", "  ", 
     RowBox[{"C4", 
      RowBox[{"(", 
       RowBox[{"\[Xi]1", "-", "\[Xi]2"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Imaginary", ".", " ", "Goes"}], " ", "inside", " ", "second", 
     " ", "loop"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"B7", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       SuperscriptBox["Wx", "2"]}], "+", 
      RowBox[{"\[ImaginaryI]", " ", "B6a"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"B8", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       SuperscriptBox["Wy", "2"]}], "+", 
      RowBox[{"\[ImaginaryI]", "  ", "B6a"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"D2", " ", "=", " ", 
     RowBox[{"C9", "+", " ", 
      RowBox[{"\[ImaginaryI]", " ", "A2"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"D4", " ", "=", " ", 
     RowBox[{"C10", "+", " ", 
      RowBox[{"\[ImaginaryI]", " ", "A2"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"G2", " ", "=", " ", 
     RowBox[{"C1", " ", "-", " ", 
      RowBox[{"\[ImaginaryI]", " ", "B2", " ", "kp"}]}]}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"G4", " ", "=", " ", 
     RowBox[{"C6", "-", " ", 
      RowBox[{"\[ImaginaryI]", " ", "B2", " ", "kp"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"H2", " ", "=", " ", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", "ks", " ", "A2"}], "+", "G2"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"H4", " ", "=", " ", 
     RowBox[{"G4", "+", 
      RowBox[{"\[ImaginaryI]", " ", "ks", " ", "A2"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"P2", " ", "=", " ", 
     RowBox[{"D2", "/", "H2"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"P4", " ", "=", " ", 
     RowBox[{"D4", "/", " ", "H4"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q2", " ", "=", " ", 
     RowBox[{"M2sq", " ", "/", " ", "H2"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q4", " ", "=", " ", 
     RowBox[{
      SuperscriptBox["B4", "2"], " ", "/", " ", "H4"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"K1", " ", "=", " ", 
     RowBox[{
      RowBox[{"-", "ki"}], "+", "kp", "-", "ks", "+", 
      FractionBox[
       RowBox[{"2", " ", "\[Pi]"}], "\[CapitalLambda]"]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Simplify", "[", "II", "]"}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.625189493304268*^9, 3.625189597096279*^9}, {
   3.625189789465787*^9, 3.6251898424907417`*^9}, {3.625189956471801*^9, 
   3.625190013408288*^9}, {3.625190072414733*^9, 3.625190078581499*^9}, {
   3.625190139725325*^9, 3.625190159043631*^9}, {3.625191572695037*^9, 
   3.625191582457858*^9}, {3.625191681635445*^9, 3.625191710551093*^9}, {
   3.6251917465668583`*^9, 3.625191963378069*^9}, 3.625192007082511*^9, 
   3.62519209802686*^9, {3.628964731628894*^9, 3.628964736297296*^9}, {
   3.628965025894059*^9, 3.6289651013154984`*^9}, {3.628965249083747*^9, 
   3.628965333217786*^9}, {3.6289653668124638`*^9, 3.628965491532497*^9}, {
   3.628965521571183*^9, 3.628965667300087*^9}, {3.6289657246532183`*^9, 
   3.62896575187875*^9}, {3.628965904199953*^9, 3.628965935335877*^9}, {
   3.6289660308408947`*^9, 3.628966124553537*^9}, {3.628966220584099*^9, 
   3.628966235682496*^9}, {3.628966309749353*^9, 3.628966334326674*^9}, {
   3.628966374642922*^9, 3.628966466119583*^9}, {3.628966699268297*^9, 
   3.628966710146928*^9}, {3.628966869725415*^9, 3.628966912228834*^9}, {
   3.628966948468549*^9, 3.628966949290099*^9}, {3.6289673363452253`*^9, 
   3.628967353506176*^9}, {3.6289676452455597`*^9, 3.6289676457573967`*^9}, {
   3.628967781814322*^9, 3.6289677819433537`*^9}, {3.628968236310218*^9, 
   3.6289682387805243`*^9}, {3.628968329748756*^9, 3.628968390966511*^9}, {
   3.628968542693602*^9, 3.6289685565836287`*^9}, {3.6289685940599937`*^9, 
   3.6289686178195963`*^9}, {3.628968652489336*^9, 3.6289686656876783`*^9}, {
   3.628968769176489*^9, 3.628968803925569*^9}, {3.6289688458977833`*^9, 
   3.628968890260056*^9}, {3.628968951975848*^9, 3.6289689768375807`*^9}, {
   3.6289690320238733`*^9, 3.628969044857685*^9}, {3.628969130467214*^9, 
   3.628969132147463*^9}, {3.62896924968056*^9, 3.6289693633041563`*^9}, {
   3.628969411179996*^9, 3.628969463225636*^9}, {3.6289695352085*^9, 
   3.6289695374578*^9}, {3.628970275194438*^9, 3.628970275330985*^9}, {
   3.628970316558612*^9, 3.62897031706966*^9}, 3.628970374686137*^9, {
   3.628970853716144*^9, 3.62897088376677*^9}, {3.6289712331636047`*^9, 
   3.628971243066592*^9}, {3.6289716035999823`*^9, 3.6289716128449507`*^9}, {
   3.628971646538191*^9, 3.628971697009499*^9}, {3.6289722555393353`*^9, 
   3.628972256531155*^9}, {3.628972301393216*^9, 3.628972339913679*^9}, {
   3.628972601108115*^9, 3.628972605812707*^9}, {3.6289733176781282`*^9, 
   3.628973389200584*^9}, {3.628974340523288*^9, 3.628974365437969*^9}, {
   3.628974428789467*^9, 3.62897444074081*^9}, {3.628975132518531*^9, 
   3.628975160183399*^9}, {3.6289752837051153`*^9, 3.6289753243357983`*^9}, {
   3.6289755151065693`*^9, 3.628975578553282*^9}, {3.6289759224436817`*^9, 
   3.628975926425726*^9}, {3.628976020219738*^9, 3.628976020618557*^9}, {
   3.628976076320745*^9, 3.628976135152931*^9}, {3.628976847455429*^9, 
   3.628976853142477*^9}, 3.628977038482304*^9, {3.628977173826033*^9, 
   3.628977173931242*^9}, {3.6290345551923018`*^9, 3.6290349927947607`*^9}, {
   3.629035035846673*^9, 3.629035113980507*^9}, {3.6290351479076567`*^9, 
   3.629035162109894*^9}, {3.629035220502077*^9, 3.629035228642988*^9}, {
   3.629035327596466*^9, 3.6290354724463987`*^9}, {3.629035505518009*^9, 
   3.629035509699416*^9}, 3.629061043779847*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"sAA1", " ", "=", " ", 
   FractionBox[
    RowBox[{"-", "H1"}], 
    RowBox[{"4", " ", "kp", " ", "ks"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sAA2", " ", "=", " ", 
   FractionBox[
    RowBox[{"-", "H2"}], 
    RowBox[{"4", " ", "kp", " ", "ks"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sBB1", " ", "=", " ", 
   FractionBox[
    RowBox[{" ", 
     RowBox[{"-", "H3"}]}], 
    RowBox[{"4", " ", "kp", " ", "ks"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sBB2", " ", "=", " ", 
   FractionBox[
    RowBox[{"-", "H4"}], 
    RowBox[{"4", " ", "kp", " ", "ks"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sEE", " ", "=", " ", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    RowBox[{"(", 
     RowBox[{"B7", "+", 
      RowBox[{"C5", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"P1", " ", "D1"}], "+", 
         RowBox[{"P2", " ", "D2"}]}], ")"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sFF", " ", "=", " ", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    RowBox[{"(", 
     RowBox[{"B8", "+", 
      RowBox[{"C5", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"P3", " ", "D3"}], "+", 
         RowBox[{"P4", " ", "D4"}]}], ")"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sGG", " ", "=", " ", 
   RowBox[{
    FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", "ks", "  ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "P1"}], " ", "M1"}], "+", 
      RowBox[{"P2", " ", "M2"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sHH", " ", "=", " ", 
   RowBox[{
    FractionBox["1", "2"], " ", "\[Rho]", " ", "\[ImaginaryI]", 
    RowBox[{"(", "  ", 
     RowBox[{"B6", "-", "  ", 
      RowBox[{"ks", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"P3", " ", "B3"}], "-", " ", 
         RowBox[{"P4", " ", "B4"}]}], ")"}]}]}], " ", ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sII", " ", "=", " ", 
    RowBox[{
     FractionBox["1", "4"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "\[ImaginaryI]", "  ", "K1", " ", "B6"}], "-", 
       RowBox[{"2", "C2", " ", "\[Psi]s"}], "-", 
       RowBox[{"kp", " ", "ks", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["\[Rho]", "2"], 
           RowBox[{"(", 
            RowBox[{"Q3", "+", "Q4"}], ")"}]}], " ", "+", "Q1", " ", "+", 
          "Q2"}], ")"}]}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{"sII", "-", " ", "II"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->CompressedData["
1:eJwd0mtM02cUx/EClU1kiTMqJkOHyKYyNzEyb7FaBy0OxEAxwGBMQGQDFeaQ
cGnASImyTowWQXS0giJeNlzEySpeuEhBlokISLd6mYyLEImVIUqLqP3+Xzz5
5PfmnJNznrmxyYqt9iKRaIPtoZvzSsXvk5+su1MwuAUvOimS0ZhxIAUVu/Qq
/Di8qQhNva+0WFw+TYdZJvkJPJcVLZj4aUoFBmlPncEEQ+x5tHfoqsK9F/z0
OJToewV7Ux1r8cNdH9SjQ5C7AVeN7WzG+/1H/8LWn5xvCXXrn7dh+7iyB0un
BzzGZ2KtGUu2nR7FFtXCMWy0zp7A7mTRu5dszh1tmYKhdkfeR8/qzpn4JqNw
FnqFdLjj1mStB1pDVKsxz5Qux1MBlRtRmZgThP8H+4XicPO0KIz7s1CJbvnB
WaiLNebgAp/FKvxsZWi9kKf43kBFg6wF/474/CHWXTr4Hz7q/acHmx4GDqDl
t7FBvLdu2IzSRj+7apudLpJJ6FYeIBiz7OkSlEYtXIqW0lursOpcvAwDvi3/
Ep1vdijwQN6LMPx+Xl8Cxn2dsxNfy5an4U2zoxL1UotgpEvMHty3PUiDYi/3
43j4cUQZanwuVAu5wrsGUxcFXsdWndSAm/TlRoyPP2JGu4bREZzqJLfg0+zi
CWxSq5z+4J9l+0/FiGsTs3G4Mmw+/rw+VlCtnf8JHqx9uQJfzBBLUJPpL8PW
Eh9/bNzbFYJJDyThGOXyVSQmGl1jsKjg5HdYM71uO2b+kJaFP6q/UWF0xlAu
7vtoQo2vd3vvF/oZejR4rEisw3llcb/gVWn6efT0LbyIi7fdrhfmsA4aML89
4Q6u0W00ovfMNJOQE/TdaG0TDaC8e8sQlnj0jeM1w78OevY3Ev8Otr7X7oH3
O+sWoKPbgBd29ZcFYtuizXno+qhJg1Xd0VpsPpT0K+YWmK+gfYnkBuYfO2p3
mfv5hNnj1eDLa9F621OKRZFhcnT9Im0Dzmk7sxn7a5VxGJ6buQMdJYYkFJ/N
TkVL2RvB9UuKczF93F2Npo6U03dtLpcNCPY5Pa/D4yM1DaiunPEASzuyBSvX
7nDosjmpol3wLaDcYEI=
  "]],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.628976856241349*^9, 3.628976932311015*^9}, 
   3.628977008506173*^9, {3.628977068327655*^9, 3.628977072293933*^9}, {
   3.6289771811473913`*^9, 3.628977233450714*^9}, {3.6290348081688557`*^9, 
   3.6290348158197527`*^9}, {3.629035013113213*^9, 3.629035030518417*^9}, 
   3.629035244378213*^9, {3.629035545578897*^9, 3.6290355509382973`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SubsR", " ", "=", "  ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"A1", " ", "\[Rule]", " ", "rrA1"}], ",", " ", 
       RowBox[{"A2", " ", "\[Rule]", " ", "rA2"}], ",", " ", 
       RowBox[{"B1", " ", "\[Rule]", " ", "rB1"}], ",", " ", 
       RowBox[{"B2", " ", "\[Rule]", " ", "rB2"}], ",", " ", 
       RowBox[{"Ca", " ", "\[Rule]", " ", "rCa"}], ",", " ", 
       RowBox[{
        RowBox[{"ks", " ", "rCa"}], " ", "\[Rule]", " ", "rC1a"}], ",", " ", 
       RowBox[{
        RowBox[{"kp", "*", "rC1a"}], " ", "\[Rule]", " ", "rC1"}], ",", " ", 
       RowBox[{"C2", " ", "\[Rule]", " ", "rC2"}], ",", " ", 
       RowBox[{"C3", " ", "\[Rule]", " ", "rC3"}], ",", " ", 
       RowBox[{"C4", " ", "\[Rule]", " ", "rC4"}], ",", " ", 
       RowBox[{"C5", " ", "\[Rule]", " ", "rC5"}], ",", " ", 
       RowBox[{"C6", " ", "\[Rule]", " ", "rC6"}], ",", " ", 
       RowBox[{"G1", " ", "\[Rule]", " ", "rG1"}], ",", " ", 
       RowBox[{"G2", " ", "\[Rule]", " ", "rG2"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "sAA1"}]}]], "Input",
 CellChangeTimes->{{3.6289768803698473`*^9, 3.6289768840484667`*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"\[ImaginaryI]", " ", "kp", " ", "L", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Xi]1"}], ")"}]}], "-", 
    RowBox[{"\[ImaginaryI]", " ", "ks", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "z0"}], "-", 
       RowBox[{"L", " ", "\[Xi]1"}]}], ")"}]}], "+", 
    RowBox[{"kp", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["Wx", "2"], "+", 
       RowBox[{
        SuperscriptBox["Wfs", "2"], " ", "\[Phi]s"}]}], ")"}]}]}], 
   RowBox[{"4", " ", "kp", " ", "ks"}]]}]], "Output",
 CellChangeTimes->{3.628976884561861*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1920, 1036},
WindowMargins->{{-199, Automatic}, {896, Automatic}},
Magnification->1.5,
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (October 5, \
2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 103, 1, 114, "Title"],
Cell[685, 25, 145, 2, 69, "Subtitle"],
Cell[833, 29, 1345, 46, 119, "Input"],
Cell[2181, 77, 2238, 71, 267, "Input"],
Cell[4422, 150, 679, 20, 40, "Input"],
Cell[5104, 172, 347, 5, 80, "Text"],
Cell[CellGroupData[{
Cell[5476, 181, 126, 2, 69, "Subtitle"],
Cell[5605, 185, 1931, 61, 189, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7573, 251, 160, 2, 69, "Subtitle"],
Cell[7736, 255, 577, 16, 47, "Input"],
Cell[8316, 273, 722, 22, 97, "Input"],
Cell[CellGroupData[{
Cell[9063, 299, 100, 1, 39, "Subsubtitle"],
Cell[CellGroupData[{
Cell[9188, 304, 1047, 32, 183, "Input"],
Cell[10238, 338, 491, 10, 32, "Message"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[10790, 355, 206, 4, 69, "Subtitle"],
Cell[10999, 361, 2928, 84, 161, "Input"],
Cell[13930, 447, 163, 2, 39, "Text"],
Cell[14096, 451, 4722, 133, 425, "Input"],
Cell[18821, 586, 140, 2, 45, "Text"],
Cell[18964, 590, 3212, 101, 633, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[22225, 697, 109, 1, 114, "Title"],
Cell[22337, 700, 2065, 59, 170, "Input"],
Cell[24405, 761, 120, 1, 39, "Text"],
Cell[24528, 764, 1006, 30, 94, "Input"],
Cell[CellGroupData[{
Cell[25559, 798, 19490, 546, 1305, "Input"],
Cell[45052, 1346, 1032, 28, 73, "Output"],
Cell[46087, 1376, 1075, 29, 73, "Output"],
Cell[47165, 1407, 987, 26, 73, "Output"],
Cell[48155, 1435, 1052, 28, 73, "Output"],
Cell[49210, 1465, 332, 4, 40, "Output"]
}, Open  ]],
Cell[49557, 1472, 12267, 307, 1629, "Input"],
Cell[CellGroupData[{
Cell[61849, 1783, 3917, 109, 597, "Input"],
Cell[65769, 1894, 392, 5, 40, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[66198, 1904, 1200, 24, 87, "Input"],
Cell[67401, 1930, 632, 19, 73, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
