(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    222410,       5839]
NotebookOptionsPosition[    216845,       5678]
NotebookOutlinePosition[    217199,       5694]
CellTagsIndexPosition[    217156,       5691]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Figure", " ", "out", " ", "the", " ", "rotation", " ", "that", " ", 
    "puts", " ", "the", " ", "signal", " ", "and", " ", "idler", " ", "into", 
    " ", "the", " ", "pump", " ", 
    RowBox[{"coordinates", ".", " ", "Here"}], " ", "\[Theta]", " ", "is", 
    " ", "the", " ", "opening", " ", "angle", " ", "and", " ", "\[Phi]", " ", 
    "is", " ", "the", " ", "azimuthal", " ", 
    RowBox[{"angle", "."}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"RotX", ":=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", " ", "0", ",", " ", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", 
        RowBox[{"-", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}], "}"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"RotZ", ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}], ",", " ", "0"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", " ", "0"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"RotY", " ", ":=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Gamma]", "]"}], ",", "0", ",", " ", 
        RowBox[{"-", 
         RowBox[{"Sin", "[", "\[Gamma]", "]"}]}]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", "  ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Gamma]", "]"}], ",", "0", ",", "  ", 
        RowBox[{"Cos", "[", "\[Gamma]", "]"}]}], "}"}]}], "}"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"RotX", ":=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", " ", "0", ",", " ", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
        RowBox[{"-", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}], ",", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}], "}"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"RotZ", ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", 
        RowBox[{"-", 
         RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", " ", "0"}], "}"}], ",", 
      " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Phi]", "]"}], ",", " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", " ", "0"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"RotY", " ", ":=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Gamma]", "]"}], ",", "0", ",", " ", 
        RowBox[{"Sin", "[", "\[Gamma]", "]"}]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", "  ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Sin", "[", "\[Gamma]", "]"}]}], ",", "0", ",", "  ", 
        RowBox[{"Cos", "[", "\[Gamma]", "]"}]}], "}"}]}], "}"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RotZLab", " ", ":=", " ", "RotY"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RotXLab", " ", ":=", " ", "RotZ"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RotYLab", " ", ":=", " ", "RotX"}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{"RotTrans", "=", 
    RowBox[{"RotX", " ", ".", " ", "RotZ"}]}], "\[IndentingNewLine]", 
   RowBox[{"RotPumpwrtXtal", " ", "=", " ", 
    RowBox[{"RotX", ".", "RotZ"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Expand", "[", 
    RowBox[{
     RowBox[{"RotXLab", ".", 
      RowBox[{"{", 
       RowBox[{"x1", ",", "y1", ",", "z1"}], "}"}]}], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"z1", "\[Rule]", 
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", 
           SubscriptBox["\[Gamma]", "p"], "]"}], "*", "x"}], " ", "-", 
         RowBox[{
          RowBox[{"Sin", "[", 
           SubscriptBox["\[Gamma]", "p"], "]"}], "*", "z"}]}]}], ",", 
       RowBox[{"x1", "\[Rule]", " ", "y"}], ",", " ", 
       RowBox[{"y1", "\[Rule]", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           SubscriptBox["\[Gamma]", "p"], "]"}], "*", "x"}], " ", "-", 
         RowBox[{
          RowBox[{"Cos", "[", 
           SubscriptBox["\[Gamma]", "p"], "]"}], "*", "z"}]}]}]}], "}"}]}], 
    "]"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.582551082707974*^9, 3.582551243412228*^9}, {
   3.582552241600596*^9, 3.58255248525065*^9}, {3.5825530886487722`*^9, 
   3.582553091710619*^9}, {3.582581931220381*^9, 3.582581994221595*^9}, {
   3.582589736354864*^9, 3.58258979384231*^9}, {3.582589853214909*^9, 
   3.582589939808462*^9}, {3.582590073974887*^9, 3.5825900784620047`*^9}, {
   3.582591942003405*^9, 3.5825919557241173`*^9}, {3.582592064468408*^9, 
   3.582592070390641*^9}, {3.582592168312223*^9, 3.582592195349346*^9}, {
   3.582592537371162*^9, 3.5825925389767017`*^9}, {3.582592609833417*^9, 
   3.582592630132695*^9}, {3.582594727920084*^9, 3.5825947541563683`*^9}, {
   3.582594786928154*^9, 3.582594837727318*^9}, {3.582594872553235*^9, 
   3.5825948732121487`*^9}, 3.582594919516144*^9, {3.582595006307055*^9, 
   3.58259502779462*^9}, {3.582595382427409*^9, 3.5825953955679607`*^9}, {
   3.582595429725254*^9, 3.582595511584939*^9}, {3.582595567715238*^9, 
   3.58259556798405*^9}, {3.5825957007377663`*^9, 3.5825957096247883`*^9}, {
   3.582595744582691*^9, 3.582595792538672*^9}, {3.582596036605506*^9, 
   3.5825960731972313`*^9}, {3.582596118612314*^9, 3.58259612941899*^9}, {
   3.582596292204793*^9, 3.5825963567715073`*^9}, {3.582596404384987*^9, 
   3.5825964610317802`*^9}, {3.5825968755404663`*^9, 3.582596891139832*^9}, 
   3.582597031324554*^9, {3.582597263234353*^9, 3.582597287940269*^9}, {
   3.5825973900652647`*^9, 3.582597396723194*^9}, {3.582597641860304*^9, 
   3.582597661706188*^9}, 3.582597849090914*^9, 3.582597885135263*^9, {
   3.5826762909693413`*^9, 3.582676292040473*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", 
     RowBox[{"-", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{"-", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
     RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.582552444028955*^9, {3.5825524768158484`*^9, 3.58255248583467*^9}, 
   3.582553092284441*^9, 3.5825618446706257`*^9, 3.582562059850234*^9, 
   3.5825639137479687`*^9, 3.5825646028075247`*^9, 3.582589879404048*^9, 
   3.5825899430288973`*^9, 3.5825900795342007`*^9, 3.582591956253748*^9, 
   3.582592071304824*^9, 3.582592198860856*^9, 3.582592540073839*^9, 
   3.582592631343177*^9, {3.582594730533414*^9, 3.5825947548183117`*^9}, {
   3.5825947953033247`*^9, 3.5825948399508038`*^9}, 3.582594874072584*^9, 
   3.582594920512519*^9, {3.582595009573421*^9, 3.5825950289301023`*^9}, 
   3.582595513334758*^9, 3.582595573438884*^9, 3.582595710901108*^9, 
   3.5825957955808153`*^9, 3.582596130526894*^9, {3.58259634392697*^9, 
   3.5825963601608133`*^9}, {3.5825964436037817`*^9, 3.5825964616825857`*^9}, 
   3.582596892086608*^9, 3.582597032157957*^9, {3.5825972667057037`*^9, 
   3.582597288407114*^9}, 3.582597397547275*^9, 3.5825976633763227`*^9, 
   3.582597850259058*^9, 3.582597885907909*^9, 3.582673481170102*^9, 
   3.589146138215351*^9, 3.5891619141542664`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", 
     RowBox[{"-", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{"-", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
     RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.582552444028955*^9, {3.5825524768158484`*^9, 3.58255248583467*^9}, 
   3.582553092284441*^9, 3.5825618446706257`*^9, 3.582562059850234*^9, 
   3.5825639137479687`*^9, 3.5825646028075247`*^9, 3.582589879404048*^9, 
   3.5825899430288973`*^9, 3.5825900795342007`*^9, 3.582591956253748*^9, 
   3.582592071304824*^9, 3.582592198860856*^9, 3.582592540073839*^9, 
   3.582592631343177*^9, {3.582594730533414*^9, 3.5825947548183117`*^9}, {
   3.5825947953033247`*^9, 3.5825948399508038`*^9}, 3.582594874072584*^9, 
   3.582594920512519*^9, {3.582595009573421*^9, 3.5825950289301023`*^9}, 
   3.582595513334758*^9, 3.582595573438884*^9, 3.582595710901108*^9, 
   3.5825957955808153`*^9, 3.582596130526894*^9, {3.58259634392697*^9, 
   3.5825963601608133`*^9}, {3.5825964436037817`*^9, 3.5825964616825857`*^9}, 
   3.582596892086608*^9, 3.582597032157957*^9, {3.5825972667057037`*^9, 
   3.582597288407114*^9}, 3.582597397547275*^9, 3.5825976633763227`*^9, 
   3.582597850259058*^9, 3.582597885907909*^9, 3.582673481170102*^9, 
   3.589146138215351*^9, 3.5891619141566477`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"y", " ", 
     RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "+", 
    RowBox[{"z", " ", 
     RowBox[{"Cos", "[", 
      SubscriptBox["\[Gamma]", "p"], "]"}], " ", 
     RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "-", 
    RowBox[{"x", " ", 
     RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
     RowBox[{"Sin", "[", 
      SubscriptBox["\[Gamma]", "p"], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "z"}], " ", 
     RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
     RowBox[{"Cos", "[", 
      SubscriptBox["\[Gamma]", "p"], "]"}]}], "+", 
    RowBox[{"y", " ", 
     RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "+", 
    RowBox[{"x", " ", 
     RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
     RowBox[{"Sin", "[", 
      SubscriptBox["\[Gamma]", "p"], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"x", " ", 
     RowBox[{"Cos", "[", 
      SubscriptBox["\[Gamma]", "p"], "]"}]}], "-", 
    RowBox[{"z", " ", 
     RowBox[{"Sin", "[", 
      SubscriptBox["\[Gamma]", "p"], "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.582552444028955*^9, {3.5825524768158484`*^9, 3.58255248583467*^9}, 
   3.582553092284441*^9, 3.5825618446706257`*^9, 3.582562059850234*^9, 
   3.5825639137479687`*^9, 3.5825646028075247`*^9, 3.582589879404048*^9, 
   3.5825899430288973`*^9, 3.5825900795342007`*^9, 3.582591956253748*^9, 
   3.582592071304824*^9, 3.582592198860856*^9, 3.582592540073839*^9, 
   3.582592631343177*^9, {3.582594730533414*^9, 3.5825947548183117`*^9}, {
   3.5825947953033247`*^9, 3.5825948399508038`*^9}, 3.582594874072584*^9, 
   3.582594920512519*^9, {3.582595009573421*^9, 3.5825950289301023`*^9}, 
   3.582595513334758*^9, 3.582595573438884*^9, 3.582595710901108*^9, 
   3.5825957955808153`*^9, 3.582596130526894*^9, {3.58259634392697*^9, 
   3.5825963601608133`*^9}, {3.5825964436037817`*^9, 3.5825964616825857`*^9}, 
   3.582596892086608*^9, 3.582597032157957*^9, {3.5825972667057037`*^9, 
   3.582597288407114*^9}, 3.582597397547275*^9, 3.5825976633763227`*^9, 
   3.582597850259058*^9, 3.582597885907909*^9, 3.582673481170102*^9, 
   3.589146138215351*^9, 3.589161914158633*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    SubscriptBox["x", "s"], " ", ":=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Phi]", "s"], "]"}], "*", "x"}], " ", "-", 
     RowBox[{
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Phi]", "s"], "]"}], "*", "y"}]}]}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["y", "s"], ":=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Theta]", "s"], "]"}], "*", 
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Phi]", "s"], "]"}], "*", "x"}], " ", "+", " ", 
     RowBox[{
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Theta]", "s"], "]"}], "*", 
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Phi]", "s"], "]"}], "*", "y"}], " ", "-", " ", 
     RowBox[{
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Theta]", "s"], "]"}], "*", "z"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["z", "s"], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Theta]", "s"], "]"}], "*", 
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Phi]", "s"], "]"}], "*", "x"}], " ", "+", " ", 
     RowBox[{
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Theta]", "s"], "]"}], "*", 
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Phi]", "s"], "]"}], "*", "y"}], " ", "+", " ", 
     RowBox[{
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Theta]", "s"], "]"}], "*", "z"}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"planarrules", " ", ":=", " ", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["\[Phi]", "s"], " ", "\[Rule]", " ", "0"}], "}"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"rulescoord", " ", ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Theta]", "s"], "\[Rule]", 
       SubscriptBox["\[Theta]", "i"]}], ",", "  ", 
      RowBox[{
       SubscriptBox["\[Phi]", "s"], " ", "\[Rule]", " ", "\[Pi]"}]}], " ", 
     "}"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["x", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["x", 
      RowBox[{"s", " "}]], "//.", "rulescoord"}]}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["y", "i"], "=", " ", 
    RowBox[{
     SubscriptBox["y", 
      RowBox[{"s", " "}]], "//.", "rulescoord"}]}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["z", "i"], "=", " ", 
    RowBox[{
     SubscriptBox["z", 
      RowBox[{"s", " "}]], "//.", "rulescoord"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["x", "s"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["x", "s"], " ", "//.", " ", "planarrules"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["y", "s"], "=", " ", 
    RowBox[{
     SubscriptBox["y", 
      RowBox[{"s", " "}]], "//.", "planarrules"}]}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["z", "s"], "=", " ", 
    RowBox[{
     SubscriptBox["z", 
      RowBox[{"s", " "}]], "//.", "planarrules"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     SubscriptBox["x", "p"], " ", ":=", " ", 
     RowBox[{
      RowBox[{"x", " ", "+", " ", 
       RowBox[{
        SubscriptBox["\[Rho]", "px"], "*", "z", "\[IndentingNewLine]", 
        SubscriptBox["y", "p"]}]}], ":=", " ", "y"}]}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["x", "p"], " ", "=", " ", "x"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["y", "p"], ":=", " ", "y"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Introduce", " ", "the", " ", "assumption", " ", "that", " ", "the", " ", 
     "Rayleigh", " ", "range", " ", "is", " ", "much", " ", "longer", " ", 
     "than", " ", "the", " ", "crystal", " ", "length", " ", "and", " ", 
     "the", " ", "waist", " ", "can", " ", "be", " ", "treated", " ", "as", 
     " ", "a", " ", 
     RowBox[{"constant", ".", " ", "This"}], " ", "dramatically", " ", 
     "simplifies", " ", 
     RowBox[{"things", "."}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"rules2", " ", ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SubscriptBox["q", "p"], " ", "\[Rule]", " ", 
       SuperscriptBox[
        SubscriptBox["W", "p"], "2"]}], " ", ",", " ", 
      RowBox[{
       SubscriptBox["q", "s"], " ", "\[Rule]", " ", 
       SuperscriptBox[
        SubscriptBox["W", "s"], "2"]}], " ", ",", " ", 
      RowBox[{
       SubscriptBox["q", "i"], " ", "\[Rule]", " ", 
       SuperscriptBox[
        SubscriptBox["W", "i"], "2"]}]}], " ", "}"}]}], " ", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.582553100047619*^9, 3.582553370588112*^9}, {
   3.5825820388549013`*^9, 3.582582169072603*^9}, {3.582587357577043*^9, 
   3.582587413066751*^9}, {3.582598276658927*^9, 3.582598320894418*^9}, {
   3.5825983892377157`*^9, 3.582598627247916*^9}, {3.58259866828645*^9, 
   3.582598704826029*^9}, {3.582600519865554*^9, 3.582600593785883*^9}, {
   3.582600716528623*^9, 3.5826007425499573`*^9}, {3.582672343066288*^9, 
   3.582672343360055*^9}, {3.582674823189691*^9, 3.5826748239251747`*^9}, 
   3.582676449697198*^9, {3.582676542418489*^9, 3.582676542619144*^9}, {
   3.589145806714732*^9, 3.58914605264056*^9}, {3.589146147816297*^9, 
   3.5891461584586277`*^9}, {3.58914618983179*^9, 3.5891461948141823`*^9}, {
   3.5891462325466146`*^9, 3.589146255351*^9}}],

Cell[BoxData[
 RowBox[{"-", "x"}]], "Output",
 CellChangeTimes->{{3.58914623300576*^9, 3.589146255711026*^9}, 
   3.589161914220317*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "y"}], " ", 
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Theta]", "i"], "]"}]}], "-", 
  RowBox[{"z", " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Theta]", "i"], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.58914623300576*^9, 3.589146255711026*^9}, 
   3.589161914222343*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"z", " ", 
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Theta]", "i"], "]"}]}], "-", 
  RowBox[{"y", " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Theta]", "i"], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.58914623300576*^9, 3.589146255711026*^9}, 
   3.589161914223872*^9}],

Cell[BoxData["x"], "Output",
 CellChangeTimes->{{3.58914623300576*^9, 3.589146255711026*^9}, 
   3.589161914225387*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"y", " ", 
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Theta]", "s"], "]"}]}], "-", 
  RowBox[{"z", " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Theta]", "s"], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.58914623300576*^9, 3.589146255711026*^9}, 
   3.5891619142268476`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"z", " ", 
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Theta]", "s"], "]"}]}], "+", 
  RowBox[{"y", " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Theta]", "s"], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.58914623300576*^9, 3.589146255711026*^9}, 
   3.5891619142283697`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "These", " ", "are", " ", "the", " ", "normalization", " ", "coefficients",
     " ", "for", " ", "the", " ", "three", " ", "Gaussians"}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["n", "s"], " ", "=", " ", 
     RowBox[{
      RowBox[{
       SubscriptBox["W", "s"], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"\[Pi]", "/", "2"}], "]"}], "*", 
         SubscriptBox["q", "s"]}], ")"}]}], " ", "//.", "rules2"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["n", "i"], " ", "=", " ", 
     RowBox[{
      RowBox[{
       SubscriptBox["W", "i"], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"\[Pi]", "/", "2"}], "]"}], "*", 
         SubscriptBox["q", "i"]}], ")"}]}], " ", "//.", "rules2"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["n", "p"], " ", "=", " ", 
     RowBox[{
      RowBox[{
       SubscriptBox["W", "p"], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"\[Pi]", "/", "2"}], "]"}], "*", 
         SubscriptBox["q", "p"]}], ")"}]}], " ", "//.", " ", "rules2"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.582676438761138*^9, 3.582676528731468*^9}, {
  3.582676729795623*^9, 3.5826767327704906`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Here", " ", "is", " ", "the", " ", "argument", " ", "in", " ", "the", 
     " ", "exponential", " ", "that", " ", "we", " ", "will", " ", "want", 
     " ", "to", " ", "integrate", " ", "over", " ", "wrt", " ", "to", " ", 
     "x"}], ",", " ", "y", ",", " ", 
    RowBox[{"and", " ", 
     RowBox[{"z", "."}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Arg1", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "1"}], "/", 
       RowBox[{"(", 
        RowBox[{"2", "*", 
         SubscriptBox["q", "s"]}], ")"}]}], "*", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["x", "s"], "2"], "+", 
        SuperscriptBox[
         SubscriptBox["y", "s"], "2"]}], ")"}]}], "-", 
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{"2", "*", 
         SubscriptBox["q", "i"]}], ")"}]}], 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["x", "i"], "2"], "+", 
        SuperscriptBox[
         SubscriptBox["y", "i"], "2"]}], ")"}]}], "-", 
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{"2", "*", 
         SubscriptBox["q", "p"]}], ")"}]}], "*", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["x", "p"], "2"], "+", 
        SuperscriptBox[
         SubscriptBox["y", "p"], "2"]}], ")"}]}], " ", "-", " ", 
     RowBox[{"\[ImaginaryI]", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[CapitalDelta]K", "x"], "*", "x"}], " ", "+", " ", 
        RowBox[{
         SubscriptBox["\[CapitalDelta]K", "y"], "*", "y"}], "+", 
        RowBox[{
         SubscriptBox["\[CapitalDelta]K", "z"], "*", "z"}]}], ")"}]}]}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.5825533941941223`*^9, 3.5825535539588547`*^9}, {
   3.5825536033128633`*^9, 3.582553608767806*^9}, 3.582553712131874*^9, {
   3.582553783669939*^9, 3.58255382316961*^9}, {3.582561756372466*^9, 
   3.582561771923471*^9}, 3.582561807119581*^9, {3.582562474614017*^9, 
   3.582562499613974*^9}, {3.582582135209609*^9, 3.5825821366901712`*^9}, {
   3.582600600836162*^9, 3.5826006048984003`*^9}, {3.582676452509242*^9, 
   3.582676454063005*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     SuperscriptBox["x", "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "y"}], " ", 
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Theta]", "i"], "]"}]}], "-", 
        RowBox[{"z", " ", 
         RowBox[{"Sin", "[", 
          SubscriptBox["\[Theta]", "i"], "]"}]}]}], ")"}], "2"]}], 
    RowBox[{"2", " ", 
     SubscriptBox["q", "i"]}]]}], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["x", "2"], "+", 
    SuperscriptBox["y", "2"]}], 
   RowBox[{"2", " ", 
    SubscriptBox["q", "p"]}]], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["x", "2"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"y", " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "s"], "]"}]}], "-", 
       RowBox[{"z", " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["\[Theta]", "s"], "]"}]}]}], ")"}], "2"]}], 
   RowBox[{"2", " ", 
    SubscriptBox["q", "s"]}]], "-", 
  RowBox[{"\[ImaginaryI]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"x", " ", 
      SubscriptBox["\[CapitalDelta]K", "x"]}], "+", 
     RowBox[{"y", " ", 
      SubscriptBox["\[CapitalDelta]K", "y"]}], "+", 
     RowBox[{"z", " ", 
      SubscriptBox["\[CapitalDelta]K", "z"]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.58256180748381*^9, 3.582561846689802*^9}, 
   3.582562060001554*^9, 3.582563913925955*^9, 3.582564602920834*^9, 
   3.582598710476437*^9, {3.5826006077291937`*^9, 3.582600617694231*^9}, 
   3.5826007461601562`*^9, 3.582672352712099*^9, 3.582673481288066*^9, 
   3.589146169458254*^9, 3.589146207276558*^9, 3.589146287489303*^9, 
   3.589161914288209*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"CompleteSquare", "[", 
   RowBox[{"f_", ",", "x_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"c", ",", "b", ",", "a"}], "}"}], "=", 
      RowBox[{"CoefficientList", "[", 
       RowBox[{"f", ",", "x"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x", "+", 
          RowBox[{
           RowBox[{"b", "/", "2"}], "/", "a"}]}], ")"}], "^", "2"}]}], "+", 
      RowBox[{"Simplify", "[", 
       RowBox[{"(", 
        RowBox[{"c", "-", 
         RowBox[{
          RowBox[{
           RowBox[{"b", "^", "2"}], "/", "4"}], "/", "a"}]}], ")"}], 
       "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.5826006354303637`*^9, 3.582600636310912*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "First", " ", "we", " ", "complete", " ", "the", " ", "square", " ", "wrt",
     " ", "to", " ", 
    RowBox[{"x", ".", " ", "This"}], " ", "makes", " ", "it", " ", "easier", 
    " ", "to", " ", "analytically", " ", "carry", " ", "out", " ", "the", " ", 
    RowBox[{"integration", "."}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"Arg1", " ", "=", " ", 
   RowBox[{"CompleteSquare", "[", 
    RowBox[{"Arg1", ",", " ", "x"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.5825537185392857`*^9, 3.582553738312705*^9}, {
  3.582582174512424*^9, 3.582582196639732*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SubscriptBox["q", "i"]}]]}], "-", 
     FractionBox["1", 
      RowBox[{"2", " ", 
       SubscriptBox["q", "p"]}]], "-", 
     FractionBox["1", 
      RowBox[{"2", " ", 
       SubscriptBox["q", "s"]}]]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"x", "-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        SubscriptBox["\[CapitalDelta]K", "x"]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["1", 
            RowBox[{"2", " ", 
             SubscriptBox["q", "i"]}]]}], "-", 
          FractionBox["1", 
           RowBox[{"2", " ", 
            SubscriptBox["q", "p"]}]], "-", 
          FractionBox["1", 
           RowBox[{"2", " ", 
            SubscriptBox["q", "s"]}]]}], ")"}]}]]}], ")"}], "2"]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", " ", 
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "i"], "]"}]}], "+", 
           RowBox[{"z", " ", 
            RowBox[{"Sin", "[", 
             SubscriptBox["\[Theta]", "i"], "]"}]}]}], ")"}], "2"]}], 
       SubscriptBox["q", "i"]]}], "-", 
     FractionBox[
      RowBox[{"2", " ", 
       SuperscriptBox["y", "2"]}], 
      SubscriptBox["q", "p"]], "-", 
     FractionBox[
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"y", " ", 
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}]}], "-", 
          RowBox[{"z", " ", 
           RowBox[{"Sin", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}]}]}], ")"}], "2"]}], 
      SubscriptBox["q", "s"]], "-", 
     FractionBox[
      RowBox[{"2", " ", 
       SubscriptBox["q", "i"], " ", 
       SubscriptBox["q", "p"], " ", 
       SubscriptBox["q", "s"], " ", 
       SubsuperscriptBox["\[CapitalDelta]K", "x", "2"]}], 
      RowBox[{
       RowBox[{
        SubscriptBox["q", "p"], " ", 
        SubscriptBox["q", "s"]}], "+", 
       RowBox[{
        SubscriptBox["q", "i"], " ", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["q", "p"], "+", 
          SubscriptBox["q", "s"]}], ")"}]}]}]], "-", 
     RowBox[{"4", " ", "\[ImaginaryI]", " ", "y", " ", 
      SubscriptBox["\[CapitalDelta]K", "y"]}], "-", 
     RowBox[{"4", " ", "\[ImaginaryI]", " ", "z", " ", 
      SubscriptBox["\[CapitalDelta]K", "z"]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.582553738961458*^9, 3.582553827351152*^9, {3.5825617764989023`*^9, 
   3.5825617944788227`*^9}, 3.5825618560286083`*^9, 3.582562061113029*^9, 
   3.5825639150159817`*^9, 3.58256460401079*^9, 3.5825987247699547`*^9, 
   3.5826006480156393`*^9, 3.5826007544161663`*^9, 3.582672374705593*^9, 
   3.5826734824310417`*^9, 3.589146301545966*^9, 3.589161914913952*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Now", ",", " ", 
    RowBox[{"the", " ", "term", " ", "in", " ", "the", " ", "b", "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"x", "-", "a"}], ")"}], "^", "2"}], " ", "term", " ", 
     "integrates", " ", "to", " ", "a", " ", "constant"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"xconst", ":=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Sqrt]", "\[Pi]"}], "/", 
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["1", 
            RowBox[{"2", " ", 
             SubscriptBox["q", "i"]}]]}], "-", 
          FractionBox["1", 
           RowBox[{"2", " ", 
            SubscriptBox["q", "p"]}]], "-", 
          FractionBox["1", 
           RowBox[{"2", " ", 
            SubscriptBox["q", "s"]}]]}], ")"}]}]}], " ", "//.", "rules2"}], 
     "]"}]}], "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "now", " ", "we", " ", "can", " ", "do", " ", "the", " ", "remaining", 
     " ", "integral", " ", "wrt", " ", "y", " ", "and", " ", "complete", " ", 
     "the", " ", "square", " ", "agaim"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"yArg", ":=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      FractionBox["1", "4"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"2", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"y", " ", 
               RowBox[{"Cos", "[", 
                SubscriptBox["\[Theta]", "i"], "]"}]}], "+", 
              RowBox[{"z", " ", 
               RowBox[{"Sin", "[", 
                SubscriptBox["\[Theta]", "i"], "]"}]}]}], ")"}], "2"]}], 
          SubscriptBox["q", "i"]]}], "-", 
        FractionBox[
         RowBox[{"2", " ", 
          SuperscriptBox["y", "2"]}], 
         SubscriptBox["q", "p"]], "-", 
        FractionBox[
         RowBox[{"2", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", " ", 
              RowBox[{"Cos", "[", 
               SubscriptBox["\[Theta]", "s"], "]"}]}], "-", 
             RowBox[{"z", " ", 
              RowBox[{"Sin", "[", 
               SubscriptBox["\[Theta]", "s"], "]"}]}]}], ")"}], "2"]}], 
         SubscriptBox["q", "s"]], "-", 
        FractionBox[
         RowBox[{"2", " ", 
          SubscriptBox["q", "i"], " ", 
          SubscriptBox["q", "p"], " ", 
          SubscriptBox["q", "s"], " ", 
          SubsuperscriptBox["\[CapitalDelta]K", "x", "2"]}], 
         RowBox[{
          RowBox[{
           SubscriptBox["q", "p"], " ", 
           SubscriptBox["q", "s"]}], "+", 
          RowBox[{
           SubscriptBox["q", "i"], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["q", "p"], "+", 
             SubscriptBox["q", "s"]}], ")"}]}]}]], "-", 
        RowBox[{"4", " ", "\[ImaginaryI]", " ", "y", " ", 
         SubscriptBox["\[CapitalDelta]K", "y"]}], "-", 
        RowBox[{"4", " ", "\[ImaginaryI]", " ", "z", " ", 
         SubscriptBox["\[CapitalDelta]K", "z"]}]}], ")"}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Simplify", "[", "yArg", "]"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"yArg2", "=", 
    RowBox[{"CompleteSquare", "[", 
     RowBox[{"yArg", ",", "y"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.5825538416732683`*^9, 3.5825540262026253`*^9}, {
   3.582554070185461*^9, 3.58255407764716*^9}, 3.5825618686585283`*^9, 
   3.5825619031644173`*^9, {3.582582212811741*^9, 3.5825822216126223`*^9}, {
   3.582598740623023*^9, 3.5825987588152237`*^9}, 3.582598791694824*^9, 
   3.5826007798659353`*^9, {3.582600814519813*^9, 3.5826010290448103`*^9}, 
   3.582601333150104*^9, 3.5826014723118773`*^9, {3.582672389928055*^9, 
   3.5826724027171583`*^9}, {3.582674796730681*^9, 3.5826747992116013`*^9}, 
   3.5891463574943027`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "i"], "]"}], "2"], 
       RowBox[{"2", " ", 
        SubscriptBox["q", "i"]}]]}], "-", 
     FractionBox["1", 
      RowBox[{"2", " ", 
       SubscriptBox["q", "p"]}]], "-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"Cos", "[", 
        SubscriptBox["\[Theta]", "s"], "]"}], "2"], 
      RowBox[{"2", " ", 
       SubscriptBox["q", "s"]}]]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"y", "+", 
      FractionBox[
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"z", " ", 
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "i"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            SubscriptBox["\[Theta]", "i"], "]"}]}], 
          SubscriptBox["q", "i"]]}], "+", 
        FractionBox[
         RowBox[{"z", " ", 
          RowBox[{"Cos", "[", 
           SubscriptBox["\[Theta]", "s"], "]"}], " ", 
          RowBox[{"Sin", "[", 
           SubscriptBox["\[Theta]", "s"], "]"}]}], 
         SubscriptBox["q", "s"]], "-", 
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["\[CapitalDelta]K", "y"]}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              SubscriptBox["\[Theta]", "i"], "]"}], "2"], 
            RowBox[{"2", " ", 
             SubscriptBox["q", "i"]}]]}], "-", 
          FractionBox["1", 
           RowBox[{"2", " ", 
            SubscriptBox["q", "p"]}]], "-", 
          FractionBox[
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "s"], "]"}], "2"], 
           RowBox[{"2", " ", 
            SubscriptBox["q", "s"]}]]}], ")"}]}]]}], ")"}], "2"]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"2", " ", 
        SuperscriptBox["z", "2"], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", 
          SubscriptBox["\[Theta]", "i"], "]"}], "2"]}], 
       SubscriptBox["q", "i"]]}], "-", 
     FractionBox[
      RowBox[{"2", " ", 
       SuperscriptBox["z", "2"], " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", 
         SubscriptBox["\[Theta]", "s"], "]"}], "2"]}], 
      SubscriptBox["q", "s"]], "-", 
     FractionBox[
      RowBox[{"2", " ", 
       SubscriptBox["q", "i"], " ", 
       SubscriptBox["q", "p"], " ", 
       SubscriptBox["q", "s"], " ", 
       SubsuperscriptBox["\[CapitalDelta]K", "x", "2"]}], 
      RowBox[{
       RowBox[{
        SubscriptBox["q", "p"], " ", 
        SubscriptBox["q", "s"]}], "+", 
       RowBox[{
        SubscriptBox["q", "i"], " ", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["q", "p"], "+", 
          SubscriptBox["q", "s"]}], ")"}]}]}]], "+", 
     FractionBox[
      RowBox[{
       SubscriptBox["q", "p"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"z", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", 
             SubscriptBox["\[Theta]", "i"]}], "]"}], " ", 
           SubscriptBox["q", "s"]}], "+", 
          RowBox[{
           SubscriptBox["q", "i"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "z"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"2", " ", 
                SubscriptBox["\[Theta]", "s"]}], "]"}]}], "+", 
             RowBox[{"2", " ", "\[ImaginaryI]", " ", 
              SubscriptBox["q", "s"], " ", 
              SubscriptBox["\[CapitalDelta]K", "y"]}]}], ")"}]}]}], ")"}], 
        "2"]}], 
      RowBox[{"2", " ", 
       SubscriptBox["q", "i"], " ", 
       SubscriptBox["q", "s"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
          SubscriptBox["q", "p"], " ", 
          SubscriptBox["q", "s"]}], "+", 
         RowBox[{
          SubscriptBox["q", "i"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox[
              RowBox[{"Cos", "[", 
               SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
             SubscriptBox["q", "p"]}], "+", 
            SubscriptBox["q", "s"]}], ")"}]}]}], ")"}]}]], "-", 
     RowBox[{"4", " ", "\[ImaginaryI]", " ", "z", " ", 
      SubscriptBox["\[CapitalDelta]K", "z"]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.582600966449912*^9, 3.582600994649864*^9}, {
   3.582601328096663*^9, 3.582601364204247*^9}, {3.58267239483342*^9, 
   3.582672406925791*^9}, 3.582673484252555*^9, {3.582674789175068*^9, 
   3.58267479965689*^9}, 3.58267678620081*^9, {3.5891463428770933`*^9, 
   3.589146360425521*^9}, 3.589161916216921*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "now", " ", "the", " ", "constant", " ", "that", " ", "remains", " ", 
    "after", " ", "integrating", " ", "over", " ", "y", " ", 
    RowBox[{"is", ":"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"yconst", " ", "=", " ", 
   RowBox[{"Simplify", "[", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Sqrt]", "\[Pi]"}], "/", 
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "i"], "]"}], "2"], 
           RowBox[{"2", " ", 
            SubscriptBox["q", "i"]}]]}], "-", 
         FractionBox["1", 
          RowBox[{"2", " ", 
           SubscriptBox["q", "p"]}]], "-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}], "2"], 
          RowBox[{"2", " ", 
           SubscriptBox["q", "s"]}]]}], ")"}]}]}], "//.", "rules2"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.582554034700173*^9, 3.5825540603452053`*^9}, {
   3.582554093889743*^9, 3.582554130244169*^9}, 3.582561974325897*^9, 
   3.5825988333434057`*^9, 3.582598872404625*^9, 3.582598959400226*^9, 
   3.5826013954180927`*^9, 3.582672420059969*^9, {3.582674789672102*^9, 
   3.582674793398522*^9}, 3.589146389913764*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", 
   SqrtBox["\[Pi]"]}], 
  RowBox[{
   FractionBox[
    SuperscriptBox[
     RowBox[{"Cos", "[", 
      SubscriptBox["\[Theta]", "i"], "]"}], "2"], 
    SubsuperscriptBox["W", "i", "2"]], "+", 
   FractionBox["1", 
    SubsuperscriptBox["W", "p", "2"]], "+", 
   FractionBox[
    SuperscriptBox[
     RowBox[{"Cos", "[", 
      SubscriptBox["\[Theta]", "s"], "]"}], "2"], 
    SubsuperscriptBox["W", "s", "2"]]}]]], "Output",
 CellChangeTimes->{
  3.582554130698413*^9, 3.582561979372128*^9, 3.582562062470771*^9, 
   3.582563916348898*^9, 3.582564605173622*^9, 3.582582720631323*^9, 
   3.5825988390544653`*^9, 3.582598875468288*^9, 3.582598960757826*^9, 
   3.582601397438807*^9, 3.5826724210605307`*^9, 3.5826734843624887`*^9, {
   3.5826747833779507`*^9, 3.5826747940005703`*^9}, 3.582676786283609*^9, 
   3.589146392203536*^9, {3.589161306989028*^9, 3.589161335878224*^9}, 
   3.589161916325561*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "This", " ", "leaves", " ", "the", " ", "remaing", " ", "z", " ", 
    "integrand"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ArgZ", ":=", 
    RowBox[{
     FractionBox["1", "4"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"2", " ", 
          SuperscriptBox["z", "2"], " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", 
            SubscriptBox["\[Theta]", "i"], "]"}], "2"]}], 
         SubscriptBox["q", "i"]]}], "-", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["z", "2"], " ", 
         SuperscriptBox[
          RowBox[{"Sin", "[", 
           SubscriptBox["\[Theta]", "s"], "]"}], "2"]}], 
        SubscriptBox["q", "s"]], "-", 
       FractionBox[
        RowBox[{"2", " ", 
         SubscriptBox["q", "i"], " ", 
         SubscriptBox["q", "p"], " ", 
         SubscriptBox["q", "s"], " ", 
         SubsuperscriptBox["\[CapitalDelta]K", "x", "2"]}], 
        RowBox[{
         RowBox[{
          SubscriptBox["q", "p"], " ", 
          SubscriptBox["q", "s"]}], "+", 
         RowBox[{
          SubscriptBox["q", "i"], " ", 
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["q", "p"], "+", 
            SubscriptBox["q", "s"]}], ")"}]}]}]], "+", 
       FractionBox[
        RowBox[{
         SubscriptBox["q", "p"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"z", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"2", " ", 
               SubscriptBox["\[Theta]", "i"]}], "]"}], " ", 
             SubscriptBox["q", "s"]}], "+", 
            RowBox[{
             SubscriptBox["q", "i"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "z"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"2", " ", 
                  SubscriptBox["\[Theta]", "s"]}], "]"}]}], "+", 
               RowBox[{"2", " ", "\[ImaginaryI]", " ", 
                SubscriptBox["q", "s"], " ", 
                SubscriptBox["\[CapitalDelta]K", "y"]}]}], ")"}]}]}], ")"}], 
          "2"]}], 
        RowBox[{"2", " ", 
         SubscriptBox["q", "i"], " ", 
         SubscriptBox["q", "s"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
            SubscriptBox["q", "p"], " ", 
            SubscriptBox["q", "s"]}], "+", 
           RowBox[{
            SubscriptBox["q", "i"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox[
                RowBox[{"Cos", "[", 
                 SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
               SubscriptBox["q", "p"]}], "+", 
              SubscriptBox["q", "s"]}], ")"}]}]}], ")"}]}]], "-", 
       RowBox[{"4", " ", "\[ImaginaryI]", " ", "z", " ", 
        SubscriptBox["\[CapitalDelta]K", "z"]}]}], ")"}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"ArgZ", "=", 
    RowBox[{"Expand", "[", "ArgZ", "]"}]}], " ", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Collect", "[", 
     RowBox[{"ArgZ", ",", " ", "z"}], "]"}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.5825541447325993`*^9, 3.582554218173704*^9}, {
   3.582554311787928*^9, 3.582554332788763*^9}, 3.582562009349558*^9, 
   3.582598942001313*^9, 3.582599220705217*^9, 3.582601424927206*^9, {
   3.5826019630624943`*^9, 3.582601984307494*^9}, 3.5826724646779633`*^9, 
   3.5891464228443213`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     SuperscriptBox["z", "2"], " ", 
     SuperscriptBox[
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Theta]", "i"], "]"}], "2"]}], 
    RowBox[{"2", " ", 
     SubscriptBox["q", "i"]}]]}], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["z", "2"], " ", 
    SuperscriptBox[
     RowBox[{"Sin", "[", 
      SubscriptBox["\[Theta]", "s"], "]"}], "2"]}], 
   RowBox[{"2", " ", 
    SubscriptBox["q", "s"]}]], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["z", "2"], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", 
      SubscriptBox["\[Theta]", "i"]}], "]"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", 
      SubscriptBox["\[Theta]", "s"]}], "]"}], " ", 
    SubscriptBox["q", "p"]}], 
   RowBox[{"4", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
       SubscriptBox["q", "p"], " ", 
       SubscriptBox["q", "s"]}], "+", 
      RowBox[{
       SubscriptBox["q", "i"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
          SubscriptBox["q", "p"]}], "+", 
         SubscriptBox["q", "s"]}], ")"}]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["z", "2"], " ", 
    SuperscriptBox[
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       SubscriptBox["\[Theta]", "s"]}], "]"}], "2"], " ", 
    SubscriptBox["q", "i"], " ", 
    SubscriptBox["q", "p"]}], 
   RowBox[{"8", " ", 
    SubscriptBox["q", "s"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
       SubscriptBox["q", "p"], " ", 
       SubscriptBox["q", "s"]}], "+", 
      RowBox[{
       SubscriptBox["q", "i"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
          SubscriptBox["q", "p"]}], "+", 
         SubscriptBox["q", "s"]}], ")"}]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["z", "2"], " ", 
    SuperscriptBox[
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       SubscriptBox["\[Theta]", "i"]}], "]"}], "2"], " ", 
    SubscriptBox["q", "p"], " ", 
    SubscriptBox["q", "s"]}], 
   RowBox[{"8", " ", 
    SubscriptBox["q", "i"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
       SubscriptBox["q", "p"], " ", 
       SubscriptBox["q", "s"]}], "+", 
      RowBox[{
       SubscriptBox["q", "i"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
          SubscriptBox["q", "p"]}], "+", 
         SubscriptBox["q", "s"]}], ")"}]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["q", "i"], " ", 
    SubscriptBox["q", "p"], " ", 
    SubscriptBox["q", "s"], " ", 
    SubsuperscriptBox["\[CapitalDelta]K", "x", "2"]}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["q", "p"], " ", 
       SubscriptBox["q", "s"]}], "+", 
      RowBox[{
       SubscriptBox["q", "i"], " ", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["q", "p"], "+", 
         SubscriptBox["q", "s"]}], ")"}]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "z", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", 
      SubscriptBox["\[Theta]", "s"]}], "]"}], " ", 
    SubscriptBox["q", "i"], " ", 
    SubscriptBox["q", "p"], " ", 
    SubscriptBox["\[CapitalDelta]K", "y"]}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
       SubscriptBox["q", "p"], " ", 
       SubscriptBox["q", "s"]}], "+", 
      RowBox[{
       SubscriptBox["q", "i"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
          SubscriptBox["q", "p"]}], "+", 
         SubscriptBox["q", "s"]}], ")"}]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "z", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", 
      SubscriptBox["\[Theta]", "i"]}], "]"}], " ", 
    SubscriptBox["q", "p"], " ", 
    SubscriptBox["q", "s"], " ", 
    SubscriptBox["\[CapitalDelta]K", "y"]}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
       SubscriptBox["q", "p"], " ", 
       SubscriptBox["q", "s"]}], "+", 
      RowBox[{
       SubscriptBox["q", "i"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
          SubscriptBox["q", "p"]}], "+", 
         SubscriptBox["q", "s"]}], ")"}]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["q", "i"], " ", 
    SubscriptBox["q", "p"], " ", 
    SubscriptBox["q", "s"], " ", 
    SubsuperscriptBox["\[CapitalDelta]K", "y", "2"]}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
       SubscriptBox["q", "p"], " ", 
       SubscriptBox["q", "s"]}], "+", 
      RowBox[{
       SubscriptBox["q", "i"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
          SubscriptBox["q", "p"]}], "+", 
         SubscriptBox["q", "s"]}], ")"}]}]}], ")"}]}]], "-", 
  RowBox[{"\[ImaginaryI]", " ", "z", " ", 
   SubscriptBox["\[CapitalDelta]K", "z"]}]}]], "Output",
 CellChangeTimes->{
  3.582601984772472*^9, 3.582672465640358*^9, 3.582672601247965*^9, 
   3.582673484409152*^9, {3.5891464241419*^9, 3.589146429744108*^9}, 
   3.589161916365054*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.5826018942273493`*^9, 3.582601895957513*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.5825632693170843`*^9, 3.582563269332837*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"xconst", " ", ":=", " ", 
     RowBox[{"xconst", " ", "//.", " ", "rules2"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"yconst", " ", ":=", " ", 
     RowBox[{"yconst", " ", "//.", " ", "rules2"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Now", ",", " ", 
    RowBox[{
    "we", " ", "get", " ", "rid", " ", "of", " ", "any", " ", "terms", " ", 
     "that", " ", "contain", "  ", 
     RowBox[{
      SubscriptBox["\[Rho]", "px"], "^", "2"}], " ", "or", " ", "higher", " ",
      "as", " ", "they", " ", "are", " ", "negligible"}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"JJ", " ", "=", " ", 
    RowBox[{"ArgZ", "/.", " ", 
     RowBox[{"{", " ", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["\[Rho]", "px"], "2"], " ", "\[Rule]", "0"}], "}"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ArgZ", " ", "=", " ", 
     RowBox[{"Simplify", "[", "JJ", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"ArgZ", "=", 
     RowBox[{"Collect", "[", 
      RowBox[{
       RowBox[{"ArgZ", " ", "//.", "rules2"}], ",", "z"}], "]"}]}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.582554473777072*^9, 3.582554588179599*^9}, {
   3.582563145314126*^9, 3.5825632517348003`*^9}, {3.58256329315735*^9, 
   3.58256330327414*^9}, {3.5825635115427217`*^9, 3.5825635182783003`*^9}, {
   3.582563892798093*^9, 3.58256390481533*^9}, {3.582563972246334*^9, 
   3.582563975428649*^9}, {3.582564100937079*^9, 3.582564137722248*^9}, {
   3.5825645735318604`*^9, 3.582564580363806*^9}, {3.5825822430253277`*^9, 
   3.58258229028465*^9}, {3.582582327384783*^9, 3.582582347448052*^9}, {
   3.5825827076197166`*^9, 3.582582734656507*^9}, {3.582599143048251*^9, 
   3.5825991837069693`*^9}, 3.582599227371872*^9, {3.582601458056863*^9, 
   3.582601550430863*^9}, {3.5826015838963833`*^9, 3.582601588070138*^9}, {
   3.582601630749078*^9, 3.582601766646276*^9}, {3.582601796952317*^9, 
   3.582601807941141*^9}, {3.5826018444897013`*^9, 3.582602013667631*^9}, 
   3.582672511316489*^9, {3.582672571354567*^9, 3.582672607455125*^9}, {
   3.582673434737115*^9, 3.5826734394159822`*^9}, {3.582674808138917*^9, 
   3.582674818630746*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     SuperscriptBox["z", "2"], " ", 
     SuperscriptBox[
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Theta]", "i"], "]"}], "2"]}], 
    RowBox[{"2", " ", 
     SubscriptBox["q", "i"]}]]}], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["z", "2"], " ", 
    SuperscriptBox[
     RowBox[{"Sin", "[", 
      SubscriptBox["\[Theta]", "s"], "]"}], "2"]}], 
   RowBox[{"2", " ", 
    SubscriptBox["q", "s"]}]], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["z", "2"], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", 
      SubscriptBox["\[Theta]", "i"]}], "]"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", 
      SubscriptBox["\[Theta]", "s"]}], "]"}], " ", 
    SubscriptBox["q", "p"]}], 
   RowBox[{"4", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
       SubscriptBox["q", "p"], " ", 
       SubscriptBox["q", "s"]}], "+", 
      RowBox[{
       SubscriptBox["q", "i"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
          SubscriptBox["q", "p"]}], "+", 
         SubscriptBox["q", "s"]}], ")"}]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["z", "2"], " ", 
    SuperscriptBox[
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       SubscriptBox["\[Theta]", "s"]}], "]"}], "2"], " ", 
    SubscriptBox["q", "i"], " ", 
    SubscriptBox["q", "p"]}], 
   RowBox[{"8", " ", 
    SubscriptBox["q", "s"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
       SubscriptBox["q", "p"], " ", 
       SubscriptBox["q", "s"]}], "+", 
      RowBox[{
       SubscriptBox["q", "i"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
          SubscriptBox["q", "p"]}], "+", 
         SubscriptBox["q", "s"]}], ")"}]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["z", "2"], " ", 
    SuperscriptBox[
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       SubscriptBox["\[Theta]", "i"]}], "]"}], "2"], " ", 
    SubscriptBox["q", "p"], " ", 
    SubscriptBox["q", "s"]}], 
   RowBox[{"8", " ", 
    SubscriptBox["q", "i"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
       SubscriptBox["q", "p"], " ", 
       SubscriptBox["q", "s"]}], "+", 
      RowBox[{
       SubscriptBox["q", "i"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
          SubscriptBox["q", "p"]}], "+", 
         SubscriptBox["q", "s"]}], ")"}]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["q", "i"], " ", 
    SubscriptBox["q", "p"], " ", 
    SubscriptBox["q", "s"], " ", 
    SubsuperscriptBox["\[CapitalDelta]K", "x", "2"]}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["q", "p"], " ", 
       SubscriptBox["q", "s"]}], "+", 
      RowBox[{
       SubscriptBox["q", "i"], " ", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["q", "p"], "+", 
         SubscriptBox["q", "s"]}], ")"}]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "z", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", 
      SubscriptBox["\[Theta]", "s"]}], "]"}], " ", 
    SubscriptBox["q", "i"], " ", 
    SubscriptBox["q", "p"], " ", 
    SubscriptBox["\[CapitalDelta]K", "y"]}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
       SubscriptBox["q", "p"], " ", 
       SubscriptBox["q", "s"]}], "+", 
      RowBox[{
       SubscriptBox["q", "i"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
          SubscriptBox["q", "p"]}], "+", 
         SubscriptBox["q", "s"]}], ")"}]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "z", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", 
      SubscriptBox["\[Theta]", "i"]}], "]"}], " ", 
    SubscriptBox["q", "p"], " ", 
    SubscriptBox["q", "s"], " ", 
    SubscriptBox["\[CapitalDelta]K", "y"]}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
       SubscriptBox["q", "p"], " ", 
       SubscriptBox["q", "s"]}], "+", 
      RowBox[{
       SubscriptBox["q", "i"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
          SubscriptBox["q", "p"]}], "+", 
         SubscriptBox["q", "s"]}], ")"}]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["q", "i"], " ", 
    SubscriptBox["q", "p"], " ", 
    SubscriptBox["q", "s"], " ", 
    SubsuperscriptBox["\[CapitalDelta]K", "y", "2"]}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
       SubscriptBox["q", "p"], " ", 
       SubscriptBox["q", "s"]}], "+", 
      RowBox[{
       SubscriptBox["q", "i"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
          SubscriptBox["q", "p"]}], "+", 
         SubscriptBox["q", "s"]}], ")"}]}]}], ")"}]}]], "-", 
  RowBox[{"\[ImaginaryI]", " ", "z", " ", 
   SubscriptBox["\[CapitalDelta]K", "z"]}]}]], "Output",
 CellChangeTimes->{
  3.582601997999753*^9, {3.5826725079444857`*^9, 3.582672514540223*^9}, {
   3.582672575421391*^9, 3.5826726094117537`*^9}, 3.582673440061619*^9, 
   3.582673484563794*^9, 3.589146452125893*^9, 3.589161916474094*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{"ArgZ", ",", "z"}], "]"}], " ", "//.", " ", "rules2"}]}]], "Input",\

 CellChangeTimes->{{3.582602027890689*^9, 3.582602068890297*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "8"], " ", 
   SuperscriptBox["z", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"4", " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", 
          SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
        SubsuperscriptBox["W", "i", "2"]}], 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"Cos", "[", 
           SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
         SubsuperscriptBox["W", "p", "2"], " ", 
         SubsuperscriptBox["W", "s", "2"]}], "+", 
        RowBox[{
         SubsuperscriptBox["W", "i", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
            SubsuperscriptBox["W", "p", "2"]}], "+", 
           SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}]]}], "-", 
     FractionBox[
      RowBox[{"4", " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", 
         RowBox[{
          SubscriptBox["\[Theta]", "i"], "+", 
          SubscriptBox["\[Theta]", "s"]}], "]"}], "2"], " ", 
       SubsuperscriptBox["W", "p", "2"]}], 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
        SubsuperscriptBox["W", "p", "2"], " ", 
        SubsuperscriptBox["W", "s", "2"]}], "+", 
       RowBox[{
        SubsuperscriptBox["W", "i", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
           SubsuperscriptBox["W", "p", "2"]}], "+", 
          SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}]], "-", 
     FractionBox[
      RowBox[{"4", " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", 
         SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
       SubsuperscriptBox["W", "s", "2"]}], 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
        SubsuperscriptBox["W", "p", "2"], " ", 
        SubsuperscriptBox["W", "s", "2"]}], "+", 
       RowBox[{
        SubsuperscriptBox["W", "i", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
           SubsuperscriptBox["W", "p", "2"]}], "+", 
          SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}]]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   SubsuperscriptBox["W", "i", "2"], " ", 
   SubsuperscriptBox["W", "p", "2"], " ", 
   SubsuperscriptBox["W", "s", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"4", " ", 
        SubsuperscriptBox["\[CapitalDelta]K", "x", "2"]}], 
       RowBox[{
        RowBox[{
         SubsuperscriptBox["W", "p", "2"], " ", 
         SubsuperscriptBox["W", "s", "2"]}], "+", 
        RowBox[{
         SubsuperscriptBox["W", "i", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           SubsuperscriptBox["W", "p", "2"], "+", 
           SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}]]}], "-", 
     FractionBox[
      RowBox[{"4", " ", 
       SubsuperscriptBox["\[CapitalDelta]K", "y", "2"]}], 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
        SubsuperscriptBox["W", "p", "2"], " ", 
        SubsuperscriptBox["W", "s", "2"]}], "+", 
       RowBox[{
        SubsuperscriptBox["W", "i", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
           SubsuperscriptBox["W", "p", "2"]}], "+", 
          SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}]]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", "z", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"8", " ", "\[ImaginaryI]", " ", 
        SubsuperscriptBox["W", "i", "2"], " ", 
        SubsuperscriptBox["W", "s", "2"], " ", 
        SubscriptBox["\[CapitalDelta]K", "z"]}], 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"Cos", "[", 
           SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
         SubsuperscriptBox["W", "p", "2"], " ", 
         SubsuperscriptBox["W", "s", "2"]}], "+", 
        RowBox[{
         SubsuperscriptBox["W", "i", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
            SubsuperscriptBox["W", "p", "2"]}], "+", 
           SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}]]}], "+", 
     FractionBox[
      RowBox[{"4", " ", "\[ImaginaryI]", " ", 
       SubsuperscriptBox["W", "p", "2"], " ", 
       SubsuperscriptBox["W", "s", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", 
            SubscriptBox["\[Theta]", "i"]}], "]"}], " ", 
          SubscriptBox["\[CapitalDelta]K", "y"]}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox[
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
          SubscriptBox["\[CapitalDelta]K", "z"]}]}], ")"}]}], 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
        SubsuperscriptBox["W", "p", "2"], " ", 
        SubsuperscriptBox["W", "s", "2"]}], "+", 
       RowBox[{
        SubsuperscriptBox["W", "i", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
           SubsuperscriptBox["W", "p", "2"]}], "+", 
          SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}]], "-", 
     FractionBox[
      RowBox[{"8", " ", "\[ImaginaryI]", " ", 
       RowBox[{"Cos", "[", 
        SubscriptBox["\[Theta]", "s"], "]"}], " ", 
       SubsuperscriptBox["W", "i", "2"], " ", 
       SubsuperscriptBox["W", "p", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           SubscriptBox["\[Theta]", "s"], "]"}], " ", 
          SubscriptBox["\[CapitalDelta]K", "y"]}], "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           SubscriptBox["\[Theta]", "s"], "]"}], " ", 
          SubscriptBox["\[CapitalDelta]K", "z"]}]}], ")"}]}], 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
        SubsuperscriptBox["W", "p", "2"], " ", 
        SubsuperscriptBox["W", "s", "2"]}], "+", 
       RowBox[{
        SubsuperscriptBox["W", "i", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
           SubsuperscriptBox["W", "p", "2"]}], "+", 
          SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}]]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{3.5826020396052856`*^9, 3.582602070339744*^9, 
  3.582672616048633*^9, 3.582673504074059*^9, 3.589146463347169*^9, 
  3.5891619293803253`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"The", " ", "integral", " ", "has", " ", "a", " ", "familar", " ", 
     RowBox[{"form", ".", " ", 
      RowBox[{"Let", "'"}]}], "s", " ", "see", " ", "if", " ", "Mathematica", 
     " ", "can", " ", "do", " ", "the", " ", "integration", " ", "straight", 
     " ", 
     RowBox[{"up", ".", " ", "Otherwise"}]}], ",", " ", 
    RowBox[{
    "compare", " ", "it", " ", "to", " ", "a", " ", "known", " ", 
     "solution"}]}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"IntZ", ":=", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Exp", "[", "ArgZ", "]"}], " ", "*", "yconst", "*", 
        "xconst"}], "//.", " ", "rules2"}], "]"}], "\[IndentingNewLine]", 
     RowBox[{"Assuming", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["W", "i"], ">", "0"}], "  ", "&&", "  ", 
        RowBox[{
         SubscriptBox["W", "s"], ">", "0"}], "  ", "&&", " ", 
        RowBox[{
         SubscriptBox["W", "p"], ">", "0"}], " ", "&&", " ", 
        RowBox[{
         SubscriptBox["\[CapitalDelta]K", "x"], ">", "0"}], " ", "&&", " ", 
        RowBox[{
         SubscriptBox["\[CapitalDelta]K", "y"], ">", "0"}], " ", "&&", " ", 
        RowBox[{
         SubscriptBox["\[CapitalDelta]K", "z"], ">", "0"}], "  ", "&&", " ", 
        RowBox[{
         SubscriptBox["\[Theta]", "i"], ">", "0"}], " ", "&&", " ", 
        RowBox[{
         SubscriptBox["\[Theta]", "s"], ">", "0"}]}], ",", "   ", 
       RowBox[{"Integrate", "[", 
        RowBox[{"IntZ", ",", " ", 
         RowBox[{"{", 
          RowBox[{"z", ",", "0", ",", "L"}], "}"}]}], "]"}]}], "]"}]}]}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.582563503557109*^9, 3.582563571134346*^9}, {
   3.582563625488155*^9, 3.5825637015706167`*^9}, {3.58256373619261*^9, 
   3.582563751911689*^9}, {3.582564140120492*^9, 3.5825641414428*^9}, {
   3.582582395941203*^9, 3.58258245816571*^9}, 3.582599165258992*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Mathematica", " ", 
    RowBox[{"can", "'"}], "t", " ", "integrate", " ", 
    RowBox[{"this", ".", " ", "Look"}], " ", "at", " ", "coefficients", " ", 
    "for", " ", "the", " ", "integral", " ", "to", " ", "get", " ", "it", " ",
     "in", " ", "the", " ", "right", " ", "form"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"AA", "=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      FractionBox[
       RowBox[{"-", "1"}], "8"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"4", " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", 
             SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
           SubsuperscriptBox["W", "i", "2"]}], 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
            SubsuperscriptBox["W", "p", "2"], " ", 
            SubsuperscriptBox["W", "s", "2"]}], "+", 
           RowBox[{
            SubsuperscriptBox["W", "i", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox[
                RowBox[{"Cos", "[", 
                 SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
               SubsuperscriptBox["W", "p", "2"]}], "+", 
              SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}]]}], "-", 
        FractionBox[
         RowBox[{"4", " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", 
            RowBox[{
             SubscriptBox["\[Theta]", "i"], "+", 
             SubscriptBox["\[Theta]", "s"]}], "]"}], "2"], " ", 
          SubsuperscriptBox["W", "p", "2"]}], 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
           SubsuperscriptBox["W", "p", "2"], " ", 
           SubsuperscriptBox["W", "s", "2"]}], "+", 
          RowBox[{
           SubsuperscriptBox["W", "i", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox[
               RowBox[{"Cos", "[", 
                SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
              SubsuperscriptBox["W", "p", "2"]}], "+", 
             SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}]], "-", 
        FractionBox[
         RowBox[{"4", " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", 
            SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
          SubsuperscriptBox["W", "s", "2"]}], 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
           SubsuperscriptBox["W", "p", "2"], " ", 
           SubsuperscriptBox["W", "s", "2"]}], "+", 
          RowBox[{
           SubsuperscriptBox["W", "i", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox[
               RowBox[{"Cos", "[", 
                SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
              SubsuperscriptBox["W", "p", "2"]}], "+", 
             SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}]]}], ")"}]}], 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"BB", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "/", "\[ImaginaryI]"}], " ", 
       FractionBox["1", "8"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"8", " ", "\[ImaginaryI]", " ", 
            SubsuperscriptBox["W", "i", "2"], " ", 
            SubsuperscriptBox["W", "s", "2"], " ", 
            SubscriptBox["\[CapitalDelta]K", "z"]}], 
           RowBox[{
            RowBox[{
             SuperscriptBox[
              RowBox[{"Cos", "[", 
               SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
             SubsuperscriptBox["W", "p", "2"], " ", 
             SubsuperscriptBox["W", "s", "2"]}], "+", 
            RowBox[{
             SubsuperscriptBox["W", "i", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox[
                 RowBox[{"Cos", "[", 
                  SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
                SubsuperscriptBox["W", "p", "2"]}], "+", 
               SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}]]}], "+", 
         FractionBox[
          RowBox[{"4", " ", "\[ImaginaryI]", " ", 
           SubsuperscriptBox["W", "p", "2"], " ", 
           SubsuperscriptBox["W", "s", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Sin", "[", 
               RowBox[{"2", " ", 
                SubscriptBox["\[Theta]", "i"]}], "]"}], " ", 
              SubscriptBox["\[CapitalDelta]K", "y"]}], "-", 
             RowBox[{"2", " ", 
              SuperscriptBox[
               RowBox[{"Cos", "[", 
                SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
              SubscriptBox["\[CapitalDelta]K", "z"]}]}], ")"}]}], 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
            SubsuperscriptBox["W", "p", "2"], " ", 
            SubsuperscriptBox["W", "s", "2"]}], "+", 
           RowBox[{
            SubsuperscriptBox["W", "i", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox[
                RowBox[{"Cos", "[", 
                 SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
               SubsuperscriptBox["W", "p", "2"]}], "+", 
              SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}]], "-", 
         FractionBox[
          RowBox[{"8", " ", "\[ImaginaryI]", " ", 
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}], " ", 
           SubsuperscriptBox["W", "i", "2"], " ", 
           SubsuperscriptBox["W", "p", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Sin", "[", 
               SubscriptBox["\[Theta]", "s"], "]"}], " ", 
              SubscriptBox["\[CapitalDelta]K", "y"]}], "+", 
             RowBox[{
              RowBox[{"Cos", "[", 
               SubscriptBox["\[Theta]", "s"], "]"}], " ", 
              SubscriptBox["\[CapitalDelta]K", "z"]}]}], ")"}]}], 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
            SubsuperscriptBox["W", "p", "2"], " ", 
            SubsuperscriptBox["W", "s", "2"]}], "+", 
           RowBox[{
            SubsuperscriptBox["W", "i", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox[
                RowBox[{"Cos", "[", 
                 SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
               SubsuperscriptBox["W", "p", "2"]}], "+", 
              SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}]]}], ")"}]}], 
      ")"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"CC", "=", 
    RowBox[{"Simplify", "[", " ", 
     RowBox[{
      RowBox[{"-", " ", 
       FractionBox["1", "8"]}], " ", 
      SubsuperscriptBox["W", "i", "2"], " ", 
      SubsuperscriptBox["W", "p", "2"], " ", 
      SubsuperscriptBox["W", "s", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"4", " ", 
           SubsuperscriptBox["\[CapitalDelta]K", "x", "2"]}], 
          RowBox[{
           RowBox[{
            SubsuperscriptBox["W", "p", "2"], " ", 
            SubsuperscriptBox["W", "s", "2"]}], "+", 
           RowBox[{
            SubsuperscriptBox["W", "i", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SubsuperscriptBox["W", "p", "2"], "+", 
              SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}]]}], "-", 
        FractionBox[
         RowBox[{"4", " ", 
          SubsuperscriptBox["\[CapitalDelta]K", "y", "2"]}], 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
           SubsuperscriptBox["W", "p", "2"], " ", 
           SubsuperscriptBox["W", "s", "2"]}], "+", 
          RowBox[{
           SubsuperscriptBox["W", "i", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox[
               RowBox[{"Cos", "[", 
                SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
              SubsuperscriptBox["W", "p", "2"]}], "+", 
             SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}]]}], ")"}]}], 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"IZ", ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"-", " ", "AA"}], "*", 
      RowBox[{"z", "^", "2"}]}], " ", "-", 
     RowBox[{"\[ImaginaryI]", "*", "BB", "*", "z"}], " ", "-", " ", "CC"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.582563620017631*^9, 3.58256362241917*^9}, {
   3.5825641857005157`*^9, 3.582564352469962*^9}, {3.582564388443557*^9, 
   3.5825644916333723`*^9}, 3.582564534937364*^9, {3.5825646146750507`*^9, 
   3.5825646276376543`*^9}, 3.582566906889018*^9, {3.582582463766726*^9, 
   3.5825824699499607`*^9}, {3.5825992613851957`*^9, 3.58259940031949*^9}, {
   3.582599446730751*^9, 3.5825994739564962`*^9}, {3.582602132738472*^9, 
   3.582602232991704*^9}, {3.582672638006193*^9, 3.582672720123804*^9}, 
   3.5891465230956993`*^9, {3.5891465608597116`*^9, 3.589146576183867*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"Sin", "[", 
      SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
    SubsuperscriptBox["W", "i", "2"]}], "+", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["\[Theta]", "i"], "+", 
       SubscriptBox["\[Theta]", "s"]}], "]"}], "2"], " ", 
    SubsuperscriptBox["W", "p", "2"]}], "+", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"Sin", "[", 
      SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
    SubsuperscriptBox["W", "s", "2"]}]}], 
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"Cos", "[", 
        SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
      SubsuperscriptBox["W", "p", "2"], " ", 
      SubsuperscriptBox["W", "s", "2"]}], "+", 
     RowBox[{
      SubsuperscriptBox["W", "i", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"Cos", "[", 
           SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
         SubsuperscriptBox["W", "p", "2"]}], "+", 
        SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}], ")"}]}]]], "Output",
 CellChangeTimes->{
  3.582599312230197*^9, {3.582599377997737*^9, 3.582599401336762*^9}, {
   3.5825994643357487`*^9, 3.58259947446242*^9}, {3.58260221884912*^9, 
   3.582602236872472*^9}, 3.582672675652617*^9, {3.5826727056635857`*^9, 
   3.582672721096286*^9}, 3.582673504217643*^9, 3.589146578576458*^9, 
   3.589161929489044*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    SubsuperscriptBox["W", "p", "2"], " ", 
    SubsuperscriptBox["W", "s", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", 
          SubscriptBox["\[Theta]", "i"]}], "]"}]}], " ", 
       SubscriptBox["\[CapitalDelta]K", "y"]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
       SubscriptBox["\[CapitalDelta]K", "z"]}]}], ")"}]}], "+", 
   RowBox[{"2", " ", 
    SubsuperscriptBox["W", "i", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubsuperscriptBox["W", "s", "2"], " ", 
       SubscriptBox["\[CapitalDelta]K", "z"]}], "+", 
      RowBox[{
       RowBox[{"Cos", "[", 
        SubscriptBox["\[Theta]", "s"], "]"}], " ", 
       SubsuperscriptBox["W", "p", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           SubscriptBox["\[Theta]", "s"], "]"}], " ", 
          SubscriptBox["\[CapitalDelta]K", "y"]}], "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           SubscriptBox["\[Theta]", "s"], "]"}], " ", 
          SubscriptBox["\[CapitalDelta]K", "z"]}]}], ")"}]}]}], ")"}]}]}], 
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"Cos", "[", 
        SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
      SubsuperscriptBox["W", "p", "2"], " ", 
      SubsuperscriptBox["W", "s", "2"]}], "+", 
     RowBox[{
      SubsuperscriptBox["W", "i", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"Cos", "[", 
           SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
         SubsuperscriptBox["W", "p", "2"]}], "+", 
        SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}], ")"}]}]]], "Output",
 CellChangeTimes->{
  3.582599312230197*^9, {3.582599377997737*^9, 3.582599401336762*^9}, {
   3.5825994643357487`*^9, 3.58259947446242*^9}, {3.58260221884912*^9, 
   3.582602236872472*^9}, 3.582672675652617*^9, {3.5826727056635857`*^9, 
   3.582672721096286*^9}, 3.582673504217643*^9, 3.589146578576458*^9, 
   3.589161929688389*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", "8"]}], " ", 
  SubsuperscriptBox["W", "i", "2"], " ", 
  SubsuperscriptBox["W", "p", "2"], " ", 
  SubsuperscriptBox["W", "s", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"4", " ", 
       SubsuperscriptBox["\[CapitalDelta]K", "x", "2"]}], 
      RowBox[{
       RowBox[{
        SubsuperscriptBox["W", "p", "2"], " ", 
        SubsuperscriptBox["W", "s", "2"]}], "+", 
       RowBox[{
        SubsuperscriptBox["W", "i", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SubsuperscriptBox["W", "p", "2"], "+", 
          SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}]]}], "-", 
    FractionBox[
     RowBox[{"4", " ", 
      SubsuperscriptBox["\[CapitalDelta]K", "y", "2"]}], 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
       SubsuperscriptBox["W", "p", "2"], " ", 
       SubsuperscriptBox["W", "s", "2"]}], "+", 
      RowBox[{
       SubsuperscriptBox["W", "i", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
          SubsuperscriptBox["W", "p", "2"]}], "+", 
         SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}]]}], ")"}]}]], "Output",\

 CellChangeTimes->{
  3.582599312230197*^9, {3.582599377997737*^9, 3.582599401336762*^9}, {
   3.5825994643357487`*^9, 3.58259947446242*^9}, {3.58260221884912*^9, 
   3.582602236872472*^9}, 3.582672675652617*^9, {3.5826727056635857`*^9, 
   3.582672721096286*^9}, 3.582673504217643*^9, 3.589146578576458*^9, 
   3.589161929882573*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"While", " ", "AA"}], ",", " ", "BB", ",", " ", 
    RowBox[{"and", " ", "CC", " ", "look", " ", "initially", " ", "ugly"}], 
    ",", " ", 
    RowBox[{"they", " ", "simplify", " ", "down", " ", 
     RowBox[{"somewhat", ".", " ", "This"}], " ", "leaves", " ", "us", " ", 
     "with", " ", "real", " ", "coefficients", " ", "for", " ", 
     RowBox[{"z", "^", "2"}], " ", "and", " ", "imaginary", " ", 
     "coefficents", " ", "for", " ", 
     RowBox[{"z", ".", " ", "Now"}]}], ",", " ", 
    RowBox[{
    "this", " ", "integral", " ", "leads", " ", "to", " ", "error", " ", 
     RowBox[{"functions", ".", " ", "Instead"}]}], ",", " ", 
    RowBox[{
    "look", " ", "at", " ", "Taylor", " ", "expanding", " ", "what", " ", 
     "is", " ", "in", " ", "the", " ", "integrand", " ", "and", " ", "then", 
     " ", "carry", " ", "out", " ", "the", " ", 
     RowBox[{"integral", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"IntResult", "=", 
   RowBox[{"Normal", "[", 
    RowBox[{"Assuming", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"R", ">", 
        RowBox[{"-", "inf"}]}], " ", "&&", " ", 
       RowBox[{"S", ">", 
        RowBox[{"-", "inf"}]}], " ", "&&", " ", 
       RowBox[{"T", ">", 
        RowBox[{"-", "inf"}]}]}], " ", ",", " ", 
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{"Series", "[", 
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"z", "^", "2"}]}], " ", "*", 
             RowBox[{"(", "R", " ", ")"}]}], " ", "-", 
            RowBox[{"z", " ", "*", 
             RowBox[{"(", 
              RowBox[{"\[ImaginaryI]", "*", "S"}], ")"}]}], " ", "-", " ", 
            "T"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"z", ",", "0", ",", "15"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", "0", ",", "L"}], "}"}]}], "]"}]}], "]"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.582554473777072*^9, 3.582554588179599*^9}, {
   3.582563145314126*^9, 3.582563242592822*^9}, {3.582564883858027*^9, 
   3.582564919110215*^9}, {3.5825655945600653`*^9, 3.582565621315242*^9}, {
   3.5825657398885517`*^9, 3.5825657602812653`*^9}, {3.582565946249815*^9, 
   3.582565955330447*^9}, {3.5825824931669617`*^9, 3.582582544077121*^9}, {
   3.582599520399379*^9, 3.582599539740485*^9}, {3.582673358218238*^9, 
   3.582673361863228*^9}, 3.589158401800233*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", "T"}]], " ", "L"}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", "T"}]], " ", 
   SuperscriptBox["L", "2"], " ", "S"}], "-", 
  RowBox[{
   FractionBox["1", "6"], " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", "T"}]], " ", 
   SuperscriptBox["L", "3"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "R"}], "+", 
     SuperscriptBox["S", "2"]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", "\[ImaginaryI]", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", "T"}]], " ", 
   SuperscriptBox["L", "4"], " ", "S", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"6", " ", "R"}], "+", 
     SuperscriptBox["S", "2"]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "120"], " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", "T"}]], " ", 
   SuperscriptBox["L", "5"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"12", " ", 
      SuperscriptBox["R", "2"]}], "+", 
     RowBox[{"12", " ", "R", " ", 
      SuperscriptBox["S", "2"]}], "+", 
     SuperscriptBox["S", "4"]}], ")"}]}], "-", 
  RowBox[{
   FractionBox["1", "720"], " ", "\[ImaginaryI]", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", "T"}]], " ", 
   SuperscriptBox["L", "6"], " ", "S", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"60", " ", 
      SuperscriptBox["R", "2"]}], "+", 
     RowBox[{"20", " ", "R", " ", 
      SuperscriptBox["S", "2"]}], "+", 
     SuperscriptBox["S", "4"]}], ")"}]}], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", "T"}]], " ", 
    SuperscriptBox["L", "7"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"120", " ", 
       SuperscriptBox["R", "3"]}], "+", 
      RowBox[{"180", " ", 
       SuperscriptBox["R", "2"], " ", 
       SuperscriptBox["S", "2"]}], "+", 
      RowBox[{"30", " ", "R", " ", 
       SuperscriptBox["S", "4"]}], "+", 
      SuperscriptBox["S", "6"]}], ")"}]}], "5040"], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", "T"}]], " ", 
    SuperscriptBox["L", "8"], " ", "S", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"840", " ", 
       SuperscriptBox["R", "3"]}], "+", 
      RowBox[{"420", " ", 
       SuperscriptBox["R", "2"], " ", 
       SuperscriptBox["S", "2"]}], "+", 
      RowBox[{"42", " ", "R", " ", 
       SuperscriptBox["S", "4"]}], "+", 
      SuperscriptBox["S", "6"]}], ")"}]}], "40320"], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", "T"}]], " ", 
    SuperscriptBox["L", "9"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"1680", " ", 
       SuperscriptBox["R", "4"]}], "+", 
      RowBox[{"3360", " ", 
       SuperscriptBox["R", "3"], " ", 
       SuperscriptBox["S", "2"]}], "+", 
      RowBox[{"840", " ", 
       SuperscriptBox["R", "2"], " ", 
       SuperscriptBox["S", "4"]}], "+", 
      RowBox[{"56", " ", "R", " ", 
       SuperscriptBox["S", "6"]}], "+", 
      SuperscriptBox["S", "8"]}], ")"}]}], "362880"], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", "T"}]], " ", 
    SuperscriptBox["L", "10"], " ", "S", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"15120", " ", 
       SuperscriptBox["R", "4"]}], "+", 
      RowBox[{"10080", " ", 
       SuperscriptBox["R", "3"], " ", 
       SuperscriptBox["S", "2"]}], "+", 
      RowBox[{"1512", " ", 
       SuperscriptBox["R", "2"], " ", 
       SuperscriptBox["S", "4"]}], "+", 
      RowBox[{"72", " ", "R", " ", 
       SuperscriptBox["S", "6"]}], "+", 
      SuperscriptBox["S", "8"]}], ")"}]}], "3628800"], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", "T"}]], " ", 
    SuperscriptBox["L", "11"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"30240", " ", 
       SuperscriptBox["R", "5"]}], "+", 
      RowBox[{"75600", " ", 
       SuperscriptBox["R", "4"], " ", 
       SuperscriptBox["S", "2"]}], "+", 
      RowBox[{"25200", " ", 
       SuperscriptBox["R", "3"], " ", 
       SuperscriptBox["S", "4"]}], "+", 
      RowBox[{"2520", " ", 
       SuperscriptBox["R", "2"], " ", 
       SuperscriptBox["S", "6"]}], "+", 
      RowBox[{"90", " ", "R", " ", 
       SuperscriptBox["S", "8"]}], "+", 
      SuperscriptBox["S", "10"]}], ")"}]}], "39916800"], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", "T"}]], " ", 
    SuperscriptBox["L", "12"], " ", "S", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"332640", " ", 
       SuperscriptBox["R", "5"]}], "+", 
      RowBox[{"277200", " ", 
       SuperscriptBox["R", "4"], " ", 
       SuperscriptBox["S", "2"]}], "+", 
      RowBox[{"55440", " ", 
       SuperscriptBox["R", "3"], " ", 
       SuperscriptBox["S", "4"]}], "+", 
      RowBox[{"3960", " ", 
       SuperscriptBox["R", "2"], " ", 
       SuperscriptBox["S", "6"]}], "+", 
      RowBox[{"110", " ", "R", " ", 
       SuperscriptBox["S", "8"]}], "+", 
      SuperscriptBox["S", "10"]}], ")"}]}], "479001600"], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", "T"}]], " ", 
    SuperscriptBox["L", "13"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"665280", " ", 
       SuperscriptBox["R", "6"]}], "+", 
      RowBox[{"1995840", " ", 
       SuperscriptBox["R", "5"], " ", 
       SuperscriptBox["S", "2"]}], "+", 
      RowBox[{"831600", " ", 
       SuperscriptBox["R", "4"], " ", 
       SuperscriptBox["S", "4"]}], "+", 
      RowBox[{"110880", " ", 
       SuperscriptBox["R", "3"], " ", 
       SuperscriptBox["S", "6"]}], "+", 
      RowBox[{"5940", " ", 
       SuperscriptBox["R", "2"], " ", 
       SuperscriptBox["S", "8"]}], "+", 
      RowBox[{"132", " ", "R", " ", 
       SuperscriptBox["S", "10"]}], "+", 
      SuperscriptBox["S", "12"]}], ")"}]}], "6227020800"], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", "T"}]], " ", 
    SuperscriptBox["L", "14"], " ", "S", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"8648640", " ", 
       SuperscriptBox["R", "6"]}], "+", 
      RowBox[{"8648640", " ", 
       SuperscriptBox["R", "5"], " ", 
       SuperscriptBox["S", "2"]}], "+", 
      RowBox[{"2162160", " ", 
       SuperscriptBox["R", "4"], " ", 
       SuperscriptBox["S", "4"]}], "+", 
      RowBox[{"205920", " ", 
       SuperscriptBox["R", "3"], " ", 
       SuperscriptBox["S", "6"]}], "+", 
      RowBox[{"8580", " ", 
       SuperscriptBox["R", "2"], " ", 
       SuperscriptBox["S", "8"]}], "+", 
      RowBox[{"156", " ", "R", " ", 
       SuperscriptBox["S", "10"]}], "+", 
      SuperscriptBox["S", "12"]}], ")"}]}], "87178291200"], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", "T"}]], " ", 
    SuperscriptBox["L", "15"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"17297280", " ", 
       SuperscriptBox["R", "7"]}], "+", 
      RowBox[{"60540480", " ", 
       SuperscriptBox["R", "6"], " ", 
       SuperscriptBox["S", "2"]}], "+", 
      RowBox[{"30270240", " ", 
       SuperscriptBox["R", "5"], " ", 
       SuperscriptBox["S", "4"]}], "+", 
      RowBox[{"5045040", " ", 
       SuperscriptBox["R", "4"], " ", 
       SuperscriptBox["S", "6"]}], "+", 
      RowBox[{"360360", " ", 
       SuperscriptBox["R", "3"], " ", 
       SuperscriptBox["S", "8"]}], "+", 
      RowBox[{"12012", " ", 
       SuperscriptBox["R", "2"], " ", 
       SuperscriptBox["S", "10"]}], "+", 
      RowBox[{"182", " ", "R", " ", 
       SuperscriptBox["S", "12"]}], "+", 
      SuperscriptBox["S", "14"]}], ")"}]}], "1307674368000"], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", "T"}]], " ", 
    SuperscriptBox["L", "16"], " ", "S", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"259459200", " ", 
       SuperscriptBox["R", "7"]}], "+", 
      RowBox[{"302702400", " ", 
       SuperscriptBox["R", "6"], " ", 
       SuperscriptBox["S", "2"]}], "+", 
      RowBox[{"90810720", " ", 
       SuperscriptBox["R", "5"], " ", 
       SuperscriptBox["S", "4"]}], "+", 
      RowBox[{"10810800", " ", 
       SuperscriptBox["R", "4"], " ", 
       SuperscriptBox["S", "6"]}], "+", 
      RowBox[{"600600", " ", 
       SuperscriptBox["R", "3"], " ", 
       SuperscriptBox["S", "8"]}], "+", 
      RowBox[{"16380", " ", 
       SuperscriptBox["R", "2"], " ", 
       SuperscriptBox["S", "10"]}], "+", 
      RowBox[{"210", " ", "R", " ", 
       SuperscriptBox["S", "12"]}], "+", 
      SuperscriptBox["S", "14"]}], ")"}]}], "20922789888000"]}]], "Output",
 CellChangeTimes->{
  3.582565622214054*^9, {3.582565743315255*^9, 3.582565760800931*^9}, {
   3.582565950094211*^9, 3.582565956028761*^9}, 3.5825825471744757`*^9, 
   3.582599594223233*^9, 3.582672737164054*^9, 3.5826733626764097`*^9, 
   3.58267351062072*^9, 3.589146622298863*^9, {3.589158395174645*^9, 
   3.589158403573201*^9}, {3.589158952279207*^9, 3.589158953483385*^9}, 
   3.589161930707303*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"So", ",", " ", 
    RowBox[{
    "by", " ", "doing", " ", "the", " ", "series", " ", "expansion", " ", 
     "to", " ", "the", " ", "5", "th", " ", "order"}], ",", " ", 
    RowBox[{
     RowBox[{"we", " ", "can", " ", "easily", " ", "find", " ", "the", " ", 
      RowBox[{"integral", ".", " ", "Here"}], " ", "R"}], " ", "=", " ", 
     "AA"}], ",", " ", 
    RowBox[{"S", " ", "=", " ", "BB"}], ",", " ", 
    RowBox[{
     RowBox[{"and", " ", "T"}], "=", " ", 
     RowBox[{
      RowBox[{"CC", ".", " ", "This"}], " ", 
      RowBox[{"isn", "'"}], "t", " ", "terrible", " ", "as", " ", "AA"}]}], 
    ",", " ", "BB", ",", " ", 
    RowBox[{
     RowBox[{
     "and", " ", "CC", " ", "are", " ", "just", " ", "constants", " ", "and", 
      " ", "can", " ", "be", " ", "individually", " ", "evaluated", " ", 
      RowBox[{"easily", ".", "  ", "At"}], " ", "the", " ", "bottom", " ", 
      "of", " ", "this", " ", "workbook", " ", "I", " ", "test", " ", "how", 
      " ", "valid", " ", "this", " ", "approximation", " ", 
      RowBox[{"is", ".", " ", "As"}], " ", "long", " ", "as", " ", "L", "*", 
      RowBox[{"Sqrt", "[", "R", "]"}]}], " ", "<", 
     RowBox[{
     "1", " ", "the", " ", "error", " ", "should", " ", "be", " ", "less", 
      " ", 
      RowBox[{"than", " ", "~", "1"}], 
      RowBox[{"%", ".", " ", "As"}], " ", "L", "*", 
      RowBox[{"Sqrt", "[", "R", "]"}], " ", 
      RowBox[{"<<", "1"}]}]}], ",", " ", 
    RowBox[{"the", " ", "approx", " ", "is", " ", "very", " ", 
     RowBox[{"good", "."}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Simplify", "[", 
    RowBox[{"IntResult", " ", "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"R", " ", "\[Rule]", " ", "AA"}], ",", " ", 
       RowBox[{"S", " ", "\[Rule]", " ", "BB"}], ",", " ", 
       RowBox[{"T", " ", "\[Rule]", " ", "CC"}]}], "}"}]}], "]"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"If", " ", "we", " ", "assume", " ", "that", " ", "Ws"}], " ", 
     "=", " ", "Wi"}], ",", " ", 
    RowBox[{"then", " ", "we", " ", "get", " ", "even", " ", "further", " ", 
     RowBox[{"simplification", ".", " ", 
      RowBox[{"Don", "'"}]}], "t", " ", "think", " ", "I", " ", "want", " ", 
     "to", " ", "do", " ", "this", " ", "in", " ", "the", " ", "final", " ", 
     RowBox[{"program", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"AAsame", " ", "=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{"AA", " ", "//.", " ", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["W", "i"], " ", "\[Rule]", " ", 
        SubscriptBox["W", "s"]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"BBsame", " ", "=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{"BB", " ", "//.", " ", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["W", "i"], " ", "\[Rule]", " ", 
        SubscriptBox["W", "s"]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"CCsame", " ", "=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{"CC", " ", "//.", " ", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["W", "i"], " ", "\[Rule]", " ", 
        SubscriptBox["W", "s"]}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.582564465934472*^9, 3.582564468357284*^9}, {
  3.58256588940904*^9, 3.582566005477667*^9}, {3.582566115215287*^9, 
  3.582566124394775*^9}, {3.582566168163336*^9, 3.582566191426721*^9}, {
  3.582567273548449*^9, 3.5825674034587*^9}, {3.582569022950839*^9, 
  3.5825690391583433`*^9}, {3.582581808543288*^9, 3.582581917934*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["\[Theta]", "i"], "+", 
       SubscriptBox["\[Theta]", "s"]}], "]"}], "2"], " ", 
    SubsuperscriptBox["W", "p", "2"]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"Sin", "[", 
        SubscriptBox["\[Theta]", "i"], "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"Sin", "[", 
        SubscriptBox["\[Theta]", "s"], "]"}], "2"]}], ")"}], " ", 
    SubsuperscriptBox["W", "s", "2"]}]}], 
  RowBox[{"2", " ", 
   SubsuperscriptBox["W", "s", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Theta]", "i"], "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Theta]", "s"], "]"}], "2"]}], ")"}], " ", 
      SubsuperscriptBox["W", "p", "2"]}], "+", 
     SubsuperscriptBox["W", "s", "2"]}], ")"}]}]]], "Output",
 CellChangeTimes->{3.582566007106476*^9, 3.5825661519987373`*^9, 
  3.58256733049247*^9, 3.582567366875348*^9, 3.5825674048477*^9, 
  3.582599604388288*^9, 3.582602281199809*^9, 3.582672740276596*^9, 
  3.582673510703857*^9, 3.589146630348349*^9, 3.589161930806258*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"2", " ", 
    SubsuperscriptBox["W", "s", "2"], " ", 
    SubscriptBox["\[CapitalDelta]K", "z"]}], "+", 
   RowBox[{
    SubsuperscriptBox["W", "p", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", 
            SubscriptBox["\[Theta]", "i"]}], "]"}]}], "+", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", 
           SubscriptBox["\[Theta]", "s"]}], "]"}]}], ")"}], " ", 
       SubscriptBox["\[CapitalDelta]K", "y"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"2", "+", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", 
           SubscriptBox["\[Theta]", "i"]}], "]"}], "+", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", 
           SubscriptBox["\[Theta]", "s"]}], "]"}]}], ")"}], " ", 
       SubscriptBox["\[CapitalDelta]K", "z"]}]}], ")"}]}]}], 
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Theta]", "i"], "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Theta]", "s"], "]"}], "2"]}], ")"}], " ", 
      SubsuperscriptBox["W", "p", "2"]}], "+", 
     SubsuperscriptBox["W", "s", "2"]}], ")"}]}]]], "Output",
 CellChangeTimes->{3.582566007106476*^9, 3.5825661519987373`*^9, 
  3.58256733049247*^9, 3.582567366875348*^9, 3.5825674048477*^9, 
  3.582599604388288*^9, 3.582602281199809*^9, 3.582672740276596*^9, 
  3.582673510703857*^9, 3.589146630348349*^9, 3.589161930942972*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", "8"]}], " ", 
  SubsuperscriptBox["W", "p", "2"], " ", 
  SubsuperscriptBox["W", "s", "4"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"4", " ", 
       SubsuperscriptBox["\[CapitalDelta]K", "x", "2"]}], 
      RowBox[{
       RowBox[{"2", " ", 
        SubsuperscriptBox["W", "p", "2"], " ", 
        SubsuperscriptBox["W", "s", "2"]}], "+", 
       SubsuperscriptBox["W", "s", "4"]}]]}], "-", 
    FractionBox[
     RowBox[{"4", " ", 
      SubsuperscriptBox["\[CapitalDelta]K", "y", "2"]}], 
     RowBox[{
      SubsuperscriptBox["W", "s", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "i"], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "s"], "]"}], "2"]}], ")"}], " ", 
         SubsuperscriptBox["W", "p", "2"]}], "+", 
        SubsuperscriptBox["W", "s", "2"]}], ")"}]}]]}], ")"}]}]], "Output",
 CellChangeTimes->{3.582566007106476*^9, 3.5825661519987373`*^9, 
  3.58256733049247*^9, 3.582567366875348*^9, 3.5825674048477*^9, 
  3.582599604388288*^9, 3.582602281199809*^9, 3.582672740276596*^9, 
  3.582673510703857*^9, 3.589146630348349*^9, 3.58916193117273*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"OK", ",", " ", 
    RowBox[{
     RowBox[{
     "now", " ", "what", " ", "if", " ", "we", " ", "substitute", " ", "in", 
      " ", "the", " ", "values", " ", "for", " ", "q_p", " ", "and", " ", 
      RowBox[{"q_s", ".", " ", "Need"}], " ", "to", " ", "start", " ", 
      RowBox[{"over", "!"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "Arg2"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "/", 
         RowBox[{"(", 
          RowBox[{"2", "*", 
           SubscriptBox["q", "s"]}], ")"}]}], "*", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["x", "s"], "2"], "+", 
          SuperscriptBox[
           SubscriptBox["y", "s"], "2"]}], ")"}]}], "-", 
       RowBox[{
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{"2", "*", 
           SubscriptBox["q", "i"]}], ")"}]}], 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["x", "i"], "2"], "+", 
          SuperscriptBox[
           SubscriptBox["y", "i"], "2"]}], ")"}]}], "-", 
       RowBox[{
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{"2", "*", 
           SubscriptBox["q", "p"]}], ")"}]}], "*", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"]}], ")"}]}], " ", "-", " ", 
       RowBox[{"\[ImaginaryI]", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["\[CapitalDelta]K", "x"], "*", "x"}], " ", "+", " ", 
          RowBox[{
           SubscriptBox["\[CapitalDelta]K", "y"], "*", "y"}], "+", 
          RowBox[{
           SubscriptBox["\[CapitalDelta]K", "z"], "*", "z"}]}], ")"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "rules1"}]}], " ", ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           SubscriptBox["q", "p"], " ", "\[Rule]", " ", 
           RowBox[{
            SuperscriptBox[
             SubscriptBox["W", "p"], "2"], " ", "+", " ", 
            RowBox[{"2", "*", "\[ImaginaryI]", "*", 
             RowBox[{"z", "/", 
              SubscriptBox["k", "p"]}]}]}]}], ",", " ", 
          RowBox[{
           SubscriptBox["q", "s"], " ", "\[Rule]", " ", 
           RowBox[{
            SuperscriptBox[
             SubscriptBox["W", "s"], "2"], " ", "-", " ", 
            RowBox[{"2", "*", "\[ImaginaryI]", "*", 
             RowBox[{
              SubscriptBox["z", "s"], "/", 
              SubscriptBox["k", "s"]}]}]}]}], ",", " ", 
          RowBox[{
           SubscriptBox["q", "i"], " ", "\[Rule]", " ", 
           RowBox[{
            SuperscriptBox[
             SubscriptBox["W", "i"], "2"], " ", "-", " ", 
            RowBox[{"2", "*", "\[ImaginaryI]", "*", 
             RowBox[{
              SubscriptBox["z", "i"], "/", 
              SubscriptBox["k", "i"]}]}]}]}], ",", " ", 
          RowBox[{
           SubscriptBox["z", "s"], " ", "\[Rule]", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Sin", "[", 
               SubscriptBox["\[Theta]", "s"], "]"}]}], "*", "y"}], " ", "+", 
            " ", 
            RowBox[{
             RowBox[{"Cos", "[", 
              SubscriptBox["\[Theta]", "s"], "]"}], "*", "z"}]}]}], ",", " ", 
          
          RowBox[{
           SubscriptBox["z", "i"], " ", "\[Rule]", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Sin", "[", 
               SubscriptBox["\[Theta]", "i"], "]"}]}], "*", "y"}], " ", "+", 
            " ", 
            RowBox[{
             RowBox[{"Cos", "[", 
              SubscriptBox["\[Theta]", "i"], "]"}], "*", "z"}]}]}]}], "}"}], 
        " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "Arg2"}], " ", "=", 
       RowBox[{"Simplify", "[", " ", 
        RowBox[{"Arg2", " ", "//.", " ", "rules1"}], "]"}]}]}]}]}], " ", 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Turns", " ", "out", " ", "this", " ", "is", " ", "way", " ", "to", " ", 
    RowBox[{"hard", ".", " ", "Going"}], " ", "to", " ", "ignore", " ", 
    "it"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.582554782936783*^9, 3.582554879991461*^9}, {
  3.582561583029579*^9, 3.582561640762952*^9}, {3.582561709843975*^9, 
  3.582561728675111*^9}, {3.5825621373940763`*^9, 3.582562190880147*^9}, {
  3.582562223501135*^9, 3.5825623913615503`*^9}, {3.582562435870626*^9, 
  3.582562439376598*^9}, {3.582562521558365*^9, 3.5825625801356792`*^9}, {
  3.582563110806714*^9, 3.58256311328623*^9}, {3.582566065536174*^9, 
  3.5825661004693317`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.58256349132627*^9, 3.582563495110099*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"OK", ",", " ", 
    RowBox[{
    "so", " ", "now", " ", "I", " ", "need", " ", "to", " ", "find", " ", 
     "the", " ", "collection", " ", "rate", " ", "into", " ", "just", " ", 
     "one", " ", "of", " ", "the", " ", 
     RowBox[{"fibers", ".", " ", "This"}], " ", "is", " ", "done", " ", "by", 
     " ", "dropping", " ", "the", " ", "Gaussian", " ", "integral", " ", "of",
      " ", "the", " ", "idler", " ", "photon"}], ",", " ", 
    RowBox[{"then", " ", "repeating", " ", "the", " ", "same", " ", 
     RowBox[{"procedure", "."}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ArgSingles", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "/", 
        RowBox[{"(", 
         RowBox[{"2", "*", 
          SubscriptBox["q", "s"]}], ")"}]}], "*", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["x", "s"], "2"], "+", 
         SuperscriptBox[
          SubscriptBox["y", "s"], "2"]}], ")"}]}], "-", 
      RowBox[{
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"2", "*", 
          SubscriptBox["q", "p"]}], ")"}]}], "*", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["x", "p"], "2"], "+", 
         SuperscriptBox[
          SubscriptBox["y", "p"], "2"]}], ")"}]}], " ", "-", " ", 
      RowBox[{"\[ImaginaryI]", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[CapitalDelta]K", "x"], "*", "x"}], " ", "+", " ", 
         RowBox[{
          SubscriptBox["\[CapitalDelta]K", "y"], "*", "y"}], "+", 
         RowBox[{
          SubscriptBox["\[CapitalDelta]K", "z"], "*", "z"}]}], ")"}]}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"ArgCoinc", " ", ":=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "1"}], "/", 
       RowBox[{"(", 
        RowBox[{"2", "*", 
         SubscriptBox["q", "s"]}], ")"}]}], "*", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["x", "s"], "2"], "+", 
        SuperscriptBox[
         SubscriptBox["y", "s"], "2"]}], ")"}]}], "-", 
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{"2", "*", 
         SubscriptBox["q", "i"]}], ")"}]}], 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["x", "i"], "2"], "+", 
        SuperscriptBox[
         SubscriptBox["y", "i"], "2"]}], ")"}]}], "-", 
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{"2", "*", 
         SubscriptBox["q", "p"]}], ")"}]}], "*", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["x", "p"], "2"], "+", 
        SuperscriptBox[
         SubscriptBox["y", "p"], "2"]}], ")"}]}], " ", "-", " ", 
     RowBox[{"\[ImaginaryI]", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[CapitalDelta]K", "x"], "*", "x"}], " ", "+", " ", 
        RowBox[{
         SubscriptBox["\[CapitalDelta]K", "y"], "*", "y"}], "+", 
        RowBox[{
         SubscriptBox["\[CapitalDelta]K", "z"], "*", "z"}]}], ")"}]}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ArgCoinc", " ", "/.", " ", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["q", "i"], "\[Rule]", " ", "\[Infinity]"}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"ArgS", " ", "=", " ", 
    RowBox[{"CompleteSquare", "[", 
     RowBox[{"ArgSingles", ",", " ", "x"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.5825682327216167`*^9, 3.582568295064464*^9}, {
  3.582568347884657*^9, 3.5825684137881413`*^9}, {3.5825684503546257`*^9, 
  3.5825684582345753`*^9}, {3.582602303021961*^9, 3.5826023084316597`*^9}, {
  3.589168811129944*^9, 3.5891689289283743`*^9}, {3.589169420261518*^9, 
  3.5891694303352013`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SubscriptBox["q", "p"]}]]}], "-", 
     FractionBox["1", 
      RowBox[{"2", " ", 
       SubscriptBox["q", "s"]}]]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"x", "-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        SubscriptBox["\[CapitalDelta]K", "x"]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["1", 
            RowBox[{"2", " ", 
             SubscriptBox["q", "p"]}]]}], "-", 
          FractionBox["1", 
           RowBox[{"2", " ", 
            SubscriptBox["q", "s"]}]]}], ")"}]}]]}], ")"}], "2"]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"2", " ", 
        SuperscriptBox["y", "2"]}], 
       SubscriptBox["q", "p"]]}], "-", 
     FractionBox[
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"y", " ", 
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}]}], "-", 
          RowBox[{"z", " ", 
           RowBox[{"Sin", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}]}]}], ")"}], "2"]}], 
      SubscriptBox["q", "s"]], "-", 
     FractionBox[
      RowBox[{"2", " ", 
       SubscriptBox["q", "p"], " ", 
       SubscriptBox["q", "s"], " ", 
       SubsuperscriptBox["\[CapitalDelta]K", "x", "2"]}], 
      RowBox[{
       SubscriptBox["q", "p"], "+", 
       SubscriptBox["q", "s"]}]], "-", 
     RowBox[{"4", " ", "\[ImaginaryI]", " ", "y", " ", 
      SubscriptBox["\[CapitalDelta]K", "y"]}], "-", 
     RowBox[{"4", " ", "\[ImaginaryI]", " ", "z", " ", 
      SubscriptBox["\[CapitalDelta]K", "z"]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.582568464458056*^9, 3.5825685993854227`*^9, {3.582599632791799*^9, 
   3.582599634678857*^9}, 3.5826023108739843`*^9, 3.582672765073677*^9, 
   3.5826735123858643`*^9, 3.589146797617275*^9, 3.589161931394212*^9, {
   3.5891688287708673`*^9, 3.589168840575873*^9}, {3.589168880382742*^9, 
   3.589168898473341*^9}, 3.589168930885706*^9, {3.5891694214895277`*^9, 
   3.589169430887136*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"xconsts", " ", ":=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    FractionBox[
     RowBox[{"\[Sqrt]", "\[Pi]"}], 
     RowBox[{"\[Sqrt]", 
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", 
           RowBox[{"2", " ", 
            SubscriptBox["q", "p"]}]]}], "-", 
         FractionBox["1", 
          RowBox[{"2", " ", 
           SubscriptBox["q", "s"]}]]}], ")"}], " "}]}]], "//.", " ", 
    "rules2"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"yints", " ", ":=", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"2", " ", 
        SuperscriptBox["y", "2"]}], 
       SubscriptBox["q", "p"]]}], "-", 
     FractionBox[
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"y", " ", 
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}]}], "-", 
          RowBox[{"z", " ", 
           RowBox[{"Sin", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}]}]}], ")"}], "2"]}], 
      SubscriptBox["q", "s"]], "-", 
     FractionBox[
      RowBox[{"2", " ", 
       SubscriptBox["q", "p"], " ", 
       SubscriptBox["q", "s"], " ", 
       SubsuperscriptBox["\[CapitalDelta]K", "x", "2"]}], 
      RowBox[{
       SubscriptBox["q", "p"], "+", 
       SubscriptBox["q", "s"]}]], "-", 
     RowBox[{"4", " ", "\[ImaginaryI]", " ", "y", " ", 
      SubscriptBox["\[CapitalDelta]K", "y"]}], "-", 
     RowBox[{"4", " ", "\[ImaginaryI]", " ", "z", " ", 
      SubscriptBox["\[CapitalDelta]K", "z"]}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"yints", " ", "=", " ", 
  RowBox[{"CompleteSquare", "[", 
   RowBox[{"yints", ",", " ", "y"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.582568630368575*^9, 3.582568636495154*^9}, {
   3.5825689333303432`*^9, 3.5825689474349833`*^9}, {3.5825996489443197`*^9, 
   3.582599665102371*^9}, 3.5826023349874353`*^9, {3.582672786024575*^9, 
   3.582672797490996*^9}, 3.589146819471959*^9, 3.5891694615663967`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SubscriptBox["q", "p"]}]]}], "-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"Cos", "[", 
        SubscriptBox["\[Theta]", "s"], "]"}], "2"], 
      RowBox[{"2", " ", 
       SubscriptBox["q", "s"]}]]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"y", "+", 
      FractionBox[
       RowBox[{
        FractionBox[
         RowBox[{"z", " ", 
          RowBox[{"Cos", "[", 
           SubscriptBox["\[Theta]", "s"], "]"}], " ", 
          RowBox[{"Sin", "[", 
           SubscriptBox["\[Theta]", "s"], "]"}]}], 
         SubscriptBox["q", "s"]], "-", 
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["\[CapitalDelta]K", "y"]}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["1", 
            RowBox[{"2", " ", 
             SubscriptBox["q", "p"]}]]}], "-", 
          FractionBox[
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "s"], "]"}], "2"], 
           RowBox[{"2", " ", 
            SubscriptBox["q", "s"]}]]}], ")"}]}]]}], ")"}], "2"]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"2", " ", 
        SuperscriptBox["z", "2"], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", 
          SubscriptBox["\[Theta]", "s"], "]"}], "2"]}], 
       SubscriptBox["q", "s"]]}], "-", 
     FractionBox[
      RowBox[{"2", " ", 
       SubscriptBox["q", "p"], " ", 
       SubscriptBox["q", "s"], " ", 
       SubsuperscriptBox["\[CapitalDelta]K", "x", "2"]}], 
      RowBox[{
       SubscriptBox["q", "p"], "+", 
       SubscriptBox["q", "s"]}]], "-", 
     FractionBox[
      RowBox[{"2", " ", 
       SubscriptBox["q", "p"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[ImaginaryI]", " ", "z", " ", 
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}]}], "+", 
          RowBox[{
           SubscriptBox["q", "s"], " ", 
           SubscriptBox["\[CapitalDelta]K", "y"]}]}], ")"}], "2"]}], 
      RowBox[{
       SubscriptBox["q", "s"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
          SubscriptBox["q", "p"]}], "+", 
         SubscriptBox["q", "s"]}], ")"}]}]], "-", 
     RowBox[{"4", " ", "\[ImaginaryI]", " ", "z", " ", 
      SubscriptBox["\[CapitalDelta]K", "z"]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.5825686174101343`*^9, 3.582568637714926*^9}, 
   3.582568950650221*^9, 3.582599669640561*^9, 3.582602342464911*^9, 
   3.58267280053104*^9, 3.582673513474505*^9, 3.582676774789138*^9, {
   3.589146804762609*^9, 3.589146824951406*^9}, 3.589154749425912*^9, 
   3.589154825469274*^9, 3.589161931992063*^9, 3.589169463974133*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "This", " ", "leaves", " ", "us", " ", "with", " ", "the", " ", "y", " ", 
    "constant", " ", "and", " ", "the", " ", "z", " ", "integrand"}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"yconsts", " ", ":=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      FractionBox[
       RowBox[{"\[Sqrt]", "\[Pi]"}], 
       RowBox[{"\[Sqrt]", 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            FractionBox["1", 
             RowBox[{"2", " ", 
              SubscriptBox["q", "p"]}]]}], "-", 
           FractionBox[
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              SubscriptBox["\[Theta]", "s"], "]"}], "2"], 
            RowBox[{"2", " ", 
             SubscriptBox["q", "s"]}]]}], ")"}]}]}]], " ", "//.", " ", 
      "rules2"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"zints", " ", ":=", 
    RowBox[{
     FractionBox["1", "4"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"2", " ", 
          SuperscriptBox["z", "2"], " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}], "2"]}], 
         SubscriptBox["q", "s"]]}], "-", 
       FractionBox[
        RowBox[{"2", " ", 
         SubscriptBox["q", "p"], " ", 
         SubscriptBox["q", "s"], " ", 
         SubsuperscriptBox["\[CapitalDelta]K", "x", "2"]}], 
        RowBox[{
         SubscriptBox["q", "p"], "+", 
         SubscriptBox["q", "s"]}]], "-", 
       FractionBox[
        RowBox[{"2", " ", 
         SubscriptBox["q", "p"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[ImaginaryI]", " ", "z", " ", 
             RowBox[{"Cos", "[", 
              SubscriptBox["\[Theta]", "s"], "]"}], " ", 
             RowBox[{"Sin", "[", 
              SubscriptBox["\[Theta]", "s"], "]"}]}], "+", 
            RowBox[{
             SubscriptBox["q", "s"], " ", 
             SubscriptBox["\[CapitalDelta]K", "y"]}]}], ")"}], "2"]}], 
        RowBox[{
         SubscriptBox["q", "s"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
            SubscriptBox["q", "p"]}], "+", 
           SubscriptBox["q", "s"]}], ")"}]}]], "-", 
       RowBox[{"4", " ", "\[ImaginaryI]", " ", "z", " ", 
        SubscriptBox["\[CapitalDelta]K", "z"]}]}], ")"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Now", " ", "make", " ", "the", " ", "subsitution", " ", "where", " ", 
     "we", " ", "assume", " ", "that", " ", "the", " ", "waist", " ", "is", 
     " ", "constant", " ", "in", " ", "the", " ", "crystal"}], 
    "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"zints", "=", " ", 
    RowBox[{
     RowBox[{"Expand", "[", "zints", "]"}], " ", "/.", " ", 
     RowBox[{"{", 
      RowBox[{
       SubsuperscriptBox["\[Rho]", "px", "2"], " ", "\[Rule]", "0"}], 
      "}"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"zints", " ", "=", " ", 
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{"zints", " ", "2"}], ",", " ", "z"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.582568647045869*^9, 3.5825687295282097`*^9}, {
   3.58256880012293*^9, 3.582568861881715*^9}, {3.5825689597890263`*^9, 
   3.582568971125276*^9}, {3.582599678597131*^9, 3.582599706448551*^9}, {
   3.582602375914809*^9, 3.5826024382386427`*^9}, {3.582602472426429*^9, 
   3.582602508278699*^9}, {3.5826025803559523`*^9, 3.582602584516078*^9}, {
   3.5826728156612787`*^9, 3.5826728432878428`*^9}, 3.589146867457657*^9, {
   3.589169480525074*^9, 3.589169491131032*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     SuperscriptBox["z", "2"], " ", 
     SuperscriptBox[
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Theta]", "s"], "]"}], "2"]}], 
    RowBox[{"2", " ", 
     SubscriptBox["q", "s"]}]]}], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["z", "2"], " ", 
    SuperscriptBox[
     RowBox[{"Cos", "[", 
      SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"Sin", "[", 
      SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
    SubscriptBox["q", "p"]}], 
   RowBox[{"2", " ", 
    SubscriptBox["q", "s"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
       SubscriptBox["q", "p"]}], "+", 
      SubscriptBox["q", "s"]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["q", "p"], " ", 
    SubscriptBox["q", "s"], " ", 
    SubsuperscriptBox["\[CapitalDelta]K", "x", "2"]}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["q", "p"], "+", 
      SubscriptBox["q", "s"]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "z", " ", 
    RowBox[{"Cos", "[", 
     SubscriptBox["\[Theta]", "s"], "]"}], " ", 
    RowBox[{"Sin", "[", 
     SubscriptBox["\[Theta]", "s"], "]"}], " ", 
    SubscriptBox["q", "p"], " ", 
    SubscriptBox["\[CapitalDelta]K", "y"]}], 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
     SubscriptBox["q", "p"]}], "+", 
    SubscriptBox["q", "s"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["q", "p"], " ", 
    SubscriptBox["q", "s"], " ", 
    SubsuperscriptBox["\[CapitalDelta]K", "y", "2"]}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
       SubscriptBox["q", "p"]}], "+", 
      SubscriptBox["q", "s"]}], ")"}]}]], "-", 
  RowBox[{"\[ImaginaryI]", " ", "z", " ", 
   SubscriptBox["\[CapitalDelta]K", "z"]}]}]], "Output",
 CellChangeTimes->{
  3.582568993163918*^9, 3.5825997089329367`*^9, 3.582602383641865*^9, 
   3.582602429638177*^9, {3.582602487795052*^9, 3.582602519731134*^9}, 
   3.5826025852199183`*^9, {3.582672816584609*^9, 3.582672839653619*^9}, 
   3.582673513586959*^9, 3.582676771199173*^9, {3.5891468686722307`*^9, 
   3.5891468793230963`*^9}, 3.589154743651537*^9, 3.589154820101966*^9, 
   3.589161932040421*^9, 3.58916949254174*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", 
   SuperscriptBox["z", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Sin", "[", 
         SubscriptBox["\[Theta]", "s"], "]"}], "2"], 
       RowBox[{"2", " ", 
        SubscriptBox["q", "s"]}]]}], "+", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", 
         SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
       SubscriptBox["q", "p"]}], 
      RowBox[{"2", " ", 
       SubscriptBox["q", "s"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
          SubscriptBox["q", "p"]}], "+", 
         SubscriptBox["q", "s"]}], ")"}]}]]}], ")"}]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SubscriptBox["q", "p"], " ", 
        SubscriptBox["q", "s"], " ", 
        SubsuperscriptBox["\[CapitalDelta]K", "x", "2"]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["q", "p"], "+", 
          SubscriptBox["q", "s"]}], ")"}]}]]}], "-", 
     FractionBox[
      RowBox[{
       SubscriptBox["q", "p"], " ", 
       SubscriptBox["q", "s"], " ", 
       SubsuperscriptBox["\[CapitalDelta]K", "y", "2"]}], 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
          SubscriptBox["q", "p"]}], "+", 
         SubscriptBox["q", "s"]}], ")"}]}]]}], ")"}]}], "+", 
  RowBox[{"2", " ", "z", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "s"], "]"}], " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["\[Theta]", "s"], "]"}], " ", 
        SubscriptBox["q", "p"], " ", 
        SubscriptBox["\[CapitalDelta]K", "y"]}], 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"Cos", "[", 
           SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
         SubscriptBox["q", "p"]}], "+", 
        SubscriptBox["q", "s"]}]]}], "-", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[CapitalDelta]K", "z"]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.582568993163918*^9, 3.5825997089329367`*^9, 3.582602383641865*^9, 
   3.582602429638177*^9, {3.582602487795052*^9, 3.582602519731134*^9}, 
   3.5826025852199183`*^9, {3.582672816584609*^9, 3.582672839653619*^9}, 
   3.582673513586959*^9, 3.582676771199173*^9, {3.5891468686722307`*^9, 
   3.5891468793230963`*^9}, 3.589154743651537*^9, 3.589154820101966*^9, 
   3.589161932040421*^9, 3.5891694925439253`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Same", " ", "form", " ", "of", " ", "the", " ", "integral", " ", 
    RowBox[{"before", ".", " ", "Now"}], " ", "we", " ", 
    RowBox[{"have", ":"}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    SubscriptBox["AA", "singles"], "=", 
    RowBox[{"Simplify", "[", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           SuperscriptBox[
            RowBox[{"Sin", "[", 
             SubscriptBox["\[Theta]", "s"], "]"}], "2"], 
           RowBox[{"2", " ", 
            SubscriptBox["q", "s"]}]]}], "+", 
         FractionBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", 
             SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
           SubscriptBox["q", "p"]}], 
          RowBox[{"2", " ", 
           SubscriptBox["q", "s"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox[
               RowBox[{"Cos", "[", 
                SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
              SubscriptBox["q", "p"]}], "+", 
             SubscriptBox["q", "s"]}], ")"}]}]]}], ")"}]}], "//.", " ", 
      "rules2"}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["BB", "singles"], "=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "/", "\[ImaginaryI]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "s"], "]"}], " ", 
            RowBox[{"Sin", "[", 
             SubscriptBox["\[Theta]", "s"], "]"}], " ", 
            SubscriptBox["q", "p"], " ", 
            SubscriptBox["\[CapitalDelta]K", "y"]}], 
           RowBox[{
            RowBox[{
             SuperscriptBox[
              RowBox[{"Cos", "[", 
               SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
             SubscriptBox["q", "p"]}], "+", 
            SubscriptBox["q", "s"]}]]}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[CapitalDelta]K", "z"]}]}], ")"}]}], " ", "//.", 
      "rules2"}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["CC", "singles"], "=", 
    RowBox[{"Simplify", "[", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            SubscriptBox["q", "p"], " ", 
            SubscriptBox["q", "s"], " ", 
            SubsuperscriptBox["\[CapitalDelta]K", "x", "2"]}], 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["q", "p"], "+", 
              SubscriptBox["q", "s"]}], ")"}]}]]}], "-", 
         FractionBox[
          RowBox[{
           SubscriptBox["q", "p"], " ", 
           SubscriptBox["q", "s"], " ", 
           SubsuperscriptBox["\[CapitalDelta]K", "y", "2"]}], 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox[
               RowBox[{"Cos", "[", 
                SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
              SubscriptBox["q", "p"]}], "+", 
             SubscriptBox["q", "s"]}], ")"}]}]]}], ")"}]}], " ", "//.", " ", 
      "rules2"}], "]"}]}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.582568998627551*^9, 3.582569122630061*^9}, {
   3.582569195819693*^9, 3.582569209101898*^9}, {3.5825770479358053`*^9, 
   3.582577065139308*^9}, {3.582599741109345*^9, 3.582599811679747*^9}, 
   3.582602622125238*^9, {3.582602654339089*^9, 3.5826027099108353`*^9}, {
   3.5826027433688507`*^9, 3.582602749314074*^9}, {3.582602780093316*^9, 
   3.582602825822988*^9}, {3.582672866938905*^9, 3.582672913276663*^9}, {
   3.5891469040701036`*^9, 3.589146920570965*^9}, {3.5891541086315813`*^9, 
   3.5891541340885553`*^9}, {3.589154654371779*^9, 3.589154663416788*^9}, {
   3.589154806942565*^9, 3.5891548321720657`*^9}, {3.58916952138275*^9, 
   3.589169541441922*^9}}],

Cell[BoxData[
 FractionBox[
  SuperscriptBox[
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Theta]", "s"], "]"}], "2"], 
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"Cos", "[", 
      SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
    SubsuperscriptBox["W", "p", "2"]}], "+", 
   SubsuperscriptBox["W", "s", "2"]}]]], "Output",
 CellChangeTimes->{
  3.5825998130225973`*^9, {3.582602700498282*^9, 3.582602711014062*^9}, 
   3.582602793714965*^9, 3.582602827269425*^9, 3.582603120629777*^9, 
   3.582672916856567*^9, 3.582673513638441*^9, 3.589146921666901*^9, 
   3.589154135256165*^9, 3.589154663960455*^9, 3.5891547551352777`*^9, {
   3.589154809051093*^9, 3.589154833041725*^9}, 3.589158961062722*^9, 
   3.5891619320719633`*^9, 3.589169543497047*^9, 3.58916965138062*^9}],

Cell[BoxData[
 RowBox[{"2", " ", 
  RowBox[{"(", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Theta]", "s"], "]"}], " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Theta]", "s"], "]"}], " ", 
      SubsuperscriptBox["W", "p", "2"], " ", 
      SubscriptBox["\[CapitalDelta]K", "y"]}], 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
       SubsuperscriptBox["W", "p", "2"]}], "+", 
      SubsuperscriptBox["W", "s", "2"]}]], "+", 
    SubscriptBox["\[CapitalDelta]K", "z"]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.5825998130225973`*^9, {3.582602700498282*^9, 3.582602711014062*^9}, 
   3.582602793714965*^9, 3.582602827269425*^9, 3.582603120629777*^9, 
   3.582672916856567*^9, 3.582673513638441*^9, 3.589146921666901*^9, 
   3.589154135256165*^9, 3.589154663960455*^9, 3.5891547551352777`*^9, {
   3.589154809051093*^9, 3.589154833041725*^9}, 3.589158961062722*^9, 
   3.5891619320719633`*^9, 3.589169543497047*^9, 3.5891696514258327`*^9}],

Cell[BoxData[
 RowBox[{
  SubsuperscriptBox["W", "p", "2"], " ", 
  SubsuperscriptBox["W", "s", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    FractionBox[
     SubsuperscriptBox["\[CapitalDelta]K", "x", "2"], 
     RowBox[{
      SubsuperscriptBox["W", "p", "2"], "+", 
      SubsuperscriptBox["W", "s", "2"]}]], "+", 
    FractionBox[
     SubsuperscriptBox["\[CapitalDelta]K", "y", "2"], 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
       SubsuperscriptBox["W", "p", "2"]}], "+", 
      SubsuperscriptBox["W", "s", "2"]}]]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.5825998130225973`*^9, {3.582602700498282*^9, 3.582602711014062*^9}, 
   3.582602793714965*^9, 3.582602827269425*^9, 3.582603120629777*^9, 
   3.582672916856567*^9, 3.582673513638441*^9, 3.589146921666901*^9, 
   3.589154135256165*^9, 3.589154663960455*^9, 3.5891547551352777`*^9, {
   3.589154809051093*^9, 3.589154833041725*^9}, 3.589158961062722*^9, 
   3.5891619320719633`*^9, 3.589169543497047*^9, 3.5891696514838657`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "We", " ", "can", " ", "use", " ", "the", " ", "same", " ", "series", " ",
      "expansion", " ", "for", " ", "the", " ", "integral"}], ",", " ", 
    RowBox[{"now", " ", "with", " ", "different", " ", 
     RowBox[{
     "coefficients", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "First"}]}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"let", "'"}], "s", " ", "look", " ", "at", " ", "the", " ", 
      RowBox[{"prefactors", ".", " ", "The"}], " ", "relationship", " ", 
      "for", " ", "efficiency", " ", "is", " ", "E"}], " ", "=", " ", 
     RowBox[{
      SubscriptBox["P", "coinc"], " ", "/", " ", 
      SubscriptBox["P", "singles"]}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"prefactor", "=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"xconst", "*", "yconst"}], ")"}], "^", "2"}], "/", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"xconsts", "*", "yconsts"}], ")"}], "^", "2"}]}], "]"}]}], 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.5825692161586647`*^9, 3.582569367864915*^9}, {
   3.5825826185960503`*^9, 3.582582619699774*^9}, {3.58258265972381*^9, 
   3.582582685331806*^9}, {3.5825827457681923`*^9, 3.582582761369029*^9}, 
   3.5825998835167313`*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.582599863339098*^9, 3.582599863349024*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "That", " ", "worked", " ", "out", " ", "nicer", " ", "than", " ", 
    RowBox[{"expected", "!"}], " ", "Now", " ", 
    RowBox[{"let", "'"}], "s", " ", "try", " ", "the", " ", "ratio", " ", 
    "of", " ", "the", " ", "series", " ", "expansion", " ", "of", " ", "the", 
    " ", "two", " ", 
    RowBox[{"integrals", "."}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"inttest", ":=", " ", 
    RowBox[{
     RowBox[{"Exp", "[", 
      RowBox[{"-", "T"}], "]"}], "*", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"z", "^", "2"}]}], " ", "*", 
        RowBox[{"(", "R", " ", ")"}]}], " ", "-", 
       RowBox[{"z", " ", "*", 
        RowBox[{"(", 
         RowBox[{"\[ImaginaryI]", "*", "S"}], ")"}]}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"IntResultExact", " ", "=", 
     RowBox[{"Normal", "[", 
      RowBox[{"Assuming", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"R", ">", 
          RowBox[{"-", "inf"}]}], " ", "&&", " ", 
         RowBox[{"S", ">", 
          RowBox[{"-", "inf"}]}], " ", "&&", " ", 
         RowBox[{"T", ">", 
          RowBox[{"-", "inf"}]}]}], " ", ",", " ", 
        RowBox[{"Integrate", "[", 
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"z", "^", "2"}]}], " ", "*", 
             RowBox[{"(", "R", " ", ")"}]}], " ", "-", 
            RowBox[{"z", " ", "*", 
             RowBox[{"(", 
              RowBox[{"\[ImaginaryI]", "*", "S"}], ")"}]}], " ", "-", " ", 
            "T"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"z", ",", "0", ",", "L"}], "}"}]}], "]"}]}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["P", "coinc"], " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{
         SubscriptBox["n", "s"], "*", 
         SubscriptBox["n", "p"], "*", 
         SubscriptBox["n", "i"], " ", "*", "xconst", "*", "yconst", "*", 
         "IntResult"}], "]"}], "^", "2"}], " ", "/.", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"R", " ", "\[Rule]", " ", "AA"}], ",", " ", 
        RowBox[{"S", " ", "\[Rule]", " ", "BB"}], ",", " ", 
        RowBox[{"T", " ", "\[Rule]", " ", "CC"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      SubscriptBox["P", "coinc"], " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["n", "s"], "*", 
          SubscriptBox["n", "i"], "*", 
          SubscriptBox["n", "p"], "*", "xconst", " ", "*", " ", "yconst"}], 
         ")"}], "^", "2"}], " ", "*", 
       SubscriptBox["P", "coinc"]}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      SubscriptBox["P", "singles"], "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", "IntResult", "]"}], "^", "2"}], " ", "//.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"R", " ", "\[Rule]", " ", 
          SubscriptBox["AA", "singles"]}], ",", " ", 
         RowBox[{"S", " ", "\[Rule]", " ", 
          SubscriptBox["BB", "singles"]}], ",", " ", 
         RowBox[{"T", " ", "\[Rule]", " ", 
          SubscriptBox["CC", "singles"]}]}], "}"}]}]}], ";"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["P", "singles"], "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[", " ", 
        RowBox[{
         SubscriptBox["n", "s"], "*", 
         SubscriptBox["n", "p"], "*", "xconsts", "*", "yconsts", "*", 
         "IntResult"}], "]"}], "^", "2"}], " ", "/.", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"R", " ", "\[Rule]", " ", 
         SubscriptBox["AA", "singles"]}], ",", " ", 
        RowBox[{"S", " ", "\[Rule]", " ", 
         SubscriptBox["BB", "singles"]}], ",", " ", 
        RowBox[{"T", " ", "\[Rule]", " ", 
         SubscriptBox["CC", "singles"]}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      SubscriptBox["P", "singles"], " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["n", "s"], "*", 
          SubscriptBox["n", "p"], "*", "xconsts", " ", "*", " ", "yconsts"}], 
         ")"}], "^", "2"}], " ", "*", 
       SubscriptBox["P", "singles"]}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["P", "singles"], "=", 
     RowBox[{"Assuming", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["W", "p"], ">", "0"}], " ", "&&", " ", 
        RowBox[{
         SubscriptBox["W", "s"], ">", "0"}], " ", "&&", " ", 
        RowBox[{
         SubscriptBox["W", "i"], ">", "0"}]}], ",", " ", 
       SubscriptBox["P", "singles"]}], " ", "]"}]}], " ", ";", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"//.", " ", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["W", "i"], "\[Rule]", "1000000"}], "}"}]}], ";"}], 
     "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["P", "singles"], " ", "=", "  ", 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{
             SubscriptBox["n", "s"], "*", 
             SubscriptBox["n", "p"], " ", "*", "xconsts", "*", "yconsts", "*",
              "IntResult"}], "]"}], "^", "2"}], " ", "/.", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"R", " ", "\[Rule]", " ", "AA"}], ",", " ", 
            RowBox[{"S", " ", "\[Rule]", " ", "BB"}], ",", " ", 
            RowBox[{"T", " ", "\[Rule]", " ", "CC"}]}], "}"}]}]}], ";"}], " ",
        "/.", " ", 
       RowBox[{"{", " ", 
        RowBox[{
         SubscriptBox["W", "s"], "\[Rule]", "\[Infinity]"}], "}"}]}], ";"}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"Eff", " ", "=", " ", 
     RowBox[{
      SubscriptBox["P", "coinc"], "/", 
      SubscriptBox["P", "singles"]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"rules2a", " ", ":=", " ", 
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Theta]", "s"], " ", "\[Rule]", " ", 
       RowBox[{"0.01", "*", 
        RowBox[{"\[Pi]", "/", "180"}]}]}], ",", " ", 
      RowBox[{
       SubscriptBox["\[Theta]", "i"], " ", "\[Rule]", " ", 
       RowBox[{"0.01", "*", 
        RowBox[{"\[Pi]", "/", "180"}]}]}], " ", ",", " ", 
      RowBox[{
       SubscriptBox["W", "s"], " ", "\[Rule]", " ", ".0001"}], ",", " ", 
      RowBox[{
       SubscriptBox["W", "i"], " ", "\[Rule]", " ", ".0001"}], ",", " ", 
      RowBox[{
       SubscriptBox["W", "p"], "\[Rule]", " ", ".001"}], ",", "   ", 
      RowBox[{
       SubscriptBox["\[CapitalDelta]K", "x"], " ", "\[Rule]", "0"}], ",", 
      "  ", 
      RowBox[{
       SubscriptBox["\[CapitalDelta]K", "y"], " ", "\[Rule]", " ", "0"}], ",",
       " ", 
      RowBox[{
       SubscriptBox["\[CapitalDelta]K", "z"], "\[Rule]", "0"}], ",", " ", 
      RowBox[{"L", " ", "\[Rule]", " ", ".001"}]}], "}"}]}], 
   "\[IndentingNewLine]", "\"\<expand\>\"", "\[IndentingNewLine]", 
   RowBox[{"rulesc", " ", ":=", " ", 
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Theta]", "s"], " ", "\[Rule]", " ", 
       RowBox[{"0.00", "*", 
        RowBox[{"\[Pi]", "/", "180"}]}]}], ",", " ", 
      RowBox[{
       SubscriptBox["\[Theta]", "i"], " ", "\[Rule]", " ", 
       RowBox[{"0.00", "*", 
        RowBox[{"\[Pi]", "/", "180"}]}]}], ",", " ", 
      RowBox[{
       SubscriptBox["\[CapitalDelta]K", "x"], " ", "\[Rule]", "0"}], ",", " ", 
      RowBox[{
       SubscriptBox["\[CapitalDelta]K", "z"], "\[Rule]", "0"}], " ", ",", " ", 
      RowBox[{
       SubscriptBox["\[CapitalDelta]K", "y"], " ", "\[Rule]", " ", "1"}]}], 
     "}"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"testcoinc", " ", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"z", "^", "2"}]}], " ", "*", 
          RowBox[{"(", "R", " ", ")"}]}], " ", "-", 
         RowBox[{"z", " ", "*", 
          RowBox[{"(", 
           RowBox[{"\[ImaginaryI]", "*", "S"}], ")"}]}], " ", "-", " ", "T"}],
         "]"}], " ", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"R", " ", "\[Rule]", " ", "AA"}], ",", " ", 
         RowBox[{"S", " ", "\[Rule]", " ", "BB"}], ",", " ", 
         RowBox[{"T", " ", "\[Rule]", " ", "CC"}]}], "}"}]}], "   ", "/.", 
      " ", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["W", "i"], "\[Rule]", "0"}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"testsingles", " ", "=", 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"z", "^", "2"}]}], " ", "*", 
         RowBox[{"(", "R", " ", ")"}]}], " ", "-", 
        RowBox[{"z", " ", "*", 
         RowBox[{"(", 
          RowBox[{"\[ImaginaryI]", "*", "S"}], ")"}]}], " ", "-", " ", "T"}], 
       "]"}], " ", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"R", " ", "\[Rule]", " ", 
         SubscriptBox["AA", "singles"]}], ",", " ", 
        RowBox[{"S", " ", "\[Rule]", " ", 
         SubscriptBox["BB", "singles"]}], ",", " ", 
        RowBox[{"T", " ", "\[Rule]", " ", 
         SubscriptBox["CC", "singles"]}]}], "}"}]}]}], "  ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"testcoinc", " ", "-", " ", "testsingles"}], " ", "/.", 
     "rulesc"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"w", ":=", " ", "10"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"w", "^", "3"}], "/", 
      RowBox[{"(", 
       RowBox[{"3", "*", 
        RowBox[{"w", "^", "2"}]}], ")"}]}], "/", "2"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"w", "^", "2"}], "/", 
     RowBox[{"(", 
      RowBox[{"2", "*", "w"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
   "\"\<coeff\>\"", "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["n", "s"], "*", 
    SubscriptBox["n", "p"], "*", 
    SubscriptBox["n", "i"], " ", "*", "xconst", "*", "yconst"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"*", "1.00001"}], " ", "/.", "rules2a"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["n", "s"], "*", 
     SubscriptBox["n", "p"], " ", "*", "xconsts", "*", "yconsts"}], " ", "/.",
     " ", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["\[Theta]", "s"], " ", "\[Rule]", "0"}], "}"}]}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"*", "1.00001"}], " ", "/.", "rules2a"}], "*)"}], 
   "\[IndentingNewLine]", "\"\<coinc\>\"", "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["P", "coinc"], " ", "/.", "rules2a"}], 
   "\[IndentingNewLine]", "\"\<singles\>\"", "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["P", "singles"], " ", "/.", "rules2a"}], " ", 
   "\[IndentingNewLine]", "\"\<eff\>\"", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["P", "coinc"], " ", "/", " ", 
      SubscriptBox["P", "singles"]}], " ", "*", "1."}], " ", "/.", 
    "rules2a"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Abs", "[", "IntResultExact", "]"}], " ", "/.", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"R", " ", "\[Rule]", " ", 
         SubscriptBox["AA", "singles"]}], ",", " ", 
        RowBox[{"S", " ", "\[Rule]", " ", 
         SubscriptBox["BB", "singles"]}], ",", " ", 
        RowBox[{"T", " ", "\[Rule]", " ", 
         SubscriptBox["CC", "singles"]}]}], "}"}]}], " ", "/.", "  ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Theta]", "i"], " ", "\[Rule]", " ", 
        RowBox[{"0.1", "*", 
         RowBox[{"\[Pi]", "/", "180"}]}]}], " ", ",", " ", 
       RowBox[{
        SubscriptBox["\[Theta]", "s"], " ", "\[Rule]", "  ", 
        RowBox[{"0.1", "*", 
         RowBox[{"\[Pi]", "/", "180"}]}]}], ",", " ", 
       RowBox[{
        SubscriptBox["\[CapitalDelta]K", "y"], " ", "\[Rule]", " ", "0"}], 
       ",", 
       RowBox[{
        SubscriptBox["\[CapitalDelta]K", "x"], " ", "\[Rule]", "0"}], ",", 
       " ", 
       RowBox[{
        SubscriptBox["\[CapitalDelta]K", "z"], "\[Rule]", "0"}]}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"\"\<coinc\>\"", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Abs", "[", "IntResultExact", "]"}], " ", "/.", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"R", " ", "\[Rule]", " ", "AA"}], ",", " ", 
        RowBox[{"S", " ", "\[Rule]", " ", "BB"}], ",", " ", 
        RowBox[{"T", " ", "\[Rule]", " ", "CC"}]}], "}"}]}], " ", "/.", "  ", 
     
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Theta]", "i"], " ", "\[Rule]", " ", 
        RowBox[{"0.1", "*", 
         RowBox[{"\[Pi]", "/", "180"}]}]}], " ", ",", " ", 
       RowBox[{
        SubscriptBox["\[Theta]", "s"], " ", "\[Rule]", "  ", 
        RowBox[{"0.1", "*", 
         RowBox[{"\[Pi]", "/", "180"}]}]}], ",", " ", 
       RowBox[{
        SubscriptBox["\[CapitalDelta]K", "x"], " ", "\[Rule]", "0"}], ",", 
       " ", 
       RowBox[{
        SubscriptBox["\[CapitalDelta]K", "z"], "\[Rule]", "0"}], ",", " ", 
       RowBox[{
        SubscriptBox["\[CapitalDelta]K", "y"], " ", "\[Rule]", " ", "0"}]}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"\"\<erf\>\"", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Erf", "[", "50", "]"}], "*", "1.0000000001"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["n", "s"], "*", 
     SubscriptBox["n", "p"], " ", "xconsts", "*", "yconsts"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Eff", " ", "=", " ", 
     RowBox[{"Simplify", "[", "Eff", "]"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"This", " ", "gets", " ", "ugly", " ", "in", " ", "a", " ", 
     RowBox[{"hurry", ".", " ", 
      RowBox[{"abort", "!"}]}]}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.582569425920869*^9, 3.5825696338585043`*^9}, {
   3.5825701049369793`*^9, 3.58257013172652*^9}, {3.582581682138384*^9, 
   3.582581696816908*^9}, {3.582672926435391*^9, 3.582672969493376*^9}, 
   3.5826730590357122`*^9, {3.582673630467607*^9, 3.582673641219104*^9}, {
   3.582673939896338*^9, 3.5826741631619053`*^9}, {3.582674211487598*^9, 
   3.5826742375756207`*^9}, {3.582674324196042*^9, 3.582674325082368*^9}, {
   3.5826745785791197`*^9, 3.582674768747527*^9}, {3.5826748402281837`*^9, 
   3.582674848320345*^9}, {3.582676563250276*^9, 3.582676598509592*^9}, {
   3.5826767007783546`*^9, 3.5826767193737507`*^9}, {3.582677042395626*^9, 
   3.582677047054591*^9}, {3.5891532431981173`*^9, 3.589153334366681*^9}, {
   3.589153937038446*^9, 3.5891539492981377`*^9}, {3.589154153010461*^9, 
   3.589154179661923*^9}, {3.589155317005013*^9, 3.589155325479734*^9}, {
   3.589156627706032*^9, 3.5891566502135897`*^9}, {3.589157826668106*^9, 
   3.589157880100156*^9}, {3.589157951283845*^9, 3.589158001013797*^9}, {
   3.5891580416857367`*^9, 3.5891580420846853`*^9}, {3.589158092496931*^9, 
   3.589158241031499*^9}, {3.589158600611247*^9, 3.589158638096024*^9}, {
   3.589158675574966*^9, 3.58915874869798*^9}, {3.589158806021665*^9, 
   3.589158880207719*^9}, {3.589158939556984*^9, 3.589158940108856*^9}, {
   3.5891589846145563`*^9, 3.589159001231635*^9}, {3.589159085915511*^9, 
   3.589159115584244*^9}, {3.5891591568161163`*^9, 3.5891592356847553`*^9}, {
   3.589159292304716*^9, 3.589159442165369*^9}, {3.5891595281992407`*^9, 
   3.589159528823045*^9}, {3.589159576959828*^9, 3.589159644329967*^9}, {
   3.5891601539717607`*^9, 3.589160208678763*^9}, {3.5891602404064913`*^9, 
   3.589160365267049*^9}, {3.589160401722396*^9, 3.589160483570478*^9}, {
   3.589160514087223*^9, 3.589160605500618*^9}, {3.5891606372610083`*^9, 
   3.5891606544094763`*^9}, {3.589160686428739*^9, 3.589160701564342*^9}, {
   3.5891607399099827`*^9, 3.589160761256093*^9}, {3.589160860691533*^9, 
   3.589160988094215*^9}, {3.589161080755043*^9, 3.5891611249474363`*^9}, {
   3.589161211963291*^9, 3.589161212276353*^9}, 3.5891612568535833`*^9, {
   3.589161455487368*^9, 3.589161459685523*^9}, {3.589161519036232*^9, 
   3.589161576235293*^9}, {3.589161622138089*^9, 3.5891616482750196`*^9}, 
   3.589161716718768*^9, {3.589161791943503*^9, 3.589161896045944*^9}, {
   3.589162575388196*^9, 3.589162772123802*^9}, {3.589162811699679*^9, 
   3.589162853671826*^9}, {3.5891628873016148`*^9, 3.589162897780089*^9}, {
   3.589163032629395*^9, 3.58916303562201*^9}, {3.589163143770659*^9, 
   3.589163253689801*^9}, {3.589163313156631*^9, 3.589163313820606*^9}, {
   3.589163356097204*^9, 3.589163393684507*^9}, {3.589163440713049*^9, 
   3.589163453199238*^9}, {3.5891634961363487`*^9, 3.589163537214642*^9}, {
   3.589168405075304*^9, 3.5891685132938623`*^9}, {3.5891685801385517`*^9, 
   3.5891685808208113`*^9}, {3.58916897585096*^9, 3.589169050290517*^9}, {
   3.589169110380064*^9, 3.589169241980283*^9}, {3.5891692874335833`*^9, 
   3.589169337775983*^9}, {3.5891696842178173`*^9, 3.589169701151493*^9}, {
   3.589169739702095*^9, 3.589169813812231*^9}, {3.5891698868091393`*^9, 
   3.589169994822295*^9}, {3.5891700269912786`*^9, 3.5891701246304502`*^9}, 
   3.589170169504209*^9, 3.589170282296586*^9, {3.589170327961761*^9, 
   3.5891703568427896`*^9}, {3.589170456369104*^9, 3.589170502029262*^9}, {
   3.5891705363531303`*^9, 3.58917054144496*^9}, {3.589170574687524*^9, 
   3.589170591996751*^9}}],

Cell[BoxData["\<\"expand\"\>"], "Output",
 CellChangeTimes->{3.5891705034223213`*^9, 3.589170543594245*^9, 
  3.5891705943238087`*^9}],

Cell[BoxData["\<\"coeff\"\>"], "Output",
 CellChangeTimes->{3.5891705034223213`*^9, 3.589170543594245*^9, 
  3.589170594325294*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"8", " ", 
   SqrtBox[
    FractionBox["2", "\[Pi]"]]}], 
  RowBox[{
   SubscriptBox["W", "i"], " ", 
   SubscriptBox["W", "p"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", 
      SubsuperscriptBox["W", "i", "2"]], "+", 
     FractionBox["1", 
      SubsuperscriptBox["W", "p", "2"]], "+", 
     FractionBox["1", 
      SubsuperscriptBox["W", "s", "2"]]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      SuperscriptBox[
       RowBox[{"Cos", "[", 
        SubscriptBox["\[Theta]", "i"], "]"}], "2"], 
      SubsuperscriptBox["W", "i", "2"]], "+", 
     FractionBox["1", 
      SubsuperscriptBox["W", "p", "2"]], "+", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"Cos", "[", 
        SubscriptBox["\[Theta]", "s"], "]"}], "2"], 
      SubsuperscriptBox["W", "s", "2"]]}], ")"}], " ", 
   SubscriptBox["W", "s"]}]]], "Output",
 CellChangeTimes->{3.5891705034223213`*^9, 3.589170543594245*^9, 
  3.58917059435979*^9}],

Cell[BoxData[
 FractionBox["4", 
  RowBox[{
   SubscriptBox["W", "p"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", 
      SubsuperscriptBox["W", "p", "2"]], "+", 
     FractionBox["1", 
      SubsuperscriptBox["W", "s", "2"]]}], ")"}], " ", 
   SubscriptBox["W", "s"]}]]], "Output",
 CellChangeTimes->{3.5891705034223213`*^9, 3.589170543594245*^9, 
  3.5891705943931007`*^9}],

Cell[BoxData["\<\"coinc\"\>"], "Output",
 CellChangeTimes->{3.5891705034223213`*^9, 3.589170543594245*^9, 
  3.589170594394552*^9}],

Cell[BoxData["2.4961748986447716`*^-16"], "Output",
 CellChangeTimes->{3.5891705034223213`*^9, 3.589170543594245*^9, 
  3.589170594396018*^9}],

Cell[BoxData["\<\"singles\"\>"], "Output",
 CellChangeTimes->{3.5891705034223213`*^9, 3.589170543594245*^9, 
  3.5891705943973703`*^9}],

Cell[BoxData["1.5684736948195353`*^-7"], "Output",
 CellChangeTimes->{3.5891705034223213`*^9, 3.589170543594245*^9, 
  3.5891705943989277`*^9}],

Cell[BoxData["\<\"eff\"\>"], "Output",
 CellChangeTimes->{3.5891705034223213`*^9, 3.589170543594245*^9, 
  3.5891705944004917`*^9}],

Cell[BoxData["1.59146749281758`*^-9"], "Output",
 CellChangeTimes->{3.5891705034223213`*^9, 3.589170543594245*^9, 
  3.589170594402104*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Let", "'"}], "s", " ", "test", " ", "how", " ", "accurate", " ", 
    "the", " ", "order", " ", "of", " ", "the", " ", "expansions", " ", "is", 
    " ", "of", " ", "the", " ", "integral"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{"inttest", ":=", " ", 
    RowBox[{
     RowBox[{"N", "*", 
      RowBox[{"Exp", "[", 
       RowBox[{"-", "T"}], "]"}], "*", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"z", "^", "2"}]}], " ", "*", 
         RowBox[{"(", "R", " ", ")"}]}], " ", "-", 
        RowBox[{"z", " ", "*", 
         RowBox[{"(", 
          RowBox[{"\[ImaginaryI]", "*", "S"}], ")"}]}]}], "]"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "IntResultExact"}], " ", 
     "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Assuming", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"R", ">", 
           RowBox[{"-", "inf"}]}], " ", "&&", " ", 
          RowBox[{"S", ">", 
           RowBox[{"-", "inf"}]}], " ", "&&", " ", 
          RowBox[{"T", ">", 
           RowBox[{"-", "inf"}]}]}], " ", ",", " ", 
         RowBox[{"Integrate", "[", 
          RowBox[{"inttest", ",", 
           RowBox[{"{", 
            RowBox[{"z", ",", "0", ",", "L"}], "}"}]}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"IntResult5E", " ", ":=", " ", 
         RowBox[{"Normal", "[", 
          RowBox[{
           RowBox[{"Series", "[", 
            RowBox[{"IntResultExact", ",", 
             RowBox[{"{", 
              RowBox[{"S", ",", "0", ",", "10"}], "}"}]}], "]"}], " ", "//.", 
           " ", 
           RowBox[{"{", " ", 
            RowBox[{
             RowBox[{"Erf", "[", 
              RowBox[{"L", " ", 
               SqrtBox["R"]}], "]"}], " ", "\[Rule]", " ", 
             RowBox[{"Series", "[", " ", 
              RowBox[{
               RowBox[{"Erf", "[", 
                RowBox[{"L", " ", 
                 SqrtBox["R"]}], "]"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"L", ",", "0", ",", "10"}], "}"}]}], "]"}]}], "}"}]}],
           "]"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"IntResult15", " ", ":=", " ", 
         RowBox[{"Assuming", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"R", ">", 
             RowBox[{"-", "inf"}]}], " ", "&&", " ", 
            RowBox[{"S", ">", 
             RowBox[{"-", "inf"}]}], " ", "&&", " ", 
            RowBox[{"T", ">", 
             RowBox[{"-", "inf"}]}]}], " ", ",", " ", 
           RowBox[{"Integrate", "[", 
            RowBox[{
             RowBox[{"Normal", "[", 
              RowBox[{"Series", "[", 
               RowBox[{
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"z", "^", "2"}]}], " ", "*", 
                   RowBox[{"(", "R", " ", ")"}]}], " ", "-", 
                  RowBox[{"z", " ", "*", 
                   RowBox[{"(", 
                    RowBox[{"\[ImaginaryI]", "*", "S"}], ")"}]}], " ", "-", 
                  " ", "T"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"z", ",", "0", ",", "15"}], "}"}]}], "]"}], "]"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"z", ",", "0", ",", "L"}], "}"}]}], "]"}]}], "]"}]}], 
        "*)"}], "\[IndentingNewLine]", "IntResult5"}], " ", ":=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Assuming", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"R", ">", 
            RowBox[{"-", "inf"}]}], " ", "&&", " ", 
           RowBox[{"S", ">", 
            RowBox[{"-", "inf"}]}], " ", "&&", " ", 
           RowBox[{"T", ">", 
            RowBox[{"-", "inf"}]}]}], " ", ",", " ", 
          RowBox[{"Integrate", "[", 
           RowBox[{
            RowBox[{"Normal", "[", 
             RowBox[{"Series", "[", 
              RowBox[{"inttest", ",", 
               RowBox[{"{", 
                RowBox[{"z", ",", "0", ",", "5"}], "}"}]}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"z", ",", "0", ",", "L"}], "}"}]}], "]"}]}], "]"}], 
        "\[IndentingNewLine]", "IntResult3"}], " ", ":=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Assuming", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"R", ">", 
             RowBox[{"-", "inf"}]}], " ", "&&", " ", 
            RowBox[{"S", ">", 
             RowBox[{"-", "inf"}]}], " ", "&&", " ", 
            RowBox[{"T", ">", 
             RowBox[{"-", "inf"}]}]}], " ", ",", " ", 
           RowBox[{"Integrate", "[", 
            RowBox[{
             RowBox[{"Normal", "[", 
              RowBox[{"Series", "[", 
               RowBox[{"inttest", ",", 
                RowBox[{"{", 
                 RowBox[{"z", ",", "0", ",", "3"}], "}"}]}], "]"}], "]"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"z", ",", "0", ",", "L"}], "}"}]}], "]"}]}], "]"}], 
         "\[IndentingNewLine]", "IntResult1"}], " ", ":=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Assuming", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"R", ">", 
              RowBox[{"-", "inf"}]}], " ", "&&", " ", 
             RowBox[{"S", ">", 
              RowBox[{"-", "inf"}]}], " ", "&&", " ", 
             RowBox[{"T", ">", 
              RowBox[{"-", "inf"}]}]}], " ", ",", " ", 
            RowBox[{"Integrate", "[", 
             RowBox[{
              RowBox[{"Normal", "[", 
               RowBox[{"Series", "[", 
                RowBox[{"inttest", ",", 
                 RowBox[{"{", 
                  RowBox[{"z", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"z", ",", "0", ",", "L"}], "}"}]}], "]"}]}], "]"}], 
          "\[IndentingNewLine]", "IntResult7"}], " ", ":=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Assuming", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"R", ">", 
               RowBox[{"-", "inf"}]}], " ", "&&", " ", 
              RowBox[{"S", ">", 
               RowBox[{"-", "inf"}]}], " ", "&&", " ", 
              RowBox[{"T", ">", 
               RowBox[{"-", "inf"}]}]}], " ", ",", " ", 
             RowBox[{"Integrate", "[", 
              RowBox[{
               RowBox[{"Normal", "[", 
                RowBox[{"Series", "[", 
                 RowBox[{"inttest", ",", 
                  RowBox[{"{", 
                   RowBox[{"z", ",", "0", ",", "7"}], "}"}]}], "]"}], "]"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"z", ",", "0", ",", "L"}], "}"}]}], "]"}]}], "]"}], 
           "\[IndentingNewLine]", "IntResult9"}], " ", ":=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Assuming", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"R", ">", 
                RowBox[{"-", "inf"}]}], " ", "&&", " ", 
               RowBox[{"S", ">", 
                RowBox[{"-", "inf"}]}], " ", "&&", " ", 
               RowBox[{"T", ">", 
                RowBox[{"-", "inf"}]}]}], " ", ",", " ", 
              RowBox[{"Integrate", "[", 
               RowBox[{
                RowBox[{"Normal", "[", 
                 RowBox[{"Series", "[", 
                  RowBox[{"inttest", ",", 
                   RowBox[{"{", 
                    RowBox[{"z", ",", "0", ",", "9"}], "}"}]}], "]"}], "]"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"z", ",", "0", ",", "L"}], "}"}]}], "]"}]}], "]"}], 
            "\[IndentingNewLine]", "IntResult15"}], " ", ":=", " ", 
           RowBox[{"Assuming", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"R", ">", 
               RowBox[{"-", "inf"}]}], " ", "&&", " ", 
              RowBox[{"S", ">", 
               RowBox[{"-", "inf"}]}], " ", "&&", " ", 
              RowBox[{"T", ">", 
               RowBox[{"-", "inf"}]}]}], " ", ",", " ", 
             RowBox[{"Integrate", "[", 
              RowBox[{
               RowBox[{"Normal", "[", 
                RowBox[{"Series", "[", 
                 RowBox[{"inttest", ",", 
                  RowBox[{"{", 
                   RowBox[{"z", ",", "0", ",", "15"}], "}"}]}], "]"}], "]"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"z", ",", "0", ",", "L"}], "}"}]}], "]"}]}], 
            "]"}]}]}]}]}]}]}]}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.582572205761004*^9, 3.582572206837862*^9}, {
   3.582572892523479*^9, 3.5825728929466352`*^9}, {3.5825730267270813`*^9, 
   3.5825730776157846`*^9}, 3.582573159248851*^9, {3.582574803934189*^9, 
   3.582574811885477*^9}, {3.5825748919450703`*^9, 3.58257491225194*^9}, {
   3.582574943344674*^9, 3.582574956820031*^9}, {3.582574996989943*^9, 
   3.582575003605554*^9}, {3.582575205414709*^9, 3.582575225406925*^9}, {
   3.582575305419675*^9, 3.5825753055625563`*^9}, 3.58257534908139*^9, {
   3.582575417899432*^9, 3.582575522713881*^9}, {3.582575586709717*^9, 
   3.58257559175743*^9}, {3.582575635733961*^9, 3.582575639725006*^9}, {
   3.582575678287434*^9, 3.582575717350861*^9}, {3.582575904920251*^9, 
   3.582575939439159*^9}, {3.582576107030368*^9, 3.582576120006235*^9}, {
   3.582576269360463*^9, 3.5825764044161987`*^9}, {3.582577907486704*^9, 
   3.582577908964764*^9}, {3.582577939933519*^9, 3.582577941173113*^9}, {
   3.582578081868434*^9, 3.5825780830357122`*^9}, {3.582578132562628*^9, 
   3.582578212352865*^9}, {3.582578244359088*^9, 3.5825783979413977`*^9}, {
   3.582581650656002*^9, 3.582581669552266*^9}, {3.5825827775671177`*^9, 
   3.582582778886656*^9}, {3.582599991894372*^9, 3.5826000088696938`*^9}, 
   3.582604066534835*^9, {3.5826045676380367`*^9, 3.582604594346463*^9}, {
   3.58260466808491*^9, 3.582604668614315*^9}, {3.5826047238398237`*^9, 
   3.582604724304657*^9}, {3.5826048197985764`*^9, 3.5826048488434963`*^9}, {
   3.582604880920669*^9, 3.5826048815143003`*^9}, {3.5826049273340387`*^9, 
   3.5826049285137053`*^9}, {3.5826049684814863`*^9, 3.582604971468669*^9}, {
   3.5826053374966297`*^9, 3.582605424304006*^9}, {3.5826766056657*^9, 
   3.582676606800818*^9}, {3.589158346445582*^9, 3.589158361382627*^9}, 
   3.589158652586523*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Consider", " ", "a", " ", "collinear"}], ",", " ", 
    RowBox[{
    "perfectly", " ", "phasematched", " ", "system", " ", "with", " ", "the", 
     " ", "signal", " ", "and", " ", "pump", " ", "waists", " ", "as", " ", 
     "100", " ", "microns"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"rulessamle", " ", ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SubscriptBox["W", "i"], "  ", "\[Rule]", " ", 
       SubscriptBox["W", "s"]}], " ", ",", "  ", 
      RowBox[{
       SubscriptBox["\[Theta]", "i"], "\[Rule]", " ", 
       SubscriptBox["\[Theta]", "s"]}], ",", " ", 
      RowBox[{
       SubscriptBox["\[Theta]", "s"], " ", "\[Rule]", 
       RowBox[{"0", "*", 
        RowBox[{"\[Pi]", "/", "180"}]}]}], ",", " ", 
      RowBox[{
       SubscriptBox["W", "s"], "  ", "\[Rule]", " ", ".01"}], ",", "  ", 
      RowBox[{
       SubscriptBox["W", "p"], "  ", "\[Rule]", " ", ".01"}], ",", "  ", 
      RowBox[{
       SubscriptBox["\[CapitalDelta]K", "x"], " ", "\[Rule]", "0"}], ",", 
      "  ", 
      RowBox[{
       SubscriptBox["\[CapitalDelta]K", "y"], " ", "\[Rule]", "0"}], ",", 
      "  ", 
      RowBox[{
       SubscriptBox["\[CapitalDelta]K", "z"], " ", "\[Rule]", "0"}], ",", 
      "  ", 
      RowBox[{
       SubscriptBox["\[Rho]", "px"], " ", "\[Rule]", " ", 
       RowBox[{"0", "*", 
        RowBox[{"\[Pi]", "/", "180"}]}]}], ",", " ", 
      RowBox[{
       SubscriptBox["\[Phi]", "s"], "\[Rule]", "0"}]}], "}"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"AAtest", " ", ":=", " ", 
    RowBox[{
     SubscriptBox["AA", "singles"], " ", "//.", "rulessamle"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"BBtest", " ", ":=", " ", 
    RowBox[{
     SubscriptBox["BB", "singles"], " ", "//.", "rulessamle"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"CCtest", " ", ":=", " ", 
    RowBox[{
     SubscriptBox["CC", "singles"], " ", "//.", "rulessamle"}]}], 
   "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Crystal", " ", "length", " ", "in", " ", "meters"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Lxtal", " ", ":=", " ", "l"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"isvalidapprox", " ", "should", " ", "be"}], " ", "<", " ", 
     RowBox[{
     "1", " ", "to", " ", "keep", " ", "the", " ", "errors", " ", "in", " ", 
      "check", " ", "with", " ", "a", " ", "5", "th", " ", "order", " ", 
      "series", " ", "expansion"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"isvalidapprox", " ", "=", " ", 
     RowBox[{"Lxtal", " ", "*", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"Abs", "[", "AAtest", "]"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"\"\<normalizations\>\"", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NN", " ", "=", " ", 
     RowBox[{
      RowBox[{
       SubscriptBox["n", "s"], "*", 
       SubscriptBox["n", "p"], "*", "xconsts", "*", "yconsts"}], " ", "//.", 
      "rulessamle"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NY", "=", " ", 
     RowBox[{
      RowBox[{
       SubscriptBox["n", "s"], "*", 
       SubscriptBox["n", "i"], "*", 
       SubscriptBox["n", "p"], "*", "xconst", "*", "yconst"}], " ", "//.", 
      "rulessamle"}]}], ";"}], "\[IndentingNewLine]", "\"\<coincidence\>\"", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Abs", "[", 
       SubscriptBox["P", "coinc"], "]"}], "^", "2"}], " ", "//.", 
     "rulessamle"}], " ", "//.", 
    RowBox[{"{", " ", 
     RowBox[{"L", " ", "\[Rule]", " ", "Lxtal"}], "}"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"rulessub", " ", ":=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"R", " ", "\[Rule]", "AAtest"}], ",", " ", 
      RowBox[{"S", " ", "\[Rule]", " ", "BBtest"}], ",", " ", 
      RowBox[{"T", " ", "\[Rule]", " ", "CCtest"}], ",", " ", 
      RowBox[{"L", " ", "\[Rule]", " ", "Lxtal"}], ",", " ", 
      RowBox[{"N", " ", "\[Rule]", " ", "1"}]}], "}"}]}], 
   "\[IndentingNewLine]", "\"\<efficiency\>\"", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Eff", "//.", "rulessamle"}], " ", "//.", 
    RowBox[{"{", " ", 
     RowBox[{"L", " ", "\[Rule]", " ", "Lxtal"}], "}"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"InE", "=", " ", 
     RowBox[{"IntResultExact", " ", "//.", " ", "rulessub"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"InE", " ", "/", " ", "Lxtal"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Eff1", " ", "=", " ", 
     RowBox[{"Eff", "//.", " ", "rulessamle"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Eff1", " ", "//.", " ", 
    RowBox[{"{", " ", 
     RowBox[{"L", " ", "\[Rule]", " ", "Lxtal"}], "}"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["n", "s"], "*", 
       SubscriptBox["n", "i"], "*", 
       SubscriptBox["n", "p"], "*", "xconst", " ", "*", " ", 
       RowBox[{"yconst", " ", "/", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["n", "s"], "*", 
          SubscriptBox["n", "p"], "*", "xconsts", " ", "*", " ", "yconsts"}], 
         ")"}]}]}], " ", "//.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[Theta]", "s"], "\[Rule]", "0"}], ",", " ", 
        RowBox[{
         SubscriptBox["\[Theta]", "i"], "\[Rule]", "0"}]}], "}"}]}], "]"}], 
    " ", "//.", "rulessamle"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"diff7", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"IntResult7", "-", "IntResult15"}], ")"}], " ", "/", 
         "IntResult15"}], "/", "L"}], " ", "//.", " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"R", " ", "\[Rule]", "AAtest"}], ",", " ", 
          RowBox[{"S", " ", "\[Rule]", " ", "BBtest"}], ",", " ", 
          RowBox[{"T", " ", "\[Rule]", " ", "CCtest"}], ",", " ", 
          RowBox[{"L", " ", "\[Rule]", " ", "0.001"}]}], "}"}], 
        "\[IndentingNewLine]", "diff9"}]}], "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"IntResult9", "-", "IntResult15"}], ")"}], " ", "/", 
         "IntResult15"}], "/", "L"}], " ", "//.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"R", " ", "\[Rule]", "AAtest"}], ",", " ", 
         RowBox[{"S", " ", "\[Rule]", " ", "BBtest"}], ",", " ", 
         RowBox[{"T", " ", "\[Rule]", " ", "CCtest"}], ",", " ", 
         RowBox[{"L", " ", "\[Rule]", " ", "0.001"}]}], "}"}]}]}]}], 
    "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.582570147920722*^9, 3.582570195741336*^9}, {
   3.5825702266473207`*^9, 3.582570352770815*^9}, {3.582570389152195*^9, 
   3.582570829808344*^9}, {3.5825708774230013`*^9, 3.58257102271488*^9}, {
   3.58257108718158*^9, 3.5825710876703444`*^9}, {3.5825711378520947`*^9, 
   3.582571194081362*^9}, {3.5825713211028957`*^9, 3.582571372749744*^9}, {
   3.5825714424096603`*^9, 3.582571461090166*^9}, {3.582571582032125*^9, 
   3.5825715845259132`*^9}, {3.582571654423809*^9, 3.5825716965358133`*^9}, 
   3.582571742091448*^9, {3.582571805219578*^9, 3.582571810611225*^9}, {
   3.582571855855719*^9, 3.582571869979395*^9}, {3.5825719294603567`*^9, 
   3.582571935293085*^9}, {3.582571976150963*^9, 3.582571978900481*^9}, {
   3.5825720142934093`*^9, 3.5825720378953953`*^9}, {3.582572069752479*^9, 
   3.582572092116683*^9}, {3.582572138326789*^9, 3.5825721680930433`*^9}, {
   3.5825722010110197`*^9, 3.582572272679966*^9}, {3.582572322893197*^9, 
   3.582572323053734*^9}, {3.582572386711502*^9, 3.5825724191907997`*^9}, {
   3.582572476653902*^9, 3.582572531114415*^9}, {3.582572563448111*^9, 
   3.582572597284574*^9}, 3.582572641775893*^9, {3.582572724360796*^9, 
   3.58257274159832*^9}, {3.582572790372628*^9, 3.582572822861246*^9}, {
   3.582573085488145*^9, 3.58257314104458*^9}, {3.582573177702846*^9, 
   3.582573191653015*^9}, {3.58257322478185*^9, 3.582573239973515*^9}, {
   3.582573273300521*^9, 3.58257328128799*^9}, {3.582573315689685*^9, 
   3.582573349042635*^9}, {3.582573385841503*^9, 3.58257345374396*^9}, {
   3.582573554499343*^9, 3.58257358045148*^9}, {3.5825736478524446`*^9, 
   3.582573663924012*^9}, {3.582574224783668*^9, 3.582574226260107*^9}, {
   3.582575527216473*^9, 3.58257553416681*^9}, 3.582575613021126*^9, {
   3.5825757339284153`*^9, 3.582575736659645*^9}, {3.582575769237528*^9, 
   3.582575878597967*^9}, {3.582576011241189*^9, 3.58257603819661*^9}, {
   3.582576139818922*^9, 3.582576163767682*^9}, {3.582576451830208*^9, 
   3.5825765756405077`*^9}, {3.582576619437772*^9, 3.582576746994718*^9}, {
   3.582576801086635*^9, 3.582576864601396*^9}, {3.582576967220229*^9, 
   3.582576972890451*^9}, {3.582577032137899*^9, 3.582577035976838*^9}, {
   3.582577370329324*^9, 3.5825774899346857`*^9}, 3.5825775241645203`*^9, {
   3.5825779855988417`*^9, 3.582578051825473*^9}, {3.582578097861334*^9, 
   3.582578101350016*^9}, 3.582578196413332*^9, {3.582578418547887*^9, 
   3.582578477190527*^9}, {3.58258138558496*^9, 3.582581416914439*^9}, {
   3.5825815036507807`*^9, 3.5825816333940077`*^9}, {3.582599949146933*^9, 
   3.582599965336502*^9}, {3.582600044394148*^9, 3.5826000807046623`*^9}, {
   3.582600116461185*^9, 3.5826001495913153`*^9}, {3.582602884138761*^9, 
   3.582602947869776*^9}, {3.582603087199744*^9, 3.5826030907698936`*^9}, {
   3.5826031999940653`*^9, 3.5826032359815407`*^9}, 3.582603296793651*^9, {
   3.582603458919821*^9, 3.5826034789806757`*^9}, {3.582603511056388*^9, 
   3.582603688543826*^9}, {3.582604584019965*^9, 3.5826045870444508`*^9}, {
   3.582604621354341*^9, 3.5826046446333017`*^9}, {3.582604788564949*^9, 
   3.5826047890544662`*^9}, {3.582604995006014*^9, 3.582605000751871*^9}, {
   3.582605031409931*^9, 3.582605311859332*^9}, {3.582673091236546*^9, 
   3.582673100783592*^9}, {3.582673132544013*^9, 3.582673258871689*^9}, {
   3.5826732951300783`*^9, 3.58267332418362*^9}, {3.582673517296598*^9, 
   3.582673523285928*^9}, {3.582673559825186*^9, 3.58267357808424*^9}, 
   3.5826737173027153`*^9, {3.582673799568041*^9, 3.5826738831694098`*^9}, 
   3.582674198046418*^9, {3.582674342546062*^9, 3.582674389475952*^9}, {
   3.582674452403171*^9, 3.582674540487863*^9}, 3.582674855781835*^9, {
   3.58267489572344*^9, 3.582674909054782*^9}, {3.582674948260013*^9, 
   3.582675028787796*^9}, {3.582676748612762*^9, 3.582676765579796*^9}, {
   3.582676872504282*^9, 3.582676934474944*^9}, {3.5826769747436237`*^9, 
   3.582677005626507*^9}, {3.5826770854932203`*^9, 3.582677116111795*^9}, {
   3.589153356110106*^9, 3.589153377164576*^9}, {3.5891534428390217`*^9, 
   3.58915351492083*^9}, {3.589153588821274*^9, 3.589153696060603*^9}, {
   3.589153998135046*^9, 3.589154019181926*^9}, {3.589154534141698*^9, 
   3.589154556818372*^9}, {3.5891549316710377`*^9, 3.589154944526208*^9}, {
   3.589154995426688*^9, 3.589155032781412*^9}, {3.589155208999354*^9, 
   3.589155232798279*^9}, {3.5891552855066032`*^9, 3.589155286921804*^9}, {
   3.589155347835034*^9, 3.589155480958825*^9}, {3.589155516629587*^9, 
   3.5891555926201353`*^9}, {3.589155826545381*^9, 3.58915592916153*^9}, {
   3.5891560194084797`*^9, 3.5891561295364437`*^9}, {3.589156356971319*^9, 
   3.589156387741671*^9}, {3.5891565663310738`*^9, 3.589156571383554*^9}, {
   3.589156703552775*^9, 3.589156771740507*^9}, {3.589158453299594*^9, 
   3.589158495376669*^9}}],

Cell[BoxData["\<\"coincidence\"\>"], "Output",
 CellChangeTimes->{{3.589153638575555*^9, 3.589153696879279*^9}, 
   3.5891539636418047`*^9, {3.5891539988873987`*^9, 3.589154019633039*^9}, 
   3.589154144561503*^9, 3.5891545651652946`*^9, 3.589154718127551*^9, 
   3.589154767388908*^9, 3.589154844456225*^9, {3.589154936261013*^9, 
   3.589154945691699*^9}, {3.5891549966955767`*^9, 3.589155033592531*^9}, 
   3.589155234174719*^9, {3.589155279573002*^9, 3.589155289123665*^9}, 
   3.589155333209495*^9, {3.5891553679188833`*^9, 3.589155481367324*^9}, {
   3.589155518031846*^9, 3.5891555937806377`*^9}, {3.589155828649741*^9, 
   3.589155929676157*^9}, {3.589156023612947*^9, 3.589156039894643*^9}, {
   3.589156073466248*^9, 3.589156130793469*^9}, {3.5891563583245897`*^9, 
   3.589156388369214*^9}, {3.589156567231132*^9, 3.5891565718118353`*^9}, {
   3.589156631470087*^9, 3.5891566569745493`*^9}, {3.589156704019106*^9, 
   3.589156772060663*^9}, 3.5891584203335457`*^9, {3.589158454722052*^9, 
   3.589158496249914*^9}, {3.589158656340477*^9, 3.589158659685629*^9}, 
   3.589161932919894*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Power", "::", "infy"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Infinite expression \
\[NoBreak]\\!\\(1\\/\\@0.`\\)\[NoBreak] encountered. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/infy\\\", ButtonNote -> \
\\\"Power::infy\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.589156731493305*^9, 3.589156772066766*^9}, 
   3.589158420338091*^9, {3.589158454728462*^9, 3.589158496254464*^9}, {
   3.589158656342115*^9, 3.589158659687673*^9}, 3.589161932921555*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Infinity", "::", "indet"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Indeterminate expression \[NoBreak]\\!\\(\\(\\((\\(\\(0.` \
\[VeryThinSpace]\\)\\) + \\(\\(0.`\\\\ \[ImaginaryI]\\)\\))\\)\\)\\\\ \
ComplexInfinity\\)\\n\[NoBreak] encountered. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/indet\\\", ButtonNote -> \
\\\"Infinity::indet\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.589156731493305*^9, 3.589156772066766*^9}, 
   3.589158420338091*^9, {3.589158454728462*^9, 3.589158496254464*^9}, {
   3.589158656342115*^9, 3.589158659687673*^9}, 3.589161932923052*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Power", "::", "infy"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Infinite expression \
\[NoBreak]\\!\\(1\\/\\@0.`\\)\[NoBreak] encountered. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/infy\\\", ButtonNote -> \
\\\"Power::infy\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.589156731493305*^9, 3.589156772066766*^9}, 
   3.589158420338091*^9, {3.589158454728462*^9, 3.589158496254464*^9}, {
   3.589158656342115*^9, 3.589158659687673*^9}, 3.589161932924226*^9}],

Cell[BoxData["Indeterminate"], "Output",
 CellChangeTimes->{{3.589153638575555*^9, 3.589153696879279*^9}, 
   3.5891539636418047`*^9, {3.5891539988873987`*^9, 3.589154019633039*^9}, 
   3.589154144561503*^9, 3.5891545651652946`*^9, 3.589154718127551*^9, 
   3.589154767388908*^9, 3.589154844456225*^9, {3.589154936261013*^9, 
   3.589154945691699*^9}, {3.5891549966955767`*^9, 3.589155033592531*^9}, 
   3.589155234174719*^9, {3.589155279573002*^9, 3.589155289123665*^9}, 
   3.589155333209495*^9, {3.5891553679188833`*^9, 3.589155481367324*^9}, {
   3.589155518031846*^9, 3.5891555937806377`*^9}, {3.589155828649741*^9, 
   3.589155929676157*^9}, {3.589156023612947*^9, 3.589156039894643*^9}, {
   3.589156073466248*^9, 3.589156130793469*^9}, {3.5891563583245897`*^9, 
   3.589156388369214*^9}, {3.589156567231132*^9, 3.5891565718118353`*^9}, {
   3.589156631470087*^9, 3.5891566569745493`*^9}, {3.589156704019106*^9, 
   3.589156772060663*^9}, 3.5891584203335457`*^9, {3.589158454722052*^9, 
   3.589158496249914*^9}, {3.589158656340477*^9, 3.589158659685629*^9}, 
   3.5891619329253073`*^9}],

Cell[BoxData["\<\"efficiency\"\>"], "Output",
 CellChangeTimes->{{3.589153638575555*^9, 3.589153696879279*^9}, 
   3.5891539636418047`*^9, {3.5891539988873987`*^9, 3.589154019633039*^9}, 
   3.589154144561503*^9, 3.5891545651652946`*^9, 3.589154718127551*^9, 
   3.589154767388908*^9, 3.589154844456225*^9, {3.589154936261013*^9, 
   3.589154945691699*^9}, {3.5891549966955767`*^9, 3.589155033592531*^9}, 
   3.589155234174719*^9, {3.589155279573002*^9, 3.589155289123665*^9}, 
   3.589155333209495*^9, {3.5891553679188833`*^9, 3.589155481367324*^9}, {
   3.589155518031846*^9, 3.5891555937806377`*^9}, {3.589155828649741*^9, 
   3.589155929676157*^9}, {3.589156023612947*^9, 3.589156039894643*^9}, {
   3.589156073466248*^9, 3.589156130793469*^9}, {3.5891563583245897`*^9, 
   3.589156388369214*^9}, {3.589156567231132*^9, 3.5891565718118353`*^9}, {
   3.589156631470087*^9, 3.5891566569745493`*^9}, {3.589156704019106*^9, 
   3.589156772060663*^9}, 3.5891584203335457`*^9, {3.589158454722052*^9, 
   3.589158496249914*^9}, {3.589158656340477*^9, 3.589158659685629*^9}, 
   3.589161932926248*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Infinity", "::", "indet"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Indeterminate expression \[NoBreak]\\!\\(0.`\\\\ \
ComplexInfinity\\)\[NoBreak] encountered. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/indet\\\", ButtonNote -> \
\\\"Infinity::indet\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.589156731493305*^9, 3.589156772066766*^9}, 
   3.589158420338091*^9, {3.589158454728462*^9, 3.589158496254464*^9}, {
   3.589158656342115*^9, 3.589158659687673*^9}, 3.58916193292727*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Power", "::", "infy"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Infinite expression \
\[NoBreak]\\!\\(1\\/\\@0.`\\)\[NoBreak] encountered. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/infy\\\", ButtonNote -> \
\\\"Power::infy\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.589156731493305*^9, 3.589156772066766*^9}, 
   3.589158420338091*^9, {3.589158454728462*^9, 3.589158496254464*^9}, {
   3.589158656342115*^9, 3.589158659687673*^9}, 3.589161932928564*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Infinity", "::", "indet"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Indeterminate expression \[NoBreak]\\!\\(\\(\\((\\(\\(0.` \
\[VeryThinSpace]\\)\\) + \\(\\(0.`\\\\ \[ImaginaryI]\\)\\))\\)\\)\\\\ \
ComplexInfinity\\)\\n\[NoBreak] encountered. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/indet\\\", ButtonNote -> \
\\\"Infinity::indet\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.589156731493305*^9, 3.589156772066766*^9}, 
   3.589158420338091*^9, {3.589158454728462*^9, 3.589158496254464*^9}, {
   3.589158656342115*^9, 3.589158659687673*^9}, 3.589161932929758*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Power", "::", "infy"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Infinite expression \
\[NoBreak]\\!\\(1\\/\\@0.`\\)\[NoBreak] encountered. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/infy\\\", ButtonNote -> \
\\\"Power::infy\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.589156731493305*^9, 3.589156772066766*^9}, 
   3.589158420338091*^9, {3.589158454728462*^9, 3.589158496254464*^9}, {
   3.589158656342115*^9, 3.589158659687673*^9}, 3.589161932931024*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Infinity", "::", "indet"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Indeterminate expression \[NoBreak]\\!\\(0.`\\\\ \
ComplexInfinity\\)\[NoBreak] encountered. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/indet\\\", ButtonNote -> \
\\\"Infinity::indet\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.589156731493305*^9, 3.589156772066766*^9}, 
   3.589158420338091*^9, {3.589158454728462*^9, 3.589158496254464*^9}, {
   3.589158656342115*^9, 3.589158659687673*^9}, 3.589161932932158*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \[NoBreak]\\!\\(\\*StyleBox[\\(Infinity \
:: indet\\), \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.589156731493305*^9, 3.589156772066766*^9}, 
   3.589158420338091*^9, {3.589158454728462*^9, 3.589158496254464*^9}, {
   3.589158656342115*^9, 3.589158659687673*^9}, 3.589161932933235*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Power", "::", "infy"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Infinite expression \
\[NoBreak]\\!\\(1\\/\\@0.`\\)\[NoBreak] encountered. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/infy\\\", ButtonNote -> \
\\\"Power::infy\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.589156731493305*^9, 3.589156772066766*^9}, 
   3.589158420338091*^9, {3.589158454728462*^9, 3.589158496254464*^9}, {
   3.589158656342115*^9, 3.589158659687673*^9}, 3.5891619329344063`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \[NoBreak]\\!\\(\\*StyleBox[\\(Power :: \
infy\\), \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.589156731493305*^9, 3.589156772066766*^9}, 
   3.589158420338091*^9, {3.589158454728462*^9, 3.589158496254464*^9}, {
   3.589158656342115*^9, 3.589158659687673*^9}, 3.589161932935523*^9}],

Cell[BoxData["Indeterminate"], "Output",
 CellChangeTimes->{{3.589153638575555*^9, 3.589153696879279*^9}, 
   3.5891539636418047`*^9, {3.5891539988873987`*^9, 3.589154019633039*^9}, 
   3.589154144561503*^9, 3.5891545651652946`*^9, 3.589154718127551*^9, 
   3.589154767388908*^9, 3.589154844456225*^9, {3.589154936261013*^9, 
   3.589154945691699*^9}, {3.5891549966955767`*^9, 3.589155033592531*^9}, 
   3.589155234174719*^9, {3.589155279573002*^9, 3.589155289123665*^9}, 
   3.589155333209495*^9, {3.5891553679188833`*^9, 3.589155481367324*^9}, {
   3.589155518031846*^9, 3.5891555937806377`*^9}, {3.589155828649741*^9, 
   3.589155929676157*^9}, {3.589156023612947*^9, 3.589156039894643*^9}, {
   3.589156073466248*^9, 3.589156130793469*^9}, {3.5891563583245897`*^9, 
   3.589156388369214*^9}, {3.589156567231132*^9, 3.5891565718118353`*^9}, {
   3.589156631470087*^9, 3.5891566569745493`*^9}, {3.589156704019106*^9, 
   3.589156772060663*^9}, 3.5891584203335457`*^9, {3.589158454722052*^9, 
   3.589158496249914*^9}, {3.589158656340477*^9, 3.589158659685629*^9}, 
   3.589161932936878*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Power", "::", "infy"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Infinite expression \[NoBreak]\\!\\(1\\/0.`\\)\[NoBreak] \
encountered. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/infy\\\", ButtonNote -> \
\\\"Power::infy\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.589156731493305*^9, 3.589156772066766*^9}, 
   3.589158420338091*^9, {3.589158454728462*^9, 3.589158496254464*^9}, {
   3.589158656342115*^9, 3.589158659687673*^9}, 3.589161932937934*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Infinity", "::", "indet"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Indeterminate expression \[NoBreak]\\!\\(0.`\\\\ \
ComplexInfinity\\)\[NoBreak] encountered. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/indet\\\", ButtonNote -> \
\\\"Infinity::indet\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.589156731493305*^9, 3.589156772066766*^9}, 
   3.589158420338091*^9, {3.589158454728462*^9, 3.589158496254464*^9}, {
   3.589158656342115*^9, 3.589158659687673*^9}, 3.589161932939086*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Power", "::", "infy"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Infinite expression \
\[NoBreak]\\!\\(1\\/\\@0.`\\)\[NoBreak] encountered. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/infy\\\", ButtonNote -> \
\\\"Power::infy\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.589156731493305*^9, 3.589156772066766*^9}, 
   3.589158420338091*^9, {3.589158454728462*^9, 3.589158496254464*^9}, {
   3.589158656342115*^9, 3.589158659687673*^9}, 3.589161932940206*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Power", "::", "infy"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Infinite expression \
\[NoBreak]\\!\\(1\\/\\@0.`\\)\[NoBreak] encountered. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/infy\\\", ButtonNote -> \
\\\"Power::infy\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.589156731493305*^9, 3.589156772066766*^9}, 
   3.589158420338091*^9, {3.589158454728462*^9, 3.589158496254464*^9}, {
   3.589158656342115*^9, 3.589158659687673*^9}, 3.5891619329413433`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \[NoBreak]\\!\\(\\*StyleBox[\\(Power :: \
infy\\), \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.589156731493305*^9, 3.589156772066766*^9}, 
   3.589158420338091*^9, {3.589158454728462*^9, 3.589158496254464*^9}, {
   3.589158656342115*^9, 3.589158659687673*^9}, 3.589161932942452*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Infinity", "::", "indet"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Indeterminate expression \[NoBreak]\\!\\(\\(\\((\\(\\(0.` \
\[VeryThinSpace]\\)\\) + \\(\\(0.`\\\\ \[ImaginaryI]\\)\\))\\)\\)\\\\ \
ComplexInfinity\\)\\n\[NoBreak] encountered. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/indet\\\", ButtonNote -> \
\\\"Infinity::indet\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.589156731493305*^9, 3.589156772066766*^9}, 
   3.589158420338091*^9, {3.589158454728462*^9, 3.589158496254464*^9}, {
   3.589158656342115*^9, 3.589158659687673*^9}, 3.589161932943585*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Infinity", "::", "indet"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Indeterminate expression \[NoBreak]\\!\\(0.`\\\\ \
ComplexInfinity\\)\[NoBreak] encountered. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/indet\\\", ButtonNote -> \
\\\"Infinity::indet\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.589156731493305*^9, 3.589156772066766*^9}, 
   3.589158420338091*^9, {3.589158454728462*^9, 3.589158496254464*^9}, {
   3.589158656342115*^9, 3.589158659687673*^9}, 3.5891619329446993`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \[NoBreak]\\!\\(\\*StyleBox[\\(Infinity \
:: indet\\), \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.589156731493305*^9, 3.589156772066766*^9}, 
   3.589158420338091*^9, {3.589158454728462*^9, 3.589158496254464*^9}, {
   3.589158656342115*^9, 3.589158659687673*^9}, 3.589161932945738*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Infinity", "::", "indet"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Indeterminate expression \[NoBreak]\\!\\(0.`\\\\ \
ComplexInfinity\\)\[NoBreak] encountered. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/indet\\\", ButtonNote -> \
\\\"Infinity::indet\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.589156731493305*^9, 3.589156772066766*^9}, 
   3.589158420338091*^9, {3.589158454728462*^9, 3.589158496254464*^9}, {
   3.589158656342115*^9, 3.589158659687673*^9}, 3.5891619329468613`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Power", "::", "infy"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Infinite expression \
\[NoBreak]\\!\\(1\\/\\@0.`\\)\[NoBreak] encountered. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/infy\\\", ButtonNote -> \
\\\"Power::infy\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.589156731493305*^9, 3.589156772066766*^9}, 
   3.589158420338091*^9, {3.589158454728462*^9, 3.589158496254464*^9}, {
   3.589158656342115*^9, 3.589158659687673*^9}, 3.589161932947913*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Infinity", "::", "indet"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Indeterminate expression \[NoBreak]\\!\\(\\(\\((\\(\\(0.` \
\[VeryThinSpace]\\)\\) + \\(\\(0.`\\\\ \[ImaginaryI]\\)\\))\\)\\)\\\\ \
ComplexInfinity\\)\\n\[NoBreak] encountered. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/indet\\\", ButtonNote -> \
\\\"Infinity::indet\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.589156731493305*^9, 3.589156772066766*^9}, 
   3.589158420338091*^9, {3.589158454728462*^9, 3.589158496254464*^9}, {
   3.589158656342115*^9, 3.589158659687673*^9}, 3.5891619329490356`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Power", "::", "infy"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Infinite expression \
\[NoBreak]\\!\\(1\\/\\@0.`\\)\[NoBreak] encountered. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/infy\\\", ButtonNote -> \
\\\"Power::infy\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.589156731493305*^9, 3.589156772066766*^9}, 
   3.589158420338091*^9, {3.589158454728462*^9, 3.589158496254464*^9}, {
   3.589158656342115*^9, 3.589158659687673*^9}, 3.589161932950169*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Infinity", "::", "indet"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Indeterminate expression \[NoBreak]\\!\\(0.`\\\\ \
ComplexInfinity\\)\[NoBreak] encountered. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/indet\\\", ButtonNote -> \
\\\"Infinity::indet\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.589156731493305*^9, 3.589156772066766*^9}, 
   3.589158420338091*^9, {3.589158454728462*^9, 3.589158496254464*^9}, {
   3.589158656342115*^9, 3.589158659687673*^9}, 3.589161932951297*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \[NoBreak]\\!\\(\\*StyleBox[\\(Infinity \
:: indet\\), \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.589156731493305*^9, 3.589156772066766*^9}, 
   3.589158420338091*^9, {3.589158454728462*^9, 3.589158496254464*^9}, {
   3.589158656342115*^9, 3.589158659687673*^9}, 3.589161932952392*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Power", "::", "infy"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Infinite expression \
\[NoBreak]\\!\\(1\\/\\@0.`\\)\[NoBreak] encountered. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/infy\\\", ButtonNote -> \
\\\"Power::infy\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.589156731493305*^9, 3.589156772066766*^9}, 
   3.589158420338091*^9, {3.589158454728462*^9, 3.589158496254464*^9}, {
   3.589158656342115*^9, 3.589158659687673*^9}, 3.58916193295354*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \[NoBreak]\\!\\(\\*StyleBox[\\(Power :: \
infy\\), \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.589156731493305*^9, 3.589156772066766*^9}, 
   3.589158420338091*^9, {3.589158454728462*^9, 3.589158496254464*^9}, {
   3.589158656342115*^9, 3.589158659687673*^9}, 3.589161932954705*^9}],

Cell[BoxData["Indeterminate"], "Output",
 CellChangeTimes->{{3.589153638575555*^9, 3.589153696879279*^9}, 
   3.5891539636418047`*^9, {3.5891539988873987`*^9, 3.589154019633039*^9}, 
   3.589154144561503*^9, 3.5891545651652946`*^9, 3.589154718127551*^9, 
   3.589154767388908*^9, 3.589154844456225*^9, {3.589154936261013*^9, 
   3.589154945691699*^9}, {3.5891549966955767`*^9, 3.589155033592531*^9}, 
   3.589155234174719*^9, {3.589155279573002*^9, 3.589155289123665*^9}, 
   3.589155333209495*^9, {3.5891553679188833`*^9, 3.589155481367324*^9}, {
   3.589155518031846*^9, 3.5891555937806377`*^9}, {3.589155828649741*^9, 
   3.589155929676157*^9}, {3.589156023612947*^9, 3.589156039894643*^9}, {
   3.589156073466248*^9, 3.589156130793469*^9}, {3.5891563583245897`*^9, 
   3.589156388369214*^9}, {3.589156567231132*^9, 3.5891565718118353`*^9}, {
   3.589156631470087*^9, 3.5891566569745493`*^9}, {3.589156704019106*^9, 
   3.589156772060663*^9}, 3.5891584203335457`*^9, {3.589158454722052*^9, 
   3.589158496249914*^9}, {3.589158656340477*^9, 3.589158659685629*^9}, 
   3.589161932955905*^9}],

Cell[BoxData["0.0035461536035682906`"], "Output",
 CellChangeTimes->{{3.589153638575555*^9, 3.589153696879279*^9}, 
   3.5891539636418047`*^9, {3.5891539988873987`*^9, 3.589154019633039*^9}, 
   3.589154144561503*^9, 3.5891545651652946`*^9, 3.589154718127551*^9, 
   3.589154767388908*^9, 3.589154844456225*^9, {3.589154936261013*^9, 
   3.589154945691699*^9}, {3.5891549966955767`*^9, 3.589155033592531*^9}, 
   3.589155234174719*^9, {3.589155279573002*^9, 3.589155289123665*^9}, 
   3.589155333209495*^9, {3.5891553679188833`*^9, 3.589155481367324*^9}, {
   3.589155518031846*^9, 3.5891555937806377`*^9}, {3.589155828649741*^9, 
   3.589155929676157*^9}, {3.589156023612947*^9, 3.589156039894643*^9}, {
   3.589156073466248*^9, 3.589156130793469*^9}, {3.5891563583245897`*^9, 
   3.589156388369214*^9}, {3.589156567231132*^9, 3.5891565718118353`*^9}, {
   3.589156631470087*^9, 3.5891566569745493`*^9}, {3.589156704019106*^9, 
   3.589156772060663*^9}, 3.5891584203335457`*^9, {3.589158454722052*^9, 
   3.589158496249914*^9}, {3.589158656340477*^9, 3.589158659685629*^9}, 
   3.589161932956863*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.582677107278851*^9, 3.5826771085437727`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.582604717680066*^9, 3.5826047176921797`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Now", " ", 
     RowBox[{"let", "'"}], "s", " ", "try", " ", "to", " ", "plot", " ", 
     "the", " ", "error", " ", "for", " ", "5", "th", " ", "order", " ", 
     "expansion", " ", "as", " ", "a", " ", "function", " ", "of", " ", "L", 
     "*", 
     RowBox[{"R", ".", " ", "When"}], " ", "there", " ", "is", " ", "perfect",
      " ", "phasematching"}], ",", " ", 
    RowBox[{
     RowBox[{
     "then", " ", "S", " ", "and", " ", "T", " ", "go", " ", "to", " ", "0.", 
      " ", "I", " ", "am", " ", "also", " ", "setting", " ", "L"}], "=", 
     RowBox[{
     "1", " ", "to", " ", "get", " ", "a", " ", "feel", " ", "for", " ", 
      "how", " ", "things", " ", 
      RowBox[{"scale", ".", " ", "It"}], " ", "should", " ", "really", " ", 
      "be", " ", "L", "*", "sqrt", 
      RowBox[{"(", "R", ")"}], " ", "that", " ", "I", " ", 
      RowBox[{"investigate", "."}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{"rulesplot", " ", ":=", 
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{"S", " ", "\[Rule]", " ", "0"}], ",", " ", 
      RowBox[{"T", " ", "\[Rule]", " ", "0"}], ",", 
      RowBox[{"L", "\[Rule]", "1"}], ",", "  ", 
      RowBox[{"N", " ", "\[Rule]", " ", "1"}]}], "}"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"IE", ":=", 
    RowBox[{"IntResultExact", " ", "//.", "rulesplot"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"diff5plot", " ", ":=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"IntResult9", "-", "IE"}], ")"}], "/", "IE"}], " ", "//.", 
     "rulesplot"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"data", " ", "=", " ", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"diff3plot", "*", "100"}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"R", ",", ".1", ",", " ", "1", ",", " ", ".3"}], "}"}], ",", 
        " ", 
        RowBox[{"{", 
         RowBox[{"L", ",", "1", ",", " ", "2", ",", ".5"}], "}"}]}], "]"}], 
      "\[IndentingNewLine]", 
      RowBox[{"ListDensityPlot", "[", "data", "]"}]}]}], 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{",", "  ", 
       RowBox[{"DataRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{".1", ",", "1"}], "}"}]}]}], "]"}], "*)"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"data", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"diff5plot", "*", "100"}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"R", ",", ".1", ",", " ", "2", ",", " ", ".4"}], "}"}]}], 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{"data", ",", " ", 
     RowBox[{"DataRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{".1", ",", "1"}], "}"}]}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"diff3plot", "*", "100"}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"R", ",", " ", ".1", ",", " ", "2"}], "}"}]}], "]"}], "*)"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.582571514461753*^9, 3.582571551456332*^9}, {
   3.582578503345278*^9, 3.58257872440841*^9}, {3.582578780921651*^9, 
   3.582578883845438*^9}, {3.582578970661623*^9, 3.5825789710615797`*^9}, {
   3.582579131654023*^9, 3.582579200204801*^9}, {3.582579243741954*^9, 
   3.5825792459243107`*^9}, {3.5825793019633627`*^9, 3.582579371951651*^9}, {
   3.582579457175651*^9, 3.5825794845162363`*^9}, {3.582579540760523*^9, 
   3.582579570935811*^9}, {3.582579607016583*^9, 3.5825796095915947`*^9}, {
   3.582579643985656*^9, 3.5825796473228292`*^9}, {3.582579712051264*^9, 
   3.58257971848114*^9}, {3.5825797686854067`*^9, 3.5825798082418137`*^9}, {
   3.582579873379818*^9, 3.582579903872665*^9}, {3.582580063163332*^9, 
   3.582580068888425*^9}, {3.582580160070561*^9, 3.582580310148143*^9}, {
   3.5825803507792*^9, 3.582580379041741*^9}, 3.582580457517507*^9, {
   3.582580497564616*^9, 3.5825805027078733`*^9}, {3.582580538025709*^9, 
   3.5825805902668457`*^9}, {3.582580630656403*^9, 3.582580655723983*^9}, 
   3.5825808355668917`*^9, {3.582580875974682*^9, 3.582580933715579*^9}, {
   3.582580993168611*^9, 3.5825810254619913`*^9}, {3.582581096198348*^9, 
   3.582581198438293*^9}, {3.582581299535063*^9, 3.5825813460732594`*^9}, 
   3.582600172444182*^9, {3.5826038389114437`*^9, 3.582603839741509*^9}, {
   3.582603984803568*^9, 3.582603990923452*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "7.720022803397002`*^-7", ",", "0.002583238282532096`", ",", 
   "0.051718892688953876`", ",", "0.341339804640373`", ",", 
   "1.3587832203136938`"}], "}"}]], "Output",
 CellChangeTimes->{{3.5825810991036158`*^9, 3.5825811058004313`*^9}, {
   3.582581136013298*^9, 3.582581164420209*^9}, 3.582581203090735*^9, 
   3.582600158676648*^9, 3.5826001916288757`*^9, 3.58260379195722*^9, 
   3.582603895092568*^9, 3.58260401860787*^9, 3.582673541566701*^9, 
   3.589161954810891*^9}],

Cell[BoxData[
 GraphicsBox[{{}, {}, 
   {Hue[0.67, 0.6, 0.6], 
    LineBox[{{0.1, 7.720022803397002*^-7}, {0.325, 0.002583238282532096}, {
     0.55, 0.051718892688953876`}, {0.775, 0.341339804640373}, {1., 
     1.3587832203136938`}}]}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesOrigin->{0, 0},
  PlotRange->{{0., 1.}, {0., 1.3587832203136938`}},
  PlotRangeClipping->True,
  PlotRangePadding->{
    Scaled[0.02], 
    Scaled[0.02]}]], "Output",
 CellChangeTimes->{{3.5825810991036158`*^9, 3.5825811058004313`*^9}, {
   3.582581136013298*^9, 3.582581164420209*^9}, 3.582581203090735*^9, 
   3.582600158676648*^9, 3.5826001916288757`*^9, 3.58260379195722*^9, 
   3.582603895092568*^9, 3.58260401860787*^9, 3.582673541566701*^9, 
   3.58916195484824*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.582579558603568*^9, 3.582579564021964*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "So", " ", "it", " ", "looks", " ", "like", " ", "the", " ", "5", "th", " ",
    "order", " ", "expansion", " ", "is", " ", "fine", " ", "as", " ", "long",
    " ", "as", " ", "L", "*", 
   RowBox[{"R", "^", "0.5"}], " ", 
   RowBox[{"<<", " ", "1."}], " ", "Is", " ", "there", " ", "a", " ", 
   "better", " ", "way", " ", "to", " ", "expand", " ", "this", " ", 
   "without", " ", "needing", " ", "to", " ", "go", " ", "to", " ", "a", " ", 
   "ton", " ", "of", " ", 
   RowBox[{"terms", "?", " ", "I"}], " ", "tried", " ", "it", " ", "with", 
   " ", "the", " ", "third", " ", "order", " ", "expansion", " ", "and", " ", 
   "9", "th", " ", "order", " ", 
   RowBox[{"expansion", "."}]}], " ", "\[IndentingNewLine]", "*)"}]], "Input",\

 CellChangeTimes->{{3.5825812218049498`*^9, 3.582581286524527*^9}, {
  3.5825813519982986`*^9, 3.582581365413608*^9}}],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{{3.5825793967420473`*^9, 3.5825794457035847`*^9}, 
   3.582581214804072*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.582581217412138*^9, 3.582581217435742*^9}}]
},
WindowSize->{1440, 852},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (October 5, \
2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 6878, 162, 303, "Input"],
Cell[7460, 186, 1977, 42, 27, "Output"],
Cell[9440, 230, 1977, 42, 27, "Output"],
Cell[11420, 274, 2151, 48, 34, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13608, 327, 5569, 146, 453, "Input"],
Cell[19180, 475, 136, 3, 27, "Output"],
Cell[19319, 480, 330, 10, 27, "Output"],
Cell[19652, 492, 311, 9, 27, "Output"],
Cell[19966, 503, 119, 2, 27, "Output"],
Cell[20088, 507, 313, 9, 27, "Output"],
Cell[20404, 518, 313, 9, 27, "Output"]
}, Open  ]],
Cell[20732, 530, 1514, 45, 124, "Input"],
Cell[CellGroupData[{
Cell[22271, 579, 2332, 65, 79, "Input"],
Cell[24606, 646, 1740, 52, 54, "Output"]
}, Open  ]],
Cell[26361, 701, 957, 28, 73, "Input"],
Cell[CellGroupData[{
Cell[27343, 733, 654, 14, 58, "Input"],
Cell[28000, 749, 3102, 92, 83, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31139, 846, 4079, 104, 226, "Input"],
Cell[35221, 952, 5018, 148, 83, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40276, 1105, 1381, 36, 71, "Input"],
Cell[41660, 1143, 952, 24, 73, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42649, 1172, 3670, 100, 123, "Input"],
Cell[46322, 1274, 6438, 208, 107, "Output"]
}, Open  ]],
Cell[52775, 1485, 94, 1, 27, "Input"],
Cell[52872, 1488, 94, 1, 27, "Input"],
Cell[CellGroupData[{
Cell[52991, 1493, 2379, 50, 173, "Input"],
Cell[55373, 1545, 6490, 208, 107, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61900, 1758, 233, 6, 43, "Input"],
Cell[62136, 1766, 7614, 216, 111, "Output"]
}, Open  ]],
Cell[69765, 1985, 2039, 48, 77, "Input"],
Cell[CellGroupData[{
Cell[71829, 2037, 9785, 248, 245, "Input"],
Cell[81617, 2287, 1536, 44, 59, "Output"],
Cell[83156, 2333, 2270, 64, 59, "Output"],
Cell[85429, 2399, 1737, 49, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[87203, 2453, 2536, 58, 73, "Input"],
Cell[89742, 2513, 9265, 268, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[99044, 2786, 3698, 83, 178, "Input"],
Cell[102745, 2871, 1333, 38, 59, "Output"],
Cell[104081, 2911, 1703, 48, 59, "Output"],
Cell[105787, 2961, 1401, 38, 59, "Output"]
}, Open  ]],
Cell[107203, 3002, 4775, 124, 175, "Input"],
Cell[111981, 3128, 91, 1, 27, "Input"],
Cell[CellGroupData[{
Cell[112097, 3133, 3926, 110, 144, "Input"],
Cell[116026, 3245, 2295, 67, 83, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[118358, 3317, 2106, 59, 141, "Input"],
Cell[120467, 3378, 3155, 92, 83, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[123659, 3475, 3884, 101, 260, "Input"],
Cell[127546, 3578, 2597, 78, 58, "Output"],
Cell[130146, 3658, 2988, 87, 58, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[133171, 3750, 4446, 115, 253, "Input"],
Cell[137620, 3867, 788, 18, 56, "Output"],
Cell[138411, 3887, 1096, 26, 59, "Output"],
Cell[139510, 3915, 1093, 26, 59, "Output"]
}, Open  ]],
Cell[140618, 3944, 1455, 34, 139, "Input"],
Cell[142076, 3980, 92, 1, 27, "Input"],
Cell[CellGroupData[{
Cell[142193, 3985, 17990, 446, 787, "Input"],
Cell[160186, 4433, 134, 2, 27, "Output"],
Cell[160323, 4437, 131, 2, 27, "Output"],
Cell[160457, 4441, 997, 32, 94, "Output"],
Cell[161457, 4475, 389, 12, 70, "Output"],
Cell[161849, 4489, 131, 2, 27, "Output"],
Cell[161983, 4493, 142, 2, 30, "Output"],
Cell[162128, 4497, 135, 2, 27, "Output"],
Cell[162266, 4501, 143, 2, 30, "Output"],
Cell[162412, 4505, 131, 2, 27, "Output"],
Cell[162546, 4509, 139, 2, 30, "Output"]
}, Open  ]],
Cell[162700, 4514, 10498, 249, 264, "Input"],
Cell[CellGroupData[{
Cell[173223, 4767, 11769, 244, 566, "Input"],
Cell[184995, 5013, 1098, 15, 27, "Output"],
Cell[186096, 5030, 618, 12, 43, "Message"],
Cell[186717, 5044, 729, 13, 40, "Message"],
Cell[187449, 5059, 618, 12, 43, "Message"],
Cell[188070, 5073, 1094, 15, 27, "Output"],
Cell[189167, 5090, 1097, 15, 27, "Output"],
Cell[190267, 5107, 644, 12, 23, "Message"],
Cell[190914, 5121, 618, 12, 43, "Message"],
Cell[191535, 5135, 729, 13, 40, "Message"],
Cell[192267, 5150, 618, 12, 43, "Message"],
Cell[192888, 5164, 645, 12, 23, "Message"],
Cell[193536, 5178, 700, 13, 23, "Message"],
Cell[194239, 5193, 620, 12, 43, "Message"],
Cell[194862, 5207, 696, 13, 23, "Message"],
Cell[195561, 5222, 1092, 15, 27, "Output"],
Cell[196656, 5239, 615, 12, 40, "Message"],
Cell[197274, 5253, 645, 12, 23, "Message"],
Cell[197922, 5267, 618, 12, 43, "Message"],
Cell[198543, 5281, 620, 12, 43, "Message"],
Cell[199166, 5295, 696, 13, 23, "Message"],
Cell[199865, 5310, 729, 13, 40, "Message"],
Cell[200597, 5325, 647, 12, 23, "Message"],
Cell[201247, 5339, 700, 13, 23, "Message"],
Cell[201950, 5354, 647, 12, 23, "Message"],
Cell[202600, 5368, 618, 12, 43, "Message"],
Cell[203221, 5382, 731, 13, 40, "Message"],
Cell[203955, 5397, 618, 12, 43, "Message"],
Cell[204576, 5411, 645, 12, 23, "Message"],
Cell[205224, 5425, 700, 13, 23, "Message"],
Cell[205927, 5440, 617, 12, 43, "Message"],
Cell[206547, 5454, 696, 13, 23, "Message"],
Cell[207246, 5469, 1092, 15, 27, "Output"],
Cell[208341, 5486, 1101, 15, 27, "Output"]
}, Open  ]],
Cell[209457, 5504, 94, 1, 27, "Input"],
Cell[209554, 5507, 94, 1, 27, "Input"],
Cell[CellGroupData[{
Cell[209673, 5512, 4596, 102, 223, "Input"],
Cell[214272, 5616, 518, 10, 33, "Output"],
Cell[214793, 5628, 793, 18, 242, "Output"]
}, Open  ]],
Cell[215601, 5649, 92, 1, 27, "Input"],
Cell[215696, 5652, 906, 17, 58, "Input"],
Cell[216605, 5671, 141, 2, 43, "Input"],
Cell[216749, 5675, 92, 1, 27, "Input"]
}
]
*)

(* End of internal cache information *)
