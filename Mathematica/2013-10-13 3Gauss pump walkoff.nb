(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[    129191,       3253]
NotebookOptionsPosition[    126147,       3155]
NotebookOutlinePosition[    126500,       3171]
CellTagsIndexPosition[    126457,       3168]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CompleteSquare", "[", 
    RowBox[{"f_", ",", "x_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"c", ",", "b", ",", "a"}], "}"}], "=", 
       RowBox[{"CoefficientList", "[", 
        RowBox[{"f", ",", "x"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"a", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"x", "+", 
           RowBox[{
            RowBox[{"b", "/", "2"}], "/", "a"}]}], ")"}], "^", "2"}]}], "+", 
       RowBox[{"Simplify", "[", 
        RowBox[{"(", 
         RowBox[{"c", "-", 
          RowBox[{
           RowBox[{
            RowBox[{"b", "^", "2"}], "/", "4"}], "/", "a"}]}], ")"}], 
        "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Figure", " ", "out", " ", "the", " ", "rotation", " ", "that", " ", 
    "puts", " ", "the", " ", "signal", " ", "and", " ", "idler", " ", "into", 
    " ", "the", " ", "pump", " ", 
    RowBox[{"coordinates", ".", " ", "Here"}], " ", "\[Theta]", " ", "is", 
    " ", "the", " ", "opening", " ", "angle", " ", "and", " ", "\[Phi]", " ", 
    "is", " ", "the", " ", "azimuthal", " ", 
    RowBox[{"angle", "."}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Rx", "[", 
    RowBox[{"\[Theta]_", ",", " ", "V_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "S", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RotX", " ", "=", "  ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", " ", "0", ",", " ", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", " ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
           RowBox[{"-", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"0", ",", " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}], ",", " ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"RotX", ".", "V"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ry", "[", 
    RowBox[{"\[Theta]_", ",", " ", "V_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "S", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RotY", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", " ", 
          RowBox[{
           RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", "0", ",", " ", 
           RowBox[{"+", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", "  ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", "0", ",", "  ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"RotY", ".", "V"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rz", "[", 
   RowBox[{"\[Theta]_", ",", " ", "V_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "S", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RotZ", " ", ":=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", " ", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}], ",", " ", "0"}], "}"}], ",", 
        " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", " ", "0"}], "}"}], ",", 
        " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RotZ", ".", "V"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.582551082707974*^9, 3.582551243412228*^9}, {
   3.582552241600596*^9, 3.58255248525065*^9}, {3.5825530886487722`*^9, 
   3.582553091710619*^9}, {3.582581931220381*^9, 3.582581994221595*^9}, {
   3.582589736354864*^9, 3.58258979384231*^9}, {3.582589853214909*^9, 
   3.582589939808462*^9}, {3.582590073974887*^9, 3.5825900784620047`*^9}, {
   3.582591942003405*^9, 3.5825919557241173`*^9}, {3.582592064468408*^9, 
   3.582592070390641*^9}, {3.582592168312223*^9, 3.582592195349346*^9}, {
   3.582592537371162*^9, 3.5825925389767017`*^9}, {3.582592609833417*^9, 
   3.582592630132695*^9}, {3.582594727920084*^9, 3.5825947541563683`*^9}, {
   3.582594786928154*^9, 3.582594837727318*^9}, {3.582594872553235*^9, 
   3.5825948732121487`*^9}, 3.582594919516144*^9, {3.582595006307055*^9, 
   3.58259502779462*^9}, {3.582595382427409*^9, 3.5825953955679607`*^9}, {
   3.582595429725254*^9, 3.582595511584939*^9}, {3.582595567715238*^9, 
   3.58259556798405*^9}, {3.5825957007377663`*^9, 3.5825957096247883`*^9}, {
   3.582595744582691*^9, 3.582595792538672*^9}, {3.582596036605506*^9, 
   3.5825960731972313`*^9}, {3.582596118612314*^9, 3.58259612941899*^9}, {
   3.582596292204793*^9, 3.5825963567715073`*^9}, {3.582596404384987*^9, 
   3.5825964610317802`*^9}, {3.5825968755404663`*^9, 3.582596891139832*^9}, 
   3.582597031324554*^9, {3.582597263234353*^9, 3.582597287940269*^9}, {
   3.5825973900652647`*^9, 3.582597396723194*^9}, {3.582597641860304*^9, 
   3.582597661706188*^9}, 3.582597849090914*^9, 3.582597885135263*^9, {
   3.5826762909693413`*^9, 3.582676292040473*^9}, {3.589299275215334*^9, 
   3.589299276871471*^9}, {3.5894735627453117`*^9, 3.589473747565434*^9}, {
   3.5894737984212646`*^9, 3.589473800825018*^9}, 3.589473836508107*^9, {
   3.58947389839431*^9, 3.5894740827498093`*^9}, {3.589475328368573*^9, 
   3.589475346401663*^9}, {3.590522057342185*^9, 3.590522057548717*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Test", " ", "for", " ", "the", " ", "Migdal", " ", "Effect", " ", 
    "coordinates"}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"vv", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vv1", " ", "=", " ", 
     RowBox[{"Ry", "[", 
      RowBox[{
       RowBox[{"-", "\[Gamma]"}], ",", "vv"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vv2", " ", "=", 
     RowBox[{"Rz", "[", 
      RowBox[{
       RowBox[{"-", "\[Phi]"}], ",", "vv1"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xprime", " ", "=", " ", "vv2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"yprime", " ", "=", " ", 
     RowBox[{"Rz", "[", 
      RowBox[{
       RowBox[{"-", "\[Phi]"}], ",", 
       RowBox[{"Ry", "[", 
        RowBox[{
         RowBox[{"-", "\[Gamma]"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"zprime", " ", "=", " ", 
     RowBox[{"Rz", "[", 
      RowBox[{
       RowBox[{"-", "\[Phi]"}], ",", 
       RowBox[{"Ry", "[", 
        RowBox[{
         RowBox[{"-", "\[Gamma]"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Rotation", " ", "Matrix", " ", "about", " ", 
     RowBox[{"y", "'"}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"yprime", " ", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Refine", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"RotationMatrix", "[", 
           RowBox[{"\[Theta]", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], ".", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ",", 
         RowBox[{"Element", "[", 
          RowBox[{"\[Theta]", ",", " ", "Reals"}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", "RotYprime"}], "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"RotationMatrix", "[", 
         RowBox[{"\[Gamma]", ",", " ", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], " ", "]"}], 
        "\[IndentingNewLine]", "RotYprime"}], "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Simplify", "[", 
          RowBox[{"Refine", "[", 
           RowBox[{
            RowBox[{"RotationMatrix", "[", 
             RowBox[{"\[Gamma]", ",", " ", "yprime"}], " ", "]"}], ",", " ", 
            RowBox[{"Element", "[", 
             RowBox[{"\[Gamma]", ",", " ", "Reals"}], "]"}]}], "]"}], "]"}], 
         "\[IndentingNewLine]", "vv2"}], " ", "=", " ", 
        RowBox[{"vv2", " ", "/.", " ", 
         RowBox[{"{", 
          RowBox[{"x1", " ", "\[Rule]", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"vv1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", "x"}], " ", "+", " ", 
            RowBox[{
             RowBox[{"vv1", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "*", "y"}], " ", "+", " ", 
            RowBox[{
             RowBox[{"vv1", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "*", "z"}]}]}], "}"}]}]}]}]}]}],
     "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"c", " ", "=", " ", 
     RowBox[{"Ry", "[", 
      RowBox[{
       RowBox[{"-", "\[Theta]"}], ",", "vv"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"pp", " ", "=", " ", 
    RowBox[{"Cross", "[", 
     RowBox[{"xprime", ",", "c"}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"tanbeta", " ", "=", " ", 
    RowBox[{
     RowBox[{"p", ".", "yprime"}], "/", 
     RowBox[{"(", 
      RowBox[{"p", ".", "zprime"}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{"p", ".", "xprime"}], "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"angle", " ", "=", " ", 
     RowBox[{
      RowBox[{"aacross", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "/", 
      RowBox[{"aacross", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Simplify", "[", "angle", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"ca", " ", "=", " ", 
      RowBox[{"CoefficientList", "[", 
       RowBox[{"aa", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Beta]", "]"}], ",", " ", 
          RowBox[{"Sin", "[", "\[Beta]", "]"}]}], "}"}]}], "]"}]}], ";"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"ctan", " ", "=", " ", 
      RowBox[{
       RowBox[{"ca", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}], "/", 
       RowBox[{"ca", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Simplify", "[", "ctan", "]"}]}], "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "*", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}], "*", 
        RowBox[{"Sin", "[", "\[Gamma]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Theta]", "]"}], "*", 
        RowBox[{"Cos", "[", "\[Gamma]", "]"}]}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]", "]"}], "*", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ")"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{"tanbeta", " ", "-", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "*", 
          RowBox[{"Cos", "[", "\[Phi]", "]"}], "*", 
          RowBox[{"Sin", "[", "\[Gamma]", "]"}]}], "+", 
         RowBox[{
          RowBox[{"Sin", "[", "\[Theta]", "]"}], "*", 
          RowBox[{"Cos", "[", "\[Gamma]", "]"}]}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cos", "[", "\[Theta]", "]"}], "*", 
         RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ")"}]}], "]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.582551082707974*^9, 3.582551243412228*^9}, {
   3.582552241600596*^9, 3.58255248525065*^9}, {3.5825530886487722`*^9, 
   3.582553091710619*^9}, {3.582581931220381*^9, 3.582581994221595*^9}, {
   3.582589736354864*^9, 3.58258979384231*^9}, {3.582589853214909*^9, 
   3.582589939808462*^9}, {3.582590073974887*^9, 3.5825900784620047`*^9}, {
   3.582591942003405*^9, 3.5825919557241173`*^9}, {3.582592064468408*^9, 
   3.582592070390641*^9}, {3.582592168312223*^9, 3.582592195349346*^9}, {
   3.582592537371162*^9, 3.5825925389767017`*^9}, {3.582592609833417*^9, 
   3.582592630132695*^9}, {3.582594727920084*^9, 3.5825947541563683`*^9}, {
   3.582594786928154*^9, 3.582594837727318*^9}, {3.582594872553235*^9, 
   3.5825948732121487`*^9}, 3.582594919516144*^9, {3.582595006307055*^9, 
   3.58259502779462*^9}, {3.582595382427409*^9, 3.5825953955679607`*^9}, {
   3.582595429725254*^9, 3.582595511584939*^9}, {3.582595567715238*^9, 
   3.58259556798405*^9}, {3.5825957007377663`*^9, 3.5825957096247883`*^9}, {
   3.582595744582691*^9, 3.582595792538672*^9}, {3.582596036605506*^9, 
   3.5825960731972313`*^9}, {3.582596118612314*^9, 3.58259612941899*^9}, {
   3.582596292204793*^9, 3.5825963567715073`*^9}, {3.582596404384987*^9, 
   3.5825964610317802`*^9}, {3.5825968755404663`*^9, 3.582596891139832*^9}, 
   3.582597031324554*^9, {3.582597263234353*^9, 3.582597287940269*^9}, {
   3.5825973900652647`*^9, 3.582597396723194*^9}, {3.582597641860304*^9, 
   3.582597661706188*^9}, 3.582597849090914*^9, 3.582597885135263*^9, {
   3.5826762909693413`*^9, 3.582676292040473*^9}, {3.589299275215334*^9, 
   3.589299276871471*^9}, {3.5894735627453117`*^9, 3.589473747565434*^9}, {
   3.5894737984212646`*^9, 3.589473800825018*^9}, 3.589473836508107*^9, {
   3.58947389839431*^9, 3.5894740827498093`*^9}, {3.589475328368573*^9, 
   3.589475346401663*^9}, {3.59035231228895*^9, 3.590352557564219*^9}, {
   3.590352618381175*^9, 3.590352700094846*^9}, {3.59035277672757*^9, 
   3.590352846180149*^9}, {3.590353511059863*^9, 3.59035351113032*^9}, {
   3.590353558497958*^9, 3.590353585213488*^9}, {3.5903681985005703`*^9, 
   3.5903682012992077`*^9}, {3.5903683320977716`*^9, 3.590368342940255*^9}, {
   3.590368515929708*^9, 3.5903685165112*^9}, {3.5903686310247927`*^9, 
   3.5903687685329123`*^9}, {3.59036882973092*^9, 3.59036898073641*^9}, {
   3.590369025097028*^9, 3.590369160144919*^9}, {3.5903717481897907`*^9, 
   3.590371757759794*^9}, {3.5903717946023693`*^9, 3.590371842464266*^9}, 
   3.59037187484477*^9, {3.5903721057867537`*^9, 3.590372137875298*^9}, {
   3.590372185665049*^9, 3.590372196053953*^9}, 3.590372277269215*^9, {
   3.590372400711143*^9, 3.590372525893437*^9}, {3.590372886230072*^9, 
   3.5903729130537453`*^9}, 3.590374053791387*^9, {3.590374105187318*^9, 
   3.590374107702107*^9}, 3.590374161794417*^9, {3.590374410482408*^9, 
   3.5903744345420713`*^9}, {3.5903744975845203`*^9, 3.590374557517441*^9}, {
   3.5903746444250317`*^9, 3.59037468432897*^9}, 3.590374747185891*^9, {
   3.59037538787215*^9, 3.5903754174894114`*^9}, {3.590375462080271*^9, 
   3.590375651927603*^9}, {3.590375849888283*^9, 3.590375872394443*^9}, {
   3.590375926286907*^9, 3.5903759605120296`*^9}, {3.59037600636863*^9, 
   3.590376090075693*^9}, {3.590376396280315*^9, 3.590376421491294*^9}, {
   3.590401308693337*^9, 3.5904013844743853`*^9}, {3.590401456788125*^9, 
   3.590401466913855*^9}, {3.590401729775968*^9, 3.5904017329115267`*^9}, {
   3.590401787036455*^9, 3.590401790123395*^9}, {3.590401913818762*^9, 
   3.590401917087358*^9}, 3.590401969842162*^9, {3.590402032463928*^9, 
   3.590402048884557*^9}, {3.590402138442749*^9, 3.5904021581360683`*^9}, {
   3.590402250393141*^9, 3.5904022729934053`*^9}, {3.590402863318907*^9, 
   3.590402865598917*^9}, {3.590403241261299*^9, 3.590403298726536*^9}, {
   3.5904033542731113`*^9, 3.590403388151552*^9}, {3.5904037299115353`*^9, 
   3.5904037459157867`*^9}, {3.590428307410595*^9, 3.590428417389591*^9}, {
   3.59042846825375*^9, 3.5904285570833187`*^9}, {3.59042863194175*^9, 
   3.590428652925955*^9}, 3.59042873193652*^9, {3.590428834241994*^9, 
   3.5904288405837107`*^9}, {3.590428871092555*^9, 3.5904288802063427`*^9}, {
   3.5904301609223967`*^9, 3.5904301948998737`*^9}, {3.590430225270535*^9, 
   3.5904302860807133`*^9}, 3.590430610111863*^9, {3.5904309142383833`*^9, 
   3.5904309220038958`*^9}, {3.5905213526795807`*^9, 3.5905213529610853`*^9}, 
   3.590522815310717*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
    RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
     RowBox[{"Sin", "[", "\[Gamma]", "]"}]}], "-", 
    RowBox[{
     RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
     RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
     RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"Cos", "[", "\[Gamma]", "]"}]}], " ", 
    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
    RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.5903687689499817`*^9, {3.590368832642667*^9, 3.590368871475341*^9}, {
   3.590368911537182*^9, 3.590368927081558*^9}, {3.5903689572401867`*^9, 
   3.590368981163251*^9}, {3.590369125940073*^9, 3.590369160647924*^9}, {
   3.5903717494468393`*^9, 3.590371758305862*^9}, {3.590371799968397*^9, 
   3.590371811499052*^9}, 3.5903718431472397`*^9, 3.590371875348291*^9, 
   3.590372138723671*^9, {3.590372187652663*^9, 3.5903721984525137`*^9}, 
   3.590372277832563*^9, {3.590372406574975*^9, 3.5903724215761766`*^9}, {
   3.5903724789625463`*^9, 3.59037252898881*^9}, 3.590372916979373*^9, 
   3.590374054369318*^9, 3.590374110585691*^9, 3.590374162529646*^9, 
   3.5903744405864267`*^9, 3.5903745586783457`*^9, {3.590374645662361*^9, 
   3.590374685500723*^9}, 3.590374748327442*^9, 3.5903755168015137`*^9, {
   3.590375558496963*^9, 3.590375620295312*^9}, 3.590375656169896*^9, 
   3.590375872801875*^9, {3.59037593734618*^9, 3.5903759612168283`*^9}, 
   3.590376026337274*^9, {3.590376069078991*^9, 3.5903760907497063`*^9}, 
   3.590376423403305*^9, {3.590401360620824*^9, 3.59040138493316*^9}, 
   3.590401467920477*^9, 3.5904017335487833`*^9, 3.5904017917332582`*^9, 
   3.5904019179681187`*^9, 3.590401970431501*^9, {3.590402037327228*^9, 
   3.590402049896289*^9}, {3.590402139562867*^9, 3.590402158613493*^9}, {
   3.590402251014365*^9, 3.590402273831831*^9}, 3.590402866112482*^9, 
   3.590403301700288*^9, 3.590403389159466*^9, {3.5904037303960876`*^9, 
   3.590403748358329*^9}, 3.590428366824472*^9, 3.590428436868195*^9, {
   3.590428483534897*^9, 3.590428495799883*^9}, {3.590428529453257*^9, 
   3.590428558000392*^9}, {3.590428634880168*^9, 3.590428653514997*^9}, 
   3.590428732415818*^9, {3.590428841264264*^9, 3.590428880646551*^9}, {
   3.590430164378193*^9, 3.590430197211114*^9}, {3.590430227444598*^9, 
   3.590430287193406*^9}, 3.5904306105750027`*^9, {3.59043091477334*^9, 
   3.590430922545223*^9}, {3.590522822436605*^9, 3.590522830805711*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Gamma]", "]"}]}], "-", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "-", 
    RowBox[{
     RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
     RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
     SuperscriptBox[
      RowBox[{"Sin", "[", "\[Phi]", "]"}], "2"]}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox[
       RowBox[{"Cos", "[", "\[Gamma]", "]"}], "2"]}], " ", 
     RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
     RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "-", 
    RowBox[{
     RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
     RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
     RowBox[{"Sin", "[", "\[Gamma]", "]"}], " ", 
     RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
     RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "-", 
    RowBox[{
     RowBox[{"Sin", "[", "\[Gamma]", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Gamma]", "]"}]}], "-", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}], " ", 
     RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.5903687689499817`*^9, {3.590368832642667*^9, 3.590368871475341*^9}, {
   3.590368911537182*^9, 3.590368927081558*^9}, {3.5903689572401867`*^9, 
   3.590368981163251*^9}, {3.590369125940073*^9, 3.590369160647924*^9}, {
   3.5903717494468393`*^9, 3.590371758305862*^9}, {3.590371799968397*^9, 
   3.590371811499052*^9}, 3.5903718431472397`*^9, 3.590371875348291*^9, 
   3.590372138723671*^9, {3.590372187652663*^9, 3.5903721984525137`*^9}, 
   3.590372277832563*^9, {3.590372406574975*^9, 3.5903724215761766`*^9}, {
   3.5903724789625463`*^9, 3.59037252898881*^9}, 3.590372916979373*^9, 
   3.590374054369318*^9, 3.590374110585691*^9, 3.590374162529646*^9, 
   3.5903744405864267`*^9, 3.5903745586783457`*^9, {3.590374645662361*^9, 
   3.590374685500723*^9}, 3.590374748327442*^9, 3.5903755168015137`*^9, {
   3.590375558496963*^9, 3.590375620295312*^9}, 3.590375656169896*^9, 
   3.590375872801875*^9, {3.59037593734618*^9, 3.5903759612168283`*^9}, 
   3.590376026337274*^9, {3.590376069078991*^9, 3.5903760907497063`*^9}, 
   3.590376423403305*^9, {3.590401360620824*^9, 3.59040138493316*^9}, 
   3.590401467920477*^9, 3.5904017335487833`*^9, 3.5904017917332582`*^9, 
   3.5904019179681187`*^9, 3.590401970431501*^9, {3.590402037327228*^9, 
   3.590402049896289*^9}, {3.590402139562867*^9, 3.590402158613493*^9}, {
   3.590402251014365*^9, 3.590402273831831*^9}, 3.590402866112482*^9, 
   3.590403301700288*^9, 3.590403389159466*^9, {3.5904037303960876`*^9, 
   3.590403748358329*^9}, 3.590428366824472*^9, 3.590428436868195*^9, {
   3.590428483534897*^9, 3.590428495799883*^9}, {3.590428529453257*^9, 
   3.590428558000392*^9}, {3.590428634880168*^9, 3.590428653514997*^9}, 
   3.590428732415818*^9, {3.590428841264264*^9, 3.590428880646551*^9}, {
   3.590430164378193*^9, 3.590430197211114*^9}, {3.590430227444598*^9, 
   3.590430287193406*^9}, 3.5904306105750027`*^9, {3.59043091477334*^9, 
   3.590430922545223*^9}, {3.590522822436605*^9, 3.590522830808408*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    RowBox[{"Cot", "[", "\[Phi]", "]"}]}], " ", 
   RowBox[{"Sin", "[", "\[Gamma]", "]"}]}], "+", 
  RowBox[{
   RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
   RowBox[{"Csc", "[", "\[Phi]", "]"}], " ", 
   RowBox[{"Tan", "[", "\[Theta]", "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.5903687689499817`*^9, {3.590368832642667*^9, 3.590368871475341*^9}, {
   3.590368911537182*^9, 3.590368927081558*^9}, {3.5903689572401867`*^9, 
   3.590368981163251*^9}, {3.590369125940073*^9, 3.590369160647924*^9}, {
   3.5903717494468393`*^9, 3.590371758305862*^9}, {3.590371799968397*^9, 
   3.590371811499052*^9}, 3.5903718431472397`*^9, 3.590371875348291*^9, 
   3.590372138723671*^9, {3.590372187652663*^9, 3.5903721984525137`*^9}, 
   3.590372277832563*^9, {3.590372406574975*^9, 3.5903724215761766`*^9}, {
   3.5903724789625463`*^9, 3.59037252898881*^9}, 3.590372916979373*^9, 
   3.590374054369318*^9, 3.590374110585691*^9, 3.590374162529646*^9, 
   3.5903744405864267`*^9, 3.5903745586783457`*^9, {3.590374645662361*^9, 
   3.590374685500723*^9}, 3.590374748327442*^9, 3.5903755168015137`*^9, {
   3.590375558496963*^9, 3.590375620295312*^9}, 3.590375656169896*^9, 
   3.590375872801875*^9, {3.59037593734618*^9, 3.5903759612168283`*^9}, 
   3.590376026337274*^9, {3.590376069078991*^9, 3.5903760907497063`*^9}, 
   3.590376423403305*^9, {3.590401360620824*^9, 3.59040138493316*^9}, 
   3.590401467920477*^9, 3.5904017335487833`*^9, 3.5904017917332582`*^9, 
   3.5904019179681187`*^9, 3.590401970431501*^9, {3.590402037327228*^9, 
   3.590402049896289*^9}, {3.590402139562867*^9, 3.590402158613493*^9}, {
   3.590402251014365*^9, 3.590402273831831*^9}, 3.590402866112482*^9, 
   3.590403301700288*^9, 3.590403389159466*^9, {3.5904037303960876`*^9, 
   3.590403748358329*^9}, 3.590428366824472*^9, 3.590428436868195*^9, {
   3.590428483534897*^9, 3.590428495799883*^9}, {3.590428529453257*^9, 
   3.590428558000392*^9}, {3.590428634880168*^9, 3.590428653514997*^9}, 
   3.590428732415818*^9, {3.590428841264264*^9, 3.590428880646551*^9}, {
   3.590430164378193*^9, 3.590430197211114*^9}, {3.590430227444598*^9, 
   3.590430287193406*^9}, 3.5904306105750027`*^9, {3.59043091477334*^9, 
   3.590430922545223*^9}, {3.590522822436605*^9, 3.590522830810204*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.5903687689499817`*^9, {3.590368832642667*^9, 3.590368871475341*^9}, {
   3.590368911537182*^9, 3.590368927081558*^9}, {3.5903689572401867`*^9, 
   3.590368981163251*^9}, {3.590369125940073*^9, 3.590369160647924*^9}, {
   3.5903717494468393`*^9, 3.590371758305862*^9}, {3.590371799968397*^9, 
   3.590371811499052*^9}, 3.5903718431472397`*^9, 3.590371875348291*^9, 
   3.590372138723671*^9, {3.590372187652663*^9, 3.5903721984525137`*^9}, 
   3.590372277832563*^9, {3.590372406574975*^9, 3.5903724215761766`*^9}, {
   3.5903724789625463`*^9, 3.59037252898881*^9}, 3.590372916979373*^9, 
   3.590374054369318*^9, 3.590374110585691*^9, 3.590374162529646*^9, 
   3.5903744405864267`*^9, 3.5903745586783457`*^9, {3.590374645662361*^9, 
   3.590374685500723*^9}, 3.590374748327442*^9, 3.5903755168015137`*^9, {
   3.590375558496963*^9, 3.590375620295312*^9}, 3.590375656169896*^9, 
   3.590375872801875*^9, {3.59037593734618*^9, 3.5903759612168283`*^9}, 
   3.590376026337274*^9, {3.590376069078991*^9, 3.5903760907497063`*^9}, 
   3.590376423403305*^9, {3.590401360620824*^9, 3.59040138493316*^9}, 
   3.590401467920477*^9, 3.5904017335487833`*^9, 3.5904017917332582`*^9, 
   3.5904019179681187`*^9, 3.590401970431501*^9, {3.590402037327228*^9, 
   3.590402049896289*^9}, {3.590402139562867*^9, 3.590402158613493*^9}, {
   3.590402251014365*^9, 3.590402273831831*^9}, 3.590402866112482*^9, 
   3.590403301700288*^9, 3.590403389159466*^9, {3.5904037303960876`*^9, 
   3.590403748358329*^9}, 3.590428366824472*^9, 3.590428436868195*^9, {
   3.590428483534897*^9, 3.590428495799883*^9}, {3.590428529453257*^9, 
   3.590428558000392*^9}, {3.590428634880168*^9, 3.590428653514997*^9}, 
   3.590428732415818*^9, {3.590428841264264*^9, 3.590428880646551*^9}, {
   3.590430164378193*^9, 3.590430197211114*^9}, {3.590430227444598*^9, 
   3.590430287193406*^9}, 3.5904306105750027`*^9, {3.59043091477334*^9, 
   3.590430922545223*^9}, {3.590522822436605*^9, 3.5905228308114977`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"sinbeta", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "*", 
     RowBox[{"Cos", "[", "\[Phi]", "]"}], "*", 
     RowBox[{"Sin", "[", "\[Gamma]", "]"}]}], "+", 
    RowBox[{
     RowBox[{"Sin", "[", "\[Theta]", "]"}], "*", 
     RowBox[{"Cos", "[", "\[Gamma]", "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cosbeta", " ", "=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Theta]", "]"}], "*", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kprime", " ", "=", " ", 
   RowBox[{"Rz", "[", 
    RowBox[{
     SubscriptBox["\[Gamma]", "s"], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kprime2", " ", "=", " ", 
   RowBox[{
    RowBox[{"Rx", "[", 
     RowBox[{
      RowBox[{"-", "\[Beta]"}], ",", "kprime"}], "]"}], " ", "//.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Sin", "[", "\[Beta]", "]"}], "\[Rule]", "sinbeta"}], ",", " ", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Beta]", "]"}], "\[Rule]", "cosbeta"}]}], 
     "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"poynting", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"kprime2", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "*", "xprime"}], " ", "+", 
    RowBox[{
     RowBox[{"kprime2", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "*", "yprime"}], " ", "+", 
    RowBox[{
     RowBox[{"kprime2", "[", 
      RowBox[{"[", "3", "]"}], "]"}], "*", "zprime"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"poynting", " ", "=", " ", 
  RowBox[{"Simplify", "[", "poynting", " ", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"poynting", " ", "=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{"poynting", "  ", "//.", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Gamma]", "\[Rule]", "0"}], ",", " ", 
        RowBox[{"\[Phi]", "\[Rule]", "0"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rx", "[", 
   RowBox[{
    RowBox[{"-", "r"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"0", ",", "y", ",", "0"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.59043252255716*^9, 3.5904326261212053`*^9}, {
  3.590432657629725*^9, 3.590432660539728*^9}, {3.590432792985394*^9, 
  3.590432862566724*^9}, {3.590432909416657*^9, 3.590433023660572*^9}, {
  3.590433106019783*^9, 3.590433152053308*^9}, {3.5904331958762913`*^9, 
  3.590433228702567*^9}, {3.590435307242157*^9, 3.590435324615347*^9}, {
  3.590440089686829*^9, 3.590440129252448*^9}, {3.590521614911076*^9, 
  3.5905216449899397`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"Cos", "[", "\[Phi]", "]"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Gamma]", "]"}], "2"]}], "+", 
       SuperscriptBox[
        RowBox[{"Sin", "[", "\[Phi]", "]"}], "2"]}], ")"}], " ", 
     RowBox[{"Sin", "[", 
      SubscriptBox["\[Gamma]", "s"], "]"}]}], "+", 
    RowBox[{
     RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
     RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", 
        SubscriptBox["\[Gamma]", "s"], "]"}], "-", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Gamma]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["\[Gamma]", "s"], "]"}]}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Gamma]", "s"], "]"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "+", 
         RowBox[{
          RowBox[{"Sin", "[", "\[Gamma]", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        SubscriptBox["\[Gamma]", "s"], "]"}]}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Cos", "[", 
      SubscriptBox["\[Gamma]", "s"], "]"}], " ", 
     RowBox[{"Sin", "[", "\[Gamma]", "]"}]}], "+", 
    RowBox[{
     RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}], " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Gamma]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}], " ", 
     RowBox[{"Sin", "[", 
      SubscriptBox["\[Gamma]", "s"], "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.589690476700568*^9, 3.589690554673818*^9, 3.5896916369828053`*^9, {
   3.589691668106585*^9, 3.589691692916295*^9}, 3.589691744707251*^9, 
   3.5904325958130217`*^9, 3.590432627526492*^9, 3.590432661192602*^9, {
   3.590432836108938*^9, 3.590432863084732*^9}, {3.590432950891849*^9, 
   3.5904329750769053`*^9}, 3.590433025142672*^9, {3.590433125409339*^9, 
   3.590433153409587*^9}, 3.5904332290892553`*^9, 3.590433280341445*^9, 
   3.5904353251552343`*^9, {3.590440113125485*^9, 3.590440129943326*^9}, {
   3.5905216167349586`*^9, 3.590521645477098*^9}, 3.590522831328915*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "These", " ", "are", " ", "the", " ", "normalization", " ", "coefficients",
     " ", "for", " ", "the", " ", "three", " ", "Gaussians"}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"To", " ", "get", " ", "the", " ", "signal"}], ",", " ", 
    RowBox[{
    "we", " ", "rotate", " ", "the", " ", "pump", " ", "vector", " ", "about",
      " ", "X", " ", "by", " ", 
     SubscriptBox["\[Theta]", "s"]}], ",", " ", 
    RowBox[{"then", " ", "about", " ", "Z", " ", "by", " ", 
     SubscriptBox["\[Phi]", "s"]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"rulescoord", " ", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Theta]", "s"], "\[Rule]", 
        SubscriptBox["\[Theta]", "i"]}], ",", "  ", 
       RowBox[{
        SubscriptBox["\[Phi]", "s"], " ", "\[Rule]", "  ", 
        RowBox[{
         SubscriptBox["\[Phi]", "s"], "+", "\[Pi]"}]}]}], " ", "}"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rulescoord2", " ", "=", "  ", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["\[Phi]", "ss"], "\[Rule]", " ", 
       SubscriptBox["\[Phi]", "s"]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"planarrules", " ", ":=", " ", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["\[Phi]", "s"], " ", "\[Rule]", " ", "0"}], "}"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"rulescoord2", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["\[Phi]", "ss"], " ", "\[Rule]", " ", 
        SubscriptBox["\[Phi]", "i"]}], "}"}]}], ";"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xs", " ", "=", " ", 
     RowBox[{"Rz", "[", 
      RowBox[{
       SubscriptBox["\[Phi]", "s"], ",", 
       RowBox[{"Rx", "[", 
        RowBox[{
         SubscriptBox["\[Theta]", "s"], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ys", " ", "=", " ", 
     RowBox[{"Rz", "[", 
      RowBox[{
       SubscriptBox["\[Phi]", "s"], ",", 
       RowBox[{"Rx", "[", 
        RowBox[{
         SubscriptBox["\[Theta]", "s"], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"zs", " ", "=", " ", 
     RowBox[{"Rz", "[", 
      RowBox[{
       SubscriptBox["\[Phi]", "s"], ",", 
       RowBox[{"Rx", "[", 
        RowBox[{
         SubscriptBox["\[Theta]", "s"], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vect", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["x", "s"], "=", 
     RowBox[{"xs", ".", "vect"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["y", "s"], "=", " ", 
     RowBox[{"ys", ".", "vect"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["z", "s"], "=", 
     RowBox[{"zs", ".", "vect"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     SubscriptBox["x", "s"], " ", ":=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Phi]", "s"], "]"}], "*", "x"}], " ", "-", 
       RowBox[{
        RowBox[{"Sin", "[", 
         SubscriptBox["\[Phi]", "s"], "]"}], "*", "y", " ", 
        "\[IndentingNewLine]", 
        SubscriptBox["y", "s"]}]}], ":=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Theta]", "s"], "]"}], "*", 
         RowBox[{"Sin", "[", 
          SubscriptBox["\[Phi]", "s"], "]"}], "*", "x"}], " ", "+", " ", 
        RowBox[{
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Theta]", "s"], "]"}], "*", 
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Phi]", "s"], "]"}], "*", "y"}], " ", "-", " ", 
        RowBox[{
         RowBox[{"Sin", "[", 
          SubscriptBox["\[Theta]", "s"], "]"}], "*", "z", 
         "\[IndentingNewLine]", 
         SubscriptBox["z", "s"]}]}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"Sin", "[", 
          SubscriptBox["\[Theta]", "s"], "]"}], "*", 
         RowBox[{"Sin", "[", 
          SubscriptBox["\[Phi]", "s"], "]"}], "*", "x"}], " ", "+", " ", 
        RowBox[{
         RowBox[{"Sin", "[", 
          SubscriptBox["\[Theta]", "s"], "]"}], "*", 
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Phi]", "s"], "]"}], "*", "y"}], " ", "+", " ", 
        RowBox[{
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Theta]", "s"], "]"}], "*", "z"}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["x", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["x", 
      RowBox[{"s", " "}]], "/.", "rulescoord"}]}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["y", "i"], "=", " ", 
    RowBox[{
     SubscriptBox["y", 
      RowBox[{"s", " "}]], "/.", "rulescoord"}]}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["z", "i"], "=", " ", 
    RowBox[{
     SubscriptBox["z", 
      RowBox[{"s", " "}]], "/.", "rulescoord"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      SubscriptBox["x", "s"], " ", "=", " ", 
      RowBox[{
       SubscriptBox["x", "s"], " ", "//.", " ", "planarrules"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["y", "s"], "=", " ", 
      RowBox[{
       SubscriptBox["y", 
        RowBox[{"s", " "}]], "//.", "planarrules"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["z", "s"], "=", " ", 
      RowBox[{
       SubscriptBox["z", 
        RowBox[{"s", " "}]], "//.", "planarrules"}]}], ";"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["x", "p"], " ", ":=", " ", 
    RowBox[{"x", " ", "-", " ", 
     RowBox[{
      SubscriptBox["\[Rho]", "px"], "*", "z"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["y", "p"], ":=", " ", "y"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      SubscriptBox["x", "p"], " ", "=", " ", "x"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["y", "p"], "=", " ", "y"}], ";"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Introduce", " ", "the", " ", "assumption", " ", "that", " ", "the", " ", 
     "Rayleigh", " ", "range", " ", "is", " ", "much", " ", "longer", " ", 
     "than", " ", "the", " ", "crystal", " ", "length", " ", "and", " ", 
     "the", " ", "waist", " ", "can", " ", "be", " ", "treated", " ", "as", 
     " ", "a", " ", 
     RowBox[{"constant", ".", " ", "This"}], " ", "dramatically", " ", 
     "simplifies", " ", 
     RowBox[{"things", "."}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"rules2", " ", ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SubscriptBox["q", "p"], " ", "\[Rule]", " ", 
        SuperscriptBox[
         SubscriptBox["W", "p"], "2"]}], " ", ",", " ", 
       RowBox[{
        SubscriptBox["q", "s"], " ", "\[Rule]", " ", 
        SuperscriptBox[
         SubscriptBox["W", "s"], "2"]}], " ", ",", " ", 
       RowBox[{
        SubscriptBox["q", "i"], " ", "\[Rule]", " ", 
        SuperscriptBox[
         SubscriptBox["W", "i"], "2"]}], ",", "  ", 
       RowBox[{
        SubscriptBox["\[Theta]", "s"], " ", "\[Rule]", " ", 
        RowBox[{"0", "*", 
         RowBox[{"\[Pi]", "/", "180"}]}]}], ",", " ", 
       RowBox[{
        SubscriptBox["\[Theta]", "i"], " ", "\[Rule]", 
        RowBox[{"0", "*", 
         RowBox[{"\[Pi]", "/", "180"}]}]}]}], " ", "}"}]}], "*)"}], 
   "\[IndentingNewLine]", " ", 
   RowBox[{"rules2", " ", ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SubscriptBox["q", "ppp"], " ", "\[Rule]", " ", 
       SuperscriptBox[
        SubscriptBox["W", "ppp"], "2"]}], " ", ",", " ", 
      RowBox[{
       SubscriptBox["q", "s"], " ", "\[Rule]", " ", 
       SuperscriptBox[
        SubscriptBox["W", "s"], "2"]}], " ", ",", " ", 
      RowBox[{
       SubscriptBox["q", "i"], " ", "\[Rule]", " ", 
       SuperscriptBox[
        SubscriptBox["W", "i"], "2"]}]}], " ", "}"}]}], "\n", " ", 
   RowBox[{"rules2", " ", ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SubscriptBox["q", "ppp"], " ", "\[Rule]", " ", 
       SuperscriptBox[
        SubscriptBox["W", "ppp"], "2"]}], " ", ",", " ", 
      RowBox[{
       SubscriptBox["q", "s"], " ", "\[Rule]", " ", 
       SuperscriptBox[
        SubscriptBox["W", "s"], "2"]}], " ", ",", " ", 
      RowBox[{
       SubscriptBox["q", "i"], " ", "\[Rule]", " ", 
       SuperscriptBox[
        SubscriptBox["W", "s"], "2"]}]}], " ", "}"}]}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{"rulesq", " ", ":=", " ", "rules2"}], "\[IndentingNewLine]", 
   RowBox[{"rulesanlge", " ", ":=", " ", 
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Theta]", "s"], " ", "\[Rule]", " ", 
       RowBox[{"0", "*", 
        RowBox[{"\[Pi]", "/", "180"}]}]}], ",", " ", 
      RowBox[{
       SubscriptBox["\[Theta]", "i"], " ", "\[Rule]", 
       RowBox[{"0", "*", 
        RowBox[{"\[Pi]", "/", "180"}]}]}]}], "}"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["n", "s"], " ", "=", " ", 
     RowBox[{
      RowBox[{
       SubscriptBox["W", "s"], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"\[Pi]", "*", "2"}], "]"}], "*", 
         SubscriptBox["q", "s"]}], ")"}]}], " ", "//.", "rules2"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["n", "i"], " ", "=", " ", 
     RowBox[{
      RowBox[{
       SubscriptBox["W", "i"], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"\[Pi]", "*", "2"}], "]"}], "*", 
         SubscriptBox["q", "i"]}], ")"}]}], " ", "//.", "rules2"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["n", "ppp"], " ", "=", " ", 
     RowBox[{
      RowBox[{
       SubscriptBox["W", "ppp"], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"\[Pi]", "*", "2"}], "]"}], "*", 
         SubscriptBox["q", "ppp"]}], ")"}]}], " ", "//.", " ", "rules2"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.582676438761138*^9, 3.582676528731468*^9}, {
   3.582676729795623*^9, 3.5826767327704906`*^9}, {3.589231298763981*^9, 
   3.589231302850792*^9}, {3.589301582840025*^9, 3.589301588609139*^9}, {
   3.589301902546296*^9, 3.589301935466913*^9}, {3.5893022782276497`*^9, 
   3.5893022799150763`*^9}, {3.589687578090417*^9, 3.589687579149075*^9}, {
   3.590521728478033*^9, 3.5905217643020144`*^9}, {3.590521800795985*^9, 
   3.590521909782888*^9}, {3.590522130031143*^9, 3.590522170299871*^9}, {
   3.590522299406642*^9, 3.590522487105804*^9}, 3.590522523544599*^9, {
   3.590522563902389*^9, 3.590522620237356*^9}, {3.590522657840081*^9, 
   3.590522738247343*^9}, {3.5905228769892*^9, 3.5905228809800663`*^9}, {
   3.590523000355813*^9, 3.590523004506609*^9}, {3.590523561758151*^9, 
   3.59052357123062*^9}, {3.590524142763977*^9, 3.590524235646515*^9}, {
   3.590524266636819*^9, 3.59052431042937*^9}, {3.590525182345914*^9, 
   3.590525193486434*^9}, {3.590526011602631*^9, 3.5905260146674767`*^9}, {
   3.5905307140862923`*^9, 3.590530718259025*^9}, {3.590693720364143*^9, 
   3.5906937205398617`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "x"}], " ", 
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Phi]", "s"], "]"}]}], "+", 
  RowBox[{"y", " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Phi]", "s"], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.590524143405465*^9, 3.590524169368422*^9}, 
   3.590524220699346*^9, 3.590524259796801*^9, {3.590524296815311*^9, 
   3.590524333063119*^9}, 3.590525194450962*^9, 3.590526016423937*^9, 
   3.590530719572781*^9, 3.5906937215960827`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "y"}], " ", 
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Theta]", "i"], "]"}], " ", 
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Phi]", "s"], "]"}]}], "+", 
  RowBox[{"z", " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Theta]", "i"], "]"}]}], "-", 
  RowBox[{"x", " ", 
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Theta]", "i"], "]"}], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Phi]", "s"], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.590524143405465*^9, 3.590524169368422*^9}, 
   3.590524220699346*^9, 3.590524259796801*^9, {3.590524296815311*^9, 
   3.590524333063119*^9}, 3.590525194450962*^9, 3.590526016423937*^9, 
   3.590530719572781*^9, 3.590693721599059*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"z", " ", 
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Theta]", "i"], "]"}]}], "+", 
  RowBox[{"y", " ", 
   RowBox[{"Cos", "[", 
    SubscriptBox["\[Phi]", "s"], "]"}], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Theta]", "i"], "]"}]}], "+", 
  RowBox[{"x", " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Theta]", "i"], "]"}], " ", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Phi]", "s"], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.590524143405465*^9, 3.590524169368422*^9}, 
   3.590524220699346*^9, 3.590524259796801*^9, {3.590524296815311*^9, 
   3.590524333063119*^9}, 3.590525194450962*^9, 3.590526016423937*^9, 
   3.590530719572781*^9, 3.5906937216005917`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Here", " ", "is", " ", "the", " ", "argument", " ", "in", " ", "the", 
     " ", "exponential", " ", "that", " ", "we", " ", "will", " ", "want", 
     " ", "to", " ", "integrate", " ", "over", " ", "wrt", " ", "to", " ", 
     "x"}], ",", " ", "y", ",", " ", 
    RowBox[{"and", " ", 
     RowBox[{"z", "."}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Arg1", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "1"}], "/", 
       RowBox[{"(", 
        RowBox[{"2", "*", 
         SubscriptBox["q", "s"]}], ")"}]}], "*", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["x", "s"], "2"], "+", 
        SuperscriptBox[
         SubscriptBox["y", "s"], "2"]}], ")"}]}], "-", 
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{"2", "*", 
         SubscriptBox["q", "i"]}], ")"}]}], 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["x", "i"], "2"], "+", 
        SuperscriptBox[
         SubscriptBox["y", "i"], "2"]}], ")"}]}], "-", 
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{"2", "*", 
         SubscriptBox["q", "ppp"]}], ")"}]}], "*", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["x", "p"], "2"], "+", 
        SuperscriptBox[
         SubscriptBox["y", "p"], "2"]}], ")"}]}], " ", "-", " ", 
     RowBox[{"\[ImaginaryI]", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[CapitalDelta]K", "x"], "*", "x"}], " ", "+", " ", 
        RowBox[{
         SubscriptBox["\[CapitalDelta]K", "y"], "*", "y"}], "+", 
        RowBox[{
         SubscriptBox["\[CapitalDelta]K", "z"], "*", "z"}]}], ")"}]}]}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.5825533941941223`*^9, 3.5825535539588547`*^9}, {
   3.5825536033128633`*^9, 3.582553608767806*^9}, 3.582553712131874*^9, {
   3.582553783669939*^9, 3.58255382316961*^9}, {3.582561756372466*^9, 
   3.582561771923471*^9}, 3.582561807119581*^9, {3.582562474614017*^9, 
   3.582562499613974*^9}, {3.582582135209609*^9, 3.5825821366901712`*^9}, {
   3.582600600836162*^9, 3.5826006048984003`*^9}, {3.582676452509242*^9, 
   3.582676454063005*^9}, 3.589299256121154*^9, 3.589299487656785*^9, {
   3.589301942732774*^9, 3.58930196123344*^9}, {3.589302272043653*^9, 
   3.589302274307569*^9}, 3.5905228696729*^9, {3.590522953456752*^9, 
   3.590522994943686*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "x"}], " ", 
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Phi]", "s"], "]"}]}], "+", 
        RowBox[{"y", " ", 
         RowBox[{"Sin", "[", 
          SubscriptBox["\[Phi]", "s"], "]"}]}]}], ")"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "y"}], " ", 
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Theta]", "i"], "]"}], " ", 
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Phi]", "s"], "]"}]}], "+", 
        RowBox[{"z", " ", 
         RowBox[{"Sin", "[", 
          SubscriptBox["\[Theta]", "i"], "]"}]}], "-", 
        RowBox[{"x", " ", 
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Theta]", "i"], "]"}], " ", 
         RowBox[{"Sin", "[", 
          SubscriptBox["\[Phi]", "s"], "]"}]}]}], ")"}], "2"]}], 
    RowBox[{"2", " ", 
     SubscriptBox["q", "i"]}]]}], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"x", " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Phi]", "s"], "]"}]}], "-", 
       RowBox[{"y", " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["\[Phi]", "s"], "]"}]}]}], ")"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"y", " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "s"], "]"}], " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Phi]", "s"], "]"}]}], "+", 
       RowBox[{"z", " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["\[Theta]", "s"], "]"}]}], "+", 
       RowBox[{"x", " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "s"], "]"}], " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["\[Phi]", "s"], "]"}]}]}], ")"}], "2"]}], 
   RowBox[{"2", " ", 
    SubscriptBox["q", "s"]}]], "-", 
  RowBox[{"\[ImaginaryI]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"x", " ", 
      SubscriptBox["\[CapitalDelta]K", "x"]}], "+", 
     RowBox[{"y", " ", 
      SubscriptBox["\[CapitalDelta]K", "y"]}], "+", 
     RowBox[{"z", " ", 
      SubscriptBox["\[CapitalDelta]K", "z"]}]}], ")"}]}], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["y", "2"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"x", "-", 
       RowBox[{"z", " ", 
        SubscriptBox["\[Rho]", "px"]}]}], ")"}], "2"]}], 
   RowBox[{"2", " ", 
    SubscriptBox["q", "ppp"]}]]}]], "Output",
 CellChangeTimes->{{3.590522910768602*^9, 3.590523012386057*^9}, 
   3.5905243407346573`*^9, 3.590524383798437*^9, 3.5905251996470623`*^9, 
   3.5905260225081387`*^9, 3.590530724903821*^9, {3.590693730616989*^9, 
   3.590693731946981*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "First", " ", "we", " ", "complete", " ", "the", " ", "square", " ", "wrt",
     " ", "to", " ", 
    RowBox[{"x", ".", " ", "This"}], " ", "makes", " ", "it", " ", "easier", 
    " ", "to", " ", "analytically", " ", "carry", " ", "out", " ", "the", " ", 
    RowBox[{"integration", "."}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Arg1", " ", "=", " ", 
     RowBox[{"CompleteSquare", "[", 
      RowBox[{"Arg1", ",", " ", "x"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"cx", ",", "bx", ",", "ax"}], "}"}], "=", 
     RowBox[{"CoefficientList", "[", 
      RowBox[{"Arg1", ",", "x"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"yzcoeff", " ", "=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{"(", 
       RowBox[{"cx", "-", 
        RowBox[{
         RowBox[{
          RowBox[{"bx", "^", "2"}], "/", "4"}], "/", "ax"}]}], ")"}], "]"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{"coeffx", " ", "=", "ax"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Now", " ", "complete", " ", "the", " ", "square", " ", "for", " ", "yz", 
     " ", "remainder", " ", "with", " ", "respect", " ", "to", " ", "y"}], 
    "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Arg2", " ", "=", " ", 
     RowBox[{"CompleteSquare", "[", 
      RowBox[{"yzcoeff", ",", " ", "y"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"cy", ",", "by", ",", "ay"}], "}"}], "=", 
     RowBox[{"CoefficientList", "[", 
      RowBox[{"Arg2", ",", "y"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"coeffy", " ", "=", " ", "ay"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"zint", " ", "=", "  ", 
     RowBox[{"Simplify", "[", 
      RowBox[{"(", 
       RowBox[{"cy", "-", 
        RowBox[{
         RowBox[{
          RowBox[{"by", "^", "2"}], "/", "4"}], "/", "ay"}]}], ")"}], "]"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Assuming", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox["q", "i"], ">", "0"}], " ", "&&", " ", 
       RowBox[{
        SubscriptBox["q", "s"], ">", "0"}], " ", "&&", " ", 
       RowBox[{
        SubscriptBox["q", "p"], ">", "0"}], " ", "&&", " ", 
       RowBox[{
        SubscriptBox["\[Theta]", "i"], ">", "0"}], " ", "&&", " ", 
       RowBox[{
        SubscriptBox["\[Theta]", "s"], ">", "0"}], " ", "&&", " ", 
       RowBox[{
        SubscriptBox["\[CapitalDelta]K", "x"], " ", ">", "0"}], " ", "&&", 
       " ", 
       RowBox[{
        SubscriptBox["\[CapitalDelta]K", "y"], " ", ">", "0"}], " ", "&&", 
       " ", 
       RowBox[{
        SubscriptBox["\[CapitalDelta]K", "z"], ">", "0"}], " ", "&&", 
       RowBox[{"y", ">", "0"}], " ", "&&", 
       RowBox[{"z", ">", "0"}]}], ",", " ", 
      RowBox[{"Integrate", "[", " ", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{"-", "zint"}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"z", ",", " ", 
          RowBox[{"-", "\[Infinity]"}], ",", " ", "\[Infinity]"}], "}"}]}], 
       "]"}]}], "]"}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.5825537185392857`*^9, 3.582553738312705*^9}, {
   3.582582174512424*^9, 3.582582196639732*^9}, {3.589299359249379*^9, 
   3.58929940769029*^9}, {3.589299706788805*^9, 3.589299953474846*^9}, {
   3.589300074213222*^9, 3.5893001254984083`*^9}, {3.589300366692685*^9, 
   3.589300470243595*^9}, {3.589300526730879*^9, 3.589300583491335*^9}, {
   3.5893006199514933`*^9, 3.589300807810451*^9}, {3.589300973245274*^9, 
   3.5893010229373007`*^9}, {3.5893025507863827`*^9, 3.589302556458641*^9}, 
   3.5905230261463614`*^9, {3.590523088364869*^9, 3.5905231894911213`*^9}, {
   3.59052336261027*^9, 3.590523375831769*^9}, 3.590523584110681*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    SuperscriptBox[
     RowBox[{"Cos", "[", 
      SubscriptBox["\[Phi]", "s"], "]"}], "2"], 
    RowBox[{"2", " ", 
     SubscriptBox["q", "i"]}]]}], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"Cos", "[", 
      SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"Sin", "[", 
      SubscriptBox["\[Phi]", "s"], "]"}], "2"]}], 
   RowBox[{"2", " ", 
    SubscriptBox["q", "i"]}]], "-", 
  FractionBox["1", 
   RowBox[{"2", " ", 
    SubscriptBox["q", "ppp"]}]], "-", 
  FractionBox[
   SuperscriptBox[
    RowBox[{"Cos", "[", 
     SubscriptBox["\[Phi]", "s"], "]"}], "2"], 
   RowBox[{"2", " ", 
    SubscriptBox["q", "s"]}]], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"Cos", "[", 
      SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"Sin", "[", 
      SubscriptBox["\[Phi]", "s"], "]"}], "2"]}], 
   RowBox[{"2", " ", 
    SubscriptBox["q", "s"]}]]}]], "Output",
 CellChangeTimes->{{3.590523143400434*^9, 3.590523189988976*^9}, 
   3.59052338226554*^9, 3.590523592996015*^9, 3.590524349794345*^9, 
   3.590524391063881*^9, 3.590525213368106*^9, 3.590526030380559*^9, {
   3.590530732103161*^9, 3.5905307526983128`*^9}, {3.590693752217005*^9, 
   3.590693775887917*^9}}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.5892997322432404`*^9, 3.589299732949974*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "The", " ", "x", " ", "and", " ", "y", " ", "integrals", " ", "reduce", 
    " ", "to", " ", "the", " ", "following", " ", "constants"}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"xconst", "=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Sqrt]", "\[Pi]"}], "/", 
        RowBox[{"\[Sqrt]", 
         RowBox[{"(", 
          RowBox[{"-", "coeffx"}], ")"}]}]}], " ", "//.", "rules2"}], "]"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"yconst", "=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Sqrt]", "\[Pi]"}], "/", 
        RowBox[{"\[Sqrt]", 
         RowBox[{"(", 
          RowBox[{"-", "coeffy"}], ")"}]}]}], " ", "//.", "rules2"}], "]"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xonst", " ", "=", " ", 
     RowBox[{"xconst", " ", "/.", " ", "rulesq"}]}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"yconst", " ", "=", " ", 
     RowBox[{"yconst", " ", "/.", "rulesq"}]}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"zint", " ", "=", 
     RowBox[{"Simplify", "[", " ", 
      RowBox[{"zint", " ", "/.", " ", "rulesq"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Zexpress", " ", "=", 
     RowBox[{"Exp", "[", "zint", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "This", " ", "leaves", " ", "us", " ", "with", " ", "just", " ", "the", 
     " ", "z", " ", 
     RowBox[{"integral", ".", " ", "Find"}], " ", "the", " ", "coefficients", 
     " ", "so", " ", "we", " ", "can", " ", "plug", " ", "it", " ", "into", 
     " ", "our", " ", "solved", " ", "integral", " ", "form"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"az", ",", " ", "bz", ",", "cz"}], "}"}], "=", 
     RowBox[{"CoefficientList", "[", " ", 
      RowBox[{"zint", ",", "z"}], "]"}]}], " ", ";"}], "\[IndentingNewLine]", 
   
   RowBox[{"AA", " ", "=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{"-", "az"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"BB", " ", "=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{"-", "bz"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"CC", " ", "=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{"-", "cz"}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.5825538416732683`*^9, 3.5825540262026253`*^9}, {
   3.582554070185461*^9, 3.58255407764716*^9}, 3.5825618686585283`*^9, 
   3.5825619031644173`*^9, {3.582582212811741*^9, 3.5825822216126223`*^9}, {
   3.582598740623023*^9, 3.5825987588152237`*^9}, 3.582598791694824*^9, 
   3.5826007798659353`*^9, {3.582600814519813*^9, 3.5826010290448103`*^9}, 
   3.582601333150104*^9, 3.5826014723118773`*^9, {3.582672389928055*^9, 
   3.5826724027171583`*^9}, {3.582674796730681*^9, 3.5826747992116013`*^9}, 
   3.5891463574943027`*^9, {3.5892291069528646`*^9, 3.5892291279266253`*^9}, 
   3.589299315272929*^9, {3.5892994199671593`*^9, 3.589299433917345*^9}, {
   3.589300836392149*^9, 3.589300943644602*^9}, {3.589301033831832*^9, 
   3.589301125570545*^9}, {3.589301176199456*^9, 3.5893011811906357`*^9}, {
   3.58930126916422*^9, 3.5893013256175747`*^9}, {3.589301359370359*^9, 
   3.589301389325317*^9}, {3.589302013723062*^9, 3.589302017465081*^9}, {
   3.589302076689983*^9, 3.589302138029945*^9}, {3.589302168188575*^9, 
   3.589302250597705*^9}, 3.589302338688246*^9, {3.589302401133462*^9, 
   3.589302409057458*^9}, {3.589302686030478*^9, 3.5893027019333267`*^9}, {
   3.589302734154758*^9, 3.5893027372989063`*^9}, {3.589302777895915*^9, 
   3.589302795645793*^9}, {3.589302948609424*^9, 3.58930297384866*^9}, {
   3.589303285661346*^9, 3.589303363589128*^9}, {3.589303473996633*^9, 
   3.589303482212236*^9}, {3.589303735528884*^9, 3.589303740601049*^9}, {
   3.589303947560666*^9, 3.589303953147936*^9}, 3.5893040110316067`*^9, {
   3.589310529899806*^9, 3.5893105385782003`*^9}, {3.5893105908829403`*^9, 
   3.589310687782134*^9}, {3.589310768063574*^9, 3.589310891354974*^9}, {
   3.589310960638303*^9, 3.589310990026972*^9}, 3.5893112701563873`*^9, {
   3.590523413863852*^9, 3.590523415430471*^9}, {3.5905239933074703`*^9, 
   3.5905240292587843`*^9}, {3.590524432754696*^9, 3.590524439607706*^9}, {
   3.590524976308745*^9, 3.5905249835840483`*^9}, {3.5905250784201393`*^9, 
   3.590525091618764*^9}, {3.590537426599852*^9, 3.590537465847196*^9}, {
   3.5906936455905027`*^9, 3.590693647439126*^9}, {3.5906993142373867`*^9, 
   3.5906993154753933`*^9}}],

Cell[BoxData[
 FractionBox[
  SqrtBox[
   RowBox[{"2", " ", "\[Pi]"}]], 
  SqrtBox[
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"Cos", "[", 
           SubscriptBox["\[Phi]", "s"], "]"}], "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "i"], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "s"], "]"}], "2"]}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"Sin", "[", 
           SubscriptBox["\[Phi]", "s"], "]"}], "2"]}]}], ")"}], " ", 
      SubsuperscriptBox["W", "ppp", "2"]}], "+", 
     SubsuperscriptBox["W", "s", "2"]}], 
    RowBox[{
     SubsuperscriptBox["W", "ppp", "2"], " ", 
     SubsuperscriptBox["W", "s", "2"]}]]]]], "Output",
 CellChangeTimes->{
  3.5893112708803997`*^9, 3.5893277087944317`*^9, {3.590523459667925*^9, 
   3.590523459761807*^9}, 3.5905237701122513`*^9, 3.5905239938687973`*^9, 
   3.590524030252717*^9, {3.590524411049635*^9, 3.590524440169916*^9}, {
   3.590524976910121*^9, 3.590524984112225*^9}, {3.5905250789111843`*^9, 
   3.590525092199316*^9}, 3.590525281881671*^9, 3.590526070416944*^9, 
   3.5905307744785213`*^9, 3.59069109058807*^9, 3.5906936481960297`*^9, 
   3.5906942605956497`*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", 
   SqrtBox["\[Pi]"]}], 
  SqrtBox[
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        SubsuperscriptBox["W", "ppp", "2"]}], "+", 
       SubsuperscriptBox["W", "s", "2"]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2", "+", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", 
            SubscriptBox["\[Theta]", "i"]}], "]"}], "+", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", 
            SubscriptBox["\[Theta]", "s"]}], "]"}]}], ")"}], " ", 
        SubsuperscriptBox["W", "ppp", "2"]}], "+", 
       RowBox[{"2", " ", 
        SubsuperscriptBox["W", "s", "2"]}]}], ")"}]}], 
    RowBox[{
     SubsuperscriptBox["W", "ppp", "2"], " ", 
     SubsuperscriptBox["W", "s", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Phi]", "s"], "]"}], "2"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"Cos", "[", 
               SubscriptBox["\[Theta]", "i"], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"Cos", "[", 
               SubscriptBox["\[Theta]", "s"], "]"}], "2"]}], ")"}], " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", 
             SubscriptBox["\[Phi]", "s"], "]"}], "2"]}]}], ")"}], " ", 
        SubsuperscriptBox["W", "ppp", "2"]}], "+", 
       SubsuperscriptBox["W", "s", "2"]}], ")"}]}]]]]], "Output",
 CellChangeTimes->{
  3.5893112708803997`*^9, 3.5893277087944317`*^9, {3.590523459667925*^9, 
   3.590523459761807*^9}, 3.5905237701122513`*^9, 3.5905239938687973`*^9, 
   3.590524030252717*^9, {3.590524411049635*^9, 3.590524440169916*^9}, {
   3.590524976910121*^9, 3.590524984112225*^9}, {3.5905250789111843`*^9, 
   3.590525092199316*^9}, 3.590525281881671*^9, 3.590526070416944*^9, 
   3.5905307744785213`*^9, 3.59069109058807*^9, 3.5906936481960297`*^9, 
   3.5906942605974693`*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"8", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       SubsuperscriptBox["W", "ppp", "2"]}], "+", 
      SubsuperscriptBox["W", "s", "2"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"2", "+", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", 
           SubscriptBox["\[Theta]", "i"]}], "]"}], "+", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", 
           SubscriptBox["\[Theta]", "s"]}], "]"}]}], ")"}], " ", 
       SubsuperscriptBox["W", "ppp", "2"]}], "+", 
      RowBox[{"2", " ", 
       SubsuperscriptBox["W", "s", "2"]}]}], ")"}]}]], 
  RowBox[{
   SubsuperscriptBox["W", "ppp", "2"], " ", 
   SubsuperscriptBox["W", "s", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"8", " ", 
      SubsuperscriptBox["W", "s", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        SubsuperscriptBox["\[CapitalDelta]K", "x", "2"], "+", 
        SubsuperscriptBox["\[CapitalDelta]K", "y", "2"]}], ")"}]}], "+", 
     RowBox[{
      SubsuperscriptBox["W", "ppp", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"12", "+", 
           RowBox[{"2", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", 
              SubscriptBox["\[Theta]", "i"]}], "]"}]}], "+", 
           RowBox[{"2", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", 
              SubscriptBox["\[Theta]", "s"]}], "]"}]}], "+", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["\[Theta]", "i"], "-", 
               SubscriptBox["\[Phi]", "s"]}], ")"}]}], "]"}], "+", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["\[Theta]", "s"], "-", 
               SubscriptBox["\[Phi]", "s"]}], ")"}]}], "]"}], "-", 
           RowBox[{"4", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", 
              SubscriptBox["\[Phi]", "s"]}], "]"}]}], "+", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["\[Theta]", "i"], "+", 
               SubscriptBox["\[Phi]", "s"]}], ")"}]}], "]"}], "+", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["\[Theta]", "s"], "+", 
               SubscriptBox["\[Phi]", "s"]}], ")"}]}], "]"}]}], ")"}], " ", 
         SubsuperscriptBox["\[CapitalDelta]K", "x", "2"]}], "-", 
        RowBox[{"4", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", 
             SubscriptBox["\[Theta]", "i"]}], "]"}], "+", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", 
             SubscriptBox["\[Theta]", "s"]}], "]"}]}], ")"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", 
           SubscriptBox["\[Phi]", "s"]}], "]"}], " ", 
         SubscriptBox["\[CapitalDelta]K", "x"], " ", 
         SubscriptBox["\[CapitalDelta]K", "y"]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "12"}], "-", 
           RowBox[{"2", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", 
              SubscriptBox["\[Theta]", "i"]}], "]"}]}], "-", 
           RowBox[{"2", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", 
              SubscriptBox["\[Theta]", "s"]}], "]"}]}], "+", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["\[Theta]", "i"], "-", 
               SubscriptBox["\[Phi]", "s"]}], ")"}]}], "]"}], "+", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["\[Theta]", "s"], "-", 
               SubscriptBox["\[Phi]", "s"]}], ")"}]}], "]"}], "-", 
           RowBox[{"4", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", 
              SubscriptBox["\[Phi]", "s"]}], "]"}]}], "+", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["\[Theta]", "i"], "+", 
               SubscriptBox["\[Phi]", "s"]}], ")"}]}], "]"}], "+", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["\[Theta]", "s"], "+", 
               SubscriptBox["\[Phi]", "s"]}], ")"}]}], "]"}]}], ")"}], " ", 
         SubsuperscriptBox["\[CapitalDelta]K", "y", "2"]}]}], ")"}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.5893112708803997`*^9, 3.5893277087944317`*^9, {3.590523459667925*^9, 
   3.590523459761807*^9}, 3.5905237701122513`*^9, 3.5905239938687973`*^9, 
   3.590524030252717*^9, {3.590524411049635*^9, 3.590524440169916*^9}, {
   3.590524976910121*^9, 3.590524984112225*^9}, {3.5905250789111843`*^9, 
   3.590525092199316*^9}, 3.590525281881671*^9, 3.590526070416944*^9, 
   3.5905307744785213`*^9, 3.59069109058807*^9, 3.5906936481960297`*^9, 
   3.5906942769980373`*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"4", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       SubsuperscriptBox["W", "ppp", "2"]}], "+", 
      SubsuperscriptBox["W", "s", "2"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"2", "+", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", 
           SubscriptBox["\[Theta]", "i"]}], "]"}], "+", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", 
           SubscriptBox["\[Theta]", "s"]}], "]"}]}], ")"}], " ", 
       SubsuperscriptBox["W", "ppp", "2"]}], "+", 
      RowBox[{"2", " ", 
       SubsuperscriptBox["W", "s", "2"]}]}], ")"}]}]], 
  RowBox[{"\[ImaginaryI]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"8", " ", 
      SubsuperscriptBox["W", "ppp", "4"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", 
             SubscriptBox["\[Theta]", "i"]}], "]"}], "-", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", 
             SubscriptBox["\[Theta]", "s"]}], "]"}]}], ")"}], " ", 
         RowBox[{"Sin", "[", 
          SubscriptBox["\[Phi]", "s"], "]"}], " ", 
         SubscriptBox["\[CapitalDelta]K", "x"]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Phi]", "s"], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", 
             SubscriptBox["\[Theta]", "i"]}], "]"}], "-", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", 
             SubscriptBox["\[Theta]", "s"]}], "]"}]}], ")"}], " ", 
         SubscriptBox["\[CapitalDelta]K", "y"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", "+", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", 
             SubscriptBox["\[Theta]", "i"]}], "]"}], "+", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", 
             SubscriptBox["\[Theta]", "s"]}], "]"}]}], ")"}], " ", 
         SubscriptBox["\[CapitalDelta]K", "z"]}]}], ")"}]}], "+", 
     RowBox[{"8", " ", 
      SubsuperscriptBox["W", "s", "4"], " ", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["\[CapitalDelta]K", "z"], "+", 
        RowBox[{
         SubscriptBox["\[CapitalDelta]K", "x"], " ", 
         SubscriptBox["\[Rho]", "px"]}]}], ")"}]}], "+", 
     RowBox[{
      SubsuperscriptBox["W", "ppp", "2"], " ", 
      SubsuperscriptBox["W", "s", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", " ", 
         RowBox[{"(", 
          RowBox[{"6", "+", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", 
             SubscriptBox["\[Theta]", "i"]}], "]"}], "+", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", 
             SubscriptBox["\[Theta]", "s"]}], "]"}]}], ")"}], " ", 
         SubscriptBox["\[CapitalDelta]K", "z"]}], "+", 
        RowBox[{
         SubscriptBox["\[CapitalDelta]K", "x"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Sin", "[", 
               RowBox[{"2", " ", 
                SubscriptBox["\[Theta]", "i"]}], "]"}], "-", 
              RowBox[{"Sin", "[", 
               RowBox[{"2", " ", 
                SubscriptBox["\[Theta]", "s"]}], "]"}]}], ")"}], " ", 
            RowBox[{"Sin", "[", 
             SubscriptBox["\[Phi]", "s"], "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"12", "+", 
              RowBox[{"2", " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"2", " ", 
                 SubscriptBox["\[Theta]", "i"]}], "]"}]}], "+", 
              RowBox[{"2", " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"2", " ", 
                 SubscriptBox["\[Theta]", "s"]}], "]"}]}], "+", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["\[Theta]", "i"], "-", 
                  SubscriptBox["\[Phi]", "s"]}], ")"}]}], "]"}], "+", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["\[Theta]", "s"], "-", 
                  SubscriptBox["\[Phi]", "s"]}], ")"}]}], "]"}], "-", 
              RowBox[{"4", " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"2", " ", 
                 SubscriptBox["\[Phi]", "s"]}], "]"}]}], "+", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["\[Theta]", "i"], "+", 
                  SubscriptBox["\[Phi]", "s"]}], ")"}]}], "]"}], "+", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["\[Theta]", "s"], "+", 
                  SubscriptBox["\[Phi]", "s"]}], ")"}]}], "]"}]}], ")"}], " ", 
            SubscriptBox["\[Rho]", "px"]}]}], ")"}]}], "+", 
        RowBox[{"4", " ", 
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Phi]", "s"], "]"}], " ", 
         SubscriptBox["\[CapitalDelta]K", "y"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", 
             SubscriptBox["\[Theta]", "i"]}], "]"}], "-", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", 
             SubscriptBox["\[Theta]", "s"]}], "]"}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", 
                SubscriptBox["\[Theta]", "i"]}], "]"}], "+", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", 
                SubscriptBox["\[Theta]", "s"]}], "]"}]}], ")"}], " ", 
            RowBox[{"Sin", "[", 
             SubscriptBox["\[Phi]", "s"], "]"}], " ", 
            SubscriptBox["\[Rho]", "px"]}]}], ")"}]}]}], ")"}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.5893112708803997`*^9, 3.5893277087944317`*^9, {3.590523459667925*^9, 
   3.590523459761807*^9}, 3.5905237701122513`*^9, 3.5905239938687973`*^9, 
   3.590524030252717*^9, {3.590524411049635*^9, 3.590524440169916*^9}, {
   3.590524976910121*^9, 3.590524984112225*^9}, {3.5905250789111843`*^9, 
   3.590525092199316*^9}, 3.590525281881671*^9, 3.590526070416944*^9, 
   3.5905307744785213`*^9, 3.59069109058807*^9, 3.5906936481960297`*^9, 
   3.590694279557228*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"16", " ", 
     SuperscriptBox[
      RowBox[{"Sin", "[", 
       RowBox[{
        SubscriptBox["\[Theta]", "i"], "+", 
        SubscriptBox["\[Theta]", "s"]}], "]"}], "2"], " ", 
     SubsuperscriptBox["W", "ppp", "4"]}], "-", 
    RowBox[{"4", " ", 
     SubsuperscriptBox["W", "ppp", "2"], " ", 
     SubsuperscriptBox["W", "s", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "5"}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", 
          SubscriptBox["\[Theta]", "i"]}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", 
          SubscriptBox["\[Theta]", "s"]}], "]"}]}], "+", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["\[Theta]", "i"], "+", 
           SubscriptBox["\[Theta]", "s"]}], ")"}]}], "]"}], "+", 
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", 
            SubscriptBox["\[Theta]", "i"]}], "]"}], "-", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", 
            SubscriptBox["\[Theta]", "s"]}], "]"}]}], ")"}], " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["\[Phi]", "s"], "]"}], " ", 
        SubscriptBox["\[Rho]", "px"]}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", 
            SubscriptBox["\[Theta]", "i"]}], "]"}], "+", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", 
            SubscriptBox["\[Theta]", "s"]}], "]"}]}], ")"}], " ", 
        SubsuperscriptBox["\[Rho]", "px", "2"]}]}], ")"}]}], "+", 
    RowBox[{
     SubsuperscriptBox["W", "s", "4"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "4"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", 
            SubscriptBox["\[Theta]", "i"]}], "]"}], "+", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", 
            SubscriptBox["\[Theta]", "s"]}], "]"}]}], ")"}]}], "-", 
       RowBox[{"8", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", 
            SubscriptBox["\[Theta]", "i"]}], "]"}], "-", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", 
            SubscriptBox["\[Theta]", "s"]}], "]"}]}], ")"}], " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["\[Phi]", "s"], "]"}], " ", 
        SubscriptBox["\[Rho]", "px"]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "12"}], "-", 
          RowBox[{"2", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", 
             SubscriptBox["\[Theta]", "i"]}], "]"}]}], "-", 
          RowBox[{"2", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", 
             SubscriptBox["\[Theta]", "s"]}], "]"}]}], "+", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["\[Theta]", "i"], "-", 
              SubscriptBox["\[Phi]", "s"]}], ")"}]}], "]"}], "+", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["\[Theta]", "s"], "-", 
              SubscriptBox["\[Phi]", "s"]}], ")"}]}], "]"}], "-", 
          RowBox[{"4", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", 
             SubscriptBox["\[Phi]", "s"]}], "]"}]}], "+", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["\[Theta]", "i"], "+", 
              SubscriptBox["\[Phi]", "s"]}], ")"}]}], "]"}], "+", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["\[Theta]", "s"], "+", 
              SubscriptBox["\[Phi]", "s"]}], ")"}]}], "]"}]}], ")"}], " ", 
        SubsuperscriptBox["\[Rho]", "px", "2"]}]}], ")"}]}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{"8", " ", 
    SubsuperscriptBox["W", "s", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       SubsuperscriptBox["W", "ppp", "2"]}], "+", 
      SubsuperscriptBox["W", "s", "2"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"2", "+", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", 
           SubscriptBox["\[Theta]", "i"]}], "]"}], "+", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", 
           SubscriptBox["\[Theta]", "s"]}], "]"}]}], ")"}], " ", 
       SubsuperscriptBox["W", "ppp", "2"]}], "+", 
      RowBox[{"2", " ", 
       SubsuperscriptBox["W", "s", "2"]}]}], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.5893112708803997`*^9, 3.5893277087944317`*^9, {3.590523459667925*^9, 
   3.590523459761807*^9}, 3.5905237701122513`*^9, 3.5905239938687973`*^9, 
   3.590524030252717*^9, {3.590524411049635*^9, 3.590524440169916*^9}, {
   3.590524976910121*^9, 3.590524984112225*^9}, {3.5905250789111843`*^9, 
   3.590525092199316*^9}, 3.590525281881671*^9, 3.590526070416944*^9, 
   3.5905307744785213`*^9, 3.59069109058807*^9, 3.5906936481960297`*^9, 
   3.590694280884473*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"gga", ",", " ", "ggb", ",", " ", "ggc"}], "}"}], " ", "=", " ", 
     RowBox[{"CoefficientList", "[", 
      RowBox[{"CC", ",", 
       SubscriptBox["\[Rho]", "px"]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{"Simplify", "[", 
    RowBox[{"CC", " ", "-", " ", 
     RowBox[{"ggc", "*", " ", 
      SubsuperscriptBox["\[Rho]", "px", "2"]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.590531679794528*^9, 3.5905316916060266`*^9}, {
   3.590531738706449*^9, 3.590531740375141*^9}, {3.590531836794589*^9, 
   3.5905318403045607`*^9}, {3.590537470833169*^9, 3.590537472305791*^9}, {
   3.590537509093202*^9, 3.590537535076665*^9}, {3.5905375765292597`*^9, 
   3.590537583318849*^9}, {3.590586298973214*^9, 3.5905863767121267`*^9}, 
   3.590689214372458*^9}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", 
     SuperscriptBox[
      RowBox[{"Sin", "[", 
       RowBox[{
        SubscriptBox["\[Theta]", "i"], "+", 
        SubscriptBox["\[Theta]", "s"]}], "]"}], "2"], " ", 
     SubsuperscriptBox["W", "ppp", "2"]}], "+", 
    RowBox[{
     SubsuperscriptBox["W", "s", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "2"}], "+", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", 
         SubscriptBox["\[Theta]", "i"]}], "]"}], "+", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", 
         SubscriptBox["\[Theta]", "s"]}], "]"}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", 
            SubscriptBox["\[Theta]", "i"]}], "]"}], "-", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", 
            SubscriptBox["\[Theta]", "s"]}], "]"}]}], ")"}], " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["\[Phi]", "s"], "]"}], " ", 
        SubscriptBox["\[Rho]", "px"]}]}], ")"}]}]}], 
   RowBox[{"2", " ", 
    SubsuperscriptBox["W", "s", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"2", "+", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", 
           SubscriptBox["\[Theta]", "i"]}], "]"}], "+", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", 
           SubscriptBox["\[Theta]", "s"]}], "]"}]}], ")"}], " ", 
       SubsuperscriptBox["W", "ppp", "2"]}], "+", 
      RowBox[{"2", " ", 
       SubsuperscriptBox["W", "s", "2"]}]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{{3.590531684262251*^9, 3.5905316920017853`*^9}, 
   3.590531741004756*^9, 3.590531840910904*^9, 3.5905374730101957`*^9, {
   3.59053751212352*^9, 3.590537535486936*^9}, {3.590537577119635*^9, 
   3.5905375836193447`*^9}, {3.59058630111788*^9, 3.590586345472505*^9}, 
   3.5905863776033907`*^9, 3.590694281219462*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"While", " ", "AA"}], ",", " ", "BB", ",", " ", 
    RowBox[{"and", " ", "CC", " ", "look", " ", "initially", " ", "ugly"}], 
    ",", " ", 
    RowBox[{"they", " ", "simplify", " ", "down", " ", 
     RowBox[{"somewhat", ".", " ", "This"}], " ", "leaves", " ", "us", " ", 
     "with", " ", "real", " ", "coefficients", " ", "for", " ", 
     RowBox[{"z", "^", "2"}], " ", "and", " ", "imaginary", " ", 
     "coefficents", " ", "for", " ", 
     RowBox[{"z", ".", " ", "Now"}]}], ",", " ", 
    RowBox[{
    "this", " ", "integral", " ", "leads", " ", "to", " ", "error", " ", 
     RowBox[{"functions", ".", " ", "Instead"}]}], ",", " ", 
    RowBox[{
    "look", " ", "at", " ", "Taylor", " ", "expanding", " ", "what", " ", 
     "is", " ", "in", " ", "the", " ", "integrand", " ", "and", " ", "then", 
     " ", "carry", " ", "out", " ", "the", " ", 
     RowBox[{"integral", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"IntResult", "=", 
     RowBox[{"Normal", "[", 
      RowBox[{"Assuming", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"aaa", ">", 
          RowBox[{"-", "inf"}]}], " ", "&&", " ", 
         RowBox[{"bbb", ">", 
          RowBox[{"-", "inf"}]}], " ", "&&", " ", 
         RowBox[{"ccc", ">", 
          RowBox[{"-", "inf"}]}]}], " ", ",", " ", 
        RowBox[{"Integrate", "[", 
         RowBox[{
          RowBox[{"Series", "[", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"z", "^", "2"}]}], " ", "*", 
               RowBox[{"(", "ccc", " ", ")"}]}], " ", "-", 
              RowBox[{"z", " ", "*", 
               RowBox[{"(", 
                RowBox[{"\[ImaginaryI]", "*", "bbb"}], ")"}]}]}], "]"}], ",", 
            
            RowBox[{"{", 
             RowBox[{"z", ",", "0", ",", "20"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"z", ",", "0", ",", "L"}], "}"}]}], "]"}]}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"IntResultExact", " ", "=", 
    RowBox[{"Normal", "[", 
     RowBox[{"Assuming", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"aaa", ">", 
         RowBox[{"-", "inf"}]}], " ", "&&", " ", 
        RowBox[{"bbb", ">", 
         RowBox[{"-", "inf"}]}], " ", "&&", " ", 
        RowBox[{"ccc", ">", 
         RowBox[{"-", "inf"}]}]}], " ", ",", " ", 
       RowBox[{"Integrate", "[", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"z", "^", "2"}]}], " ", "*", 
            RowBox[{"(", "ccc", " ", ")"}]}], " ", "-", 
           RowBox[{"z", " ", "*", 
            RowBox[{"(", 
             RowBox[{"\[ImaginaryI]", "*", "bbb"}], ")"}]}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"z", ",", "0", ",", "L"}], "}"}]}], "]"}]}], "]"}], "]"}]}],
    "\[IndentingNewLine]", 
   RowBox[{"IntResultNoZsq", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{"Normal", "[", 
      RowBox[{"Assuming", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"aaa", ">", 
          RowBox[{"-", "inf"}]}], " ", "&&", " ", 
         RowBox[{"bbb", ">", 
          RowBox[{"-", "inf"}]}], " ", "&&", " ", 
         RowBox[{"ccc", ">", 
          RowBox[{"-", "inf"}]}]}], " ", ",", " ", 
        RowBox[{"Integrate", "[", 
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "z"}], " ", "*", 
            RowBox[{"(", 
             RowBox[{"\[ImaginaryI]", "*", "bbb"}], ")"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"z", ",", "0", ",", "L"}], "}"}]}], "]"}]}], "]"}], "]"}], 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"IntResultNoZsq", " ", "=", " ", 
    RowBox[{
     RowBox[{"Exp", "[", 
      RowBox[{"\[ImaginaryI]", "*", "bbb", "*", 
       RowBox[{"L", "/", "2"}]}], "]"}], "*", 
     RowBox[{"Sinc", "[", 
      RowBox[{"bbb", "*", 
       RowBox[{"L", "/", "2"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"IntResultExact", " ", "/.", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"R", " ", "\[Rule]", " ", 
        RowBox[{"-", "AA"}]}], ",", " ", 
       RowBox[{"S", " ", "\[Rule]", " ", 
        RowBox[{"-", "BB"}]}], ",", " ", 
       RowBox[{"T", " ", "\[Rule]", " ", 
        RowBox[{"-", "CC"}]}]}], "}"}]}], "  ", "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.5825541447325993`*^9, 3.582554218173704*^9}, {
   3.582554311787928*^9, 3.582554332788763*^9}, 3.582562009349558*^9, 
   3.582598942001313*^9, 3.582599220705217*^9, 3.582601424927206*^9, {
   3.5826019630624943`*^9, 3.582601984307494*^9}, 3.5826724646779633`*^9, 
   3.5891464228443213`*^9, 3.589301227499234*^9, 3.589301370740279*^9, {
   3.5893014329726353`*^9, 3.5893015115305567`*^9}, {3.589302039289466*^9, 
   3.589302042950698*^9}, {3.589302889573372*^9, 3.58930290480516*^9}, 
   3.5893110584640427`*^9, {3.590531635647273*^9, 3.590531670022317*^9}, {
   3.590587169195961*^9, 3.5905871780052347`*^9}, {3.590587381482347*^9, 
   3.59058738347991*^9}, {3.590587493238393*^9, 3.5905875515005293`*^9}, {
   3.59068881788616*^9, 3.59068889031148*^9}, {3.590689460214615*^9, 
   3.590689461586296*^9}, {3.5906895193179293`*^9, 3.5906895930357857`*^9}, 
   3.59068962961385*^9, {3.5906916120203867`*^9, 3.590691613149151*^9}, {
   3.590691706112774*^9, 3.59069174702166*^9}, {3.590692163595139*^9, 
   3.590692230340989*^9}, {3.590692303659708*^9, 3.590692305378883*^9}, 
   3.590692929425699*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox["bbb", "2"], 
      RowBox[{"4", " ", "ccc"}]]}]], " ", 
   SqrtBox["\[Pi]"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Erf", "[", 
      FractionBox[
       RowBox[{
        RowBox[{"\[ImaginaryI]", " ", "bbb"}], "+", 
        RowBox[{"2", " ", "ccc", " ", "L"}]}], 
       RowBox[{"2", " ", 
        SqrtBox["ccc"]}]], "]"}], "-", 
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"Erfi", "[", 
       FractionBox["bbb", 
        RowBox[{"2", " ", 
         SqrtBox["ccc"]}]], "]"}]}]}], ")"}]}], 
  RowBox[{"2", " ", 
   SqrtBox["ccc"]}]]], "Output",
 CellChangeTimes->{
  3.590689632495658*^9, 3.5906916164582253`*^9, {3.590691733438922*^9, 
   3.5906917494262466`*^9}, 3.590692012766891*^9, {3.5906922201456614`*^9, 
   3.590692232601706*^9}, 3.590692307679336*^9, 3.590692931703277*^9, 
   3.590694303242279*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[ImaginaryI]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "bbb", " ", "L"}]]}], ")"}]}], 
  "bbb"]], "Output",
 CellChangeTimes->{
  3.590689632495658*^9, 3.5906916164582253`*^9, {3.590691733438922*^9, 
   3.5906917494262466`*^9}, 3.590692012766891*^9, {3.5906922201456614`*^9, 
   3.590692232601706*^9}, 3.590692307679336*^9, 3.590692931703277*^9, 
   3.59069430336521*^9}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[ExponentialE]", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", "bbb", " ", "L"}], "2"]], " ", 
  RowBox[{"Sinc", "[", 
   FractionBox[
    RowBox[{"bbb", " ", "L"}], "2"], "]"}]}]], "Output",
 CellChangeTimes->{
  3.590689632495658*^9, 3.5906916164582253`*^9, {3.590691733438922*^9, 
   3.5906917494262466`*^9}, 3.590692012766891*^9, {3.5906922201456614`*^9, 
   3.590692232601706*^9}, 3.590692307679336*^9, 3.590692931703277*^9, 
   3.590694303366721*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Expand", "[", "IntResultExact", "]"}]], "Input",
 CellChangeTimes->{{3.582554782936783*^9, 3.582554879991461*^9}, {
  3.582561583029579*^9, 3.582561640762952*^9}, {3.582561709843975*^9, 
  3.582561728675111*^9}, {3.5825621373940763`*^9, 3.582562190880147*^9}, {
  3.582562223501135*^9, 3.5825623913615503`*^9}, {3.582562435870626*^9, 
  3.582562439376598*^9}, {3.582562521558365*^9, 3.5825625801356792`*^9}, {
  3.582563110806714*^9, 3.58256311328623*^9}, {3.582566065536174*^9, 
  3.5825661004693317`*^9}, {3.5892292429502087`*^9, 3.5892292435101557`*^9}, {
  3.5905878609147167`*^9, 3.5905878683092957`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "aaa"}], "-", 
      FractionBox[
       SuperscriptBox["bbb", "2"], 
       RowBox[{"4", " ", "ccc"}]]}]], " ", 
    SqrtBox["\[Pi]"], " ", 
    RowBox[{"Erf", "[", 
     FractionBox[
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", "bbb"}], "+", 
       RowBox[{"2", " ", "ccc", " ", "L"}]}], 
      RowBox[{"2", " ", 
       SqrtBox["ccc"]}]], "]"}]}], 
   RowBox[{"2", " ", 
    SqrtBox["ccc"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "aaa"}], "-", 
      FractionBox[
       SuperscriptBox["bbb", "2"], 
       RowBox[{"4", " ", "ccc"}]]}]], " ", 
    SqrtBox["\[Pi]"], " ", 
    RowBox[{"Erfi", "[", 
     FractionBox["bbb", 
      RowBox[{"2", " ", 
       SqrtBox["ccc"]}]], "]"}]}], 
   RowBox[{"2", " ", 
    SqrtBox["ccc"]}]]}]], "Output",
 CellChangeTimes->{3.59058786870644*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"rules2a", " ", ":=", " ", 
  RowBox[{"{", " ", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Theta]", "s"], " ", "\[Rule]", 
     RowBox[{"2.2", "*", 
      RowBox[{"\[Pi]", "/", "180"}]}]}], ",", " ", 
    RowBox[{
     SubscriptBox["\[Theta]", "i"], " ", "\[Rule]", 
     RowBox[{"2.2", "*", 
      RowBox[{"\[Pi]", "/", "180"}]}]}], " ", ",", " ", 
    RowBox[{
     SubscriptBox["W", "s"], " ", "\[Rule]", " ", ".00005"}], ",", " ", 
    RowBox[{
     SubscriptBox["W", "ppp"], "\[Rule]", " ", ".00005"}], ",", "   ", 
    RowBox[{
     SubscriptBox["\[CapitalDelta]K", "x"], " ", "\[Rule]", "0"}], ",", 
    RowBox[{
     SubscriptBox["\[CapitalDelta]K", "y"], " ", "\[Rule]", "0"}], ",", " ", 
    RowBox[{"L", " ", "\[Rule]", " ", ".001"}], ",", " ", 
    RowBox[{
     SubscriptBox["\[Phi]", "s"], "\[Rule]", "0.00000000000"}], ",", " ", 
    RowBox[{
     SubscriptBox["\[Rho]", "px"], "\[Rule]", 
     RowBox[{"0", "*", 
      RowBox[{"\[Pi]", "/", "180"}]}]}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"AA", " ", "/.", " ", "rules2a"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BB", " ", "/.", " ", "rules2a"}], " ", "/.", " ", 
  RowBox[{"{", 
   RowBox[{
    SubscriptBox["\[CapitalDelta]K", "z"], " ", "\[Rule]", "0"}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"CC", " ", "/.", " ", "rules2a"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IntResult", "*", 
     RowBox[{"Exp", "[", 
      RowBox[{"-", "aaa"}], "]"}]}], "//.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"aaa", "\[Rule]", "AA"}], ",", " ", 
      RowBox[{"bbb", "\[Rule]", "BB"}], ",", " ", 
      RowBox[{"ccc", "\[Rule]", "CC"}]}], "}"}]}], " ", "//.", "rules2a"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"exactResult", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"IntResultExact", "/", "L"}], "  ", "//.", "  ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"aaa", "\[Rule]", 
        RowBox[{"-", "AA"}]}], ",", " ", 
       RowBox[{"bbb", "\[Rule]", 
        RowBox[{"-", "BB"}]}], ",", " ", 
       RowBox[{"ccc", "\[Rule]", "CC"}]}], "}"}]}], " ", "//.", "rules2a"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sincResult", " ", "=", " ", 
    RowBox[{
     RowBox[{"IntResultNoZsq", "  ", "//.", "  ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"aaa", "\[Rule]", 
         RowBox[{"-", "AA"}]}], ",", " ", 
        RowBox[{"bbb", "\[Rule]", "BB"}], ",", " ", 
        RowBox[{"ccc", "\[Rule]", 
         RowBox[{"-", "CC"}]}]}], "}"}]}], " ", "//.", "rules2a"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SqrtBox[
     RowBox[{"2", "*", 
      RowBox[{"-", "ccc"}]}]], "*", "L"}], " ", "//.", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"aaa", "\[Rule]", 
      RowBox[{"-", "AA"}]}], ",", " ", 
     RowBox[{"bbb", "\[Rule]", "BB"}], ",", " ", 
     RowBox[{"ccc", "\[Rule]", 
      RowBox[{"-", "CC"}]}]}], "}"}]}], " ", "/.", 
  "rules2a"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"BB", "/", "2"}], 
     RowBox[{"Sqrt", "[", "CC", "]"}]}], " ", "/.", " ", "rules2a"}], " ", "/.",
    " ", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\[CapitalDelta]K", "z"], " ", "\[Rule]", "10"}], "}"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nor", " ", "=", " ", 
    RowBox[{"exactResult", "/.", " ", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["\[CapitalDelta]K", "z"], " ", "\[Rule]", "0"}], 
      "}"}]}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"exactResult", "/", " ", 
      RowBox[{"(", "nor", ")"}]}], ",", "sincResult"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\[CapitalDelta]K", "z"], ",", "0", ",", "1000"}], "}"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.58256349132627*^9, 3.582563495110099*^9}, {
   3.590689134816766*^9, 3.5906891885531063`*^9}, {3.590689223242515*^9, 
   3.5906894462740717`*^9}, {3.5906894953653297`*^9, 3.590689501859786*^9}, 
   3.590689604281765*^9, {3.590689636116609*^9, 3.590689845847547*^9}, {
   3.590689888564788*^9, 3.59068991139326*^9}, {3.5906901573311357`*^9, 
   3.590690182454824*^9}, {3.590690248255979*^9, 3.5906902634033213`*^9}, {
   3.590690347559293*^9, 3.590690361558818*^9}, {3.590690590837369*^9, 
   3.590690721154359*^9}, {3.590690763510709*^9, 3.590691027040444*^9}, {
   3.590691641595707*^9, 3.590691662615444*^9}, {3.5906917669021807`*^9, 
   3.5906919523795557`*^9}, {3.590691998354834*^9, 3.590691999608111*^9}, {
   3.59069203870498*^9, 3.590692039660225*^9}, {3.590692104874502*^9, 
   3.590692108481469*^9}, {3.590692241503277*^9, 3.5906923405078382`*^9}, {
   3.590692414213072*^9, 3.590692429988011*^9}, {3.590692495850953*^9, 
   3.5906925193747063`*^9}, {3.590692584904544*^9, 3.590692676501904*^9}, {
   3.5906929548340397`*^9, 3.5906929866444283`*^9}, {3.590693112265786*^9, 
   3.590693279373214*^9}, {3.590693467732444*^9, 3.590693481674457*^9}, {
   3.590693568215784*^9, 3.590693592678686*^9}, {3.590694313108568*^9, 
   3.59069431628088*^9}, {3.5906943471130342`*^9, 3.590694429832603*^9}, {
   3.5906944603788853`*^9, 3.5906944607727118`*^9}, {3.590694492351788*^9, 
   3.590694681247302*^9}, {3.590694730851157*^9, 3.590694751914744*^9}, {
   3.590694784674917*^9, 3.590694923133439*^9}, {3.590694968399907*^9, 
   3.590695012828775*^9}, {3.590695050098987*^9, 3.590695079085531*^9}, {
   3.5906952058909893`*^9, 3.5906953810262213`*^9}, {3.590703523781375*^9, 
   3.590703688367538*^9}, {3.5907199288945503`*^9, 3.5907200950178213`*^9}, {
   3.590720137539844*^9, 3.590720138401004*^9}, {3.5907210515373373`*^9, 
   3.590721073169735*^9}, {3.590721119811398*^9, 3.59072112458604*^9}, {
   3.590721161866335*^9, 3.5907211819807673`*^9}, 3.5907212142476673`*^9, {
   3.59072127001033*^9, 3.590721337943755*^9}, {3.590721413086351*^9, 
   3.590721447720007*^9}, {3.590721505490848*^9, 3.5907215056327667`*^9}, {
   3.590721635684663*^9, 3.5907218333227253`*^9}, {3.590721879902192*^9, 
   3.5907218861585093`*^9}, {3.590722210776909*^9, 3.5907222569600277`*^9}, {
   3.590722550625949*^9, 3.590722560806024*^9}, 3.590722602761242*^9, {
   3.590722692852169*^9, 3.590722694564612*^9}, {3.590722757338128*^9, 
   3.590722759057476*^9}, 3.5907227895753508`*^9, {3.5907228219925957`*^9, 
   3.5907228992184057`*^9}, {3.590722934739349*^9, 3.590722941626505*^9}}],

Cell[BoxData["0.`"], "Output",
 CellChangeTimes->{{3.590721441909869*^9, 3.5907214532588797`*^9}, {
   3.5907215063884563`*^9, 3.5907215294117937`*^9}, {3.590721653445063*^9, 
   3.590721675687402*^9}, {3.590721735656768*^9, 3.590721834388883*^9}, 
   3.590721887603882*^9, {3.5907221479718037`*^9, 3.5907221560755463`*^9}, {
   3.590722211592836*^9, 3.5907222590416203`*^9}, {3.59072256169007*^9, 
   3.590722603636388*^9}, 3.590722695485046*^9, 3.590722759851677*^9, 
   3.590722790472349*^9, {3.5907228447216053`*^9, 3.59072285453843*^9}, {
   3.590722888205139*^9, 3.5907229053356047`*^9}, {3.590722935704652*^9, 
   3.590722941954506*^9}}],

Cell[BoxData[
 RowBox[{"0.`", "\[VeryThinSpace]", "+", 
  RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]], "Output",
 CellChangeTimes->{{3.590721441909869*^9, 3.5907214532588797`*^9}, {
   3.5907215063884563`*^9, 3.5907215294117937`*^9}, {3.590721653445063*^9, 
   3.590721675687402*^9}, {3.590721735656768*^9, 3.590721834388883*^9}, 
   3.590721887603882*^9, {3.5907221479718037`*^9, 3.5907221560755463`*^9}, {
   3.590722211592836*^9, 3.5907222590416203`*^9}, {3.59072256169007*^9, 
   3.590722603636388*^9}, 3.590722695485046*^9, 3.590722759851677*^9, 
   3.590722790472349*^9, {3.5907228447216053`*^9, 3.59072285453843*^9}, {
   3.590722888205139*^9, 3.5907229053356047`*^9}, {3.590722935704652*^9, 
   3.59072294195615*^9}}],

Cell[BoxData["589449.5546159478`"], "Output",
 CellChangeTimes->{{3.590721441909869*^9, 3.5907214532588797`*^9}, {
   3.5907215063884563`*^9, 3.5907215294117937`*^9}, {3.590721653445063*^9, 
   3.590721675687402*^9}, {3.590721735656768*^9, 3.590721834388883*^9}, 
   3.590721887603882*^9, {3.5907221479718037`*^9, 3.5907221560755463`*^9}, {
   3.590722211592836*^9, 3.5907222590416203`*^9}, {3.59072256169007*^9, 
   3.590722603636388*^9}, 3.590722695485046*^9, 3.590722759851677*^9, 
   3.590722790472349*^9, {3.5907228447216053`*^9, 3.59072285453843*^9}, {
   3.590722888205139*^9, 3.5907229053356047`*^9}, {3.590722935704652*^9, 
   3.590722941957389*^9}}],

Cell[BoxData["1.0857712048271935`"], "Output",
 CellChangeTimes->{{3.590721441909869*^9, 3.5907214532588797`*^9}, {
   3.5907215063884563`*^9, 3.5907215294117937`*^9}, {3.590721653445063*^9, 
   3.590721675687402*^9}, {3.590721735656768*^9, 3.590721834388883*^9}, 
   3.590721887603882*^9, {3.5907221479718037`*^9, 3.5907221560755463`*^9}, {
   3.590722211592836*^9, 3.5907222590416203`*^9}, {3.59072256169007*^9, 
   3.590722603636388*^9}, 3.590722695485046*^9, 3.590722759851677*^9, 
   3.590722790472349*^9, {3.5907228447216053`*^9, 3.59072285453843*^9}, {
   3.590722888205139*^9, 3.5907229053356047`*^9}, {3.590722935704652*^9, 
   3.590722942000149*^9}}],

Cell[BoxData[
 RowBox[{"0.`", "\[VeryThinSpace]", "+", 
  RowBox[{"3838.780908751982`", " ", "\[ImaginaryI]"}]}]], "Output",
 CellChangeTimes->{{3.590721441909869*^9, 3.5907214532588797`*^9}, {
   3.5907215063884563`*^9, 3.5907215294117937`*^9}, {3.590721653445063*^9, 
   3.590721675687402*^9}, {3.590721735656768*^9, 3.590721834388883*^9}, 
   3.590721887603882*^9, {3.5907221479718037`*^9, 3.5907221560755463`*^9}, {
   3.590722211592836*^9, 3.5907222590416203`*^9}, {3.59072256169007*^9, 
   3.590722603636388*^9}, 3.590722695485046*^9, 3.590722759851677*^9, 
   3.590722790472349*^9, {3.5907228447216053`*^9, 3.59072285453843*^9}, {
   3.590722888205139*^9, 3.5907229053356047`*^9}, {3.590722935704652*^9, 
   3.5907229420016203`*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {}, 
   {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1:eJwVjns0lAkchselrcmZENqwpWmyRkhncEiN30+5bCIpObqpya2xcqs0jMhd
YT5SQ0lmVLSttk6tMA26TOly9qCsQ2I3nW8YzEwhqhE7+8d73vOc54/3pR+O
3xmpS6FQArT5v8cmZv19oj57PN1G1czPqyHpeoqTl/gNVHkvrH43pwaegTLK
XPwBbv67P6j5uxr4rbUUffEk9EgN3idp1PC9PDvgq0gP6zmcevm0Glr1JyYn
RSb4C9N1olOphpUbbX0/iRgoEZLOd/rVsL1H9lEtcsLzVz24FxvVgKXZBt7H
vbDw1TzHMkYNxpMhd0rDt+PXZfcE9avV4PGAF3TKKBhDmF+oGQMqEB1rvfUu
dA/yRRcaI8tUMLh14LXGJwx1pPvyVwSqIHJbqvJwBwd9GjwqaT+owFMyo98R
F4HxqtFuzzYlGDS9p1i+j0KL0xVZi9OVYPfJN25TARcjVO5KZzcluDdbPGTr
xuI5K3ZJ98w43N560PpZfBym8q6+SWkeh5bFRnPGZxKwvlCnoS55HCyaavvv
PElErrjircmGcVidrUmULD+GFu3JD5gzYxDGop7Ljz6OSXX3Pno3joGxbcA1
WfUJrAkNu/Fr2hjEswPjYyeSsS7S0PQgewy8Lubb56zjYfcOg1DQGwPZ0vSa
H3JTcL9gd4DB01E4meBQ4/93Ku61qRhqKxgFsZnJeV3DNLS78sjIMUjre+97
MMJPoSNPeqLebBRkQyX990TpeCSdK3w5qACvLobuot4M5IesLq36TQFNcZKE
D+dPY7mhak11ggLOLE/vS2VlYhChP2yySQHru0RXfAcy0fVFhM5rPQV81FQz
p3OyMDRjwW7fv0Yg1k/y+356NrKcn6Fe5Qi01DkVfnmZjeZNuntsIkfgJfN5
uD83B0/T7H7kO43AJ8sNOln6uRgCpqtC9UZAuYKqGa/PRdqDjV6SjmG4vmVK
aeiXh7R8q0sM0TCweB7sI1N5GLaCpbY9Ogz8zqu5vLJ8jMmQTtE9hmHgEnku
xrEAs+iH+EVGw2B2PG+2tLcAR6cclt/+Rw7UxM0HE5PPYND0SX7VXTm8Tjuw
Mo9+FlNaWMF7s+TQ8C24Ju3FWdxBaZQV7pLDrsvRVnZRhTjw5s++cKYc2v37
viwxKkKab7nLmm8kTK+KenXzjyLsfHTZnNdBAkR3HGb6FeNuy1PBFrUkhEnL
Q/onipG2J9SsJYUENxf+Fp8SAS7dbnytawcJPfzNaxeUCVBoOjhtqeUTj6nG
sgsC3Ngk3RkVSMLdwIpBz0oBtsbdstYEkGAf05DCrhXg0cwAN+ttJKyqVt92
lgrQt8bQiO9NApUa8RNjRIDmnb25Du4k3Ai00xsaFSA3secrbwMJPsIJhUgp
wPa27mSZGwk5jMzGlZMCnIeuwn2uJMyxr+y0mBPg3R4J/awzCRNJvQXGpgRG
tvTOjqwjoaS5Or5zGYFoKqa4aNmREh1CmBNYUsyhZTqQEFv8mUGzInD9s+ee
5vYkyOuWti1aS+CBaPoyP1vtnqrvers9gY2KSo6QSQLDRVyU50jgRf/F94ds
SDj02HGvvguB4rKHKfyftX8WzeATVwKbohcq2q1JqApstclyJ5A1CxxTLW8S
5i7xZBNo9YI7dGgNCW/f+X+eBwKFPjmxtxgk/AfJRUtK
     "]]}, 
   {Hue[0.9060679774997897, 0.6, 0.6], LineBox[CompressedData["
1:eJwVjn080wkcx6XViyR56lVkcivPJYa61fb9kqdqo9R1d7mbC428nIco85jY
MLEfeqCrGBd6uqLU4Wq68qJcV6q7jkRHP5thG0aJ4twfn9f79f7r/bEKiQk8
qK2lpcWZ3/8cHv/E9uFNsp4Qwum5OTUcrkqie1W8hLet8ZHSWTXw9ZS8VRXv
QHuP+3DqZzWkSKu1KBUa6I13tZyeVsPnkizOR8lCZFh83DU5qQYpZVyjkRgj
9cfW16phNVC32PmOSWjI35yTofpHDf6vWkbVEjrmOub0WNaqAYuy9LwTvLCp
1z3p1n41GGr21RaF+qMrJUWwaKkaWL/xd6ct34uZdGZdf7MKJPHSX9588y2e
/zpzEy9aBb3be17M+HBxSpQ6w6Wp4ODOZGXIswNYNxOusXmpBI+mD5Rn0WE4
aG1dly5Ugl5Dn5Z5Hw+vSgw8FrKU4DDmG7019xAap/tN5IyNAKPR7D5TOwq9
ajpvm14dgRvbg9e1xkQjVWZ9Uc4bgXtLls8aimLRL827SGYxAmYN1d21D+Mw
rHGJ4fXXw/BF1kxc08p41Be6V7YVDwPXRbc4JzwBl2aWKGw4w2Box7nYUn4E
d768+9RQfxhimAExUeNH0cE1wo//aAi8zuY4Cjbwcdb54ZSvaAhajNIrFwuT
UOeyifSO9xAkxq6vZP+djPXOrtU+lCGoMDU+pW2Qiv5O5uaLHikgsfMOixaa
hqv9S+h5OQpo6S/sviVJR5FZfZUlWwFez2naOp3HkJS4tZ41UkBDdFPsu1MZ
WNFx4NTcX4MgWpnelexyHJ0zAhvw/CBsfC4p8+05joTe03X5wYMwOlNu+16Q
ifcstJOlawchakfT1e+ssrCZEb2/VCWHezX0E1PtWch5+7imvF4O7baPQtmH
BFgZUNZFPyaHMfMvF2RShHhuY9CZpJ1yUFrozoxcE+IlVdwVfRM5VG2bUBrs
yEYJ89yTuX9l4MJnMSMmsnHiXXNi0BUZpHT8LOSfzMGPJR3bPyXKoOengeJI
p1w06r7wge4rA9OE7E9FnbmY5B1CaoxkoBvnGRx3VIQKoaf7n/0D8CL1e2q2
VR6O2p608bsxALen91amPs7Dxat/lwelDcCe8+GWDrwTWHC0xI8bMABt7K6p
Zcvz8YBybbwldQDer+H9ceV6PrZz+hiNoyRA+LMQ2x0FWGMnuN/cQgL3bsm+
7vECnKOzeZLTJGx2S9nmUyjGJ9zgMZdIEl6leNovOilGyoopt8OHSDjyQNew
5bQYHaz6BHURJNwMKO31OCdGlFR4bAwnwTHydhKzWoxKVrv7hjAS1pSrb7je
FeNFfXsDRy4Jurphq2mDYhTVV8c7BZJwKcBhYf+QGIXZegtid5Pgc2ZcIVGK
sdjuWmntLhIEtOO/UjViDP2qTOYcQMIssyzQbFaM9hGun13ZJIwf7sw1NCEw
736pCdOHhMLG8piOFQS2Wkd7p3uT4KQVvo9YRSCuP5LR7EVCVMEkTd+SQHah
qannNhJkNUbNOvYEgqygwRfne6quqjZHAh8LexkiIIHmVpGf7UTg7rqgtnYW
CT88cNpPcSNQl9Y1y2HO/9H5gA83EXhtbedlYisJFwKkNpkMAul2C4KfbyFh
6xnhMg8mgQniPVTjeX/9hj05BwT633wq38sg4T8SbVPJ
     "]]}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesOrigin->{0, 0.63},
  PlotRange->{{0, 1000}, {0.6321205642212335, 0.9999999907544114}},
  PlotRangeClipping->True,
  PlotRangePadding->{
    Scaled[0.02], 
    Scaled[0.02]}]], "Output",
 CellChangeTimes->{{3.590721441909869*^9, 3.5907214532588797`*^9}, {
   3.5907215063884563`*^9, 3.5907215294117937`*^9}, {3.590721653445063*^9, 
   3.590721675687402*^9}, {3.590721735656768*^9, 3.590721834388883*^9}, 
   3.590721887603882*^9, {3.5907221479718037`*^9, 3.5907221560755463`*^9}, {
   3.590722211592836*^9, 3.5907222590416203`*^9}, {3.59072256169007*^9, 
   3.590722603636388*^9}, 3.590722695485046*^9, 3.590722759851677*^9, 
   3.590722790472349*^9, {3.5907228447216053`*^9, 3.59072285453843*^9}, {
   3.590722888205139*^9, 3.5907229053356047`*^9}, {3.590722935704652*^9, 
   3.59072294200749*^9}}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.590721407284198*^9, 3.590721408957677*^9}, {
   3.590721460076645*^9, 3.5907216074691677`*^9}, 3.590721686976589*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.590721689694435*^9, 3.590721689732211*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "It", " ", "looks", " ", "like", " ", "I", " ", "can", " ", "drop", " ", 
    "the", " ", 
    RowBox[{"z", "^", "2"}], " ", "term", " ", "as", " ", "long", " ", "as", 
    " ", 
    SqrtBox[
     RowBox[{"2", "*", "ccc"}]], "*", "L", " ", 
    RowBox[{"<<", " ", "1."}], " ", "Then", " ", "I", " ", "can", " ", "use", 
    " ", "the", " ", "straight", " ", "Gaussian", " ", "without", " ", "any", 
    " ", 
    RowBox[{"problems", "."}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["W", "s"], "\[Rule]", "0"}], ",", " ", 
     RowBox[{
      SubscriptBox["\[Theta]", "i"], "\[Rule]", "0"}], ",", " ", 
     RowBox[{
      SubscriptBox["\[Theta]", "s"], "\[Rule]", "0"}]}], "}"}], 
   "\[IndentingNewLine]", 
   RowBox[{"BB", "   ", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Rho]", "px"], "\[Rule]", "0"}], ",", " ", 
      RowBox[{
       SubscriptBox["W", "s"], "\[Rule]", "0"}], ",", " ", 
      RowBox[{
       SubscriptBox["\[Phi]", "s"], "\[Rule]", "0"}]}], "}"}]}]}]}]], "Input",\

 CellChangeTimes->{
  3.590693222448194*^9, {3.590695144517846*^9, 3.590695197163515*^9}, {
   3.590698704937541*^9, 3.5906987847808037`*^9}, {3.5906988823700447`*^9, 
   3.590698967070087*^9}, {3.590699012461445*^9, 3.590699050152123*^9}, {
   3.590699749536888*^9, 3.5906998176915207`*^9}, {3.5906999218153057`*^9, 
   3.590699951337212*^9}, {3.5907000301721487`*^9, 3.590700050032143*^9}, {
   3.590701117557129*^9, 3.590701117894127*^9}, 3.590704534899603*^9, {
   3.590704574221983*^9, 3.5907046058797283`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SubscriptBox["W", "s"], "\[Rule]", "0"}], ",", 
   RowBox[{
    SubscriptBox["\[Theta]", "i"], "\[Rule]", "0"}], ",", 
   RowBox[{
    SubscriptBox["\[Theta]", "s"], "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.590698785275813*^9, {3.590698885629745*^9, 3.590698913528783*^9}, 
   3.590698968342342*^9, {3.590699013272533*^9, 3.590699017012121*^9}, 
   3.5906990508935003`*^9, {3.590699756471943*^9, 3.5906998180862083`*^9}, 
   3.590699922778294*^9, 3.590699954453779*^9, {3.5907000356835327`*^9, 
   3.590700050530944*^9}, 3.590701118494628*^9, 3.590704536184516*^9, {
   3.590704577450467*^9, 3.5907046069844427`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[ImaginaryI]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", 
          SubscriptBox["\[Theta]", "i"]}], "]"}], "-", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", 
          SubscriptBox["\[Theta]", "s"]}], "]"}]}], ")"}], " ", 
      SubscriptBox["\[CapitalDelta]K", "y"]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2", "+", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", 
          SubscriptBox["\[Theta]", "i"]}], "]"}], "+", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", 
          SubscriptBox["\[Theta]", "s"]}], "]"}]}], ")"}], " ", 
      SubscriptBox["\[CapitalDelta]K", "z"]}]}], ")"}]}], 
  RowBox[{"2", "+", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", 
     SubscriptBox["\[Theta]", "i"]}], "]"}], "+", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", 
     SubscriptBox["\[Theta]", "s"]}], "]"}]}]]], "Output",
 CellChangeTimes->{
  3.590698785275813*^9, {3.590698885629745*^9, 3.590698913528783*^9}, 
   3.590698968342342*^9, {3.590699013272533*^9, 3.590699017012121*^9}, 
   3.5906990508935003`*^9, {3.590699756471943*^9, 3.5906998180862083`*^9}, 
   3.590699922778294*^9, 3.590699954453779*^9, {3.5907000356835327`*^9, 
   3.590700050530944*^9}, 3.590701118494628*^9, 3.590704536184516*^9, {
   3.590704577450467*^9, 3.590704606986292*^9}}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.590699766517214*^9, 3.5906997677936172`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"zz", " ", "=", " ", 
   RowBox[{
    RowBox[{"a", "*", 
     RowBox[{"z", "^", "2"}]}], " ", "+", 
    RowBox[{"\[ImaginaryI]", "*", "b", "*", "z"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CompleteSquare", "[", 
   RowBox[{"zz", ",", " ", "z"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"n_", ",", "x_", ",", "y_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"2", "*", "x"}], "-", 
       RowBox[{"2", "*", "x", "*", 
        RowBox[{"Cosh", "[", 
         RowBox[{"n", "*", "y"}], "]"}], "*", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", "*", "x", "*", "y"}], "]"}]}], "+", 
       RowBox[{"n", "*", 
        RowBox[{"Sinh", "[", 
         RowBox[{"n", "*", "y"}], "]"}], "*", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", "*", "x", "*", "y"}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"g", "[", 
     RowBox[{"n_", ",", "x_", ",", "y_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"2", "*", "x", "*", 
        RowBox[{"Cosh", "[", 
         RowBox[{"n", "*", "y"}], "]"}], "*", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", "*", "x", "*", "y"}], "]"}]}], "+", 
       RowBox[{"n", "*", 
        RowBox[{"Sinh", "[", 
         RowBox[{"n", "*", "y"}], "]"}], "*", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", "*", "x", "*", "y"}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ErfApprox", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "ans", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"ans", " ", "=", " ", 
      RowBox[{
       RowBox[{"Erf", "[", "x", "]"}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"-", 
           RowBox[{"x", "^", "2"}]}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"2", "*", "\[Pi]", "*", "x"}], ")"}]}], " ", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", "*", "x", "*", "y"}], "]"}]}], ")"}], "+", 
          RowBox[{"\[ImaginaryI]", "*", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", "*", "x", "*", "y"}], "]"}]}]}], ")"}]}], "  ", "+", 
       " ", 
       RowBox[{"2", "*", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"-", 
           RowBox[{"x", "^", "2"}]}], "]"}], "/", 
         RowBox[{"(", "\[Pi]", ")"}]}], "*", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "1"}], "/", "2"}], "*", 
              RowBox[{"n", "^", "2"}]}], "]"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"n", "^", "2"}], "+", 
              RowBox[{"4", "*", 
               RowBox[{"x", "^", "2"}]}]}], ")"}]}], " ", "*", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"f", "[", 
              RowBox[{"n", ",", "x", ",", "y"}], "]"}], "+", 
             RowBox[{"\[ImaginaryI]", "*", 
              RowBox[{"g", "[", 
               RowBox[{"n", ",", "x", ",", "y"}], "]"}]}]}], ")"}]}], ",", 
          " ", 
          RowBox[{"{", 
           RowBox[{"n", ",", "1", ",", " ", "100"}], "}"}]}], "]"}]}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"val", " ", "=", " ", 
   RowBox[{
    RowBox[{"\[ImaginaryI]", "*", "mm", "*", 
     RowBox[{"(", 
      RowBox[{"ll", "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", "*", "mm"}], "+", "mm"}], ")"}]}], ")"}]}], " ", "/.", 
    " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ll", "\[Rule]", "1."}], ",", " ", 
      RowBox[{"mm", "\[Rule]", ".1"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"coef", " ", "=", 
    RowBox[{
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"ll", "^", "2"}], "/", 
       RowBox[{"(", 
        RowBox[{"4", "*", "mm"}], ")"}]}], "]"}], "  ", "/.", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ll", "\[Rule]", ".1"}], ",", " ", 
       RowBox[{"mm", "\[Rule]", ".1"}]}], "}"}]}]}], ";"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ErfApprox", "[", 
  RowBox[{
   RowBox[{"Re", "[", "val", "]"}], ",", " ", 
   RowBox[{"Im", "[", "val", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Erf", "[", "val", "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.582599863339098*^9, 3.582599863349024*^9}, {
  3.59071593576803*^9, 3.590715982811954*^9}, {3.5907173035114403`*^9, 
  3.590717670288961*^9}, {3.590717705062963*^9, 3.5907179408968897`*^9}, {
  3.590718009890333*^9, 3.590718332052627*^9}, {3.590718390641624*^9, 
  3.5907185167956142`*^9}, {3.5907185600226316`*^9, 3.590718564675071*^9}, {
  3.5907186768403873`*^9, 3.590718691133597*^9}, {3.590718733699142*^9, 
  3.590718791372504*^9}, {3.590719857859764*^9, 3.5907198908100643`*^9}, {
  3.590720160129662*^9, 3.5907202102542257`*^9}, {3.590720352290475*^9, 
  3.5907205043495617`*^9}, {3.5907230523589287`*^9, 3.590723067330069*^9}, {
  3.590723206807535*^9, 3.5907234429896*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   SuperscriptBox["b", "2"], 
   RowBox[{"4", " ", "a"}]], "+", 
  RowBox[{"a", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "b"}], 
       RowBox[{"2", " ", "a"}]], "+", "z"}], ")"}], "2"]}]}]], "Output",
 CellChangeTimes->{{3.590718424998212*^9, 3.590718517637727*^9}, 
   3.5907185657066383`*^9, {3.590718670591421*^9, 3.590718691853713*^9}, {
   3.590718734924328*^9, 3.5907187924361134`*^9}, {3.590719862098881*^9, 
   3.590719891387475*^9}, {3.59072018381251*^9, 3.590720210863652*^9}, {
   3.590720353246567*^9, 3.5907205049315653`*^9}, {3.5907233167650433`*^9, 
   3.590723351350686*^9}, {3.590723392587096*^9, 3.5907234439621487`*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Power", "::", "infy"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Infinite expression \[NoBreak]\\!\\(1\\/0.`\\)\[NoBreak] \
encountered. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/infy\\\", ButtonNote -> \
\\\"Power::infy\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.590723403622014*^9, 3.590723443964075*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Infinity", "::", "indet"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Indeterminate expression \[NoBreak]\\!\\(\\(\\((\\(\\(0.` \
\[VeryThinSpace]\\)\\) + \\(\\(0.`\\\\ \[ImaginaryI]\\)\\))\\)\\)\\\\ \
ComplexInfinity\\)\\n\[NoBreak] encountered. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/indet\\\", ButtonNote -> \
\\\"Infinity::indet\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.590723403622014*^9, 3.5907234439654818`*^9}}],

Cell[BoxData["Indeterminate"], "Output",
 CellChangeTimes->{{3.590718424998212*^9, 3.590718517637727*^9}, 
   3.5907185657066383`*^9, {3.590718670591421*^9, 3.590718691853713*^9}, {
   3.590718734924328*^9, 3.5907187924361134`*^9}, {3.590719862098881*^9, 
   3.590719891387475*^9}, {3.59072018381251*^9, 3.590720210863652*^9}, {
   3.590720353246567*^9, 3.5907205049315653`*^9}, {3.5907233167650433`*^9, 
   3.590723351350686*^9}, {3.590723392587096*^9, 3.590723443966565*^9}}],

Cell[BoxData[
 RowBox[{"0.`", "\[VeryThinSpace]", "+", 
  RowBox[{"0.39053390439339664`", " ", "\[ImaginaryI]"}]}]], "Output",
 CellChangeTimes->{{3.590718424998212*^9, 3.590718517637727*^9}, 
   3.5907185657066383`*^9, {3.590718670591421*^9, 3.590718691853713*^9}, {
   3.590718734924328*^9, 3.5907187924361134`*^9}, {3.590719862098881*^9, 
   3.590719891387475*^9}, {3.59072018381251*^9, 3.590720210863652*^9}, {
   3.590720353246567*^9, 3.5907205049315653`*^9}, {3.5907233167650433`*^9, 
   3.590723351350686*^9}, {3.590723392587096*^9, 3.59072344396777*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{"a", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "b"}], 
          RowBox[{"2", " ", "a"}]], "+", "z"}], ")"}], "2"]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"z", ",", "0", ",", "L"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.5907160190475616`*^9, 3.590716103876049*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SqrtBox["\[Pi]"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", 
      RowBox[{"Erf", "[", 
       FractionBox["b", 
        RowBox[{"2", " ", 
         SqrtBox["a"]}]], "]"}]}], "+", 
     RowBox[{"Erfi", "[", 
      RowBox[{
       SqrtBox["a"], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "b"}], 
          RowBox[{"2", " ", "a"}]], "+", "L"}], ")"}]}], "]"}]}], ")"}]}], 
  RowBox[{"2", " ", 
   SqrtBox["a"]}]]], "Output",
 CellChangeTimes->{{3.59071605011265*^9, 3.590716107127982*^9}}]
}, Open  ]]
},
WindowSize->{845, 852},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (October 5, \
2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[400, 13, 6230, 142, 373, "Input"],
Cell[CellGroupData[{
Cell[6655, 159, 11065, 246, 508, "Input"],
Cell[17723, 407, 2675, 47, 27, "Output"],
Cell[20401, 456, 3621, 73, 73, "Output"],
Cell[24025, 531, 2303, 37, 27, "Output"],
Cell[26331, 570, 2021, 28, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28389, 603, 2860, 80, 178, "Input"],
Cell[31252, 685, 2909, 75, 68, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34198, 765, 12140, 327, 889, "Input"],
Cell[46341, 1094, 493, 12, 27, "Output"],
Cell[46837, 1108, 730, 19, 27, "Output"],
Cell[47570, 1129, 713, 18, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48320, 1152, 2547, 68, 79, "Input"],
Cell[50870, 1222, 2798, 85, 142, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53705, 1312, 4133, 104, 337, "Input"],
Cell[57841, 1418, 1344, 42, 54, "Output"]
}, Open  ]],
Cell[59200, 1463, 94, 1, 27, "Input"],
Cell[CellGroupData[{
Cell[59319, 1468, 4777, 99, 324, "Input"],
Cell[64099, 1569, 1441, 38, 88, "Output"],
Cell[65543, 1609, 2178, 59, 87, "Output"],
Cell[67724, 1670, 5390, 142, 135, "Output"],
Cell[73117, 1814, 6683, 175, 159, "Output"],
Cell[79803, 1991, 5463, 150, 121, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[85303, 2146, 908, 20, 84, "Input"],
Cell[86214, 2168, 1991, 55, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[88242, 2228, 5695, 135, 298, "Input"],
Cell[93940, 2365, 961, 29, 72, "Output"],
Cell[94904, 2396, 537, 14, 51, "Output"],
Cell[95444, 2412, 504, 12, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[95985, 2429, 634, 9, 27, "Input"],
Cell[96622, 2440, 1007, 35, 72, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[97666, 2480, 6568, 150, 270, "Input"],
Cell[104237, 2632, 644, 9, 27, "Output"],
Cell[104884, 2643, 722, 11, 27, "Output"],
Cell[105609, 2656, 659, 9, 27, "Output"],
Cell[106271, 2667, 660, 9, 27, "Output"],
Cell[106934, 2678, 740, 11, 27, "Output"],
Cell[107677, 2691, 4442, 78, 239, "Output"]
}, Open  ]],
Cell[112134, 2772, 166, 2, 27, InheritFromParent],
Cell[112303, 2776, 92, 1, 27, InheritFromParent],
Cell[CellGroupData[{
Cell[112420, 2781, 1692, 42, 99, "Input"],
Cell[114115, 2825, 694, 15, 27, "Output"],
Cell[114812, 2842, 1440, 38, 53, "Output"]
}, Open  ]],
Cell[116267, 2883, 94, 1, 27, "Input"],
Cell[CellGroupData[{
Cell[116386, 2888, 5700, 158, 358, "Input"],
Cell[122089, 3048, 751, 17, 49, "Output"],
Cell[122843, 3067, 471, 10, 40, "Message"],
Cell[123317, 3079, 587, 11, 40, "Message"],
Cell[123907, 3092, 477, 6, 27, "Output"],
Cell[124387, 3100, 562, 8, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[124986, 3113, 499, 15, 64, InheritFromParent],
Cell[125488, 3130, 643, 22, 61, "Output"]
}, Open  ]]
}
]
*)

