(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     66896,       1773]
NotebookOptionsPosition[     65962,       1738]
NotebookOutlinePosition[     66316,       1754]
CellTagsIndexPosition[     66273,       1751]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CompleteSquare", "[", 
    RowBox[{"f_", ",", "x_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"c", ",", "b", ",", "a"}], "}"}], "=", 
       RowBox[{"CoefficientList", "[", 
        RowBox[{"f", ",", "x"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"a", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"x", "+", 
           RowBox[{
            RowBox[{"b", "/", "2"}], "/", "a"}]}], ")"}], "^", "2"}]}], "+", 
       RowBox[{"Simplify", "[", 
        RowBox[{"(", 
         RowBox[{"c", "-", 
          RowBox[{
           RowBox[{
            RowBox[{"b", "^", "2"}], "/", "4"}], "/", "a"}]}], ")"}], 
        "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Figure", " ", "out", " ", "the", " ", "rotation", " ", "that", " ", 
    "puts", " ", "the", " ", "signal", " ", "and", " ", "idler", " ", "into", 
    " ", "the", " ", "pump", " ", 
    RowBox[{"coordinates", ".", " ", "Here"}], " ", "\[Theta]", " ", "is", 
    " ", "the", " ", "opening", " ", "angle", " ", "and", " ", "\[Phi]", " ", 
    "is", " ", "the", " ", "azimuthal", " ", 
    RowBox[{"angle", "."}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Rx", "[", 
    RowBox[{"\[Theta]_", ",", " ", "V_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "S", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RotX", " ", "=", "  ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", " ", "0", ",", " ", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", " ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
           RowBox[{"-", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"0", ",", " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}], ",", " ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"RotX", ".", "V"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ry", "[", 
    RowBox[{"\[Theta]_", ",", " ", "V_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "S", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RotY", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", " ", 
          RowBox[{
           RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", "0", ",", " ", 
           RowBox[{"+", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", "  ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", "0", ",", "  ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"RotY", ".", "V"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rz", "[", 
   RowBox[{"\[Theta]_", ",", " ", "V_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "S", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RotZ", " ", ":=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", " ", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}], ",", " ", "0"}], "}"}], ",", 
        " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", " ", "0"}], "}"}], ",", 
        " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RotZ", ".", "V"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.582551082707974*^9, 3.582551243412228*^9}, {
   3.582552241600596*^9, 3.58255248525065*^9}, {3.5825530886487722`*^9, 
   3.582553091710619*^9}, {3.582581931220381*^9, 3.582581994221595*^9}, {
   3.582589736354864*^9, 3.58258979384231*^9}, {3.582589853214909*^9, 
   3.582589939808462*^9}, {3.582590073974887*^9, 3.5825900784620047`*^9}, {
   3.582591942003405*^9, 3.5825919557241173`*^9}, {3.582592064468408*^9, 
   3.582592070390641*^9}, {3.582592168312223*^9, 3.582592195349346*^9}, {
   3.582592537371162*^9, 3.5825925389767017`*^9}, {3.582592609833417*^9, 
   3.582592630132695*^9}, {3.582594727920084*^9, 3.5825947541563683`*^9}, {
   3.582594786928154*^9, 3.582594837727318*^9}, {3.582594872553235*^9, 
   3.5825948732121487`*^9}, 3.582594919516144*^9, {3.582595006307055*^9, 
   3.58259502779462*^9}, {3.582595382427409*^9, 3.5825953955679607`*^9}, {
   3.582595429725254*^9, 3.582595511584939*^9}, {3.582595567715238*^9, 
   3.58259556798405*^9}, {3.5825957007377663`*^9, 3.5825957096247883`*^9}, {
   3.582595744582691*^9, 3.582595792538672*^9}, {3.582596036605506*^9, 
   3.5825960731972313`*^9}, {3.582596118612314*^9, 3.58259612941899*^9}, {
   3.582596292204793*^9, 3.5825963567715073`*^9}, {3.582596404384987*^9, 
   3.5825964610317802`*^9}, {3.5825968755404663`*^9, 3.582596891139832*^9}, 
   3.582597031324554*^9, {3.582597263234353*^9, 3.582597287940269*^9}, {
   3.5825973900652647`*^9, 3.582597396723194*^9}, {3.582597641860304*^9, 
   3.582597661706188*^9}, 3.582597849090914*^9, 3.582597885135263*^9, {
   3.5826762909693413`*^9, 3.582676292040473*^9}, {3.589299275215334*^9, 
   3.589299276871471*^9}, {3.5894735627453117`*^9, 3.589473747565434*^9}, {
   3.5894737984212646`*^9, 3.589473800825018*^9}, 3.589473836508107*^9, {
   3.58947389839431*^9, 3.5894740827498093`*^9}, {3.589475328368573*^9, 
   3.589475346401663*^9}, {3.590522057342185*^9, 3.590522057548717*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"To", " ", "get", " ", "the", " ", "signal"}], ",", " ", 
    RowBox[{
    "we", " ", "rotate", " ", "the", " ", "pump", " ", "vector", " ", "about",
      " ", "X", " ", "by", " ", 
     SubscriptBox["\[Theta]", "s"]}], ",", " ", 
    RowBox[{"then", " ", "about", " ", "Z", " ", "by", " ", 
     SubscriptBox["\[Phi]", "s"]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"rulescoord", " ", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Theta]", "s"], "\[Rule]", 
        SubscriptBox["\[Theta]", "i"]}], ",", "  ", 
       RowBox[{
        SubscriptBox["\[Phi]", "s"], " ", "\[Rule]", "  ", 
        RowBox[{
         SubscriptBox["\[Phi]", "s"], "+", "\[Pi]"}]}]}], " ", "}"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rulescoord2", " ", "=", "  ", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["\[Phi]", "ss"], "\[Rule]", " ", 
       SubscriptBox["\[Phi]", "s"]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"planarrules", " ", ":=", " ", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["\[Phi]", "s"], " ", "\[Rule]", " ", "0"}], "}"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"rulescoord2", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["\[Phi]", "ss"], " ", "\[Rule]", " ", 
        SubscriptBox["\[Phi]", "i"]}], "}"}]}], ";"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xs", " ", "=", " ", 
     RowBox[{"Rz", "[", 
      RowBox[{
       SubscriptBox["\[Phi]", "s"], ",", 
       RowBox[{"Rx", "[", 
        RowBox[{
         SubscriptBox["\[Theta]", "s"], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ys", " ", "=", " ", 
     RowBox[{"Rz", "[", 
      RowBox[{
       SubscriptBox["\[Phi]", "s"], ",", 
       RowBox[{"Rx", "[", 
        RowBox[{
         SubscriptBox["\[Theta]", "s"], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"zs", " ", "=", " ", 
     RowBox[{"Rz", "[", 
      RowBox[{
       SubscriptBox["\[Phi]", "s"], ",", 
       RowBox[{"Rx", "[", 
        RowBox[{
         SubscriptBox["\[Theta]", "s"], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vect", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      SubscriptBox["x", "s"], "=", 
      RowBox[{"xs", ".", "vect"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["y", "s"], "=", " ", 
      RowBox[{"ys", ".", "vect"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["z", "s"], "=", 
      RowBox[{"zs", ".", "vect"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["x", "i"], " ", "=", " ", 
      RowBox[{
       RowBox[{
        SubscriptBox["x", 
         RowBox[{"s", " "}]], "/.", 
        RowBox[{"rulescoord", "\[IndentingNewLine]", 
         SubscriptBox["y", "i"]}]}], "=", " ", 
       RowBox[{
        RowBox[{
         SubscriptBox["y", 
          RowBox[{"s", " "}]], "/.", 
         RowBox[{"rulescoord", "\[IndentingNewLine]", 
          SubscriptBox["z", "i"]}]}], "=", " ", 
        RowBox[{
         RowBox[{
          SubscriptBox["z", 
           RowBox[{"s", " "}]], "/.", 
          RowBox[{
          "rulescoord", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           SubscriptBox["x", "p"]}]}], " ", "=", " ", 
         RowBox[{"x", " ", "-", " ", 
          RowBox[{
           SubscriptBox["\[Rho]", "px"], "*", "z"}]}]}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["y", "p"], "=", " ", "y"}], ";"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["x", "s"], "=", "x"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["y", "s"], "=", " ", "y"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["z", "s"], "=", " ", "z"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["x", "i"], "=", "x"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["y", "i"], "=", " ", "y"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["z", "i"], "=", " ", "z"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["x", "p"], "=", "x"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["y", "p"], "=", " ", "y"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["z", "p"], "=", " ", "z"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Introduce", " ", "the", " ", "assumption", " ", "that", " ", "the", " ", 
     "Rayleigh", " ", "range", " ", "is", " ", "much", " ", "longer", " ", 
     "than", " ", "the", " ", "crystal", " ", "length", " ", "and", " ", 
     "the", " ", "waist", " ", "can", " ", "be", " ", "treated", " ", "as", 
     " ", "a", " ", 
     RowBox[{"constant", ".", " ", "This"}], " ", "dramatically", " ", 
     "simplifies", " ", 
     RowBox[{"things", "."}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"rules2", " ", ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SubscriptBox["q", "p"], " ", "\[Rule]", " ", 
        SuperscriptBox[
         SubscriptBox["W", "p"], "2"]}], " ", ",", " ", 
       RowBox[{
        SubscriptBox["q", "s"], " ", "\[Rule]", " ", 
        SuperscriptBox[
         SubscriptBox["W", "s"], "2"]}], " ", ",", " ", 
       RowBox[{
        SubscriptBox["q", "i"], " ", "\[Rule]", " ", 
        SuperscriptBox[
         SubscriptBox["W", "i"], "2"]}], ",", "  ", 
       RowBox[{
        SubscriptBox["\[Theta]", "s"], " ", "\[Rule]", " ", 
        RowBox[{"0", "*", 
         RowBox[{"\[Pi]", "/", "180"}]}]}], ",", " ", 
       RowBox[{
        SubscriptBox["\[Theta]", "i"], " ", "\[Rule]", 
        RowBox[{"0", "*", 
         RowBox[{"\[Pi]", "/", "180"}]}]}]}], " ", "}"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"rules2", " ", ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          SubscriptBox["q", "ppp"], " ", "\[Rule]", " ", 
          SuperscriptBox[
           SubscriptBox["W", "ppp"], "2"]}], " ", ",", " ", 
         RowBox[{
          SubscriptBox["q", "s"], " ", "\[Rule]", " ", 
          SuperscriptBox[
           SubscriptBox["W", "s"], "2"]}], " ", ",", " ", 
         RowBox[{
          SubscriptBox["q", "i"], " ", "\[Rule]", " ", 
          SuperscriptBox[
           SubscriptBox["W", "i"], "2"]}]}], " ", "}"}], "\n", " ", 
       "rules2"}], " ", ":=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SubscriptBox["q", "ppp"], " ", "\[Rule]", " ", 
         SuperscriptBox[
          SubscriptBox["W", "ppp"], "2"]}], " ", ",", " ", 
        RowBox[{
         SubscriptBox["q", "s"], " ", "\[Rule]", " ", 
         SuperscriptBox[
          SubscriptBox["W", "s"], "2"]}], " ", ",", " ", 
        RowBox[{
         SubscriptBox["q", "i"], " ", "\[Rule]", " ", 
         SuperscriptBox[
          SubscriptBox["W", "s"], "2"]}]}], " ", "}"}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"rules2", " ", ":=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SubscriptBox["q", "ppp"], " ", "\[Rule]", " ", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["W", "ppp"], "2"], " ", "+", " ", 
        RowBox[{"2", "*", "\[ImaginaryI]", "*", 
         RowBox[{"z", "/", 
          SubscriptBox["k", "ppp"]}]}]}]}], ",", " ", 
      RowBox[{
       SubscriptBox["q", "s"], " ", "\[Rule]", " ", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["W", "s"], "2"], " ", "-", " ", 
        RowBox[{"2", "*", "\[ImaginaryI]", "*", 
         RowBox[{"z", "/", 
          SubscriptBox["k", "s"]}]}]}]}], ",", " ", 
      RowBox[{
       SubscriptBox["q", "i"], " ", "\[Rule]", " ", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["W", "i"], "2"], " ", "-", " ", 
        RowBox[{"2", "*", "\[ImaginaryI]", "*", 
         RowBox[{"z", "/", 
          SubscriptBox["k", "i"]}]}]}]}]}], "}"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"rulesq", " ", ":=", " ", "rules2"}], "\[IndentingNewLine]", 
   RowBox[{"rulesanlge", " ", ":=", " ", 
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Theta]", "s"], " ", "\[Rule]", " ", 
       RowBox[{"0", "*", 
        RowBox[{"\[Pi]", "/", "180"}]}]}], ",", " ", 
      RowBox[{
       SubscriptBox["\[Theta]", "i"], " ", "\[Rule]", 
       RowBox[{"0", "*", 
        RowBox[{"\[Pi]", "/", "180"}]}]}]}], "}"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["n", "s"], " ", "=", " ", 
     RowBox[{
      RowBox[{
       SubscriptBox["W", "s"], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"\[Pi]", "*", "2"}], "]"}], "*", 
         SubscriptBox["q", "s"]}], ")"}]}], " ", "//.", "rules2"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["n", "i"], " ", "=", " ", 
     RowBox[{
      RowBox[{
       SubscriptBox["W", "i"], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"\[Pi]", "*", "2"}], "]"}], "*", 
         SubscriptBox["q", "i"]}], ")"}]}], " ", "//.", "rules2"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["n", "ppp"], " ", "=", " ", 
     RowBox[{
      RowBox[{
       SubscriptBox["W", "ppp"], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"\[Pi]", "*", "2"}], "]"}], "*", 
         SubscriptBox["q", "ppp"]}], ")"}]}], " ", "//.", " ", "rules2"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.582676438761138*^9, 3.582676528731468*^9}, {
   3.582676729795623*^9, 3.5826767327704906`*^9}, {3.589231298763981*^9, 
   3.589231302850792*^9}, {3.589301582840025*^9, 3.589301588609139*^9}, {
   3.589301902546296*^9, 3.589301935466913*^9}, {3.5893022782276497`*^9, 
   3.5893022799150763`*^9}, {3.589687578090417*^9, 3.589687579149075*^9}, {
   3.590521728478033*^9, 3.5905217643020144`*^9}, {3.590521800795985*^9, 
   3.590521909782888*^9}, {3.590522130031143*^9, 3.590522170299871*^9}, {
   3.590522299406642*^9, 3.590522487105804*^9}, 3.590522523544599*^9, {
   3.590522563902389*^9, 3.590522620237356*^9}, {3.590522657840081*^9, 
   3.590522738247343*^9}, {3.5905228769892*^9, 3.5905228809800663`*^9}, {
   3.590523000355813*^9, 3.590523004506609*^9}, {3.590523561758151*^9, 
   3.59052357123062*^9}, {3.590524142763977*^9, 3.590524235646515*^9}, {
   3.590524266636819*^9, 3.59052431042937*^9}, {3.590525182345914*^9, 
   3.590525193486434*^9}, {3.590526011602631*^9, 3.5905260146674767`*^9}, {
   3.5905307140862923`*^9, 3.590530718259025*^9}, {3.590693720364143*^9, 
   3.5906937205398617`*^9}, {3.5922745689175863`*^9, 3.592274654691163*^9}, {
   3.592274695064767*^9, 3.592274712904697*^9}, {3.5922747455507517`*^9, 
   3.592274818734551*^9}, {3.5922748535620213`*^9, 3.592274935686894*^9}, {
   3.592275557273614*^9, 3.5922756262592573`*^9}}],

Cell[BoxData["x"], "Output",
 CellChangeTimes->{{3.590524143405465*^9, 3.590524169368422*^9}, 
   3.590524220699346*^9, 3.590524259796801*^9, {3.590524296815311*^9, 
   3.590524333063119*^9}, 3.590525194450962*^9, 3.590526016423937*^9, 
   3.590530719572781*^9, 3.5906937215960827`*^9, {3.592274941076507*^9, 
   3.5922749440411053`*^9}, 3.592275319271544*^9, 3.592275558734556*^9, 
   3.5922756271923933`*^9}],

Cell[BoxData["x"], "Output",
 CellChangeTimes->{{3.590524143405465*^9, 3.590524169368422*^9}, 
   3.590524220699346*^9, 3.590524259796801*^9, {3.590524296815311*^9, 
   3.590524333063119*^9}, 3.590525194450962*^9, 3.590526016423937*^9, 
   3.590530719572781*^9, 3.5906937215960827`*^9, {3.592274941076507*^9, 
   3.5922749440411053`*^9}, 3.592275319271544*^9, 3.592275558734556*^9, 
   3.592275627193761*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Here", " ", "is", " ", "the", " ", "argument", " ", "in", " ", "the", 
     " ", "exponential", " ", "that", " ", "we", " ", "will", " ", "want", 
     " ", "to", " ", "integrate", " ", "over", " ", "wrt", " ", "to", " ", 
     "x"}], ",", " ", "y", ",", " ", 
    RowBox[{"and", " ", 
     RowBox[{"z", "."}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Arg1", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "1"}], "/", 
       RowBox[{"(", 
        RowBox[{"2", "*", 
         SubscriptBox["q", "s"]}], ")"}]}], "*", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["x", "s"], "2"], "+", 
        SuperscriptBox[
         SubscriptBox["y", "s"], "2"]}], ")"}]}], "-", 
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{"2", "*", 
         SubscriptBox["q", "i"]}], ")"}]}], 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["x", "i"], "2"], "+", 
        SuperscriptBox[
         SubscriptBox["y", "i"], "2"]}], ")"}]}], "-", 
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{"2", "*", 
         SubscriptBox["q", "ppp"]}], ")"}]}], "*", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["x", "p"], "2"], "+", 
        SuperscriptBox[
         SubscriptBox["y", "p"], "2"]}], ")"}]}], " ", "-", " ", 
     RowBox[{"\[ImaginaryI]", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[CapitalDelta]K", "x"], "*", "x"}], " ", "+", " ", 
        RowBox[{
         SubscriptBox["\[CapitalDelta]K", "y"], "*", "y"}], "+", 
        RowBox[{
         SubscriptBox["\[CapitalDelta]K", "z"], "*", "z"}]}], ")"}]}]}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.5825533941941223`*^9, 3.5825535539588547`*^9}, {
   3.5825536033128633`*^9, 3.582553608767806*^9}, 3.582553712131874*^9, {
   3.582553783669939*^9, 3.58255382316961*^9}, {3.582561756372466*^9, 
   3.582561771923471*^9}, 3.582561807119581*^9, {3.582562474614017*^9, 
   3.582562499613974*^9}, {3.582582135209609*^9, 3.5825821366901712`*^9}, {
   3.582600600836162*^9, 3.5826006048984003`*^9}, {3.582676452509242*^9, 
   3.582676454063005*^9}, 3.589299256121154*^9, 3.589299487656785*^9, {
   3.589301942732774*^9, 3.58930196123344*^9}, {3.589302272043653*^9, 
   3.589302274307569*^9}, 3.5905228696729*^9, {3.590522953456752*^9, 
   3.590522994943686*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     SuperscriptBox["x", "2"], "+", 
     SuperscriptBox["y", "2"]}], 
    RowBox[{"2", " ", 
     SubscriptBox["q", "i"]}]]}], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["x", "2"], "+", 
    SuperscriptBox["y", "2"]}], 
   RowBox[{"2", " ", 
    SubscriptBox["q", "ppp"]}]], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["x", "2"], "+", 
    SuperscriptBox["y", "2"]}], 
   RowBox[{"2", " ", 
    SubscriptBox["q", "s"]}]], "-", 
  RowBox[{"\[ImaginaryI]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"x", " ", 
      SubscriptBox["\[CapitalDelta]K", "x"]}], "+", 
     RowBox[{"y", " ", 
      SubscriptBox["\[CapitalDelta]K", "y"]}], "+", 
     RowBox[{"z", " ", 
      SubscriptBox["\[CapitalDelta]K", "z"]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.590522910768602*^9, 3.590523012386057*^9}, 
   3.5905243407346573`*^9, 3.590524383798437*^9, 3.5905251996470623`*^9, 
   3.5905260225081387`*^9, 3.590530724903821*^9, {3.590693730616989*^9, 
   3.590693731946981*^9}, 3.592274946338991*^9, 3.59227563115767*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "First", " ", "we", " ", "complete", " ", "the", " ", "square", " ", "wrt",
     " ", "to", " ", 
    RowBox[{"x", ".", " ", "This"}], " ", "makes", " ", "it", " ", "easier", 
    " ", "to", " ", "analytically", " ", "carry", " ", "out", " ", "the", " ", 
    RowBox[{"integration", "."}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Arg1", " ", "=", " ", 
     RowBox[{"CompleteSquare", "[", 
      RowBox[{"Arg1", ",", " ", "x"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"cx", ",", "bx", ",", "ax"}], "}"}], "=", 
     RowBox[{"CoefficientList", "[", 
      RowBox[{"Arg1", ",", "x"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"yzcoeff", " ", "=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{"(", 
       RowBox[{"cx", "-", 
        RowBox[{
         RowBox[{
          RowBox[{"bx", "^", "2"}], "/", "4"}], "/", "ax"}]}], ")"}], "]"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{"coeffx", " ", "=", "ax"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Now", " ", "complete", " ", "the", " ", "square", " ", "for", " ", "yz", 
     " ", "remainder", " ", "with", " ", "respect", " ", "to", " ", "y"}], 
    "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Arg2", " ", "=", " ", 
     RowBox[{"CompleteSquare", "[", 
      RowBox[{"yzcoeff", ",", " ", "y"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"cy", ",", "by", ",", "ay"}], "}"}], "=", 
     RowBox[{"CoefficientList", "[", 
      RowBox[{"Arg2", ",", "y"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"coeffy", " ", "=", " ", "ay"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"zint", " ", "=", "  ", 
     RowBox[{"Simplify", "[", 
      RowBox[{"(", 
       RowBox[{"cy", "-", 
        RowBox[{
         RowBox[{
          RowBox[{"by", "^", "2"}], "/", "4"}], "/", "ay"}]}], ")"}], "]"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Assuming", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox["q", "i"], ">", "0"}], " ", "&&", " ", 
       RowBox[{
        SubscriptBox["q", "s"], ">", "0"}], " ", "&&", " ", 
       RowBox[{
        SubscriptBox["q", "p"], ">", "0"}], " ", "&&", " ", 
       RowBox[{
        SubscriptBox["\[Theta]", "i"], ">", "0"}], " ", "&&", " ", 
       RowBox[{
        SubscriptBox["\[Theta]", "s"], ">", "0"}], " ", "&&", " ", 
       RowBox[{
        SubscriptBox["\[CapitalDelta]K", "x"], " ", ">", "0"}], " ", "&&", 
       " ", 
       RowBox[{
        SubscriptBox["\[CapitalDelta]K", "y"], " ", ">", "0"}], " ", "&&", 
       " ", 
       RowBox[{
        SubscriptBox["\[CapitalDelta]K", "z"], ">", "0"}], " ", "&&", 
       RowBox[{"y", ">", "0"}], " ", "&&", 
       RowBox[{"z", ">", "0"}]}], ",", " ", 
      RowBox[{"Integrate", "[", " ", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{"-", "zint"}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"z", ",", " ", 
          RowBox[{"-", "\[Infinity]"}], ",", " ", "\[Infinity]"}], "}"}]}], 
       "]"}]}], "]"}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.5825537185392857`*^9, 3.582553738312705*^9}, {
   3.582582174512424*^9, 3.582582196639732*^9}, {3.589299359249379*^9, 
   3.58929940769029*^9}, {3.589299706788805*^9, 3.589299953474846*^9}, {
   3.589300074213222*^9, 3.5893001254984083`*^9}, {3.589300366692685*^9, 
   3.589300470243595*^9}, {3.589300526730879*^9, 3.589300583491335*^9}, {
   3.5893006199514933`*^9, 3.589300807810451*^9}, {3.589300973245274*^9, 
   3.5893010229373007`*^9}, {3.5893025507863827`*^9, 3.589302556458641*^9}, 
   3.5905230261463614`*^9, {3.590523088364869*^9, 3.5905231894911213`*^9}, {
   3.59052336261027*^9, 3.590523375831769*^9}, 3.590523584110681*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", 
    RowBox[{"2", " ", 
     SubscriptBox["q", "i"]}]]}], "-", 
  FractionBox["1", 
   RowBox[{"2", " ", 
    SubscriptBox["q", "ppp"]}]], "-", 
  FractionBox["1", 
   RowBox[{"2", " ", 
    SubscriptBox["q", "s"]}]]}]], "Output",
 CellChangeTimes->{{3.590523143400434*^9, 3.590523189988976*^9}, 
   3.59052338226554*^9, 3.590523592996015*^9, 3.590524349794345*^9, 
   3.590524391063881*^9, 3.590525213368106*^9, 3.590526030380559*^9, {
   3.590530732103161*^9, 3.5905307526983128`*^9}, {3.590693752217005*^9, 
   3.590693775887917*^9}, 3.592274961261918*^9, 3.5922756390146503`*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.5892997322432404`*^9, 3.589299732949974*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "The", " ", "x", " ", "and", " ", "y", " ", "integrals", " ", "reduce", 
    " ", "to", " ", "the", " ", "following", " ", "constants"}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"xconst", "=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Sqrt]", "\[Pi]"}], "/", 
        RowBox[{"\[Sqrt]", 
         RowBox[{"(", 
          RowBox[{"-", "coeffx"}], ")"}]}]}], " ", "//.", "rules2"}], "]"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"yconst", "=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Sqrt]", "\[Pi]"}], "/", 
        RowBox[{"\[Sqrt]", 
         RowBox[{"(", 
          RowBox[{"-", "coeffy"}], ")"}]}]}], " ", "//.", "rules2"}], "]"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xonst", " ", "=", " ", 
     RowBox[{"xconst", " ", "/.", " ", "rulesq"}]}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"yconst", " ", "=", " ", 
     RowBox[{"yconst", " ", "/.", "rulesq"}]}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"zint", " ", "=", 
     RowBox[{"Simplify", "[", " ", 
      RowBox[{"zint", " ", "/.", " ", "rulesq"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Zexpress", " ", "=", 
     RowBox[{"Exp", "[", "zint", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{"ComplexExpand", "[", 
     RowBox[{"Re", "[", "zint", "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{"ComplexExpand", "[", 
     RowBox[{"Im", "[", "zint", "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"norm", " ", "=", " ", 
     RowBox[{"xconst", "*", "yconst", "*", 
      SubscriptBox["n", "s"], "*", 
      SubscriptBox["n", "i"], "*", 
      SubscriptBox["n", "ppp"]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{"ComplexExpand", "[", 
     RowBox[{"Re", "[", "norm", "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{"ComplexExpand", "[", 
     RowBox[{"Im", "[", "norm", "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "This", " ", "leaves", " ", "us", " ", "with", " ", "just", " ", "the", 
     " ", "z", " ", 
     RowBox[{"integral", ".", " ", "Find"}], " ", "the", " ", "coefficients", 
     " ", "so", " ", "we", " ", "can", " ", "plug", " ", "it", " ", "into", 
     " ", "our", " ", "solved", " ", "integral", " ", "form"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"az", ",", " ", "bz", ",", "cz"}], "}"}], "=", 
      RowBox[{"CoefficientList", "[", " ", 
       RowBox[{"zint", ",", "z"}], "]"}]}], " ", ";", "\[IndentingNewLine]", 
     RowBox[{"AA", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Simplify", "[", 
         RowBox[{"-", "az"}], "]"}], "\[IndentingNewLine]", "BB"}], " ", "=", 
       " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Simplify", "[", 
          RowBox[{"-", "bz"}], "]"}], "\[IndentingNewLine]", "CC"}], " ", "=",
         " ", 
        RowBox[{"Simplify", "[", 
         RowBox[{"-", "cz"}], "]"}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.5825538416732683`*^9, 3.5825540262026253`*^9}, {
   3.582554070185461*^9, 3.58255407764716*^9}, 3.5825618686585283`*^9, 
   3.5825619031644173`*^9, {3.582582212811741*^9, 3.5825822216126223`*^9}, {
   3.582598740623023*^9, 3.5825987588152237`*^9}, 3.582598791694824*^9, 
   3.5826007798659353`*^9, {3.582600814519813*^9, 3.5826010290448103`*^9}, 
   3.582601333150104*^9, 3.5826014723118773`*^9, {3.582672389928055*^9, 
   3.5826724027171583`*^9}, {3.582674796730681*^9, 3.5826747992116013`*^9}, 
   3.5891463574943027`*^9, {3.5892291069528646`*^9, 3.5892291279266253`*^9}, 
   3.589299315272929*^9, {3.5892994199671593`*^9, 3.589299433917345*^9}, {
   3.589300836392149*^9, 3.589300943644602*^9}, {3.589301033831832*^9, 
   3.589301125570545*^9}, {3.589301176199456*^9, 3.5893011811906357`*^9}, {
   3.58930126916422*^9, 3.5893013256175747`*^9}, {3.589301359370359*^9, 
   3.589301389325317*^9}, {3.589302013723062*^9, 3.589302017465081*^9}, {
   3.589302076689983*^9, 3.589302138029945*^9}, {3.589302168188575*^9, 
   3.589302250597705*^9}, 3.589302338688246*^9, {3.589302401133462*^9, 
   3.589302409057458*^9}, {3.589302686030478*^9, 3.5893027019333267`*^9}, {
   3.589302734154758*^9, 3.5893027372989063`*^9}, {3.589302777895915*^9, 
   3.589302795645793*^9}, {3.589302948609424*^9, 3.58930297384866*^9}, {
   3.589303285661346*^9, 3.589303363589128*^9}, {3.589303473996633*^9, 
   3.589303482212236*^9}, {3.589303735528884*^9, 3.589303740601049*^9}, {
   3.589303947560666*^9, 3.589303953147936*^9}, 3.5893040110316067`*^9, {
   3.589310529899806*^9, 3.5893105385782003`*^9}, {3.5893105908829403`*^9, 
   3.589310687782134*^9}, {3.589310768063574*^9, 3.589310891354974*^9}, {
   3.589310960638303*^9, 3.589310990026972*^9}, 3.5893112701563873`*^9, {
   3.590523413863852*^9, 3.590523415430471*^9}, {3.5905239933074703`*^9, 
   3.5905240292587843`*^9}, {3.590524432754696*^9, 3.590524439607706*^9}, {
   3.590524976308745*^9, 3.5905249835840483`*^9}, {3.5905250784201393`*^9, 
   3.590525091618764*^9}, {3.590537426599852*^9, 3.590537465847196*^9}, {
   3.5906936455905027`*^9, 3.590693647439126*^9}, {3.5906993142373867`*^9, 
   3.5906993154753933`*^9}, {3.5922749951194696`*^9, 
   3.5922750721452827`*^9}, {3.592275115655408*^9, 3.592275172003324*^9}, {
   3.592275209571595*^9, 3.5922752141966343`*^9}, {3.5922753006817617`*^9, 
   3.5922754118171167`*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", 
        SuperscriptBox["z", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", 
           SuperscriptBox["z", "2"], " ", 
           SubsuperscriptBox["k", "s", "2"], " ", 
           SubsuperscriptBox["W", "s", "2"]}], "+", 
          RowBox[{
           SubsuperscriptBox["k", "ppp", "2"], " ", 
           SubsuperscriptBox["W", "ppp", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", " ", 
              SuperscriptBox["z", "2"]}], "+", 
             RowBox[{
              SubsuperscriptBox["k", "s", "2"], " ", 
              SubsuperscriptBox["W", "s", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                SubsuperscriptBox["W", "ppp", "2"], "+", 
                SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}], "+", 
       RowBox[{
        SubsuperscriptBox["k", "i", "2"], " ", 
        SubsuperscriptBox["W", "i", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", 
           SuperscriptBox["z", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", " ", 
              SuperscriptBox["z", "2"]}], "+", 
             RowBox[{
              SubsuperscriptBox["k", "s", "2"], " ", 
              SubsuperscriptBox["W", "s", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                SubsuperscriptBox["W", "i", "2"], "+", 
                SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SubsuperscriptBox["k", "ppp", "2"], " ", 
           SubsuperscriptBox["W", "ppp", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SubsuperscriptBox["W", "ppp", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"4", " ", 
                 SuperscriptBox["z", "2"]}], "+", 
                RowBox[{
                 SubsuperscriptBox["k", "s", "2"], " ", 
                 SubsuperscriptBox["W", "s", "4"]}]}], ")"}]}], "+", 
             RowBox[{
              SubsuperscriptBox["W", "i", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"4", " ", 
                 SuperscriptBox["z", "2"]}], "+", 
                RowBox[{
                 SubsuperscriptBox["k", "s", "2"], " ", 
                 SubsuperscriptBox["W", "s", "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   SubsuperscriptBox["W", "ppp", "2"], "+", 
                   SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}], ")"}]}]}], 
            ")"}]}]}], ")"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SubsuperscriptBox["\[CapitalDelta]K", "x", "2"], "+", 
       SubsuperscriptBox["\[CapitalDelta]K", "y", "2"]}], ")"}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"8", " ", 
        SuperscriptBox["z", "2"], " ", 
        SubscriptBox["k", "i"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", 
           SuperscriptBox["z", "2"], " ", 
           SubscriptBox["k", "s"]}], "+", 
          RowBox[{
           SubsuperscriptBox["k", "ppp", "2"], " ", 
           SubscriptBox["k", "s"], " ", 
           SubsuperscriptBox["W", "ppp", "4"]}], "-", 
          RowBox[{
           SubscriptBox["k", "ppp"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", " ", 
              SuperscriptBox["z", "2"]}], "+", 
             RowBox[{
              SubsuperscriptBox["k", "s", "2"], " ", 
              SubsuperscriptBox["W", "s", "4"]}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["z", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "8"}], " ", 
           SuperscriptBox["z", "2"], " ", 
           SubscriptBox["k", "ppp"], " ", 
           SubscriptBox["k", "s"]}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["z", "2"], " ", 
           SubsuperscriptBox["k", "s", "2"]}], "+", 
          RowBox[{
           SubsuperscriptBox["k", "ppp", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", " ", 
              SuperscriptBox["z", "2"]}], "+", 
             RowBox[{
              SubsuperscriptBox["k", "s", "2"], " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SubsuperscriptBox["W", "ppp", "2"], "+", 
                 SubsuperscriptBox["W", "s", "2"]}], ")"}], "2"]}]}], 
            ")"}]}]}], ")"}]}], "+", 
       RowBox[{
        SubsuperscriptBox["k", "i", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "8"}], " ", 
           SuperscriptBox["z", "2"], " ", 
           SubscriptBox["k", "ppp"], " ", 
           SubscriptBox["k", "s"], " ", 
           SubsuperscriptBox["W", "i", "4"]}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["z", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", " ", 
              SuperscriptBox["z", "2"]}], "+", 
             RowBox[{
              SubsuperscriptBox["k", "s", "2"], " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SubsuperscriptBox["W", "i", "2"], "+", 
                 SubsuperscriptBox["W", "s", "2"]}], ")"}], "2"]}]}], ")"}]}],
           "+", 
          RowBox[{
           SubsuperscriptBox["k", "ppp", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SubsuperscriptBox["W", "ppp", "4"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"4", " ", 
                 SuperscriptBox["z", "2"]}], "+", 
                RowBox[{
                 SubsuperscriptBox["k", "s", "2"], " ", 
                 SubsuperscriptBox["W", "s", "4"]}]}], ")"}]}], "+", 
             RowBox[{"2", " ", 
              SubsuperscriptBox["W", "i", "2"], " ", 
              SubsuperscriptBox["W", "ppp", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"4", " ", 
                 SuperscriptBox["z", "2"]}], "+", 
                RowBox[{
                 SubsuperscriptBox["k", "s", "2"], " ", 
                 SubsuperscriptBox["W", "s", "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   SubsuperscriptBox["W", "ppp", "2"], "+", 
                   SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}], ")"}]}], 
             "+", 
             RowBox[{
              SubsuperscriptBox["W", "i", "4"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"4", " ", 
                 SuperscriptBox["z", "2"]}], "+", 
                RowBox[{
                 SubsuperscriptBox["k", "s", "2"], " ", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SubsuperscriptBox["W", "ppp", "2"], "+", 
                    SubsuperscriptBox["W", "s", "2"]}], ")"}], "2"]}]}], 
               ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], ")"}]}]}]], "Output",\

 CellChangeTimes->{{3.592275003107293*^9, 3.5922750726408043`*^9}, {
   3.59227511924443*^9, 3.592275136407569*^9}, 3.592275172423059*^9, 
   3.592275215306522*^9, {3.592275335712215*^9, 3.5922754128220253`*^9}, 
   3.592275642966074*^9}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"z", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         SubscriptBox["k", "i"]}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", " ", 
              SuperscriptBox["z", "2"]}], "+", 
             RowBox[{
              SubsuperscriptBox["k", "ppp", "2"], " ", 
              SubsuperscriptBox["W", "ppp", "4"]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", " ", 
              SuperscriptBox["z", "2"]}], "+", 
             RowBox[{
              SubsuperscriptBox["k", "s", "2"], " ", 
              SubsuperscriptBox["W", "s", "4"]}]}], ")"}], " ", 
           SubsuperscriptBox["\[CapitalDelta]K", "x", "2"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", " ", 
              SuperscriptBox["z", "2"]}], "+", 
             RowBox[{
              SubsuperscriptBox["k", "ppp", "2"], " ", 
              SubsuperscriptBox["W", "ppp", "4"]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", " ", 
              SuperscriptBox["z", "2"]}], "+", 
             RowBox[{
              SubsuperscriptBox["k", "s", "2"], " ", 
              SubsuperscriptBox["W", "s", "4"]}]}], ")"}], " ", 
           SubsuperscriptBox["\[CapitalDelta]K", "y", "2"]}], "+", 
          RowBox[{"8", " ", 
           SuperscriptBox["z", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "4"}], " ", 
              SuperscriptBox["z", "2"], " ", 
              SubscriptBox["k", "s"]}], "-", 
             RowBox[{
              SubsuperscriptBox["k", "ppp", "2"], " ", 
              SubscriptBox["k", "s"], " ", 
              SubsuperscriptBox["W", "ppp", "4"]}], "+", 
             RowBox[{
              SubscriptBox["k", "ppp"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"4", " ", 
                 SuperscriptBox["z", "2"]}], "+", 
                RowBox[{
                 SubsuperscriptBox["k", "s", "2"], " ", 
                 SubsuperscriptBox["W", "s", "4"]}]}], ")"}]}]}], ")"}], " ", 
           
           SubscriptBox["\[CapitalDelta]K", "z"]}]}], ")"}]}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["z", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", 
           SuperscriptBox["z", "2"], " ", 
           SubscriptBox["k", "s"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              SubsuperscriptBox["\[CapitalDelta]K", "x", "2"]}], "-", 
             SubsuperscriptBox["\[CapitalDelta]K", "y", "2"], "+", 
             RowBox[{
              SubscriptBox["k", "s"], " ", 
              SubscriptBox["\[CapitalDelta]K", "z"]}]}], ")"}]}], "+", 
          RowBox[{
           SubscriptBox["k", "ppp"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"4", " ", 
                 SuperscriptBox["z", "2"]}], "+", 
                RowBox[{
                 SubsuperscriptBox["k", "s", "2"], " ", 
                 SubsuperscriptBox["W", "s", "4"]}]}], ")"}], " ", 
              SubsuperscriptBox["\[CapitalDelta]K", "x", "2"]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"4", " ", 
                 SuperscriptBox["z", "2"]}], "+", 
                RowBox[{
                 SubsuperscriptBox["k", "s", "2"], " ", 
                 SubsuperscriptBox["W", "s", "4"]}]}], ")"}], " ", 
              SubsuperscriptBox["\[CapitalDelta]K", "y", "2"]}], "-", 
             RowBox[{"8", " ", 
              SuperscriptBox["z", "2"], " ", 
              SubscriptBox["k", "s"], " ", 
              SubscriptBox["\[CapitalDelta]K", "z"]}]}], ")"}]}], "+", 
          RowBox[{
           SubsuperscriptBox["k", "ppp", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               SubscriptBox["k", "s"]}], " ", 
              SubsuperscriptBox["W", "ppp", "4"], " ", 
              RowBox[{"(", 
               RowBox[{
                SubsuperscriptBox["\[CapitalDelta]K", "x", "2"], "+", 
                SubsuperscriptBox["\[CapitalDelta]K", "y", "2"]}], ")"}]}], 
             "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["z", "2"], " ", 
              SubscriptBox["\[CapitalDelta]K", "z"]}], "+", 
             RowBox[{
              SubsuperscriptBox["k", "s", "2"], " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SubsuperscriptBox["W", "ppp", "2"], "+", 
                 SubsuperscriptBox["W", "s", "2"]}], ")"}], "2"], " ", 
              SubscriptBox["\[CapitalDelta]K", "z"]}]}], ")"}]}]}], ")"}]}], 
       "+", 
       RowBox[{
        SubsuperscriptBox["k", "i", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["k", "ppp"], " ", 
           SubsuperscriptBox["W", "i", "4"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"4", " ", 
                 SuperscriptBox["z", "2"]}], "+", 
                RowBox[{
                 SubsuperscriptBox["k", "s", "2"], " ", 
                 SubsuperscriptBox["W", "s", "4"]}]}], ")"}], " ", 
              SubsuperscriptBox["\[CapitalDelta]K", "x", "2"]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"4", " ", 
                 SuperscriptBox["z", "2"]}], "+", 
                RowBox[{
                 SubsuperscriptBox["k", "s", "2"], " ", 
                 SubsuperscriptBox["W", "s", "4"]}]}], ")"}], " ", 
              SubsuperscriptBox["\[CapitalDelta]K", "y", "2"]}], "-", 
             RowBox[{"8", " ", 
              SuperscriptBox["z", "2"], " ", 
              SubscriptBox["k", "s"], " ", 
              SubscriptBox["\[CapitalDelta]K", "z"]}]}], ")"}]}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["z", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               SubscriptBox["k", "s"]}], " ", 
              SubsuperscriptBox["W", "i", "4"], " ", 
              RowBox[{"(", 
               RowBox[{
                SubsuperscriptBox["\[CapitalDelta]K", "x", "2"], "+", 
                SubsuperscriptBox["\[CapitalDelta]K", "y", "2"]}], ")"}]}], 
             "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["z", "2"], " ", 
              SubscriptBox["\[CapitalDelta]K", "z"]}], "+", 
             RowBox[{
              SubsuperscriptBox["k", "s", "2"], " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SubsuperscriptBox["W", "i", "2"], "+", 
                 SubsuperscriptBox["W", "s", "2"]}], ")"}], "2"], " ", 
              SubscriptBox["\[CapitalDelta]K", "z"]}]}], ")"}]}], "+", 
          RowBox[{
           SubsuperscriptBox["k", "ppp", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               SubscriptBox["k", "s"]}], " ", 
              SubsuperscriptBox["W", "i", "4"], " ", 
              SubsuperscriptBox["W", "ppp", "4"], " ", 
              RowBox[{"(", 
               RowBox[{
                SubsuperscriptBox["\[CapitalDelta]K", "x", "2"], "+", 
                SubsuperscriptBox["\[CapitalDelta]K", "y", "2"]}], ")"}]}], 
             "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["z", "2"], " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SubsuperscriptBox["W", "i", "2"], "+", 
                 SubsuperscriptBox["W", "ppp", "2"]}], ")"}], "2"], " ", 
              SubscriptBox["\[CapitalDelta]K", "z"]}], "+", 
             RowBox[{
              SubsuperscriptBox["k", "s", "2"], " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SubsuperscriptBox["W", "ppp", "2"], " ", 
                  SubsuperscriptBox["W", "s", "2"]}], "+", 
                 RowBox[{
                  SubsuperscriptBox["W", "i", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    SubsuperscriptBox["W", "ppp", "2"], "+", 
                    SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}], ")"}], 
               "2"], " ", 
              SubscriptBox["\[CapitalDelta]K", "z"]}]}], ")"}]}]}], ")"}]}]}],
       ")"}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"8", " ", 
      SuperscriptBox["z", "2"], " ", 
      SubscriptBox["k", "i"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", " ", 
         SuperscriptBox["z", "2"], " ", 
         SubscriptBox["k", "s"]}], "+", 
        RowBox[{
         SubsuperscriptBox["k", "ppp", "2"], " ", 
         SubscriptBox["k", "s"], " ", 
         SubsuperscriptBox["W", "ppp", "4"]}], "-", 
        RowBox[{
         SubscriptBox["k", "ppp"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", 
            SuperscriptBox["z", "2"]}], "+", 
           RowBox[{
            SubsuperscriptBox["k", "s", "2"], " ", 
            SubsuperscriptBox["W", "s", "4"]}]}], ")"}]}]}], ")"}]}], "+", 
     RowBox[{"4", " ", 
      SuperscriptBox["z", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "8"}], " ", 
         SuperscriptBox["z", "2"], " ", 
         SubscriptBox["k", "ppp"], " ", 
         SubscriptBox["k", "s"]}], "+", 
        RowBox[{"4", " ", 
         SuperscriptBox["z", "2"], " ", 
         SubsuperscriptBox["k", "s", "2"]}], "+", 
        RowBox[{
         SubsuperscriptBox["k", "ppp", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", 
            SuperscriptBox["z", "2"]}], "+", 
           RowBox[{
            SubsuperscriptBox["k", "s", "2"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["W", "ppp", "2"], "+", 
               SubsuperscriptBox["W", "s", "2"]}], ")"}], "2"]}]}], ")"}]}]}],
        ")"}]}], "+", 
     RowBox[{
      SubsuperscriptBox["k", "i", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "8"}], " ", 
         SuperscriptBox["z", "2"], " ", 
         SubscriptBox["k", "ppp"], " ", 
         SubscriptBox["k", "s"], " ", 
         SubsuperscriptBox["W", "i", "4"]}], "+", 
        RowBox[{"4", " ", 
         SuperscriptBox["z", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", 
            SuperscriptBox["z", "2"]}], "+", 
           RowBox[{
            SubsuperscriptBox["k", "s", "2"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["W", "i", "2"], "+", 
               SubsuperscriptBox["W", "s", "2"]}], ")"}], "2"]}]}], ")"}]}], 
        "+", 
        RowBox[{
         SubsuperscriptBox["k", "ppp", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubsuperscriptBox["W", "ppp", "4"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", " ", 
               SuperscriptBox["z", "2"]}], "+", 
              RowBox[{
               SubsuperscriptBox["k", "s", "2"], " ", 
               SubsuperscriptBox["W", "s", "4"]}]}], ")"}]}], "+", 
           RowBox[{"2", " ", 
            SubsuperscriptBox["W", "i", "2"], " ", 
            SubsuperscriptBox["W", "ppp", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", " ", 
               SuperscriptBox["z", "2"]}], "+", 
              RowBox[{
               SubsuperscriptBox["k", "s", "2"], " ", 
               SubsuperscriptBox["W", "s", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 SubsuperscriptBox["W", "ppp", "2"], "+", 
                 SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}], ")"}]}], "+", 
           
           RowBox[{
            SubsuperscriptBox["W", "i", "4"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", " ", 
               SuperscriptBox["z", "2"]}], "+", 
              RowBox[{
               SubsuperscriptBox["k", "s", "2"], " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SubsuperscriptBox["W", "ppp", "2"], "+", 
                  SubsuperscriptBox["W", "s", "2"]}], ")"}], "2"]}]}], 
             ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.592275003107293*^9, 3.5922750726408043`*^9}, {
   3.59227511924443*^9, 3.592275136407569*^9}, 3.592275172423059*^9, 
   3.592275215306522*^9, {3.592275335712215*^9, 3.5922754128220253`*^9}, 
   3.5922756433764687`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    SubscriptBox["k", "i"], " ", 
    SubscriptBox["k", "ppp"], " ", 
    SubscriptBox["k", "s"], " ", 
    SubscriptBox["W", "i"], " ", 
    SubscriptBox["W", "ppp"], " ", 
    SubscriptBox["W", "s"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"4", " ", 
       SuperscriptBox["z", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          SubscriptBox["k", "ppp"]}], "+", 
         SubscriptBox["k", "s"]}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["k", "i"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"4", " ", 
          SuperscriptBox["z", "2"]}], "+", 
         RowBox[{
          SubscriptBox["k", "ppp"], " ", 
          SubscriptBox["k", "s"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SubsuperscriptBox["W", "ppp", "2"], " ", 
             SubsuperscriptBox["W", "s", "2"]}], "+", 
            RowBox[{
             SubsuperscriptBox["W", "i", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["W", "ppp", "2"], "+", 
               SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}], ")"}]}]}], 
        ")"}]}]}], ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    SqrtBox[
     RowBox[{"2", " ", "\[Pi]"}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"8", " ", 
       SuperscriptBox["z", "2"], " ", 
       SubscriptBox["k", "i"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"4", " ", 
          SuperscriptBox["z", "2"], " ", 
          SubscriptBox["k", "s"]}], "+", 
         RowBox[{
          SubsuperscriptBox["k", "ppp", "2"], " ", 
          SubscriptBox["k", "s"], " ", 
          SubsuperscriptBox["W", "ppp", "4"]}], "-", 
         RowBox[{
          SubscriptBox["k", "ppp"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", 
             SuperscriptBox["z", "2"]}], "+", 
            RowBox[{
             SubsuperscriptBox["k", "s", "2"], " ", 
             SubsuperscriptBox["W", "s", "4"]}]}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["z", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "8"}], " ", 
          SuperscriptBox["z", "2"], " ", 
          SubscriptBox["k", "ppp"], " ", 
          SubscriptBox["k", "s"]}], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["z", "2"], " ", 
          SubsuperscriptBox["k", "s", "2"]}], "+", 
         RowBox[{
          SubsuperscriptBox["k", "ppp", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", 
             SuperscriptBox["z", "2"]}], "+", 
            RowBox[{
             SubsuperscriptBox["k", "s", "2"], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubsuperscriptBox["W", "ppp", "2"], "+", 
                SubsuperscriptBox["W", "s", "2"]}], ")"}], "2"]}]}], 
           ")"}]}]}], ")"}]}], "+", 
      RowBox[{
       SubsuperscriptBox["k", "i", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "8"}], " ", 
          SuperscriptBox["z", "2"], " ", 
          SubscriptBox["k", "ppp"], " ", 
          SubscriptBox["k", "s"], " ", 
          SubsuperscriptBox["W", "i", "4"]}], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["z", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", 
             SuperscriptBox["z", "2"]}], "+", 
            RowBox[{
             SubsuperscriptBox["k", "s", "2"], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SubsuperscriptBox["W", "i", "2"], "+", 
                SubsuperscriptBox["W", "s", "2"]}], ")"}], "2"]}]}], ")"}]}], 
         "+", 
         RowBox[{
          SubsuperscriptBox["k", "ppp", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SubsuperscriptBox["W", "ppp", "4"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"4", " ", 
                SuperscriptBox["z", "2"]}], "+", 
               RowBox[{
                SubsuperscriptBox["k", "s", "2"], " ", 
                SubsuperscriptBox["W", "s", "4"]}]}], ")"}]}], "+", 
            RowBox[{"2", " ", 
             SubsuperscriptBox["W", "i", "2"], " ", 
             SubsuperscriptBox["W", "ppp", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"4", " ", 
                SuperscriptBox["z", "2"]}], "+", 
               RowBox[{
                SubsuperscriptBox["k", "s", "2"], " ", 
                SubsuperscriptBox["W", "s", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SubsuperscriptBox["W", "ppp", "2"], "+", 
                  SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}], ")"}]}], "+", 
            RowBox[{
             SubsuperscriptBox["W", "i", "4"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"4", " ", 
                SuperscriptBox["z", "2"]}], "+", 
               RowBox[{
                SubsuperscriptBox["k", "s", "2"], " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubsuperscriptBox["W", "ppp", "2"], "+", 
                   SubsuperscriptBox["W", "s", "2"]}], ")"}], "2"]}]}], 
              ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.592275003107293*^9, 3.5922750726408043`*^9}, {
   3.59227511924443*^9, 3.592275136407569*^9}, 3.592275172423059*^9, 
   3.592275215306522*^9, {3.592275335712215*^9, 3.5922754128220253`*^9}, 
   3.592275643622828*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    SqrtBox[
     FractionBox["2", "\[Pi]"]], " ", "z", " ", 
    SubscriptBox["k", "i"], " ", 
    SubscriptBox["k", "ppp"], " ", 
    SubscriptBox["k", "s"], " ", 
    SubscriptBox["W", "i"], " ", 
    SubscriptBox["W", "ppp"], " ", 
    SubscriptBox["W", "s"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["k", "ppp"], " ", 
       SubscriptBox["k", "s"], " ", 
       RowBox[{"(", 
        RowBox[{
         SubsuperscriptBox["W", "ppp", "2"], "+", 
         SubsuperscriptBox["W", "s", "2"]}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["k", "i"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["k", "ppp"], " ", 
          RowBox[{"(", 
           RowBox[{
            SubsuperscriptBox["W", "i", "2"], "+", 
            SubsuperscriptBox["W", "ppp", "2"]}], ")"}]}], "-", 
         RowBox[{
          SubscriptBox["k", "s"], " ", 
          RowBox[{"(", 
           RowBox[{
            SubsuperscriptBox["W", "i", "2"], "+", 
            SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}], ")"}]}]}], ")"}]}],
    ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"8", " ", 
     SuperscriptBox["z", "2"], " ", 
     SubscriptBox["k", "i"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", 
        SuperscriptBox["z", "2"], " ", 
        SubscriptBox["k", "s"]}], "+", 
       RowBox[{
        SubsuperscriptBox["k", "ppp", "2"], " ", 
        SubscriptBox["k", "s"], " ", 
        SubsuperscriptBox["W", "ppp", "4"]}], "-", 
       RowBox[{
        SubscriptBox["k", "ppp"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", 
           SuperscriptBox["z", "2"]}], "+", 
          RowBox[{
           SubsuperscriptBox["k", "s", "2"], " ", 
           SubsuperscriptBox["W", "s", "4"]}]}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{"4", " ", 
     SuperscriptBox["z", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "8"}], " ", 
        SuperscriptBox["z", "2"], " ", 
        SubscriptBox["k", "ppp"], " ", 
        SubscriptBox["k", "s"]}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["z", "2"], " ", 
        SubsuperscriptBox["k", "s", "2"]}], "+", 
       RowBox[{
        SubsuperscriptBox["k", "ppp", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", 
           SuperscriptBox["z", "2"]}], "+", 
          RowBox[{
           SubsuperscriptBox["k", "s", "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SubsuperscriptBox["W", "ppp", "2"], "+", 
              SubsuperscriptBox["W", "s", "2"]}], ")"}], "2"]}]}], ")"}]}]}], 
      ")"}]}], "+", 
    RowBox[{
     SubsuperscriptBox["k", "i", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "8"}], " ", 
        SuperscriptBox["z", "2"], " ", 
        SubscriptBox["k", "ppp"], " ", 
        SubscriptBox["k", "s"], " ", 
        SubsuperscriptBox["W", "i", "4"]}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["z", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", 
           SuperscriptBox["z", "2"]}], "+", 
          RowBox[{
           SubsuperscriptBox["k", "s", "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SubsuperscriptBox["W", "i", "2"], "+", 
              SubsuperscriptBox["W", "s", "2"]}], ")"}], "2"]}]}], ")"}]}], 
       "+", 
       RowBox[{
        SubsuperscriptBox["k", "ppp", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubsuperscriptBox["W", "ppp", "4"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", " ", 
              SuperscriptBox["z", "2"]}], "+", 
             RowBox[{
              SubsuperscriptBox["k", "s", "2"], " ", 
              SubsuperscriptBox["W", "s", "4"]}]}], ")"}]}], "+", 
          RowBox[{"2", " ", 
           SubsuperscriptBox["W", "i", "2"], " ", 
           SubsuperscriptBox["W", "ppp", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", " ", 
              SuperscriptBox["z", "2"]}], "+", 
             RowBox[{
              SubsuperscriptBox["k", "s", "2"], " ", 
              SubsuperscriptBox["W", "s", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                SubsuperscriptBox["W", "ppp", "2"], "+", 
                SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SubsuperscriptBox["W", "i", "4"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", " ", 
              SuperscriptBox["z", "2"]}], "+", 
             RowBox[{
              SubsuperscriptBox["k", "s", "2"], " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SubsuperscriptBox["W", "ppp", "2"], "+", 
                 SubsuperscriptBox["W", "s", "2"]}], ")"}], "2"]}]}], 
            ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.592275003107293*^9, 3.5922750726408043`*^9}, {
   3.59227511924443*^9, 3.592275136407569*^9}, 3.592275172423059*^9, 
   3.592275215306522*^9, {3.592275335712215*^9, 3.5922754128220253`*^9}, 
   3.5922756438134604`*^9}]
}, Open  ]]
},
WindowSize->{1440, 852},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (October 5, \
2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 6230, 142, 358, "Input"],
Cell[CellGroupData[{
Cell[6812, 166, 11909, 315, 897, "Input"],
Cell[18724, 483, 410, 6, 27, "Output"],
Cell[19137, 491, 408, 6, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19582, 502, 2547, 68, 79, "Input"],
Cell[22132, 572, 1109, 33, 54, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23278, 610, 4133, 104, 302, "Input"],
Cell[27414, 716, 643, 16, 51, "Output"]
}, Open  ]],
Cell[28072, 735, 94, 1, 27, "Input"],
Cell[CellGroupData[{
Cell[28191, 740, 5922, 125, 403, "Input"],
Cell[34116, 867, 7553, 201, 80, "Output"],
Cell[41672, 1070, 13171, 345, 126, "Output"],
Cell[54846, 1417, 5753, 161, 59, "Output"],
Cell[60602, 1580, 5344, 155, 95, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
