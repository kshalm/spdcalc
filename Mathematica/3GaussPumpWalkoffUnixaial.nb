(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    202731,       5326]
NotebookOptionsPosition[    199071,       5211]
NotebookOutlinePosition[    199427,       5227]
CellTagsIndexPosition[    199384,       5224]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Figure", " ", "out", " ", "the", " ", "rotation", " ", "that", " ", 
    "puts", " ", "the", " ", "signal", " ", "and", " ", "idler", " ", "into", 
    " ", "the", " ", "pump", " ", 
    RowBox[{"coordinates", ".", " ", "Here"}], " ", "\[Theta]", " ", "is", 
    " ", "the", " ", "opening", " ", "angle", " ", "and", " ", "\[Phi]", " ", 
    "is", " ", "the", " ", "azimuthal", " ", 
    RowBox[{"angle", "."}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"RotX", ":=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", " ", "0", ",", " ", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", 
        RowBox[{"-", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}], "}"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"RotZ", ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}], ",", " ", "0"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", " ", "0"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"RotY", " ", ":=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Gamma]", "]"}], ",", "0", ",", " ", 
        RowBox[{"-", 
         RowBox[{"Sin", "[", "\[Gamma]", "]"}]}]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", "  ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Gamma]", "]"}], ",", "0", ",", "  ", 
        RowBox[{"Cos", "[", "\[Gamma]", "]"}]}], "}"}]}], "}"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"RotX", ":=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", " ", "0", ",", " ", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
        RowBox[{"-", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}], ",", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}], "}"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"RotZ", ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", 
        RowBox[{"-", 
         RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", " ", "0"}], "}"}], ",", 
      " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Phi]", "]"}], ",", " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", " ", "0"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"RotY", " ", ":=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Gamma]", "]"}], ",", "0", ",", " ", 
        RowBox[{"Sin", "[", "\[Gamma]", "]"}]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", "  ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Sin", "[", "\[Gamma]", "]"}]}], ",", "0", ",", "  ", 
        RowBox[{"Cos", "[", "\[Gamma]", "]"}]}], "}"}]}], "}"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RotZLab", " ", ":=", " ", "RotY"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RotXLab", " ", ":=", " ", "RotZ"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RotYLab", " ", ":=", " ", "RotX"}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{"RotTrans", "=", 
    RowBox[{"RotX", " ", ".", " ", "RotZ"}]}], "\[IndentingNewLine]", 
   RowBox[{"RotPumpwrtXtal", " ", "=", " ", 
    RowBox[{"RotX", ".", "RotZ"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Expand", "[", 
    RowBox[{
     RowBox[{"RotXLab", ".", 
      RowBox[{"{", 
       RowBox[{"x1", ",", "y1", ",", "z1"}], "}"}]}], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"z1", "\[Rule]", 
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", 
           SubscriptBox["\[Gamma]", "p"], "]"}], "*", "x"}], " ", "-", 
         RowBox[{
          RowBox[{"Sin", "[", 
           SubscriptBox["\[Gamma]", "p"], "]"}], "*", "z"}]}]}], ",", 
       RowBox[{"x1", "\[Rule]", " ", "y"}], ",", " ", 
       RowBox[{"y1", "\[Rule]", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           SubscriptBox["\[Gamma]", "p"], "]"}], "*", "x"}], " ", "-", 
         RowBox[{
          RowBox[{"Cos", "[", 
           SubscriptBox["\[Gamma]", "p"], "]"}], "*", "z"}]}]}]}], "}"}]}], 
    "]"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.582551082707974*^9, 3.582551243412228*^9}, {
   3.582552241600596*^9, 3.58255248525065*^9}, {3.5825530886487722`*^9, 
   3.582553091710619*^9}, {3.582581931220381*^9, 3.582581994221595*^9}, {
   3.582589736354864*^9, 3.58258979384231*^9}, {3.582589853214909*^9, 
   3.582589939808462*^9}, {3.582590073974887*^9, 3.5825900784620047`*^9}, {
   3.582591942003405*^9, 3.5825919557241173`*^9}, {3.582592064468408*^9, 
   3.582592070390641*^9}, {3.582592168312223*^9, 3.582592195349346*^9}, {
   3.582592537371162*^9, 3.5825925389767017`*^9}, {3.582592609833417*^9, 
   3.582592630132695*^9}, {3.582594727920084*^9, 3.5825947541563683`*^9}, {
   3.582594786928154*^9, 3.582594837727318*^9}, {3.582594872553235*^9, 
   3.5825948732121487`*^9}, 3.582594919516144*^9, {3.582595006307055*^9, 
   3.58259502779462*^9}, {3.582595382427409*^9, 3.5825953955679607`*^9}, {
   3.582595429725254*^9, 3.582595511584939*^9}, {3.582595567715238*^9, 
   3.58259556798405*^9}, {3.5825957007377663`*^9, 3.5825957096247883`*^9}, {
   3.582595744582691*^9, 3.582595792538672*^9}, {3.582596036605506*^9, 
   3.5825960731972313`*^9}, {3.582596118612314*^9, 3.58259612941899*^9}, {
   3.582596292204793*^9, 3.5825963567715073`*^9}, {3.582596404384987*^9, 
   3.5825964610317802`*^9}, {3.5825968755404663`*^9, 3.582596891139832*^9}, 
   3.582597031324554*^9, {3.582597263234353*^9, 3.582597287940269*^9}, {
   3.5825973900652647`*^9, 3.582597396723194*^9}, {3.582597641860304*^9, 
   3.582597661706188*^9}, 3.582597849090914*^9, 3.582597885135263*^9, {
   3.5826762909693413`*^9, 3.582676292040473*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", 
     RowBox[{"-", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{"-", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
     RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.582552444028955*^9, {3.5825524768158484`*^9, 3.58255248583467*^9}, 
   3.582553092284441*^9, 3.5825618446706257`*^9, 3.582562059850234*^9, 
   3.5825639137479687`*^9, 3.5825646028075247`*^9, 3.582589879404048*^9, 
   3.5825899430288973`*^9, 3.5825900795342007`*^9, 3.582591956253748*^9, 
   3.582592071304824*^9, 3.582592198860856*^9, 3.582592540073839*^9, 
   3.582592631343177*^9, {3.582594730533414*^9, 3.5825947548183117`*^9}, {
   3.5825947953033247`*^9, 3.5825948399508038`*^9}, 3.582594874072584*^9, 
   3.582594920512519*^9, {3.582595009573421*^9, 3.5825950289301023`*^9}, 
   3.582595513334758*^9, 3.582595573438884*^9, 3.582595710901108*^9, 
   3.5825957955808153`*^9, 3.582596130526894*^9, {3.58259634392697*^9, 
   3.5825963601608133`*^9}, {3.5825964436037817`*^9, 3.5825964616825857`*^9}, 
   3.582596892086608*^9, 3.582597032157957*^9, {3.5825972667057037`*^9, 
   3.582597288407114*^9}, 3.582597397547275*^9, 3.5825976633763227`*^9, 
   3.582597850259058*^9, 3.582597885907909*^9, 3.582673481170102*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", 
     RowBox[{"-", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{"-", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
     RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.582552444028955*^9, {3.5825524768158484`*^9, 3.58255248583467*^9}, 
   3.582553092284441*^9, 3.5825618446706257`*^9, 3.582562059850234*^9, 
   3.5825639137479687`*^9, 3.5825646028075247`*^9, 3.582589879404048*^9, 
   3.5825899430288973`*^9, 3.5825900795342007`*^9, 3.582591956253748*^9, 
   3.582592071304824*^9, 3.582592198860856*^9, 3.582592540073839*^9, 
   3.582592631343177*^9, {3.582594730533414*^9, 3.5825947548183117`*^9}, {
   3.5825947953033247`*^9, 3.5825948399508038`*^9}, 3.582594874072584*^9, 
   3.582594920512519*^9, {3.582595009573421*^9, 3.5825950289301023`*^9}, 
   3.582595513334758*^9, 3.582595573438884*^9, 3.582595710901108*^9, 
   3.5825957955808153`*^9, 3.582596130526894*^9, {3.58259634392697*^9, 
   3.5825963601608133`*^9}, {3.5825964436037817`*^9, 3.5825964616825857`*^9}, 
   3.582596892086608*^9, 3.582597032157957*^9, {3.5825972667057037`*^9, 
   3.582597288407114*^9}, 3.582597397547275*^9, 3.5825976633763227`*^9, 
   3.582597850259058*^9, 3.582597885907909*^9, 3.58267348117211*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"y", " ", 
     RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "+", 
    RowBox[{"z", " ", 
     RowBox[{"Cos", "[", 
      SubscriptBox["\[Gamma]", "p"], "]"}], " ", 
     RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "-", 
    RowBox[{"x", " ", 
     RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
     RowBox[{"Sin", "[", 
      SubscriptBox["\[Gamma]", "p"], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "z"}], " ", 
     RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
     RowBox[{"Cos", "[", 
      SubscriptBox["\[Gamma]", "p"], "]"}]}], "+", 
    RowBox[{"y", " ", 
     RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "+", 
    RowBox[{"x", " ", 
     RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
     RowBox[{"Sin", "[", 
      SubscriptBox["\[Gamma]", "p"], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"x", " ", 
     RowBox[{"Cos", "[", 
      SubscriptBox["\[Gamma]", "p"], "]"}]}], "-", 
    RowBox[{"z", " ", 
     RowBox[{"Sin", "[", 
      SubscriptBox["\[Gamma]", "p"], "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.582552444028955*^9, {3.5825524768158484`*^9, 3.58255248583467*^9}, 
   3.582553092284441*^9, 3.5825618446706257`*^9, 3.582562059850234*^9, 
   3.5825639137479687`*^9, 3.5825646028075247`*^9, 3.582589879404048*^9, 
   3.5825899430288973`*^9, 3.5825900795342007`*^9, 3.582591956253748*^9, 
   3.582592071304824*^9, 3.582592198860856*^9, 3.582592540073839*^9, 
   3.582592631343177*^9, {3.582594730533414*^9, 3.5825947548183117`*^9}, {
   3.5825947953033247`*^9, 3.5825948399508038`*^9}, 3.582594874072584*^9, 
   3.582594920512519*^9, {3.582595009573421*^9, 3.5825950289301023`*^9}, 
   3.582595513334758*^9, 3.582595573438884*^9, 3.582595710901108*^9, 
   3.5825957955808153`*^9, 3.582596130526894*^9, {3.58259634392697*^9, 
   3.5825963601608133`*^9}, {3.5825964436037817`*^9, 3.5825964616825857`*^9}, 
   3.582596892086608*^9, 3.582597032157957*^9, {3.5825972667057037`*^9, 
   3.582597288407114*^9}, 3.582597397547275*^9, 3.5825976633763227`*^9, 
   3.582597850259058*^9, 3.582597885907909*^9, 3.582673481174111*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "We", " ", "can", " ", "use", " ", "the", " ", "fact", " ", "that", " ", 
      
      SubscriptBox["\[Phi]", "i"]}], "=", " ", 
     RowBox[{
      SubscriptBox["\[Phi]", "s"], "+", 
      RowBox[{"\[Pi]", " ", "to", " ", "simplify", " ", "things", " ", 
       RowBox[{"somewhat", ".", " ", "Here"}], " ", "are", " ", "the", " ", 
       "coordinate", " ", "transformations", " ", "for", " ", "the", " ", 
       "signal", " ", "and", " ", 
       RowBox[{"idler", ".", " ", "Eventually"}]}]}]}], ",", " ", 
    RowBox[{
    "these", " ", "terms", " ", "will", " ", "include", " ", "the", " ", 
     "walkoff", " ", "angles", " ", "for", " ", "the", " ", "signal"}], ",", 
    " ", "idler", ",", " ", 
    RowBox[{"and", " ", 
     RowBox[{"pump", ".", " ", "For"}], " ", "now"}], ",", " ", 
    RowBox[{"this", " ", "is", " ", "more", " ", 
     RowBox[{"tractable", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    SubscriptBox["x", "s"], " ", ":=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", 
        SubscriptBox["\[Phi]", "s"], "]"}], "*", "x"}], " ", "+", " ", 
      RowBox[{
       RowBox[{"Cos", "[", 
        SubscriptBox["\[Theta]", "s"], "]"}], "*", 
       RowBox[{"Sin", "[", 
        SubscriptBox["\[Phi]", "s"], "]"}], "*", "y"}], " ", "+", " ", 
      RowBox[{
       RowBox[{"Sin", "[", 
        SubscriptBox["\[Theta]", "s"], "]"}], "*", 
       RowBox[{"Sin", "[", 
        SubscriptBox["\[Phi]", "s"], "]"}], "*", "z", "\[IndentingNewLine]", 
       SubscriptBox["y", "s"]}]}], ":=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Sin", "[", 
          SubscriptBox["\[Phi]", "s"], "]"}]}], "*", "x"}], " ", "+", " ", 
       RowBox[{
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "s"], "]"}], "*", 
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Phi]", "s"], "]"}], "*", "y"}], " ", "+", " ", 
       RowBox[{
        RowBox[{"Sin", "[", 
         SubscriptBox["\[Theta]", "s"], "]"}], "*", 
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Phi]", "s"], "]"}], "*", "z", "\[IndentingNewLine]", 
        
        SubscriptBox["z", "s"]}]}], ":=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Sin", "[", 
           SubscriptBox["\[Theta]", "s"], "]"}]}], "*", "y"}], " ", "+", " ", 
        
        RowBox[{
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Theta]", "s"], "]"}], "*", "z", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         SubscriptBox["x", "i"]}]}], " ", ":=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Phi]", "s"], "]"}]}], "*", "x"}], " ", "-", " ", 
         RowBox[{
          RowBox[{"Cos", "[", 
           SubscriptBox["\[Theta]", "i"], "]"}], "*", 
          RowBox[{"Sin", "[", 
           SubscriptBox["\[Phi]", "s"], "]"}], "*", "y"}], " ", "-", " ", 
         RowBox[{
          RowBox[{"Sin", "[", 
           SubscriptBox["\[Theta]", "i"], "]"}], "*", 
          RowBox[{"Sin", "[", 
           SubscriptBox["\[Phi]", "s"], "]"}], "*", "z", 
          "\[IndentingNewLine]", 
          SubscriptBox["y", "i"]}]}], ":=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Sin", "[", 
            SubscriptBox["\[Phi]", "s"], "]"}], "*", "x"}], " ", "-", " ", 
          RowBox[{
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "i"], "]"}], "*", 
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Phi]", "s"], "]"}], "*", "y"}], " ", "-", " ", 
          RowBox[{
           RowBox[{"Sin", "[", 
            SubscriptBox["\[Theta]", "i"], "]"}], "*", 
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Phi]", "s"], "]"}], "*", "z", 
           "\[IndentingNewLine]", 
           SubscriptBox["z", "i"]}]}], ":=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Sin", "[", 
              SubscriptBox["\[Theta]", "i"], "]"}]}], "*", "y"}], " ", "+", 
           " ", 
           RowBox[{
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "i"], "]"}], "*", "z", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            SubscriptBox["x", "p"]}]}], " ", ":=", " ", 
          RowBox[{
           RowBox[{"x", " ", "+", " ", 
            RowBox[{
             RowBox[{"Tan", "[", 
              SubscriptBox["\[Rho]", "px"], "]"}], "*", "z", 
             "\[IndentingNewLine]", 
             SubscriptBox["y", "p"]}]}], " ", ":=", "  ", 
           RowBox[{"y", "+", " ", 
            RowBox[{
             RowBox[{"Tan", "[", 
              SubscriptBox["\[Rho]", "py"], "]"}], "*", 
             "z"}]}]}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Made", " ", "a", " ", "mistake", " ", "in", " ", "my", " ", "coordinate", 
    " ", "transforms", " ", 
    RowBox[{"before", ".", " ", "Now"}], " ", "I", " ", "need", " ", "to", 
    " ", "fix", " ", "them", " ", 
    RowBox[{"up", "."}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    SubscriptBox["x", "s"], " ", ":=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Phi]", "s"], "]"}], "*", "x"}], " ", "-", 
     RowBox[{
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Phi]", "s"], "]"}], "*", "y"}]}]}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["y", "s"], ":=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Theta]", "s"], "]"}], "*", 
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Phi]", "s"], "]"}], "*", "x"}], " ", "+", " ", 
     RowBox[{
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Theta]", "s"], "]"}], "*", 
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Phi]", "s"], "]"}], "*", "y"}], " ", "-", " ", 
     RowBox[{
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Theta]", "s"], "]"}], "*", "z"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["z", "s"], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Theta]", "s"], "]"}], "*", 
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Phi]", "s"], "]"}], "*", "x"}], " ", "+", " ", 
     RowBox[{
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Theta]", "s"], "]"}], "*", 
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Phi]", "s"], "]"}], "*", "y"}], " ", "+", " ", 
     RowBox[{
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Theta]", "s"], "]"}], "*", "z"}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"rulescoord", " ", ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Theta]", "s"], "\[Rule]", 
       SubscriptBox["\[Theta]", "i"]}], ",", " ", 
      RowBox[{
       SubscriptBox["\[Phi]", "s"], "\[Rule]", 
       RowBox[{
        SubscriptBox["\[Phi]", "s"], "+", "\[Pi]"}]}]}], "}"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["x", "i"], " ", ":=", " ", 
    RowBox[{
     SubscriptBox["x", 
      RowBox[{"s", " "}]], "/.", "rulescoord"}]}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["y", "i"], ":=", " ", 
    RowBox[{
     SubscriptBox["y", 
      RowBox[{"s", " "}]], "/.", "rulescoord"}]}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["z", "i"], ":=", " ", 
    RowBox[{
     SubscriptBox["z", 
      RowBox[{"s", " "}]], "/.", "rulescoord"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Include", " ", "pump", " ", "walkoff", " ", "in", " ", "a", " ", 
     "uniaxial", " ", "crystal", " ", 
     RowBox[{"configuration", ".", " ", "The"}], " ", "center", " ", "of", 
     " ", "the", " ", "Gaussian", " ", "beam", " ", "translates", " ", 
     "vertically", " ", "upward", " ", "along", " ", "the", " ", "x", " ", 
     RowBox[{"dir", ".", " ", "Use"}], " ", "small", " ", "angle", " ", 
     "approx", " ", "to", " ", "replace", " ", 
     RowBox[{"Tan", "[", " ", 
      SubscriptBox["\[Rho]", "px"], "]"}], " ", "with", "  ", 
     RowBox[{
      SubscriptBox["\[Rho]", "px"], "."}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["x", "p"], " ", ":=", " ", 
    RowBox[{"x", " ", "+", " ", 
     RowBox[{
      SubscriptBox["\[Rho]", "px"], "*", "z"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["y", "p"], ":=", " ", "y"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Introduce", " ", "the", " ", "assumption", " ", "that", " ", "the", " ", 
     "Rayleigh", " ", "range", " ", "is", " ", "much", " ", "longer", " ", 
     "than", " ", "the", " ", "crystal", " ", "length", " ", "and", " ", 
     "the", " ", "waist", " ", "can", " ", "be", " ", "treated", " ", "as", 
     " ", "a", " ", 
     RowBox[{"constant", ".", " ", "This"}], " ", "dramatically", " ", 
     "simplifies", " ", 
     RowBox[{"things", "."}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"rules2", " ", ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SubscriptBox["q", "p"], " ", "\[Rule]", " ", 
       SuperscriptBox[
        SubscriptBox["W", "p"], "2"]}], " ", ",", " ", 
      RowBox[{
       SubscriptBox["q", "s"], " ", "\[Rule]", " ", 
       SuperscriptBox[
        SubscriptBox["W", "s"], "2"]}], " ", ",", " ", 
      RowBox[{
       SubscriptBox["q", "i"], " ", "\[Rule]", " ", 
       SuperscriptBox[
        SubscriptBox["W", "i"], "2"]}]}], " ", "}"}]}], " ", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.582553100047619*^9, 3.582553370588112*^9}, {
   3.5825820388549013`*^9, 3.582582169072603*^9}, {3.582587357577043*^9, 
   3.582587413066751*^9}, {3.582598276658927*^9, 3.582598320894418*^9}, {
   3.5825983892377157`*^9, 3.582598627247916*^9}, {3.58259866828645*^9, 
   3.582598704826029*^9}, {3.582600519865554*^9, 3.582600593785883*^9}, {
   3.582600716528623*^9, 3.5826007425499573`*^9}, {3.582672343066288*^9, 
   3.582672343360055*^9}, {3.582674823189691*^9, 3.5826748239251747`*^9}, 
   3.582676449697198*^9, {3.582676542418489*^9, 3.582676542619144*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "These", " ", "are", " ", "the", " ", "normalization", " ", "coefficients",
     " ", "for", " ", "the", " ", "three", " ", "Gaussians"}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["n", "s"], " ", "=", " ", 
     RowBox[{
      RowBox[{
       SubscriptBox["W", "s"], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"\[Pi]", "/", "2"}], "]"}], "*", 
         SubscriptBox["q", "s"]}], ")"}]}], " ", "//.", "rules2"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["n", "i"], " ", "=", " ", 
     RowBox[{
      RowBox[{
       SubscriptBox["W", "i"], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"\[Pi]", "/", "2"}], "]"}], "*", 
         SubscriptBox["q", "i"]}], ")"}]}], " ", "//.", "rules2"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["n", "p"], " ", "=", " ", 
     RowBox[{
      RowBox[{
       SubscriptBox["W", "p"], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"\[Pi]", "/", "2"}], "]"}], "*", 
         SubscriptBox["q", "p"]}], ")"}]}], " ", "//.", " ", "rules2"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.582676438761138*^9, 3.582676528731468*^9}, {
  3.582676729795623*^9, 3.5826767327704906`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Here", " ", "is", " ", "the", " ", "argument", " ", "in", " ", "the", 
     " ", "exponential", " ", "that", " ", "we", " ", "will", " ", "want", 
     " ", "to", " ", "integrate", " ", "over", " ", "wrt", " ", "to", " ", 
     "x"}], ",", " ", "y", ",", " ", 
    RowBox[{"and", " ", 
     RowBox[{"z", "."}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Arg1", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "1"}], "/", 
       RowBox[{"(", 
        RowBox[{"2", "*", 
         SubscriptBox["q", "s"]}], ")"}]}], "*", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["x", "s"], "2"], "+", 
        SuperscriptBox[
         SubscriptBox["y", "s"], "2"]}], ")"}]}], "-", 
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{"2", "*", 
         SubscriptBox["q", "i"]}], ")"}]}], 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["x", "i"], "2"], "+", 
        SuperscriptBox[
         SubscriptBox["y", "i"], "2"]}], ")"}]}], "-", 
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{"2", "*", 
         SubscriptBox["q", "p"]}], ")"}]}], "*", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["x", "p"], "2"], "+", 
        SuperscriptBox[
         SubscriptBox["y", "p"], "2"]}], ")"}]}], " ", "-", " ", 
     RowBox[{"\[ImaginaryI]", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[CapitalDelta]K", "x"], "*", "x"}], " ", "+", " ", 
        RowBox[{
         SubscriptBox["\[CapitalDelta]K", "y"], "*", "y"}], "+", 
        RowBox[{
         SubscriptBox["\[CapitalDelta]K", "z"], "*", "z"}]}], ")"}]}]}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.5825533941941223`*^9, 3.5825535539588547`*^9}, {
   3.5825536033128633`*^9, 3.582553608767806*^9}, 3.582553712131874*^9, {
   3.582553783669939*^9, 3.58255382316961*^9}, {3.582561756372466*^9, 
   3.582561771923471*^9}, 3.582561807119581*^9, {3.582562474614017*^9, 
   3.582562499613974*^9}, {3.582582135209609*^9, 3.5825821366901712`*^9}, {
   3.582600600836162*^9, 3.5826006048984003`*^9}, {3.582676452509242*^9, 
   3.582676454063005*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     SuperscriptBox["x", "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"y", " ", 
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Theta]", "i"], "]"}]}], "-", 
        RowBox[{"z", " ", 
         RowBox[{"Sin", "[", 
          SubscriptBox["\[Theta]", "i"], "]"}]}]}], ")"}], "2"]}], 
    RowBox[{"2", " ", 
     SubscriptBox["q", "i"]}]]}], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["x", "2"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"y", " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "s"], "]"}]}], "-", 
       RowBox[{"z", " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["\[Theta]", "s"], "]"}]}]}], ")"}], "2"]}], 
   RowBox[{"2", " ", 
    SubscriptBox["q", "s"]}]], "-", 
  RowBox[{"\[ImaginaryI]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"x", " ", 
      SubscriptBox["\[CapitalDelta]K", "x"]}], "+", 
     RowBox[{"y", " ", 
      SubscriptBox["\[CapitalDelta]K", "y"]}], "+", 
     RowBox[{"z", " ", 
      SubscriptBox["\[CapitalDelta]K", "z"]}]}], ")"}]}], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["y", "2"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"x", "+", 
       RowBox[{"z", " ", 
        SubscriptBox["\[Rho]", "px"]}]}], ")"}], "2"]}], 
   RowBox[{"2", " ", 
    SubscriptBox["q", "p"]}]]}]], "Output",
 CellChangeTimes->{{3.58256180748381*^9, 3.582561846689802*^9}, 
   3.582562060001554*^9, 3.582563913925955*^9, 3.582564602920834*^9, 
   3.582598710476437*^9, {3.5826006077291937`*^9, 3.582600617694231*^9}, 
   3.5826007461601562`*^9, 3.582672352712099*^9, 3.582673481288066*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"CompleteSquare", "[", 
   RowBox[{"f_", ",", "x_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"c", ",", "b", ",", "a"}], "}"}], "=", 
      RowBox[{"CoefficientList", "[", 
       RowBox[{"f", ",", "x"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x", "+", 
          RowBox[{
           RowBox[{"b", "/", "2"}], "/", "a"}]}], ")"}], "^", "2"}]}], "+", 
      RowBox[{"Simplify", "[", 
       RowBox[{"(", 
        RowBox[{"c", "-", 
         RowBox[{
          RowBox[{
           RowBox[{"b", "^", "2"}], "/", "4"}], "/", "a"}]}], ")"}], 
       "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.5826006354303637`*^9, 3.582600636310912*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "First", " ", "we", " ", "complete", " ", "the", " ", "square", " ", "wrt",
     " ", "to", " ", 
    RowBox[{"x", ".", " ", "This"}], " ", "makes", " ", "it", " ", "easier", 
    " ", "to", " ", "analytically", " ", "carry", " ", "out", " ", "the", " ", 
    RowBox[{"integration", "."}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"Arg1", " ", "=", " ", 
   RowBox[{"CompleteSquare", "[", 
    RowBox[{"Arg1", ",", " ", "x"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.5825537185392857`*^9, 3.582553738312705*^9}, {
  3.582582174512424*^9, 3.582582196639732*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SubscriptBox["q", "i"]}]]}], "-", 
     FractionBox["1", 
      RowBox[{"2", " ", 
       SubscriptBox["q", "p"]}]], "-", 
     FractionBox["1", 
      RowBox[{"2", " ", 
       SubscriptBox["q", "s"]}]]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"x", "+", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", 
         SubscriptBox["\[CapitalDelta]K", "x"]}], "-", 
        FractionBox[
         RowBox[{"z", " ", 
          SubscriptBox["\[Rho]", "px"]}], 
         SubscriptBox["q", "p"]]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["1", 
            RowBox[{"2", " ", 
             SubscriptBox["q", "i"]}]]}], "-", 
          FractionBox["1", 
           RowBox[{"2", " ", 
            SubscriptBox["q", "p"]}]], "-", 
          FractionBox["1", 
           RowBox[{"2", " ", 
            SubscriptBox["q", "s"]}]]}], ")"}]}]]}], ")"}], "2"]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", " ", 
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "i"], "]"}]}], "-", 
           RowBox[{"z", " ", 
            RowBox[{"Sin", "[", 
             SubscriptBox["\[Theta]", "i"], "]"}]}]}], ")"}], "2"]}], 
       SubscriptBox["q", "i"]]}], "-", 
     FractionBox[
      RowBox[{"2", " ", 
       SubscriptBox["q", "i"], " ", 
       SubscriptBox["q", "s"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["q", "p"], " ", 
           SubscriptBox["\[CapitalDelta]K", "x"]}], "-", 
          RowBox[{"\[ImaginaryI]", " ", "z", " ", 
           SubscriptBox["\[Rho]", "px"]}]}], ")"}], "2"]}], 
      RowBox[{
       SubscriptBox["q", "p"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["q", "p"], " ", 
          SubscriptBox["q", "s"]}], "+", 
         RowBox[{
          SubscriptBox["q", "i"], " ", 
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["q", "p"], "+", 
            SubscriptBox["q", "s"]}], ")"}]}]}], ")"}]}]], "-", 
     FractionBox[
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["q", "p"], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"y", " ", 
                RowBox[{"Cos", "[", 
                 SubscriptBox["\[Theta]", "s"], "]"}]}], "-", 
               RowBox[{"z", " ", 
                RowBox[{"Sin", "[", 
                 SubscriptBox["\[Theta]", "s"], "]"}]}]}], ")"}], "2"], "+", 
            RowBox[{"2", " ", "\[ImaginaryI]", " ", 
             SubscriptBox["q", "s"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"y", " ", 
                SubscriptBox["\[CapitalDelta]K", "y"]}], "+", 
               RowBox[{"z", " ", 
                SubscriptBox["\[CapitalDelta]K", "z"]}]}], ")"}]}]}], ")"}]}],
          "+", 
         RowBox[{
          SubscriptBox["q", "s"], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["y", "2"], "+", 
            RowBox[{
             SuperscriptBox["z", "2"], " ", 
             SubsuperscriptBox["\[Rho]", "px", "2"]}]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       SubscriptBox["q", "p"], " ", 
       SubscriptBox["q", "s"]}]]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.582553738961458*^9, 3.582553827351152*^9, {3.5825617764989023`*^9, 
   3.5825617944788227`*^9}, 3.5825618560286083`*^9, 3.582562061113029*^9, 
   3.5825639150159817`*^9, 3.58256460401079*^9, 3.5825987247699547`*^9, 
   3.5826006480156393`*^9, 3.5826007544161663`*^9, 3.582672374705593*^9, 
   3.5826734824310417`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Now", ",", " ", 
    RowBox[{"the", " ", "term", " ", "in", " ", "the", " ", "b", "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"x", "-", "a"}], ")"}], "^", "2"}], " ", "term", " ", 
     "integrates", " ", "to", " ", "a", " ", "constant"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"xconst", ":=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Sqrt]", "\[Pi]"}], "/", 
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["1", 
            RowBox[{"2", " ", 
             SubscriptBox["q", "i"]}]]}], "-", 
          FractionBox["1", 
           RowBox[{"2", " ", 
            SubscriptBox["q", "p"]}]], "-", 
          FractionBox["1", 
           RowBox[{"2", " ", 
            SubscriptBox["q", "s"]}]]}], ")"}]}]}], " ", "//.", "rules2"}], 
     "]"}]}], "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "now", " ", "we", " ", "can", " ", "do", " ", "the", " ", "remaining", 
     " ", "integral", " ", "wrt", " ", "y", " ", "and", " ", "complete", " ", 
     "the", " ", "square", " ", "agaim"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"yArg", ":=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      FractionBox["1", "4"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"2", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"y", " ", 
               RowBox[{"Cos", "[", 
                SubscriptBox["\[Theta]", "i"], "]"}]}], "-", 
              RowBox[{"z", " ", 
               RowBox[{"Sin", "[", 
                SubscriptBox["\[Theta]", "i"], "]"}]}]}], ")"}], "2"]}], 
          SubscriptBox["q", "i"]]}], "-", 
        FractionBox[
         RowBox[{"2", " ", 
          SubscriptBox["q", "i"], " ", 
          SubscriptBox["q", "s"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SubscriptBox["q", "p"], " ", 
              SubscriptBox["\[CapitalDelta]K", "x"]}], "-", 
             RowBox[{"\[ImaginaryI]", " ", "z", " ", 
              SubscriptBox["\[Rho]", "px"]}]}], ")"}], "2"]}], 
         RowBox[{
          SubscriptBox["q", "p"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SubscriptBox["q", "p"], " ", 
             SubscriptBox["q", "s"]}], "+", 
            RowBox[{
             SubscriptBox["q", "i"], " ", 
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["q", "p"], "+", 
               SubscriptBox["q", "s"]}], ")"}]}]}], ")"}]}]], "-", 
        FractionBox[
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SubscriptBox["q", "p"], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"y", " ", 
                   RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "s"], "]"}]}], "-", 
                  RowBox[{"z", " ", 
                   RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "s"], "]"}]}]}], ")"}], "2"], 
               "+", 
               RowBox[{"2", " ", "\[ImaginaryI]", " ", 
                SubscriptBox["q", "s"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"y", " ", 
                   SubscriptBox["\[CapitalDelta]K", "y"]}], "+", 
                  RowBox[{"z", " ", 
                   SubscriptBox["\[CapitalDelta]K", "z"]}]}], ")"}]}]}], 
              ")"}]}], "+", 
            RowBox[{
             SubscriptBox["q", "s"], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["y", "2"], "+", 
               RowBox[{
                SuperscriptBox["z", "2"], " ", 
                SubsuperscriptBox["\[Rho]", "px", "2"]}]}], ")"}]}]}], 
           ")"}]}], 
         RowBox[{
          SubscriptBox["q", "p"], " ", 
          SubscriptBox["q", "s"]}]]}], ")"}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Simplify", "[", "yArg", "]"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"yArg2", "=", 
    RowBox[{"CompleteSquare", "[", 
     RowBox[{"yArg", ",", "y"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.5825538416732683`*^9, 3.5825540262026253`*^9}, {
   3.582554070185461*^9, 3.58255407764716*^9}, 3.5825618686585283`*^9, 
   3.5825619031644173`*^9, {3.582582212811741*^9, 3.5825822216126223`*^9}, {
   3.582598740623023*^9, 3.5825987588152237`*^9}, 3.582598791694824*^9, 
   3.5826007798659353`*^9, {3.582600814519813*^9, 3.5826010290448103`*^9}, 
   3.582601333150104*^9, 3.5826014723118773`*^9, {3.582672389928055*^9, 
   3.5826724027171583`*^9}, {3.582674796730681*^9, 3.5826747992116013`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "i"], "]"}], "2"], 
       RowBox[{"2", " ", 
        SubscriptBox["q", "i"]}]]}], "-", 
     FractionBox["1", 
      RowBox[{"2", " ", 
       SubscriptBox["q", "p"]}]], "-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"Cos", "[", 
        SubscriptBox["\[Theta]", "s"], "]"}], "2"], 
      RowBox[{"2", " ", 
       SubscriptBox["q", "s"]}]]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"y", "+", 
      FractionBox[
       RowBox[{
        FractionBox[
         RowBox[{"z", " ", 
          RowBox[{"Cos", "[", 
           SubscriptBox["\[Theta]", "i"], "]"}], " ", 
          RowBox[{"Sin", "[", 
           SubscriptBox["\[Theta]", "i"], "]"}]}], 
         SubscriptBox["q", "i"]], "+", 
        FractionBox[
         RowBox[{"z", " ", 
          RowBox[{"Cos", "[", 
           SubscriptBox["\[Theta]", "s"], "]"}], " ", 
          RowBox[{"Sin", "[", 
           SubscriptBox["\[Theta]", "s"], "]"}]}], 
         SubscriptBox["q", "s"]], "-", 
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["\[CapitalDelta]K", "y"]}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              SubscriptBox["\[Theta]", "i"], "]"}], "2"], 
            RowBox[{"2", " ", 
             SubscriptBox["q", "i"]}]]}], "-", 
          FractionBox["1", 
           RowBox[{"2", " ", 
            SubscriptBox["q", "p"]}]], "-", 
          FractionBox[
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "s"], "]"}], "2"], 
           RowBox[{"2", " ", 
            SubscriptBox["q", "s"]}]]}], ")"}]}]]}], ")"}], "2"]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"2", " ", 
        SuperscriptBox["z", "2"], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", 
          SubscriptBox["\[Theta]", "i"], "]"}], "2"]}], 
       SubscriptBox["q", "i"]]}], "-", 
     FractionBox[
      RowBox[{"2", " ", 
       SuperscriptBox["z", "2"], " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", 
         SubscriptBox["\[Theta]", "s"], "]"}], "2"]}], 
      SubscriptBox["q", "s"]], "+", 
     FractionBox[
      RowBox[{
       SubscriptBox["q", "p"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"z", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", 
             SubscriptBox["\[Theta]", "i"]}], "]"}], " ", 
           SubscriptBox["q", "s"]}], "+", 
          RowBox[{
           SubscriptBox["q", "i"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"z", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"2", " ", 
                SubscriptBox["\[Theta]", "s"]}], "]"}]}], "-", 
             RowBox[{"2", " ", "\[ImaginaryI]", " ", 
              SubscriptBox["q", "s"], " ", 
              SubscriptBox["\[CapitalDelta]K", "y"]}]}], ")"}]}]}], ")"}], 
        "2"]}], 
      RowBox[{"2", " ", 
       SubscriptBox["q", "i"], " ", 
       SubscriptBox["q", "s"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
          SubscriptBox["q", "p"], " ", 
          SubscriptBox["q", "s"]}], "+", 
         RowBox[{
          SubscriptBox["q", "i"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox[
              RowBox[{"Cos", "[", 
               SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
             SubscriptBox["q", "p"]}], "+", 
            SubscriptBox["q", "s"]}], ")"}]}]}], ")"}]}]], "-", 
     RowBox[{"4", " ", "\[ImaginaryI]", " ", "z", " ", 
      SubscriptBox["\[CapitalDelta]K", "z"]}], "-", 
     FractionBox[
      RowBox[{"2", " ", 
       SuperscriptBox["z", "2"], " ", 
       SubsuperscriptBox["\[Rho]", "px", "2"]}], 
      SubscriptBox["q", "p"]], "-", 
     FractionBox[
      RowBox[{"2", " ", 
       SubscriptBox["q", "i"], " ", 
       SubscriptBox["q", "s"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["q", "p"], " ", 
           SubscriptBox["\[CapitalDelta]K", "x"]}], "-", 
          RowBox[{"\[ImaginaryI]", " ", "z", " ", 
           SubscriptBox["\[Rho]", "px"]}]}], ")"}], "2"]}], 
      RowBox[{
       SubscriptBox["q", "p"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["q", "p"], " ", 
          SubscriptBox["q", "s"]}], "+", 
         RowBox[{
          SubscriptBox["q", "i"], " ", 
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["q", "p"], "+", 
            SubscriptBox["q", "s"]}], ")"}]}]}], ")"}]}]]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{{3.582600966449912*^9, 3.582600994649864*^9}, {
   3.582601328096663*^9, 3.582601364204247*^9}, {3.58267239483342*^9, 
   3.582672406925791*^9}, 3.582673484252555*^9, {3.582674789175068*^9, 
   3.58267479965689*^9}, 3.58267678620081*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "now", " ", "the", " ", "constant", " ", "that", " ", "remains", " ", 
    "after", " ", "integrating", " ", "over", " ", "y", " ", 
    RowBox[{"is", ":"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"yconst", " ", "=", " ", 
   RowBox[{"Simplify", "[", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Sqrt]", "\[Pi]"}], "/", 
      RowBox[{"-", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "i"], "]"}], "2"], 
           RowBox[{"2", " ", 
            SubscriptBox["q", "i"]}]]}], "-", 
         FractionBox["1", 
          RowBox[{"2", " ", 
           SubscriptBox["q", "p"]}]], "-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}], "2"], 
          RowBox[{"2", " ", 
           SubscriptBox["q", "s"]}]]}], ")"}]}]}], " ", "//.", "rules2"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.582554034700173*^9, 3.5825540603452053`*^9}, {
   3.582554093889743*^9, 3.582554130244169*^9}, 3.582561974325897*^9, 
   3.5825988333434057`*^9, 3.582598872404625*^9, 3.582598959400226*^9, 
   3.5826013954180927`*^9, 3.582672420059969*^9, {3.582674789672102*^9, 
   3.582674793398522*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", 
   SqrtBox["\[Pi]"]}], 
  RowBox[{
   FractionBox[
    SuperscriptBox[
     RowBox[{"Cos", "[", 
      SubscriptBox["\[Theta]", "i"], "]"}], "2"], 
    SubsuperscriptBox["W", "i", "2"]], "+", 
   FractionBox["1", 
    SubsuperscriptBox["W", "p", "2"]], "+", 
   FractionBox[
    SuperscriptBox[
     RowBox[{"Cos", "[", 
      SubscriptBox["\[Theta]", "s"], "]"}], "2"], 
    SubsuperscriptBox["W", "s", "2"]]}]]], "Output",
 CellChangeTimes->{
  3.582554130698413*^9, 3.582561979372128*^9, 3.582562062470771*^9, 
   3.582563916348898*^9, 3.582564605173622*^9, 3.582582720631323*^9, 
   3.5825988390544653`*^9, 3.582598875468288*^9, 3.582598960757826*^9, 
   3.582601397438807*^9, 3.5826724210605307`*^9, 3.5826734843624887`*^9, {
   3.5826747833779507`*^9, 3.5826747940005703`*^9}, 3.582676786283609*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "This", " ", "leaves", " ", "the", " ", "remaing", " ", "z", " ", 
    "integrand"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ArgZ", ":=", 
    RowBox[{
     FractionBox["1", "4"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"2", " ", 
          SuperscriptBox["z", "2"], " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", 
            SubscriptBox["\[Theta]", "i"], "]"}], "2"]}], 
         SubscriptBox["q", "i"]]}], "-", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["z", "2"], " ", 
         SuperscriptBox[
          RowBox[{"Sin", "[", 
           SubscriptBox["\[Theta]", "s"], "]"}], "2"]}], 
        SubscriptBox["q", "s"]], "+", 
       FractionBox[
        RowBox[{
         SubscriptBox["q", "p"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"z", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"2", " ", 
               SubscriptBox["\[Theta]", "i"]}], "]"}], " ", 
             SubscriptBox["q", "s"]}], "+", 
            RowBox[{
             SubscriptBox["q", "i"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"z", " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"2", " ", 
                  SubscriptBox["\[Theta]", "s"]}], "]"}]}], "-", 
               RowBox[{"2", " ", "\[ImaginaryI]", " ", 
                SubscriptBox["q", "s"], " ", 
                SubscriptBox["\[CapitalDelta]K", "y"]}]}], ")"}]}]}], ")"}], 
          "2"]}], 
        RowBox[{"2", " ", 
         SubscriptBox["q", "i"], " ", 
         SubscriptBox["q", "s"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
            SubscriptBox["q", "p"], " ", 
            SubscriptBox["q", "s"]}], "+", 
           RowBox[{
            SubscriptBox["q", "i"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox[
                RowBox[{"Cos", "[", 
                 SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
               SubscriptBox["q", "p"]}], "+", 
              SubscriptBox["q", "s"]}], ")"}]}]}], ")"}]}]], "-", 
       RowBox[{"4", " ", "\[ImaginaryI]", " ", "z", " ", 
        SubscriptBox["\[CapitalDelta]K", "z"]}], "-", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["z", "2"], " ", 
         SubsuperscriptBox["\[Rho]", "px", "2"]}], 
        SubscriptBox["q", "p"]], "-", 
       FractionBox[
        RowBox[{"2", " ", 
         SubscriptBox["q", "i"], " ", 
         SubscriptBox["q", "s"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SubscriptBox["q", "p"], " ", 
             SubscriptBox["\[CapitalDelta]K", "x"]}], "-", 
            RowBox[{"\[ImaginaryI]", " ", "z", " ", 
             SubscriptBox["\[Rho]", "px"]}]}], ")"}], "2"]}], 
        RowBox[{
         SubscriptBox["q", "p"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["q", "p"], " ", 
            SubscriptBox["q", "s"]}], "+", 
           RowBox[{
            SubscriptBox["q", "i"], " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["q", "p"], "+", 
              SubscriptBox["q", "s"]}], ")"}]}]}], ")"}]}]]}], ")"}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"ArgZ", "=", 
    RowBox[{"Expand", "[", "ArgZ", "]"}]}], " ", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Collect", "[", 
     RowBox[{"ArgZ", ",", " ", "z"}], "]"}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.5825541447325993`*^9, 3.582554218173704*^9}, {
   3.582554311787928*^9, 3.582554332788763*^9}, 3.582562009349558*^9, 
   3.582598942001313*^9, 3.582599220705217*^9, 3.582601424927206*^9, {
   3.5826019630624943`*^9, 3.582601984307494*^9}, 3.5826724646779633`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     SuperscriptBox["z", "2"], " ", 
     SuperscriptBox[
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Theta]", "i"], "]"}], "2"]}], 
    RowBox[{"2", " ", 
     SubscriptBox["q", "i"]}]]}], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["z", "2"], " ", 
    SuperscriptBox[
     RowBox[{"Sin", "[", 
      SubscriptBox["\[Theta]", "s"], "]"}], "2"]}], 
   RowBox[{"2", " ", 
    SubscriptBox["q", "s"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["z", "2"], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", 
      SubscriptBox["\[Theta]", "i"]}], "]"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", 
      SubscriptBox["\[Theta]", "s"]}], "]"}], " ", 
    SubscriptBox["q", "p"]}], 
   RowBox[{"4", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
       SubscriptBox["q", "p"], " ", 
       SubscriptBox["q", "s"]}], "+", 
      RowBox[{
       SubscriptBox["q", "i"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
          SubscriptBox["q", "p"]}], "+", 
         SubscriptBox["q", "s"]}], ")"}]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["z", "2"], " ", 
    SuperscriptBox[
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       SubscriptBox["\[Theta]", "s"]}], "]"}], "2"], " ", 
    SubscriptBox["q", "i"], " ", 
    SubscriptBox["q", "p"]}], 
   RowBox[{"8", " ", 
    SubscriptBox["q", "s"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
       SubscriptBox["q", "p"], " ", 
       SubscriptBox["q", "s"]}], "+", 
      RowBox[{
       SubscriptBox["q", "i"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
          SubscriptBox["q", "p"]}], "+", 
         SubscriptBox["q", "s"]}], ")"}]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["z", "2"], " ", 
    SuperscriptBox[
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       SubscriptBox["\[Theta]", "i"]}], "]"}], "2"], " ", 
    SubscriptBox["q", "p"], " ", 
    SubscriptBox["q", "s"]}], 
   RowBox[{"8", " ", 
    SubscriptBox["q", "i"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
       SubscriptBox["q", "p"], " ", 
       SubscriptBox["q", "s"]}], "+", 
      RowBox[{
       SubscriptBox["q", "i"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
          SubscriptBox["q", "p"]}], "+", 
         SubscriptBox["q", "s"]}], ")"}]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["q", "i"], " ", 
    SubscriptBox["q", "p"], " ", 
    SubscriptBox["q", "s"], " ", 
    SubsuperscriptBox["\[CapitalDelta]K", "x", "2"]}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["q", "p"], " ", 
       SubscriptBox["q", "s"]}], "+", 
      RowBox[{
       SubscriptBox["q", "i"], " ", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["q", "p"], "+", 
         SubscriptBox["q", "s"]}], ")"}]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "z", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", 
      SubscriptBox["\[Theta]", "s"]}], "]"}], " ", 
    SubscriptBox["q", "i"], " ", 
    SubscriptBox["q", "p"], " ", 
    SubscriptBox["\[CapitalDelta]K", "y"]}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
       SubscriptBox["q", "p"], " ", 
       SubscriptBox["q", "s"]}], "+", 
      RowBox[{
       SubscriptBox["q", "i"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
          SubscriptBox["q", "p"]}], "+", 
         SubscriptBox["q", "s"]}], ")"}]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "z", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", 
      SubscriptBox["\[Theta]", "i"]}], "]"}], " ", 
    SubscriptBox["q", "p"], " ", 
    SubscriptBox["q", "s"], " ", 
    SubscriptBox["\[CapitalDelta]K", "y"]}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
       SubscriptBox["q", "p"], " ", 
       SubscriptBox["q", "s"]}], "+", 
      RowBox[{
       SubscriptBox["q", "i"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
          SubscriptBox["q", "p"]}], "+", 
         SubscriptBox["q", "s"]}], ")"}]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["q", "i"], " ", 
    SubscriptBox["q", "p"], " ", 
    SubscriptBox["q", "s"], " ", 
    SubsuperscriptBox["\[CapitalDelta]K", "y", "2"]}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
       SubscriptBox["q", "p"], " ", 
       SubscriptBox["q", "s"]}], "+", 
      RowBox[{
       SubscriptBox["q", "i"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
          SubscriptBox["q", "p"]}], "+", 
         SubscriptBox["q", "s"]}], ")"}]}]}], ")"}]}]], "-", 
  RowBox[{"\[ImaginaryI]", " ", "z", " ", 
   SubscriptBox["\[CapitalDelta]K", "z"]}], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "z", " ", 
    SubscriptBox["q", "i"], " ", 
    SubscriptBox["q", "s"], " ", 
    SubscriptBox["\[CapitalDelta]K", "x"], " ", 
    SubscriptBox["\[Rho]", "px"]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["q", "p"], " ", 
     SubscriptBox["q", "s"]}], "+", 
    RowBox[{
     SubscriptBox["q", "i"], " ", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["q", "p"], "+", 
       SubscriptBox["q", "s"]}], ")"}]}]}]], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["z", "2"], " ", 
    SubsuperscriptBox["\[Rho]", "px", "2"]}], 
   RowBox[{"2", " ", 
    SubscriptBox["q", "p"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["z", "2"], " ", 
    SubscriptBox["q", "i"], " ", 
    SubscriptBox["q", "s"], " ", 
    SubsuperscriptBox["\[Rho]", "px", "2"]}], 
   RowBox[{"2", " ", 
    SubscriptBox["q", "p"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["q", "p"], " ", 
       SubscriptBox["q", "s"]}], "+", 
      RowBox[{
       SubscriptBox["q", "i"], " ", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["q", "p"], "+", 
         SubscriptBox["q", "s"]}], ")"}]}]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{3.582601984772472*^9, 3.582672465640358*^9, 
  3.582672601247965*^9, 3.582673484409152*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.5826018942273493`*^9, 3.582601895957513*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.5825632693170843`*^9, 3.582563269332837*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"xconst", " ", ":=", " ", 
     RowBox[{"xconst", " ", "//.", " ", "rules2"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"yconst", " ", ":=", " ", 
     RowBox[{"yconst", " ", "//.", " ", "rules2"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Now", ",", " ", 
    RowBox[{
    "we", " ", "get", " ", "rid", " ", "of", " ", "any", " ", "terms", " ", 
     "that", " ", "contain", "  ", 
     RowBox[{
      SubscriptBox["\[Rho]", "px"], "^", "2"}], " ", "or", " ", "higher", " ",
      "as", " ", "they", " ", "are", " ", "negligible"}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"JJ", " ", "=", " ", 
    RowBox[{"ArgZ", "/.", " ", 
     RowBox[{"{", " ", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["\[Rho]", "px"], "2"], " ", "\[Rule]", "0"}], "}"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ArgZ", " ", "=", " ", 
     RowBox[{"Simplify", "[", "JJ", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"ArgZ", "=", 
     RowBox[{"Collect", "[", 
      RowBox[{
       RowBox[{"ArgZ", " ", "//.", "rules2"}], ",", "z"}], "]"}]}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.582554473777072*^9, 3.582554588179599*^9}, {
   3.582563145314126*^9, 3.5825632517348003`*^9}, {3.58256329315735*^9, 
   3.58256330327414*^9}, {3.5825635115427217`*^9, 3.5825635182783003`*^9}, {
   3.582563892798093*^9, 3.58256390481533*^9}, {3.582563972246334*^9, 
   3.582563975428649*^9}, {3.582564100937079*^9, 3.582564137722248*^9}, {
   3.5825645735318604`*^9, 3.582564580363806*^9}, {3.5825822430253277`*^9, 
   3.58258229028465*^9}, {3.582582327384783*^9, 3.582582347448052*^9}, {
   3.5825827076197166`*^9, 3.582582734656507*^9}, {3.582599143048251*^9, 
   3.5825991837069693`*^9}, 3.582599227371872*^9, {3.582601458056863*^9, 
   3.582601550430863*^9}, {3.5826015838963833`*^9, 3.582601588070138*^9}, {
   3.582601630749078*^9, 3.582601766646276*^9}, {3.582601796952317*^9, 
   3.582601807941141*^9}, {3.5826018444897013`*^9, 3.582602013667631*^9}, 
   3.582672511316489*^9, {3.582672571354567*^9, 3.582672607455125*^9}, {
   3.582673434737115*^9, 3.5826734394159822`*^9}, {3.582674808138917*^9, 
   3.582674818630746*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     SuperscriptBox["z", "2"], " ", 
     SuperscriptBox[
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Theta]", "i"], "]"}], "2"]}], 
    RowBox[{"2", " ", 
     SubscriptBox["q", "i"]}]]}], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["z", "2"], " ", 
    SuperscriptBox[
     RowBox[{"Sin", "[", 
      SubscriptBox["\[Theta]", "s"], "]"}], "2"]}], 
   RowBox[{"2", " ", 
    SubscriptBox["q", "s"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["z", "2"], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", 
      SubscriptBox["\[Theta]", "i"]}], "]"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", 
      SubscriptBox["\[Theta]", "s"]}], "]"}], " ", 
    SubscriptBox["q", "p"]}], 
   RowBox[{"4", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
       SubscriptBox["q", "p"], " ", 
       SubscriptBox["q", "s"]}], "+", 
      RowBox[{
       SubscriptBox["q", "i"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
          SubscriptBox["q", "p"]}], "+", 
         SubscriptBox["q", "s"]}], ")"}]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["z", "2"], " ", 
    SuperscriptBox[
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       SubscriptBox["\[Theta]", "s"]}], "]"}], "2"], " ", 
    SubscriptBox["q", "i"], " ", 
    SubscriptBox["q", "p"]}], 
   RowBox[{"8", " ", 
    SubscriptBox["q", "s"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
       SubscriptBox["q", "p"], " ", 
       SubscriptBox["q", "s"]}], "+", 
      RowBox[{
       SubscriptBox["q", "i"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
          SubscriptBox["q", "p"]}], "+", 
         SubscriptBox["q", "s"]}], ")"}]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["z", "2"], " ", 
    SuperscriptBox[
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       SubscriptBox["\[Theta]", "i"]}], "]"}], "2"], " ", 
    SubscriptBox["q", "p"], " ", 
    SubscriptBox["q", "s"]}], 
   RowBox[{"8", " ", 
    SubscriptBox["q", "i"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
       SubscriptBox["q", "p"], " ", 
       SubscriptBox["q", "s"]}], "+", 
      RowBox[{
       SubscriptBox["q", "i"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
          SubscriptBox["q", "p"]}], "+", 
         SubscriptBox["q", "s"]}], ")"}]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["q", "i"], " ", 
    SubscriptBox["q", "p"], " ", 
    SubscriptBox["q", "s"], " ", 
    SubsuperscriptBox["\[CapitalDelta]K", "x", "2"]}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["q", "p"], " ", 
       SubscriptBox["q", "s"]}], "+", 
      RowBox[{
       SubscriptBox["q", "i"], " ", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["q", "p"], "+", 
         SubscriptBox["q", "s"]}], ")"}]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "z", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", 
      SubscriptBox["\[Theta]", "s"]}], "]"}], " ", 
    SubscriptBox["q", "i"], " ", 
    SubscriptBox["q", "p"], " ", 
    SubscriptBox["\[CapitalDelta]K", "y"]}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
       SubscriptBox["q", "p"], " ", 
       SubscriptBox["q", "s"]}], "+", 
      RowBox[{
       SubscriptBox["q", "i"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
          SubscriptBox["q", "p"]}], "+", 
         SubscriptBox["q", "s"]}], ")"}]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "z", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", 
      SubscriptBox["\[Theta]", "i"]}], "]"}], " ", 
    SubscriptBox["q", "p"], " ", 
    SubscriptBox["q", "s"], " ", 
    SubscriptBox["\[CapitalDelta]K", "y"]}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
       SubscriptBox["q", "p"], " ", 
       SubscriptBox["q", "s"]}], "+", 
      RowBox[{
       SubscriptBox["q", "i"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
          SubscriptBox["q", "p"]}], "+", 
         SubscriptBox["q", "s"]}], ")"}]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["q", "i"], " ", 
    SubscriptBox["q", "p"], " ", 
    SubscriptBox["q", "s"], " ", 
    SubsuperscriptBox["\[CapitalDelta]K", "y", "2"]}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
       SubscriptBox["q", "p"], " ", 
       SubscriptBox["q", "s"]}], "+", 
      RowBox[{
       SubscriptBox["q", "i"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
          SubscriptBox["q", "p"]}], "+", 
         SubscriptBox["q", "s"]}], ")"}]}]}], ")"}]}]], "-", 
  RowBox[{"\[ImaginaryI]", " ", "z", " ", 
   SubscriptBox["\[CapitalDelta]K", "z"]}], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "z", " ", 
    SubscriptBox["q", "i"], " ", 
    SubscriptBox["q", "s"], " ", 
    SubscriptBox["\[CapitalDelta]K", "x"], " ", 
    SubscriptBox["\[Rho]", "px"]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["q", "p"], " ", 
     SubscriptBox["q", "s"]}], "+", 
    RowBox[{
     SubscriptBox["q", "i"], " ", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["q", "p"], "+", 
       SubscriptBox["q", "s"]}], ")"}]}]}]]}]], "Output",
 CellChangeTimes->{
  3.582601997999753*^9, {3.5826725079444857`*^9, 3.582672514540223*^9}, {
   3.582672575421391*^9, 3.5826726094117537`*^9}, 3.582673440061619*^9, 
   3.582673484563794*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{"ArgZ", ",", "z"}], "]"}], " ", "//.", " ", "rules2"}]}]], "Input",\

 CellChangeTimes->{{3.582602027890689*^9, 3.582602068890297*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "8"], " ", 
   SuperscriptBox["z", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"4", " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", 
          SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
        SubsuperscriptBox["W", "i", "2"]}], 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"Cos", "[", 
           SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
         SubsuperscriptBox["W", "p", "2"], " ", 
         SubsuperscriptBox["W", "s", "2"]}], "+", 
        RowBox[{
         SubsuperscriptBox["W", "i", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
            SubsuperscriptBox["W", "p", "2"]}], "+", 
           SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}]]}], "-", 
     FractionBox[
      RowBox[{"4", " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", 
         RowBox[{
          SubscriptBox["\[Theta]", "i"], "-", 
          SubscriptBox["\[Theta]", "s"]}], "]"}], "2"], " ", 
       SubsuperscriptBox["W", "p", "2"]}], 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
        SubsuperscriptBox["W", "p", "2"], " ", 
        SubsuperscriptBox["W", "s", "2"]}], "+", 
       RowBox[{
        SubsuperscriptBox["W", "i", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
           SubsuperscriptBox["W", "p", "2"]}], "+", 
          SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}]], "-", 
     FractionBox[
      RowBox[{"4", " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", 
         SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
       SubsuperscriptBox["W", "s", "2"]}], 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
        SubsuperscriptBox["W", "p", "2"], " ", 
        SubsuperscriptBox["W", "s", "2"]}], "+", 
       RowBox[{
        SubsuperscriptBox["W", "i", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
           SubsuperscriptBox["W", "p", "2"]}], "+", 
          SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}]]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   SubsuperscriptBox["W", "i", "2"], " ", 
   SubsuperscriptBox["W", "p", "2"], " ", 
   SubsuperscriptBox["W", "s", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"4", " ", 
        SubsuperscriptBox["\[CapitalDelta]K", "x", "2"]}], 
       RowBox[{
        RowBox[{
         SubsuperscriptBox["W", "p", "2"], " ", 
         SubsuperscriptBox["W", "s", "2"]}], "+", 
        RowBox[{
         SubsuperscriptBox["W", "i", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           SubsuperscriptBox["W", "p", "2"], "+", 
           SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}]]}], "-", 
     FractionBox[
      RowBox[{"4", " ", 
       SubsuperscriptBox["\[CapitalDelta]K", "y", "2"]}], 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
        SubsuperscriptBox["W", "p", "2"], " ", 
        SubsuperscriptBox["W", "s", "2"]}], "+", 
       RowBox[{
        SubsuperscriptBox["W", "i", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
           SubsuperscriptBox["W", "p", "2"]}], "+", 
          SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}]]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", "z", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"4", " ", "\[ImaginaryI]", " ", 
        SubsuperscriptBox["W", "p", "2"], " ", 
        SubsuperscriptBox["W", "s", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", 
             SubscriptBox["\[Theta]", "i"]}], "]"}], " ", 
           SubscriptBox["\[CapitalDelta]K", "y"]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
           SubscriptBox["\[CapitalDelta]K", "z"]}]}], ")"}]}], 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"Cos", "[", 
           SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
         SubsuperscriptBox["W", "p", "2"], " ", 
         SubsuperscriptBox["W", "s", "2"]}], "+", 
        RowBox[{
         SubsuperscriptBox["W", "i", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
            SubsuperscriptBox["W", "p", "2"]}], "+", 
           SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}]]}], "-", 
     FractionBox[
      RowBox[{"8", " ", "\[ImaginaryI]", " ", 
       RowBox[{"Cos", "[", 
        SubscriptBox["\[Theta]", "s"], "]"}], " ", 
       SubsuperscriptBox["W", "i", "2"], " ", 
       SubsuperscriptBox["W", "p", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           SubscriptBox["\[Theta]", "s"], "]"}], " ", 
          SubscriptBox["\[CapitalDelta]K", "y"]}], "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           SubscriptBox["\[Theta]", "s"], "]"}], " ", 
          SubscriptBox["\[CapitalDelta]K", "z"]}]}], ")"}]}], 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
        SubsuperscriptBox["W", "p", "2"], " ", 
        SubsuperscriptBox["W", "s", "2"]}], "+", 
       RowBox[{
        SubsuperscriptBox["W", "i", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
           SubsuperscriptBox["W", "p", "2"]}], "+", 
          SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}]], "+", 
     RowBox[{"4", " ", 
      SubsuperscriptBox["W", "i", "2"], " ", 
      SubsuperscriptBox["W", "s", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"2", " ", "\[ImaginaryI]", " ", 
           SubscriptBox["\[CapitalDelta]K", "z"]}], 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
            SubsuperscriptBox["W", "p", "2"], " ", 
            SubsuperscriptBox["W", "s", "2"]}], "+", 
           RowBox[{
            SubsuperscriptBox["W", "i", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox[
                RowBox[{"Cos", "[", 
                 SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
               SubsuperscriptBox["W", "p", "2"]}], "+", 
              SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}]]}], "+", 
        FractionBox[
         RowBox[{"2", " ", "\[ImaginaryI]", " ", 
          SubscriptBox["\[CapitalDelta]K", "x"], " ", 
          SubscriptBox["\[Rho]", "px"]}], 
         RowBox[{
          RowBox[{
           SubsuperscriptBox["W", "p", "2"], " ", 
           SubsuperscriptBox["W", "s", "2"]}], "+", 
          RowBox[{
           SubsuperscriptBox["W", "i", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             SubsuperscriptBox["W", "p", "2"], "+", 
             SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}]]}], ")"}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{3.5826020396052856`*^9, 3.582602070339744*^9, 
  3.582672616048633*^9, 3.582673504074059*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"The", " ", "integral", " ", "has", " ", "a", " ", "familar", " ", 
     RowBox[{"form", ".", " ", 
      RowBox[{"Let", "'"}]}], "s", " ", "see", " ", "if", " ", "Mathematica", 
     " ", "can", " ", "do", " ", "the", " ", "integration", " ", "straight", 
     " ", 
     RowBox[{"up", ".", " ", "Otherwise"}]}], ",", " ", 
    RowBox[{
    "compare", " ", "it", " ", "to", " ", "a", " ", "known", " ", 
     "solution"}]}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"IntZ", ":=", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Exp", "[", "ArgZ", "]"}], " ", "*", "yconst", "*", 
        "xconst"}], "//.", " ", "rules2"}], "]"}], "\[IndentingNewLine]", 
     RowBox[{"Assuming", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["W", "i"], ">", "0"}], "  ", "&&", "  ", 
        RowBox[{
         SubscriptBox["W", "s"], ">", "0"}], "  ", "&&", " ", 
        RowBox[{
         SubscriptBox["W", "p"], ">", "0"}], " ", "&&", " ", 
        RowBox[{
         SubscriptBox["\[CapitalDelta]K", "x"], ">", "0"}], " ", "&&", " ", 
        RowBox[{
         SubscriptBox["\[CapitalDelta]K", "y"], ">", "0"}], " ", "&&", " ", 
        RowBox[{
         SubscriptBox["\[CapitalDelta]K", "z"], ">", "0"}], "  ", "&&", " ", 
        RowBox[{
         SubscriptBox["\[Theta]", "i"], ">", "0"}], " ", "&&", " ", 
        RowBox[{
         SubscriptBox["\[Theta]", "s"], ">", "0"}]}], ",", "   ", 
       RowBox[{"Integrate", "[", 
        RowBox[{"IntZ", ",", " ", 
         RowBox[{"{", 
          RowBox[{"z", ",", "0", ",", "L"}], "}"}]}], "]"}]}], "]"}]}]}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.582563503557109*^9, 3.582563571134346*^9}, {
   3.582563625488155*^9, 3.5825637015706167`*^9}, {3.58256373619261*^9, 
   3.582563751911689*^9}, {3.582564140120492*^9, 3.5825641414428*^9}, {
   3.582582395941203*^9, 3.58258245816571*^9}, 3.582599165258992*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Mathematica", " ", 
    RowBox[{"can", "'"}], "t", " ", "integrate", " ", 
    RowBox[{"this", ".", " ", "Look"}], " ", "at", " ", "coefficients", " ", 
    "for", " ", "the", " ", "integral", " ", "to", " ", "get", " ", "it", " ",
     "in", " ", "the", " ", "right", " ", "form"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"AA", "=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      FractionBox[
       RowBox[{"-", "1"}], "8"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"4", " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", 
             SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
           SubsuperscriptBox["W", "i", "2"]}], 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
            SubsuperscriptBox["W", "p", "2"], " ", 
            SubsuperscriptBox["W", "s", "2"]}], "+", 
           RowBox[{
            SubsuperscriptBox["W", "i", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox[
                RowBox[{"Cos", "[", 
                 SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
               SubsuperscriptBox["W", "p", "2"]}], "+", 
              SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}]]}], "-", 
        FractionBox[
         RowBox[{"4", " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", 
            RowBox[{
             SubscriptBox["\[Theta]", "i"], "-", 
             SubscriptBox["\[Theta]", "s"]}], "]"}], "2"], " ", 
          SubsuperscriptBox["W", "p", "2"]}], 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
           SubsuperscriptBox["W", "p", "2"], " ", 
           SubsuperscriptBox["W", "s", "2"]}], "+", 
          RowBox[{
           SubsuperscriptBox["W", "i", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox[
               RowBox[{"Cos", "[", 
                SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
              SubsuperscriptBox["W", "p", "2"]}], "+", 
             SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}]], "-", 
        FractionBox[
         RowBox[{"4", " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", 
            SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
          SubsuperscriptBox["W", "s", "2"]}], 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
           SubsuperscriptBox["W", "p", "2"], " ", 
           SubsuperscriptBox["W", "s", "2"]}], "+", 
          RowBox[{
           SubsuperscriptBox["W", "i", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox[
               RowBox[{"Cos", "[", 
                SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
              SubsuperscriptBox["W", "p", "2"]}], "+", 
             SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}]]}], ")"}]}], 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"BB", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "/", "\[ImaginaryI]"}], " ", 
       FractionBox["1", "8"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"4", " ", "\[ImaginaryI]", " ", 
            SubsuperscriptBox["W", "p", "2"], " ", 
            SubsuperscriptBox["W", "s", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"2", " ", 
                 SubscriptBox["\[Theta]", "i"]}], "]"}], " ", 
               SubscriptBox["\[CapitalDelta]K", "y"]}], "+", 
              RowBox[{"2", " ", 
               SuperscriptBox[
                RowBox[{"Cos", "[", 
                 SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
               SubscriptBox["\[CapitalDelta]K", "z"]}]}], ")"}]}], 
           RowBox[{
            RowBox[{
             SuperscriptBox[
              RowBox[{"Cos", "[", 
               SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
             SubsuperscriptBox["W", "p", "2"], " ", 
             SubsuperscriptBox["W", "s", "2"]}], "+", 
            RowBox[{
             SubsuperscriptBox["W", "i", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox[
                 RowBox[{"Cos", "[", 
                  SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
                SubsuperscriptBox["W", "p", "2"]}], "+", 
               SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}]]}], "-", 
         FractionBox[
          RowBox[{"8", " ", "\[ImaginaryI]", " ", 
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}], " ", 
           SubsuperscriptBox["W", "i", "2"], " ", 
           SubsuperscriptBox["W", "p", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Sin", "[", 
               SubscriptBox["\[Theta]", "s"], "]"}], " ", 
              SubscriptBox["\[CapitalDelta]K", "y"]}], "+", 
             RowBox[{
              RowBox[{"Cos", "[", 
               SubscriptBox["\[Theta]", "s"], "]"}], " ", 
              SubscriptBox["\[CapitalDelta]K", "z"]}]}], ")"}]}], 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
            SubsuperscriptBox["W", "p", "2"], " ", 
            SubsuperscriptBox["W", "s", "2"]}], "+", 
           RowBox[{
            SubsuperscriptBox["W", "i", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox[
                RowBox[{"Cos", "[", 
                 SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
               SubsuperscriptBox["W", "p", "2"]}], "+", 
              SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}]], "+", 
         RowBox[{"4", " ", 
          SubsuperscriptBox["W", "i", "2"], " ", 
          SubsuperscriptBox["W", "s", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             FractionBox[
              RowBox[{"2", " ", "\[ImaginaryI]", " ", 
               SubscriptBox["\[CapitalDelta]K", "z"]}], 
              RowBox[{
               RowBox[{
                SuperscriptBox[
                 RowBox[{"Cos", "[", 
                  SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
                SubsuperscriptBox["W", "p", "2"], " ", 
                SubsuperscriptBox["W", "s", "2"]}], "+", 
               RowBox[{
                SubsuperscriptBox["W", "i", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
                   SubsuperscriptBox["W", "p", "2"]}], "+", 
                  SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}]]}], "+", 
            FractionBox[
             RowBox[{"2", " ", "\[ImaginaryI]", " ", 
              SubscriptBox["\[CapitalDelta]K", "x"], " ", 
              SubscriptBox["\[Rho]", "px"]}], 
             RowBox[{
              RowBox[{
               SubsuperscriptBox["W", "p", "2"], " ", 
               SubsuperscriptBox["W", "s", "2"]}], "+", 
              RowBox[{
               SubsuperscriptBox["W", "i", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 SubsuperscriptBox["W", "p", "2"], "+", 
                 SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}]]}], ")"}]}]}], 
        ")"}]}], ")"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"CC", "=", 
    RowBox[{"Simplify", "[", " ", 
     RowBox[{
      RowBox[{"-", " ", 
       FractionBox["1", "8"]}], " ", 
      SubsuperscriptBox["W", "i", "2"], " ", 
      SubsuperscriptBox["W", "p", "2"], " ", 
      SubsuperscriptBox["W", "s", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"4", " ", 
           SubsuperscriptBox["\[CapitalDelta]K", "x", "2"]}], 
          RowBox[{
           RowBox[{
            SubsuperscriptBox["W", "p", "2"], " ", 
            SubsuperscriptBox["W", "s", "2"]}], "+", 
           RowBox[{
            SubsuperscriptBox["W", "i", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SubsuperscriptBox["W", "p", "2"], "+", 
              SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}]]}], "-", 
        FractionBox[
         RowBox[{"4", " ", 
          SubsuperscriptBox["\[CapitalDelta]K", "y", "2"]}], 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
           SubsuperscriptBox["W", "p", "2"], " ", 
           SubsuperscriptBox["W", "s", "2"]}], "+", 
          RowBox[{
           SubsuperscriptBox["W", "i", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox[
               RowBox[{"Cos", "[", 
                SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
              SubsuperscriptBox["W", "p", "2"]}], "+", 
             SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}]]}], ")"}]}], 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"IZ", ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"-", " ", "AA"}], "*", 
      RowBox[{"z", "^", "2"}]}], " ", "-", 
     RowBox[{"\[ImaginaryI]", "*", "BB", "*", "z"}], " ", "-", " ", "CC", 
     "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.582563620017631*^9, 3.58256362241917*^9}, {
   3.5825641857005157`*^9, 3.582564352469962*^9}, {3.582564388443557*^9, 
   3.5825644916333723`*^9}, 3.582564534937364*^9, {3.5825646146750507`*^9, 
   3.5825646276376543`*^9}, 3.582566906889018*^9, {3.582582463766726*^9, 
   3.5825824699499607`*^9}, {3.5825992613851957`*^9, 3.58259940031949*^9}, {
   3.582599446730751*^9, 3.5825994739564962`*^9}, {3.582602132738472*^9, 
   3.582602232991704*^9}, {3.582672638006193*^9, 3.582672720123804*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"Sin", "[", 
      SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
    SubsuperscriptBox["W", "i", "2"]}], "+", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["\[Theta]", "i"], "-", 
       SubscriptBox["\[Theta]", "s"]}], "]"}], "2"], " ", 
    SubsuperscriptBox["W", "p", "2"]}], "+", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"Sin", "[", 
      SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
    SubsuperscriptBox["W", "s", "2"]}]}], 
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"Cos", "[", 
        SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
      SubsuperscriptBox["W", "p", "2"], " ", 
      SubsuperscriptBox["W", "s", "2"]}], "+", 
     RowBox[{
      SubsuperscriptBox["W", "i", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"Cos", "[", 
           SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
         SubsuperscriptBox["W", "p", "2"]}], "+", 
        SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}], ")"}]}]]], "Output",
 CellChangeTimes->{
  3.582599312230197*^9, {3.582599377997737*^9, 3.582599401336762*^9}, {
   3.5825994643357487`*^9, 3.58259947446242*^9}, {3.58260221884912*^9, 
   3.582602236872472*^9}, 3.582672675652617*^9, {3.5826727056635857`*^9, 
   3.582672721096286*^9}, 3.582673504217643*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"Cos", "[", 
     SubscriptBox["\[Theta]", "i"], "]"}], " ", 
    SubsuperscriptBox["W", "p", "2"], " ", 
    SubsuperscriptBox["W", "s", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Sin", "[", 
        SubscriptBox["\[Theta]", "i"], "]"}], " ", 
       SubscriptBox["\[CapitalDelta]K", "y"]}], "+", 
      RowBox[{
       RowBox[{"Cos", "[", 
        SubscriptBox["\[Theta]", "i"], "]"}], " ", 
       SubscriptBox["\[CapitalDelta]K", "z"]}]}], ")"}]}], 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
     SubsuperscriptBox["W", "p", "2"], " ", 
     SubsuperscriptBox["W", "s", "2"]}], "+", 
    RowBox[{
     SubsuperscriptBox["W", "i", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
        SubsuperscriptBox["W", "p", "2"]}], "+", 
       SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}]], "+", 
  RowBox[{
   SubsuperscriptBox["W", "i", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"Cos", "[", 
        SubscriptBox["\[Theta]", "s"], "]"}], " ", 
       SubsuperscriptBox["W", "p", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           SubscriptBox["\[Theta]", "s"], "]"}], " ", 
          SubscriptBox["\[CapitalDelta]K", "y"]}], "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           SubscriptBox["\[Theta]", "s"], "]"}], " ", 
          SubscriptBox["\[CapitalDelta]K", "z"]}]}], ")"}]}], 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
        SubsuperscriptBox["W", "p", "2"], " ", 
        SubsuperscriptBox["W", "s", "2"]}], "+", 
       RowBox[{
        SubsuperscriptBox["W", "i", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
           SubsuperscriptBox["W", "p", "2"]}], "+", 
          SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}]], "+", 
     RowBox[{
      SubsuperscriptBox["W", "s", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         SubscriptBox["\[CapitalDelta]K", "z"], 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
           SubsuperscriptBox["W", "p", "2"], " ", 
           SubsuperscriptBox["W", "s", "2"]}], "+", 
          RowBox[{
           SubsuperscriptBox["W", "i", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox[
               RowBox[{"Cos", "[", 
                SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
              SubsuperscriptBox["W", "p", "2"]}], "+", 
             SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}]], "-", 
        FractionBox[
         RowBox[{
          SubscriptBox["\[CapitalDelta]K", "x"], " ", 
          SubscriptBox["\[Rho]", "px"]}], 
         RowBox[{
          RowBox[{
           SubsuperscriptBox["W", "p", "2"], " ", 
           SubsuperscriptBox["W", "s", "2"]}], "+", 
          RowBox[{
           SubsuperscriptBox["W", "i", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             SubsuperscriptBox["W", "p", "2"], "+", 
             SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}]]}], ")"}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.582599312230197*^9, {3.582599377997737*^9, 3.582599401336762*^9}, {
   3.5825994643357487`*^9, 3.58259947446242*^9}, {3.58260221884912*^9, 
   3.582602236872472*^9}, 3.582672675652617*^9, {3.5826727056635857`*^9, 
   3.582672721096286*^9}, 3.58267351035605*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", "8"]}], " ", 
  SubsuperscriptBox["W", "i", "2"], " ", 
  SubsuperscriptBox["W", "p", "2"], " ", 
  SubsuperscriptBox["W", "s", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"4", " ", 
       SubsuperscriptBox["\[CapitalDelta]K", "x", "2"]}], 
      RowBox[{
       RowBox[{
        SubsuperscriptBox["W", "p", "2"], " ", 
        SubsuperscriptBox["W", "s", "2"]}], "+", 
       RowBox[{
        SubsuperscriptBox["W", "i", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SubsuperscriptBox["W", "p", "2"], "+", 
          SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}]]}], "-", 
    FractionBox[
     RowBox[{"4", " ", 
      SubsuperscriptBox["\[CapitalDelta]K", "y", "2"]}], 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "i"], "]"}], "2"], " ", 
       SubsuperscriptBox["W", "p", "2"], " ", 
       SubsuperscriptBox["W", "s", "2"]}], "+", 
      RowBox[{
       SubsuperscriptBox["W", "i", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
          SubsuperscriptBox["W", "p", "2"]}], "+", 
         SubsuperscriptBox["W", "s", "2"]}], ")"}]}]}]]}], ")"}]}]], "Output",\

 CellChangeTimes->{
  3.582599312230197*^9, {3.582599377997737*^9, 3.582599401336762*^9}, {
   3.5825994643357487`*^9, 3.58259947446242*^9}, {3.58260221884912*^9, 
   3.582602236872472*^9}, 3.582672675652617*^9, {3.5826727056635857`*^9, 
   3.582672721096286*^9}, 3.582673510358427*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"While", " ", "AA"}], ",", " ", "BB", ",", " ", 
    RowBox[{"and", " ", "CC", " ", "look", " ", "initially", " ", "ugly"}], 
    ",", " ", 
    RowBox[{"they", " ", "simplify", " ", "down", " ", 
     RowBox[{"somewhat", ".", " ", "This"}], " ", "leaves", " ", "us", " ", 
     "with", " ", "real", " ", "coefficients", " ", "for", " ", 
     RowBox[{"z", "^", "2"}], " ", "and", " ", "imaginary", " ", 
     "coefficents", " ", "for", " ", 
     RowBox[{"z", ".", " ", "Now"}]}], ",", " ", 
    RowBox[{
    "this", " ", "integral", " ", "leads", " ", "to", " ", "error", " ", 
     RowBox[{"functions", ".", " ", "Instead"}]}], ",", " ", 
    RowBox[{
    "look", " ", "at", " ", "Taylor", " ", "expanding", " ", "what", " ", 
     "is", " ", "in", " ", "the", " ", "integrand", " ", "and", " ", "then", 
     " ", "carry", " ", "out", " ", "the", " ", 
     RowBox[{"integral", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"IntResult", "=", 
   RowBox[{"Normal", "[", 
    RowBox[{"Assuming", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"R", ">", 
        RowBox[{"-", "inf"}]}], " ", "&&", " ", 
       RowBox[{"S", ">", 
        RowBox[{"-", "inf"}]}], " ", "&&", " ", 
       RowBox[{"T", ">", 
        RowBox[{"-", "inf"}]}]}], " ", ",", " ", 
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{"Series", "[", 
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"z", "^", "2"}]}], " ", "*", 
             RowBox[{"(", "R", " ", ")"}]}], " ", "-", 
            RowBox[{"z", " ", "*", 
             RowBox[{"(", 
              RowBox[{"\[ImaginaryI]", "*", "S"}], ")"}]}], " ", "-", " ", 
            "T"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"z", ",", "0", ",", "5"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", "0", ",", "L"}], "}"}]}], "]"}]}], "]"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.582554473777072*^9, 3.582554588179599*^9}, {
  3.582563145314126*^9, 3.582563242592822*^9}, {3.582564883858027*^9, 
  3.582564919110215*^9}, {3.5825655945600653`*^9, 3.582565621315242*^9}, {
  3.5825657398885517`*^9, 3.5825657602812653`*^9}, {3.582565946249815*^9, 
  3.582565955330447*^9}, {3.5825824931669617`*^9, 3.582582544077121*^9}, {
  3.582599520399379*^9, 3.582599539740485*^9}, {3.582673358218238*^9, 
  3.582673361863228*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", "T"}]], " ", "L"}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", "T"}]], " ", 
   SuperscriptBox["L", "2"], " ", "S"}], "-", 
  RowBox[{
   FractionBox["1", "6"], " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", "T"}]], " ", 
   SuperscriptBox["L", "3"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "R"}], "+", 
     SuperscriptBox["S", "2"]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "24"], " ", "\[ImaginaryI]", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", "T"}]], " ", 
   SuperscriptBox["L", "4"], " ", "S", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"6", " ", "R"}], "+", 
     SuperscriptBox["S", "2"]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "120"], " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", "T"}]], " ", 
   SuperscriptBox["L", "5"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"12", " ", 
      SuperscriptBox["R", "2"]}], "+", 
     RowBox[{"12", " ", "R", " ", 
      SuperscriptBox["S", "2"]}], "+", 
     SuperscriptBox["S", "4"]}], ")"}]}], "-", 
  RowBox[{
   FractionBox["1", "720"], " ", "\[ImaginaryI]", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", "T"}]], " ", 
   SuperscriptBox["L", "6"], " ", "S", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"60", " ", 
      SuperscriptBox["R", "2"]}], "+", 
     RowBox[{"20", " ", "R", " ", 
      SuperscriptBox["S", "2"]}], "+", 
     SuperscriptBox["S", "4"]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.582565622214054*^9, {3.582565743315255*^9, 3.582565760800931*^9}, {
   3.582565950094211*^9, 3.582565956028761*^9}, 3.5825825471744757`*^9, 
   3.582599594223233*^9, 3.582672737164054*^9, 3.5826733626764097`*^9, 
   3.58267351062072*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"So", ",", " ", 
    RowBox[{
    "by", " ", "doing", " ", "the", " ", "series", " ", "expansion", " ", 
     "to", " ", "the", " ", "5", "th", " ", "order"}], ",", " ", 
    RowBox[{
     RowBox[{"we", " ", "can", " ", "easily", " ", "find", " ", "the", " ", 
      RowBox[{"integral", ".", " ", "Here"}], " ", "R"}], " ", "=", " ", 
     "AA"}], ",", " ", 
    RowBox[{"S", " ", "=", " ", "BB"}], ",", " ", 
    RowBox[{
     RowBox[{"and", " ", "T"}], "=", " ", 
     RowBox[{
      RowBox[{"CC", ".", " ", "This"}], " ", 
      RowBox[{"isn", "'"}], "t", " ", "terrible", " ", "as", " ", "AA"}]}], 
    ",", " ", "BB", ",", " ", 
    RowBox[{
     RowBox[{
     "and", " ", "CC", " ", "are", " ", "just", " ", "constants", " ", "and", 
      " ", "can", " ", "be", " ", "individually", " ", "evaluated", " ", 
      RowBox[{"easily", ".", "  ", "At"}], " ", "the", " ", "bottom", " ", 
      "of", " ", "this", " ", "workbook", " ", "I", " ", "test", " ", "how", 
      " ", "valid", " ", "this", " ", "approximation", " ", 
      RowBox[{"is", ".", " ", "As"}], " ", "long", " ", "as", " ", "L", "*", 
      RowBox[{"Sqrt", "[", "R", "]"}]}], " ", "<", 
     RowBox[{
     "1", " ", "the", " ", "error", " ", "should", " ", "be", " ", "less", 
      " ", 
      RowBox[{"than", " ", "~", "1"}], 
      RowBox[{"%", ".", " ", "As"}], " ", "L", "*", 
      RowBox[{"Sqrt", "[", "R", "]"}], " ", 
      RowBox[{"<<", "1"}]}]}], ",", " ", 
    RowBox[{"the", " ", "approx", " ", "is", " ", "very", " ", 
     RowBox[{"good", "."}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Simplify", "[", 
    RowBox[{"IntResult", " ", "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"R", " ", "\[Rule]", " ", "AA"}], ",", " ", 
       RowBox[{"S", " ", "\[Rule]", " ", "BB"}], ",", " ", 
       RowBox[{"T", " ", "\[Rule]", " ", "CC"}]}], "}"}]}], "]"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"If", " ", "we", " ", "assume", " ", "that", " ", "Ws"}], " ", 
     "=", " ", "Wi"}], ",", " ", 
    RowBox[{"then", " ", "we", " ", "get", " ", "even", " ", "further", " ", 
     RowBox[{"simplification", ".", " ", 
      RowBox[{"Don", "'"}]}], "t", " ", "think", " ", "I", " ", "want", " ", 
     "to", " ", "do", " ", "this", " ", "in", " ", "the", " ", "final", " ", 
     RowBox[{"program", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"AAsame", " ", "=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{"AA", " ", "//.", " ", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["W", "i"], " ", "\[Rule]", " ", 
        SubscriptBox["W", "s"]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"BBsame", " ", "=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{"BB", " ", "//.", " ", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["W", "i"], " ", "\[Rule]", " ", 
        SubscriptBox["W", "s"]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"CCsame", " ", "=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{"CC", " ", "//.", " ", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["W", "i"], " ", "\[Rule]", " ", 
        SubscriptBox["W", "s"]}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.582564465934472*^9, 3.582564468357284*^9}, {
  3.58256588940904*^9, 3.582566005477667*^9}, {3.582566115215287*^9, 
  3.582566124394775*^9}, {3.582566168163336*^9, 3.582566191426721*^9}, {
  3.582567273548449*^9, 3.5825674034587*^9}, {3.582569022950839*^9, 
  3.5825690391583433`*^9}, {3.582581808543288*^9, 3.582581917934*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"Sin", "[", 
      RowBox[{
       SubscriptBox["\[Theta]", "i"], "-", 
       SubscriptBox["\[Theta]", "s"]}], "]"}], "2"], " ", 
    SubsuperscriptBox["W", "p", "2"]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"Sin", "[", 
        SubscriptBox["\[Theta]", "i"], "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"Sin", "[", 
        SubscriptBox["\[Theta]", "s"], "]"}], "2"]}], ")"}], " ", 
    SubsuperscriptBox["W", "s", "2"]}]}], 
  RowBox[{"2", " ", 
   SubsuperscriptBox["W", "s", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Theta]", "i"], "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Theta]", "s"], "]"}], "2"]}], ")"}], " ", 
      SubsuperscriptBox["W", "p", "2"]}], "+", 
     SubsuperscriptBox["W", "s", "2"]}], ")"}]}]]], "Output",
 CellChangeTimes->{3.582566007106476*^9, 3.5825661519987373`*^9, 
  3.58256733049247*^9, 3.582567366875348*^9, 3.5825674048477*^9, 
  3.582599604388288*^9, 3.582602281199809*^9, 3.582672740276596*^9, 
  3.582673510703857*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    SubsuperscriptBox["W", "p", "4"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", 
           SubscriptBox["\[Theta]", "i"]}], "]"}], "+", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", 
           SubscriptBox["\[Theta]", "s"]}], "]"}]}], ")"}], " ", 
       SubscriptBox["\[CapitalDelta]K", "y"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"2", "+", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", 
           SubscriptBox["\[Theta]", "i"]}], "]"}], "+", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", 
           SubscriptBox["\[Theta]", "s"]}], "]"}]}], ")"}], " ", 
       SubscriptBox["\[CapitalDelta]K", "z"]}]}], ")"}]}], "+", 
   RowBox[{
    SubsuperscriptBox["W", "s", "4"], " ", 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["\[CapitalDelta]K", "z"], "-", 
      RowBox[{
       SubscriptBox["\[CapitalDelta]K", "x"], " ", 
       SubscriptBox["\[Rho]", "px"]}]}], ")"}]}], "+", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    SubsuperscriptBox["W", "p", "2"], " ", 
    SubsuperscriptBox["W", "s", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", 
           SubscriptBox["\[Theta]", "i"]}], "]"}], "+", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", 
           SubscriptBox["\[Theta]", "s"]}], "]"}]}], ")"}], " ", 
       SubscriptBox["\[CapitalDelta]K", "y"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"6", "+", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", 
           SubscriptBox["\[Theta]", "i"]}], "]"}], "+", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", 
           SubscriptBox["\[Theta]", "s"]}], "]"}]}], ")"}], " ", 
       SubscriptBox["\[CapitalDelta]K", "z"]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"2", "+", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", 
           SubscriptBox["\[Theta]", "i"]}], "]"}], "+", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", 
           SubscriptBox["\[Theta]", "s"]}], "]"}]}], ")"}], " ", 
       SubscriptBox["\[CapitalDelta]K", "x"], " ", 
       SubscriptBox["\[Rho]", "px"]}]}], ")"}]}]}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      SubsuperscriptBox["W", "p", "2"]}], "+", 
     SubsuperscriptBox["W", "s", "2"]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Theta]", "i"], "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Theta]", "s"], "]"}], "2"]}], ")"}], " ", 
      SubsuperscriptBox["W", "p", "2"]}], "+", 
     SubsuperscriptBox["W", "s", "2"]}], ")"}]}]]], "Output",
 CellChangeTimes->{3.582566007106476*^9, 3.5825661519987373`*^9, 
  3.58256733049247*^9, 3.582567366875348*^9, 3.5825674048477*^9, 
  3.582599604388288*^9, 3.582602281199809*^9, 3.582672740276596*^9, 
  3.582673511238571*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", "8"]}], " ", 
  SubsuperscriptBox["W", "p", "2"], " ", 
  SubsuperscriptBox["W", "s", "4"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"4", " ", 
       SubsuperscriptBox["\[CapitalDelta]K", "x", "2"]}], 
      RowBox[{
       RowBox[{"2", " ", 
        SubsuperscriptBox["W", "p", "2"], " ", 
        SubsuperscriptBox["W", "s", "2"]}], "+", 
       SubsuperscriptBox["W", "s", "4"]}]]}], "-", 
    FractionBox[
     RowBox[{"4", " ", 
      SubsuperscriptBox["\[CapitalDelta]K", "y", "2"]}], 
     RowBox[{
      SubsuperscriptBox["W", "s", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "i"], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "s"], "]"}], "2"]}], ")"}], " ", 
         SubsuperscriptBox["W", "p", "2"]}], "+", 
        SubsuperscriptBox["W", "s", "2"]}], ")"}]}]]}], ")"}]}]], "Output",
 CellChangeTimes->{3.582566007106476*^9, 3.5825661519987373`*^9, 
  3.58256733049247*^9, 3.582567366875348*^9, 3.5825674048477*^9, 
  3.582599604388288*^9, 3.582602281199809*^9, 3.582672740276596*^9, 
  3.582673511497753*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"OK", ",", " ", 
    RowBox[{
     RowBox[{
     "now", " ", "what", " ", "if", " ", "we", " ", "substitute", " ", "in", 
      " ", "the", " ", "values", " ", "for", " ", "q_p", " ", "and", " ", 
      RowBox[{"q_s", ".", " ", "Need"}], " ", "to", " ", "start", " ", 
      RowBox[{"over", "!"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "Arg2"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "/", 
         RowBox[{"(", 
          RowBox[{"2", "*", 
           SubscriptBox["q", "s"]}], ")"}]}], "*", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["x", "s"], "2"], "+", 
          SuperscriptBox[
           SubscriptBox["y", "s"], "2"]}], ")"}]}], "-", 
       RowBox[{
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{"2", "*", 
           SubscriptBox["q", "i"]}], ")"}]}], 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["x", "i"], "2"], "+", 
          SuperscriptBox[
           SubscriptBox["y", "i"], "2"]}], ")"}]}], "-", 
       RowBox[{
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{"2", "*", 
           SubscriptBox["q", "p"]}], ")"}]}], "*", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"]}], ")"}]}], " ", "-", " ", 
       RowBox[{"\[ImaginaryI]", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["\[CapitalDelta]K", "x"], "*", "x"}], " ", "+", " ", 
          RowBox[{
           SubscriptBox["\[CapitalDelta]K", "y"], "*", "y"}], "+", 
          RowBox[{
           SubscriptBox["\[CapitalDelta]K", "z"], "*", "z"}]}], ")"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "rules1"}]}], " ", ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           SubscriptBox["q", "p"], " ", "\[Rule]", " ", 
           RowBox[{
            SuperscriptBox[
             SubscriptBox["W", "p"], "2"], " ", "+", " ", 
            RowBox[{"2", "*", "\[ImaginaryI]", "*", 
             RowBox[{"z", "/", 
              SubscriptBox["k", "p"]}]}]}]}], ",", " ", 
          RowBox[{
           SubscriptBox["q", "s"], " ", "\[Rule]", " ", 
           RowBox[{
            SuperscriptBox[
             SubscriptBox["W", "s"], "2"], " ", "-", " ", 
            RowBox[{"2", "*", "\[ImaginaryI]", "*", 
             RowBox[{
              SubscriptBox["z", "s"], "/", 
              SubscriptBox["k", "s"]}]}]}]}], ",", " ", 
          RowBox[{
           SubscriptBox["q", "i"], " ", "\[Rule]", " ", 
           RowBox[{
            SuperscriptBox[
             SubscriptBox["W", "i"], "2"], " ", "-", " ", 
            RowBox[{"2", "*", "\[ImaginaryI]", "*", 
             RowBox[{
              SubscriptBox["z", "i"], "/", 
              SubscriptBox["k", "i"]}]}]}]}], ",", " ", 
          RowBox[{
           SubscriptBox["z", "s"], " ", "\[Rule]", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Sin", "[", 
               SubscriptBox["\[Theta]", "s"], "]"}]}], "*", "y"}], " ", "+", 
            " ", 
            RowBox[{
             RowBox[{"Cos", "[", 
              SubscriptBox["\[Theta]", "s"], "]"}], "*", "z"}]}]}], ",", " ", 
          
          RowBox[{
           SubscriptBox["z", "i"], " ", "\[Rule]", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Sin", "[", 
               SubscriptBox["\[Theta]", "i"], "]"}]}], "*", "y"}], " ", "+", 
            " ", 
            RowBox[{
             RowBox[{"Cos", "[", 
              SubscriptBox["\[Theta]", "i"], "]"}], "*", "z"}]}]}]}], "}"}], 
        " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "Arg2"}], " ", "=", 
       RowBox[{"Simplify", "[", " ", 
        RowBox[{"Arg2", " ", "//.", " ", "rules1"}], "]"}]}]}]}]}], " ", 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Turns", " ", "out", " ", "this", " ", "is", " ", "way", " ", "to", " ", 
    RowBox[{"hard", ".", " ", "Going"}], " ", "to", " ", "ignore", " ", 
    "it"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.582554782936783*^9, 3.582554879991461*^9}, {
  3.582561583029579*^9, 3.582561640762952*^9}, {3.582561709843975*^9, 
  3.582561728675111*^9}, {3.5825621373940763`*^9, 3.582562190880147*^9}, {
  3.582562223501135*^9, 3.5825623913615503`*^9}, {3.582562435870626*^9, 
  3.582562439376598*^9}, {3.582562521558365*^9, 3.5825625801356792`*^9}, {
  3.582563110806714*^9, 3.58256311328623*^9}, {3.582566065536174*^9, 
  3.5825661004693317`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.58256349132627*^9, 3.582563495110099*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"OK", ",", " ", 
    RowBox[{
    "so", " ", "now", " ", "I", " ", "need", " ", "to", " ", "find", " ", 
     "the", " ", "collection", " ", "rate", " ", "into", " ", "just", " ", 
     "one", " ", "of", " ", "the", " ", 
     RowBox[{"fibers", ".", " ", "This"}], " ", "is", " ", "done", " ", "by", 
     " ", "dropping", " ", "the", " ", "Gaussian", " ", "integral", " ", "of",
      " ", "the", " ", "idler", " ", "photon"}], ",", " ", 
    RowBox[{"then", " ", "repeating", " ", "the", " ", "same", " ", 
     RowBox[{"procedure", "."}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ArgSingles", ":=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "1"}], "/", 
       RowBox[{"(", 
        RowBox[{"2", "*", 
         SubscriptBox["q", "s"]}], ")"}]}], "*", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["x", "s"], "2"], "+", 
        SuperscriptBox[
         SubscriptBox["y", "s"], "2"]}], ")"}]}], "-", 
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{"2", "*", 
         SubscriptBox["q", "p"]}], ")"}]}], "*", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["x", "p"], "2"], "+", 
        SuperscriptBox[
         SubscriptBox["y", "p"], "2"]}], ")"}]}], " ", "-", " ", 
     RowBox[{"\[ImaginaryI]", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[CapitalDelta]K", "x"], "*", "x"}], " ", "+", " ", 
        RowBox[{
         SubscriptBox["\[CapitalDelta]K", "y"], "*", "y"}], "+", 
        RowBox[{
         SubscriptBox["\[CapitalDelta]K", "z"], "*", "z"}]}], ")"}]}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"ArgS", " ", "=", " ", 
    RowBox[{"CompleteSquare", "[", 
     RowBox[{"ArgSingles", ",", " ", "x"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.5825682327216167`*^9, 3.582568295064464*^9}, {
  3.582568347884657*^9, 3.5825684137881413`*^9}, {3.5825684503546257`*^9, 
  3.5825684582345753`*^9}, {3.582602303021961*^9, 3.5826023084316597`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "4"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"2", " ", 
        SuperscriptBox["y", "2"]}], 
       SubscriptBox["q", "p"]]}], "-", 
     FractionBox[
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"y", " ", 
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}]}], "-", 
          RowBox[{"z", " ", 
           RowBox[{"Sin", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}]}]}], ")"}], "2"]}], 
      SubscriptBox["q", "s"]], "-", 
     RowBox[{"4", " ", "\[ImaginaryI]", " ", "y", " ", 
      SubscriptBox["\[CapitalDelta]K", "y"]}], "-", 
     RowBox[{"4", " ", "\[ImaginaryI]", " ", "z", " ", 
      SubscriptBox["\[CapitalDelta]K", "z"]}], "-", 
     FractionBox[
      RowBox[{"2", " ", 
       SuperscriptBox["z", "2"], " ", 
       SubsuperscriptBox["\[Rho]", "px", "2"]}], 
      SubscriptBox["q", "p"]], "-", 
     FractionBox[
      RowBox[{"2", " ", 
       SubscriptBox["q", "s"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["q", "p"], " ", 
           SubscriptBox["\[CapitalDelta]K", "x"]}], "-", 
          RowBox[{"\[ImaginaryI]", " ", "z", " ", 
           SubscriptBox["\[Rho]", "px"]}]}], ")"}], "2"]}], 
      RowBox[{
       SubscriptBox["q", "p"], " ", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["q", "p"], "+", 
         SubscriptBox["q", "s"]}], ")"}]}]]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SubscriptBox["q", "p"]}]]}], "-", 
     FractionBox["1", 
      RowBox[{"2", " ", 
       SubscriptBox["q", "s"]}]]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"x", "+", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", 
         SubscriptBox["\[CapitalDelta]K", "x"]}], "-", 
        FractionBox[
         RowBox[{"z", " ", 
          SubscriptBox["\[Rho]", "px"]}], 
         SubscriptBox["q", "p"]]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["1", 
            RowBox[{"2", " ", 
             SubscriptBox["q", "p"]}]]}], "-", 
          FractionBox["1", 
           RowBox[{"2", " ", 
            SubscriptBox["q", "s"]}]]}], ")"}]}]]}], ")"}], 
    "2"]}]}]], "Output",
 CellChangeTimes->{
  3.582568464458056*^9, 3.5825685993854227`*^9, {3.582599632791799*^9, 
   3.582599634678857*^9}, 3.5826023108739843`*^9, 3.582672765073677*^9, 
   3.5826735123858643`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"xconsts", " ", ":=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    FractionBox[
     RowBox[{"\[Sqrt]", "\[Pi]"}], 
     RowBox[{"\[Sqrt]", 
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", 
           RowBox[{"2", " ", 
            SubscriptBox["q", "p"]}]]}], "-", 
         FractionBox["1", 
          RowBox[{"2", " ", 
           SubscriptBox["q", "s"]}]]}], ")"}], " "}]}]], "//.", " ", 
    "rules2"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"yints", " ", ":=", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"2", " ", 
        SuperscriptBox["y", "2"]}], 
       SubscriptBox["q", "p"]]}], "-", 
     FractionBox[
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"y", " ", 
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}]}], "-", 
          RowBox[{"z", " ", 
           RowBox[{"Sin", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}]}]}], ")"}], "2"]}], 
      SubscriptBox["q", "s"]], "-", 
     RowBox[{"4", " ", "\[ImaginaryI]", " ", "y", " ", 
      SubscriptBox["\[CapitalDelta]K", "y"]}], "-", 
     RowBox[{"4", " ", "\[ImaginaryI]", " ", "z", " ", 
      SubscriptBox["\[CapitalDelta]K", "z"]}], "-", 
     FractionBox[
      RowBox[{"2", " ", 
       SuperscriptBox["z", "2"], " ", 
       SubsuperscriptBox["\[Rho]", "px", "2"]}], 
      SubscriptBox["q", "p"]], "-", 
     FractionBox[
      RowBox[{"2", " ", 
       SubscriptBox["q", "s"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["q", "p"], " ", 
           SubscriptBox["\[CapitalDelta]K", "x"]}], "-", 
          RowBox[{"\[ImaginaryI]", " ", "z", " ", 
           SubscriptBox["\[Rho]", "px"]}]}], ")"}], "2"]}], 
      RowBox[{
       SubscriptBox["q", "p"], " ", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["q", "p"], "+", 
         SubscriptBox["q", "s"]}], ")"}]}]]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"yints", " ", "=", " ", 
  RowBox[{"CompleteSquare", "[", 
   RowBox[{"yints", ",", " ", "y"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.582568630368575*^9, 3.582568636495154*^9}, {
   3.5825689333303432`*^9, 3.5825689474349833`*^9}, {3.5825996489443197`*^9, 
   3.582599665102371*^9}, 3.5826023349874353`*^9, {3.582672786024575*^9, 
   3.582672797490996*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SubscriptBox["q", "p"]}]]}], "-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"Cos", "[", 
        SubscriptBox["\[Theta]", "s"], "]"}], "2"], 
      RowBox[{"2", " ", 
       SubscriptBox["q", "s"]}]]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"y", "+", 
      FractionBox[
       RowBox[{
        FractionBox[
         RowBox[{"z", " ", 
          RowBox[{"Cos", "[", 
           SubscriptBox["\[Theta]", "s"], "]"}], " ", 
          RowBox[{"Sin", "[", 
           SubscriptBox["\[Theta]", "s"], "]"}]}], 
         SubscriptBox["q", "s"]], "-", 
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["\[CapitalDelta]K", "y"]}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["1", 
            RowBox[{"2", " ", 
             SubscriptBox["q", "p"]}]]}], "-", 
          FractionBox[
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "s"], "]"}], "2"], 
           RowBox[{"2", " ", 
            SubscriptBox["q", "s"]}]]}], ")"}]}]]}], ")"}], "2"]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"2", " ", 
        SuperscriptBox["z", "2"], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", 
          SubscriptBox["\[Theta]", "s"], "]"}], "2"]}], 
       SubscriptBox["q", "s"]]}], "-", 
     FractionBox[
      RowBox[{"2", " ", 
       SubscriptBox["q", "p"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[ImaginaryI]", " ", "z", " ", 
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}]}], "+", 
          RowBox[{
           SubscriptBox["q", "s"], " ", 
           SubscriptBox["\[CapitalDelta]K", "y"]}]}], ")"}], "2"]}], 
      RowBox[{
       SubscriptBox["q", "s"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
          SubscriptBox["q", "p"]}], "+", 
         SubscriptBox["q", "s"]}], ")"}]}]], "-", 
     RowBox[{"4", " ", "\[ImaginaryI]", " ", "z", " ", 
      SubscriptBox["\[CapitalDelta]K", "z"]}], "-", 
     FractionBox[
      RowBox[{"2", " ", 
       SuperscriptBox["z", "2"], " ", 
       SubsuperscriptBox["\[Rho]", "px", "2"]}], 
      SubscriptBox["q", "p"]], "-", 
     FractionBox[
      RowBox[{"2", " ", 
       SubscriptBox["q", "s"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["q", "p"], " ", 
           SubscriptBox["\[CapitalDelta]K", "x"]}], "-", 
          RowBox[{"\[ImaginaryI]", " ", "z", " ", 
           SubscriptBox["\[Rho]", "px"]}]}], ")"}], "2"]}], 
      RowBox[{
       SubscriptBox["q", "p"], " ", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["q", "p"], "+", 
         SubscriptBox["q", "s"]}], ")"}]}]]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.5825686174101343`*^9, 3.582568637714926*^9}, 
   3.582568950650221*^9, 3.582599669640561*^9, 3.582602342464911*^9, 
   3.58267280053104*^9, 3.582673513474505*^9, 3.582676774789138*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "This", " ", "leaves", " ", "us", " ", "with", " ", "the", " ", "y", " ", 
    "constant", " ", "and", " ", "the", " ", "z", " ", "integrand"}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"yconsts", " ", ":=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      FractionBox[
       RowBox[{"\[Sqrt]", "\[Pi]"}], 
       RowBox[{"\[Sqrt]", 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            FractionBox["1", 
             RowBox[{"2", " ", 
              SubscriptBox["q", "p"]}]]}], "-", 
           FractionBox[
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              SubscriptBox["\[Theta]", "s"], "]"}], "2"], 
            RowBox[{"2", " ", 
             SubscriptBox["q", "s"]}]]}], ")"}]}]}]], " ", "//.", " ", 
      "rules2"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"zints", " ", ":=", 
    RowBox[{
     FractionBox["1", "4"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"2", " ", 
          SuperscriptBox["z", "2"], " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}], "2"]}], 
         SubscriptBox["q", "s"]]}], "-", 
       FractionBox[
        RowBox[{"2", " ", 
         SubscriptBox["q", "p"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[ImaginaryI]", " ", "z", " ", 
             RowBox[{"Cos", "[", 
              SubscriptBox["\[Theta]", "s"], "]"}], " ", 
             RowBox[{"Sin", "[", 
              SubscriptBox["\[Theta]", "s"], "]"}]}], "+", 
            RowBox[{
             SubscriptBox["q", "s"], " ", 
             SubscriptBox["\[CapitalDelta]K", "y"]}]}], ")"}], "2"]}], 
        RowBox[{
         SubscriptBox["q", "s"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
            SubscriptBox["q", "p"]}], "+", 
           SubscriptBox["q", "s"]}], ")"}]}]], "-", 
       RowBox[{"4", " ", "\[ImaginaryI]", " ", "z", " ", 
        SubscriptBox["\[CapitalDelta]K", "z"]}], "-", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["z", "2"], " ", 
         SubsuperscriptBox["\[Rho]", "px", "2"]}], 
        SubscriptBox["q", "p"]], "-", 
       FractionBox[
        RowBox[{"2", " ", 
         SubscriptBox["q", "s"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SubscriptBox["q", "p"], " ", 
             SubscriptBox["\[CapitalDelta]K", "x"]}], "-", 
            RowBox[{"\[ImaginaryI]", " ", "z", " ", 
             SubscriptBox["\[Rho]", "px"]}]}], ")"}], "2"]}], 
        RowBox[{
         SubscriptBox["q", "p"], " ", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["q", "p"], "+", 
           SubscriptBox["q", "s"]}], ")"}]}]]}], ")"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Now", " ", "make", " ", "the", " ", "subsitution", " ", "where", " ", 
     "we", " ", "assume", " ", "that", " ", "the", " ", "waist", " ", "is", 
     " ", "constant", " ", "in", " ", "the", " ", "crystal"}], 
    "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"zints", "=", " ", 
    RowBox[{
     RowBox[{"Expand", "[", "zints", "]"}], " ", "/.", " ", 
     RowBox[{"{", 
      RowBox[{
       SubsuperscriptBox["\[Rho]", "px", "2"], " ", "\[Rule]", "0"}], 
      "}"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"zints", " ", "=", " ", 
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{"zints", " ", "2"}], ",", " ", "z"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.582568647045869*^9, 3.5825687295282097`*^9}, {
  3.58256880012293*^9, 3.582568861881715*^9}, {3.5825689597890263`*^9, 
  3.582568971125276*^9}, {3.582599678597131*^9, 3.582599706448551*^9}, {
  3.582602375914809*^9, 3.5826024382386427`*^9}, {3.582602472426429*^9, 
  3.582602508278699*^9}, {3.5826025803559523`*^9, 3.582602584516078*^9}, {
  3.5826728156612787`*^9, 3.5826728432878428`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     SuperscriptBox["z", "2"], " ", 
     SuperscriptBox[
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Theta]", "s"], "]"}], "2"]}], 
    RowBox[{"2", " ", 
     SubscriptBox["q", "s"]}]]}], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["z", "2"], " ", 
    SuperscriptBox[
     RowBox[{"Cos", "[", 
      SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"Sin", "[", 
      SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
    SubscriptBox["q", "p"]}], 
   RowBox[{"2", " ", 
    SubscriptBox["q", "s"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
       SubscriptBox["q", "p"]}], "+", 
      SubscriptBox["q", "s"]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["q", "p"], " ", 
    SubscriptBox["q", "s"], " ", 
    SubsuperscriptBox["\[CapitalDelta]K", "x", "2"]}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["q", "p"], "+", 
      SubscriptBox["q", "s"]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "z", " ", 
    RowBox[{"Cos", "[", 
     SubscriptBox["\[Theta]", "s"], "]"}], " ", 
    RowBox[{"Sin", "[", 
     SubscriptBox["\[Theta]", "s"], "]"}], " ", 
    SubscriptBox["q", "p"], " ", 
    SubscriptBox["\[CapitalDelta]K", "y"]}], 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
     SubscriptBox["q", "p"]}], "+", 
    SubscriptBox["q", "s"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["q", "p"], " ", 
    SubscriptBox["q", "s"], " ", 
    SubsuperscriptBox["\[CapitalDelta]K", "y", "2"]}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
       SubscriptBox["q", "p"]}], "+", 
      SubscriptBox["q", "s"]}], ")"}]}]], "-", 
  RowBox[{"\[ImaginaryI]", " ", "z", " ", 
   SubscriptBox["\[CapitalDelta]K", "z"]}], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "z", " ", 
    SubscriptBox["q", "s"], " ", 
    SubscriptBox["\[CapitalDelta]K", "x"], " ", 
    SubscriptBox["\[Rho]", "px"]}], 
   RowBox[{
    SubscriptBox["q", "p"], "+", 
    SubscriptBox["q", "s"]}]]}]], "Output",
 CellChangeTimes->{
  3.582568993163918*^9, 3.5825997089329367`*^9, 3.582602383641865*^9, 
   3.582602429638177*^9, {3.582602487795052*^9, 3.582602519731134*^9}, 
   3.5826025852199183`*^9, {3.582672816584609*^9, 3.582672839653619*^9}, 
   3.582673513586959*^9, 3.582676771199173*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", 
   SuperscriptBox["z", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Sin", "[", 
         SubscriptBox["\[Theta]", "s"], "]"}], "2"], 
       RowBox[{"2", " ", 
        SubscriptBox["q", "s"]}]]}], "+", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", 
         SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
       SubscriptBox["q", "p"]}], 
      RowBox[{"2", " ", 
       SubscriptBox["q", "s"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
          SubscriptBox["q", "p"]}], "+", 
         SubscriptBox["q", "s"]}], ")"}]}]]}], ")"}]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SubscriptBox["q", "p"], " ", 
        SubscriptBox["q", "s"], " ", 
        SubsuperscriptBox["\[CapitalDelta]K", "x", "2"]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["q", "p"], "+", 
          SubscriptBox["q", "s"]}], ")"}]}]]}], "-", 
     FractionBox[
      RowBox[{
       SubscriptBox["q", "p"], " ", 
       SubscriptBox["q", "s"], " ", 
       SubsuperscriptBox["\[CapitalDelta]K", "y", "2"]}], 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
          SubscriptBox["q", "p"]}], "+", 
         SubscriptBox["q", "s"]}], ")"}]}]]}], ")"}]}], "+", 
  RowBox[{"2", " ", "z", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "s"], "]"}], " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["\[Theta]", "s"], "]"}], " ", 
        SubscriptBox["q", "p"], " ", 
        SubscriptBox["\[CapitalDelta]K", "y"]}], 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"Cos", "[", 
           SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
         SubscriptBox["q", "p"]}], "+", 
        SubscriptBox["q", "s"]}]]}], "-", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[CapitalDelta]K", "z"]}], "+", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["q", "s"], " ", 
       SubscriptBox["\[CapitalDelta]K", "x"], " ", 
       SubscriptBox["\[Rho]", "px"]}], 
      RowBox[{
       SubscriptBox["q", "p"], "+", 
       SubscriptBox["q", "s"]}]]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.582568993163918*^9, 3.5825997089329367`*^9, 3.582602383641865*^9, 
   3.582602429638177*^9, {3.582602487795052*^9, 3.582602519731134*^9}, 
   3.5826025852199183`*^9, {3.582672816584609*^9, 3.582672839653619*^9}, 
   3.582673513586959*^9, 3.582676771202415*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Same", " ", "form", " ", "of", " ", "the", " ", "integral", " ", 
    RowBox[{"before", ".", " ", "Now"}], " ", "we", " ", 
    RowBox[{"have", ":"}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    SubscriptBox["AA", "singles"], "=", 
    RowBox[{"Simplify", "[", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], "  ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           SuperscriptBox[
            RowBox[{"Sin", "[", 
             SubscriptBox["\[Theta]", "s"], "]"}], "2"], 
           RowBox[{"2", " ", 
            SubscriptBox["q", "s"]}]]}], "+", 
         FractionBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", 
             SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
           SubscriptBox["q", "p"]}], 
          RowBox[{"2", " ", 
           SubscriptBox["q", "s"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox[
               RowBox[{"Cos", "[", 
                SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
              SubscriptBox["q", "p"]}], "+", 
             SubscriptBox["q", "s"]}], ")"}]}]]}], ")"}]}], "//.", " ", 
      "rules2"}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["BB", "singles"], "=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "/", "\[ImaginaryI]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "s"], "]"}], " ", 
            RowBox[{"Sin", "[", 
             SubscriptBox["\[Theta]", "s"], "]"}], " ", 
            SubscriptBox["q", "p"], " ", 
            SubscriptBox["\[CapitalDelta]K", "y"]}], 
           RowBox[{
            RowBox[{
             SuperscriptBox[
              RowBox[{"Cos", "[", 
               SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
             SubscriptBox["q", "p"]}], "+", 
            SubscriptBox["q", "s"]}]]}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[CapitalDelta]K", "z"]}], "+", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", 
           SubscriptBox["q", "s"], " ", 
           SubscriptBox["\[CapitalDelta]K", "x"], " ", 
           SubscriptBox["\[Rho]", "px"]}], 
          RowBox[{
           SubscriptBox["q", "p"], "+", 
           SubscriptBox["q", "s"]}]]}], ")"}]}], " ", "//.", "rules2"}], 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["CC", "singles"], "=", 
    RowBox[{"Simplify", "[", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            SubscriptBox["q", "p"], " ", 
            SubscriptBox["q", "s"], " ", 
            SubsuperscriptBox["\[CapitalDelta]K", "x", "2"]}], 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["q", "p"], "+", 
              SubscriptBox["q", "s"]}], ")"}]}]]}], "-", 
         FractionBox[
          RowBox[{
           SubscriptBox["q", "p"], " ", 
           SubscriptBox["q", "s"], " ", 
           SubsuperscriptBox["\[CapitalDelta]K", "y", "2"]}], 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox[
               RowBox[{"Cos", "[", 
                SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
              SubscriptBox["q", "p"]}], "+", 
             SubscriptBox["q", "s"]}], ")"}]}]]}], ")"}]}], " ", "//.", " ", 
      "rules2"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.582568998627551*^9, 3.582569122630061*^9}, {
   3.582569195819693*^9, 3.582569209101898*^9}, {3.5825770479358053`*^9, 
   3.582577065139308*^9}, {3.582599741109345*^9, 3.582599811679747*^9}, 
   3.582602622125238*^9, {3.582602654339089*^9, 3.5826027099108353`*^9}, {
   3.5826027433688507`*^9, 3.582602749314074*^9}, {3.582602780093316*^9, 
   3.582602825822988*^9}, {3.582672866938905*^9, 3.582672913276663*^9}}],

Cell[BoxData[
 FractionBox[
  SuperscriptBox[
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Theta]", "s"], "]"}], "2"], 
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"Cos", "[", 
      SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
    SubsuperscriptBox["W", "p", "2"]}], "+", 
   SubsuperscriptBox["W", "s", "2"]}]]], "Output",
 CellChangeTimes->{
  3.5825998130225973`*^9, {3.582602700498282*^9, 3.582602711014062*^9}, 
   3.582602793714965*^9, 3.582602827269425*^9, 3.582603120629777*^9, 
   3.582672916856567*^9, 3.582673513638441*^9}],

Cell[BoxData[
 RowBox[{"2", " ", 
  RowBox[{"(", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Theta]", "s"], "]"}], " ", 
      RowBox[{"Sin", "[", 
       SubscriptBox["\[Theta]", "s"], "]"}], " ", 
      SubsuperscriptBox["W", "p", "2"], " ", 
      SubscriptBox["\[CapitalDelta]K", "y"]}], 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
       SubsuperscriptBox["W", "p", "2"]}], "+", 
      SubsuperscriptBox["W", "s", "2"]}]], "+", 
    SubscriptBox["\[CapitalDelta]K", "z"], "-", 
    FractionBox[
     RowBox[{
      SubsuperscriptBox["W", "s", "2"], " ", 
      SubscriptBox["\[CapitalDelta]K", "x"], " ", 
      SubscriptBox["\[Rho]", "px"]}], 
     RowBox[{
      SubsuperscriptBox["W", "p", "2"], "+", 
      SubsuperscriptBox["W", "s", "2"]}]]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.5825998130225973`*^9, {3.582602700498282*^9, 3.582602711014062*^9}, 
   3.582602793714965*^9, 3.582602827269425*^9, 3.582603120629777*^9, 
   3.582672916856567*^9, 3.582673513687554*^9}],

Cell[BoxData[
 RowBox[{
  SubsuperscriptBox["W", "p", "2"], " ", 
  SubsuperscriptBox["W", "s", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    FractionBox[
     SubsuperscriptBox["\[CapitalDelta]K", "x", "2"], 
     RowBox[{
      SubsuperscriptBox["W", "p", "2"], "+", 
      SubsuperscriptBox["W", "s", "2"]}]], "+", 
    FractionBox[
     SubsuperscriptBox["\[CapitalDelta]K", "y", "2"], 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "s"], "]"}], "2"], " ", 
       SubsuperscriptBox["W", "p", "2"]}], "+", 
      SubsuperscriptBox["W", "s", "2"]}]]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.5825998130225973`*^9, {3.582602700498282*^9, 3.582602711014062*^9}, 
   3.582602793714965*^9, 3.582602827269425*^9, 3.582603120629777*^9, 
   3.582672916856567*^9, 3.582673513744114*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "We", " ", "can", " ", "use", " ", "the", " ", "same", " ", "series", " ",
      "expansion", " ", "for", " ", "the", " ", "integral"}], ",", " ", 
    RowBox[{"now", " ", "with", " ", "different", " ", 
     RowBox[{
     "coefficients", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "First"}]}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"let", "'"}], "s", " ", "look", " ", "at", " ", "the", " ", 
      RowBox[{"prefactors", ".", " ", "The"}], " ", "relationship", " ", 
      "for", " ", "efficiency", " ", "is", " ", "E"}], " ", "=", " ", 
     RowBox[{
      SubscriptBox["P", "coinc"], " ", "/", " ", 
      SubscriptBox["P", "singles"]}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"prefactor", "=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"xconst", "*", "yconst"}], ")"}], "^", "2"}], "/", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"xconsts", "*", "yconsts"}], ")"}], "^", "2"}]}], "]"}]}], 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.5825692161586647`*^9, 3.582569367864915*^9}, {
   3.5825826185960503`*^9, 3.582582619699774*^9}, {3.58258265972381*^9, 
   3.582582685331806*^9}, {3.5825827457681923`*^9, 3.582582761369029*^9}, 
   3.5825998835167313`*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.582599863339098*^9, 3.582599863349024*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "That", " ", "worked", " ", "out", " ", "nicer", " ", "than", " ", 
    RowBox[{"expected", "!"}], " ", "Now", " ", 
    RowBox[{"let", "'"}], "s", " ", "try", " ", "the", " ", "ratio", " ", 
    "of", " ", "the", " ", "series", " ", "expansion", " ", "of", " ", "the", 
    " ", "two", " ", 
    RowBox[{"integrals", "."}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["P", "coinc"], " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[", "IntResult", "]"}], "^", "2"}], " ", "/.", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"R", " ", "\[Rule]", " ", "AA"}], ",", " ", 
        RowBox[{"S", " ", "\[Rule]", " ", "BB"}], ",", " ", 
        RowBox[{"T", " ", "\[Rule]", " ", "CC"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      SubscriptBox["P", "coinc"], " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["n", "s"], "*", 
          SubscriptBox["n", "i"], "*", 
          SubscriptBox["n", "p"], "*", "xconst", " ", "*", " ", "yconst"}], 
         ")"}], "^", "2"}], " ", "*", 
       SubscriptBox["P", "coinc"]}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      SubscriptBox["P", "singles"], "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", "IntResult", "]"}], "^", "2"}], " ", "//.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"R", " ", "\[Rule]", " ", 
          SubscriptBox["AA", "singles"]}], ",", " ", 
         RowBox[{"S", " ", "\[Rule]", " ", 
          SubscriptBox["BB", "singles"]}], ",", " ", 
         RowBox[{"T", " ", "\[Rule]", " ", 
          SubscriptBox["CC", "singles"]}]}], "}"}]}]}], ";"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["P", "singles"], "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[", "IntResult", "]"}], "^", "2"}], " ", "/.", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"R", " ", "\[Rule]", " ", "AA"}], ",", " ", 
        RowBox[{"S", " ", "\[Rule]", " ", "BB"}], ",", " ", 
        RowBox[{"T", " ", "\[Rule]", " ", "CC"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      SubscriptBox["P", "singles"], " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["n", "s"], "*", 
          SubscriptBox["n", "p"], "*", "xconsts", " ", "*", " ", "yconsts"}], 
         ")"}], "^", "2"}], " ", "*", 
       SubscriptBox["P", "singles"]}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["P", "singles"], "=", 
     RowBox[{
      RowBox[{"Assuming", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          SubscriptBox["W", "p"], ">", "0"}], " ", "&&", " ", 
         RowBox[{
          SubscriptBox["W", "s"], ">", "0"}], " ", "&&", " ", 
         RowBox[{
          SubscriptBox["W", "i"], ">", "0"}]}], ",", " ", 
        SubscriptBox["P", "singles"]}], " ", "]"}], "//.", " ", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["W", "i"], "\[Rule]", "1000000"}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Eff", " ", "=", " ", 
     RowBox[{
      SubscriptBox["P", "coinc"], "/", 
      SubscriptBox["P", "singles"]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Eff", " ", "=", " ", 
     RowBox[{"Simplify", "[", "Eff", "]"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"This", " ", "gets", " ", "ugly", " ", "in", " ", "a", " ", 
     RowBox[{"hurry", ".", " ", 
      RowBox[{"abort", "!"}]}]}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.582569425920869*^9, 3.5825696338585043`*^9}, {
   3.5825701049369793`*^9, 3.58257013172652*^9}, {3.582581682138384*^9, 
   3.582581696816908*^9}, {3.582672926435391*^9, 3.582672969493376*^9}, 
   3.5826730590357122`*^9, {3.582673630467607*^9, 3.582673641219104*^9}, {
   3.582673939896338*^9, 3.5826741631619053`*^9}, {3.582674211487598*^9, 
   3.5826742375756207`*^9}, {3.582674324196042*^9, 3.582674325082368*^9}, {
   3.5826745785791197`*^9, 3.582674768747527*^9}, {3.5826748402281837`*^9, 
   3.582674848320345*^9}, {3.582676563250276*^9, 3.582676598509592*^9}, {
   3.5826767007783546`*^9, 3.5826767193737507`*^9}, {3.582677042395626*^9, 
   3.582677047054591*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Let", "'"}], "s", " ", "test", " ", "how", " ", "accurate", " ", 
    "the", " ", "order", " ", "of", " ", "the", " ", "expansions", " ", "is", 
    " ", "of", " ", "the", " ", "integral"}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"inttest", ":=", " ", 
    RowBox[{"N", "*", 
     RowBox[{"Exp", "[", 
      RowBox[{"-", "T"}], "]"}], "*", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"z", "^", "2"}]}], " ", "*", 
        RowBox[{"(", "R", " ", ")"}]}], " ", "-", 
       RowBox[{"z", " ", "*", 
        RowBox[{"(", 
         RowBox[{"\[ImaginaryI]", "*", "S"}], ")"}]}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"IntResultExact", " ", "=", " ", 
    RowBox[{"Assuming", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"R", ">", 
        RowBox[{"-", "inf"}]}], " ", "&&", " ", 
       RowBox[{"S", ">", 
        RowBox[{"-", "inf"}]}], " ", "&&", " ", 
       RowBox[{"T", ">", 
        RowBox[{"-", "inf"}]}]}], " ", ",", " ", 
      RowBox[{"Integrate", "[", 
       RowBox[{"inttest", ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", "0", ",", "L"}], "}"}]}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"IntResult5E", " ", ":=", " ", 
     RowBox[{"Normal", "[", 
      RowBox[{
       RowBox[{"Series", "[", 
        RowBox[{"IntResultExact", ",", 
         RowBox[{"{", 
          RowBox[{"S", ",", "0", ",", "10"}], "}"}]}], "]"}], " ", "//.", " ", 
       RowBox[{"{", " ", 
        RowBox[{
         RowBox[{"Erf", "[", 
          RowBox[{"L", " ", 
           SqrtBox["R"]}], "]"}], " ", "\[Rule]", " ", 
         RowBox[{"Series", "[", " ", 
          RowBox[{
           RowBox[{"Erf", "[", 
            RowBox[{"L", " ", 
             SqrtBox["R"]}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"L", ",", "0", ",", "10"}], "}"}]}], "]"}]}], "}"}]}], 
      "]"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"IntResult15", " ", ":=", " ", 
     RowBox[{"Assuming", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"R", ">", 
         RowBox[{"-", "inf"}]}], " ", "&&", " ", 
        RowBox[{"S", ">", 
         RowBox[{"-", "inf"}]}], " ", "&&", " ", 
        RowBox[{"T", ">", 
         RowBox[{"-", "inf"}]}]}], " ", ",", " ", 
       RowBox[{"Integrate", "[", 
        RowBox[{
         RowBox[{"Normal", "[", 
          RowBox[{"Series", "[", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"z", "^", "2"}]}], " ", "*", 
               RowBox[{"(", "R", " ", ")"}]}], " ", "-", 
              RowBox[{"z", " ", "*", 
               RowBox[{"(", 
                RowBox[{"\[ImaginaryI]", "*", "S"}], ")"}]}], " ", "-", " ", 
              "T"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"z", ",", "0", ",", "15"}], "}"}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"z", ",", "0", ",", "L"}], "}"}]}], "]"}]}], "]"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"IntResult5", " ", ":=", " ", 
    RowBox[{"Assuming", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"R", ">", 
        RowBox[{"-", "inf"}]}], " ", "&&", " ", 
       RowBox[{"S", ">", 
        RowBox[{"-", "inf"}]}], " ", "&&", " ", 
       RowBox[{"T", ">", 
        RowBox[{"-", "inf"}]}]}], " ", ",", " ", 
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{"Normal", "[", 
         RowBox[{"Series", "[", 
          RowBox[{"inttest", ",", 
           RowBox[{"{", 
            RowBox[{"z", ",", "0", ",", "5"}], "}"}]}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", "0", ",", "L"}], "}"}]}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"IntResult3", " ", ":=", " ", 
    RowBox[{"Assuming", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"R", ">", 
        RowBox[{"-", "inf"}]}], " ", "&&", " ", 
       RowBox[{"S", ">", 
        RowBox[{"-", "inf"}]}], " ", "&&", " ", 
       RowBox[{"T", ">", 
        RowBox[{"-", "inf"}]}]}], " ", ",", " ", 
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{"Normal", "[", 
         RowBox[{"Series", "[", 
          RowBox[{"inttest", ",", 
           RowBox[{"{", 
            RowBox[{"z", ",", "0", ",", "3"}], "}"}]}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", "0", ",", "L"}], "}"}]}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"IntResult1", " ", ":=", " ", 
    RowBox[{"Assuming", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"R", ">", 
        RowBox[{"-", "inf"}]}], " ", "&&", " ", 
       RowBox[{"S", ">", 
        RowBox[{"-", "inf"}]}], " ", "&&", " ", 
       RowBox[{"T", ">", 
        RowBox[{"-", "inf"}]}]}], " ", ",", " ", 
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{"Normal", "[", 
         RowBox[{"Series", "[", 
          RowBox[{"inttest", ",", 
           RowBox[{"{", 
            RowBox[{"z", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", "0", ",", "L"}], "}"}]}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"IntResult7", " ", ":=", " ", 
    RowBox[{"Assuming", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"R", ">", 
        RowBox[{"-", "inf"}]}], " ", "&&", " ", 
       RowBox[{"S", ">", 
        RowBox[{"-", "inf"}]}], " ", "&&", " ", 
       RowBox[{"T", ">", 
        RowBox[{"-", "inf"}]}]}], " ", ",", " ", 
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{"Normal", "[", 
         RowBox[{"Series", "[", 
          RowBox[{"inttest", ",", 
           RowBox[{"{", 
            RowBox[{"z", ",", "0", ",", "7"}], "}"}]}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", "0", ",", "L"}], "}"}]}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"IntResult9", " ", ":=", " ", 
    RowBox[{"Assuming", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"R", ">", 
        RowBox[{"-", "inf"}]}], " ", "&&", " ", 
       RowBox[{"S", ">", 
        RowBox[{"-", "inf"}]}], " ", "&&", " ", 
       RowBox[{"T", ">", 
        RowBox[{"-", "inf"}]}]}], " ", ",", " ", 
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{"Normal", "[", 
         RowBox[{"Series", "[", 
          RowBox[{"inttest", ",", 
           RowBox[{"{", 
            RowBox[{"z", ",", "0", ",", "9"}], "}"}]}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", "0", ",", "L"}], "}"}]}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"IntResult15", " ", ":=", " ", 
    RowBox[{"Assuming", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"R", ">", 
        RowBox[{"-", "inf"}]}], " ", "&&", " ", 
       RowBox[{"S", ">", 
        RowBox[{"-", "inf"}]}], " ", "&&", " ", 
       RowBox[{"T", ">", 
        RowBox[{"-", "inf"}]}]}], " ", ",", " ", 
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{"Normal", "[", 
         RowBox[{"Series", "[", 
          RowBox[{"inttest", ",", 
           RowBox[{"{", 
            RowBox[{"z", ",", "0", ",", "15"}], "}"}]}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", "0", ",", "L"}], "}"}]}], "]"}]}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.582572205761004*^9, 3.582572206837862*^9}, {
   3.582572892523479*^9, 3.5825728929466352`*^9}, {3.5825730267270813`*^9, 
   3.5825730776157846`*^9}, 3.582573159248851*^9, {3.582574803934189*^9, 
   3.582574811885477*^9}, {3.5825748919450703`*^9, 3.58257491225194*^9}, {
   3.582574943344674*^9, 3.582574956820031*^9}, {3.582574996989943*^9, 
   3.582575003605554*^9}, {3.582575205414709*^9, 3.582575225406925*^9}, {
   3.582575305419675*^9, 3.5825753055625563`*^9}, 3.58257534908139*^9, {
   3.582575417899432*^9, 3.582575522713881*^9}, {3.582575586709717*^9, 
   3.58257559175743*^9}, {3.582575635733961*^9, 3.582575639725006*^9}, {
   3.582575678287434*^9, 3.582575717350861*^9}, {3.582575904920251*^9, 
   3.582575939439159*^9}, {3.582576107030368*^9, 3.582576120006235*^9}, {
   3.582576269360463*^9, 3.5825764044161987`*^9}, {3.582577907486704*^9, 
   3.582577908964764*^9}, {3.582577939933519*^9, 3.582577941173113*^9}, {
   3.582578081868434*^9, 3.5825780830357122`*^9}, {3.582578132562628*^9, 
   3.582578212352865*^9}, {3.582578244359088*^9, 3.5825783979413977`*^9}, {
   3.582581650656002*^9, 3.582581669552266*^9}, {3.5825827775671177`*^9, 
   3.582582778886656*^9}, {3.582599991894372*^9, 3.5826000088696938`*^9}, 
   3.582604066534835*^9, {3.5826045676380367`*^9, 3.582604594346463*^9}, {
   3.58260466808491*^9, 3.582604668614315*^9}, {3.5826047238398237`*^9, 
   3.582604724304657*^9}, {3.5826048197985764`*^9, 3.5826048488434963`*^9}, {
   3.582604880920669*^9, 3.5826048815143003`*^9}, {3.5826049273340387`*^9, 
   3.5826049285137053`*^9}, {3.5826049684814863`*^9, 3.582604971468669*^9}, {
   3.5826053374966297`*^9, 3.582605424304006*^9}, {3.5826766056657*^9, 
   3.582676606800818*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox["S", "2"], 
       RowBox[{"4", " ", "R"}]]}], "-", "T"}]], " ", "N", " ", 
   SqrtBox["\[Pi]"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Erf", "[", 
      FractionBox[
       RowBox[{
        RowBox[{"2", " ", "L", " ", "R"}], "+", 
        RowBox[{"\[ImaginaryI]", " ", "S"}]}], 
       RowBox[{"2", " ", 
        SqrtBox["R"]}]], "]"}], "-", 
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"Erfi", "[", 
       FractionBox["S", 
        RowBox[{"2", " ", 
         SqrtBox["R"]}]], "]"}]}]}], ")"}]}], 
  RowBox[{"2", " ", 
   SqrtBox["R"]}]]], "Output",
 CellChangeTimes->{
  3.582573161964714*^9, 3.582574814618772*^9, 3.582574913810543*^9, 
   3.5825749585639887`*^9, 3.582575005539266*^9, {3.5825752211406803`*^9, 
   3.582575226325254*^9}, {3.582575306527272*^9, 3.582575317686431*^9}, 
   3.582575351884685*^9, {3.5825754802297487`*^9, 3.582575524384667*^9}, 
   3.582575603252763*^9, {3.582575659447135*^9, 3.582575689318501*^9}, 
   3.582575730060116*^9, 3.582575908169973*^9, 3.582575941173546*^9, {
   3.582576110420974*^9, 3.582576122787078*^9}, 3.582576412998436*^9, 
   3.582577075040058*^9, {3.582577914036601*^9, 3.582577942515175*^9}, 
   3.582578084321995*^9, {3.5825781337046747`*^9, 3.58257814171865*^9}, {
   3.582578185044962*^9, 3.5825782138070717`*^9}, 3.5825782520836906`*^9, 
   3.5825782876851883`*^9, {3.58257833079881*^9, 3.5825783581477127`*^9}, 
   3.58257839941127*^9, 3.5825998917735443`*^9, 3.582600014514237*^9, 
   3.582602848341959*^9, 3.582603282470069*^9, 3.5826040697898283`*^9, {
   3.58260457738792*^9, 3.5826045954385757`*^9}, 3.582604725976807*^9, {
   3.5826048226835814`*^9, 3.582604850051671*^9}, 3.582604883340601*^9, 
   3.582604929878993*^9, 3.5826049731657457`*^9, {3.582605342209608*^9, 
   3.58260542564155*^9}, 3.582673084915327*^9, 3.5826735145060883`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Consider", " ", "a", " ", "collinear"}], ",", " ", 
    RowBox[{
    "perfectly", " ", "phasematched", " ", "system", " ", "with", " ", "the", 
     " ", "signal", " ", "and", " ", "pump", " ", "waists", " ", "as", " ", 
     "100", " ", "microns"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"rulessamle", " ", ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SubscriptBox["W", "i"], "  ", "\[Rule]", " ", 
       SubscriptBox["W", "s"]}], " ", ",", "  ", 
      RowBox[{
       SubscriptBox["\[Theta]", "i"], "\[Rule]", " ", 
       SubscriptBox["\[Theta]", "s"]}], ",", " ", 
      RowBox[{
       SubscriptBox["\[Theta]", "s"], " ", "\[Rule]", 
       RowBox[{"1", "*", 
        RowBox[{"\[Pi]", "/", "180"}]}]}], ",", " ", 
      RowBox[{
       SubscriptBox["W", "s"], "  ", "\[Rule]", " ", ".0001"}], ",", "  ", 
      RowBox[{
       SubscriptBox["W", "p"], "  ", "\[Rule]", " ", ".00001"}], ",", "  ", 
      RowBox[{
       SubscriptBox["\[CapitalDelta]K", "x"], " ", "\[Rule]", "0"}], ",", 
      "  ", 
      RowBox[{
       SubscriptBox["\[CapitalDelta]K", "y"], " ", "\[Rule]", "0"}], ",", 
      "  ", 
      RowBox[{
       SubscriptBox["\[CapitalDelta]K", "z"], " ", "\[Rule]", "0"}], ",", 
      "  ", 
      RowBox[{
       SubscriptBox["\[Rho]", "px"], " ", "\[Rule]", " ", 
       RowBox[{"3", "*", 
        RowBox[{"\[Pi]", "/", "180"}]}]}], ",", " ", 
      RowBox[{
       SubscriptBox["\[Phi]", "s"], "\[Rule]", "0"}]}], "}"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"AAtest", " ", ":=", " ", 
    RowBox[{
     SubscriptBox["AA", "singles"], " ", "//.", "rulessamle"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"BBtest", " ", ":=", " ", 
    RowBox[{
     SubscriptBox["BB", "singles"], " ", "//.", "rulessamle"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"CCtest", " ", ":=", " ", 
    RowBox[{
     SubscriptBox["CC", "singles"], " ", "//.", "rulessamle"}]}], 
   "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Crystal", " ", "length", " ", "in", " ", "meters"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Lxtal", " ", ":=", " ", "0.001"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"isvalidapprox", " ", "should", " ", "be"}], " ", "<", " ", 
     RowBox[{
     "1", " ", "to", " ", "keep", " ", "the", " ", "errors", " ", "in", " ", 
      "check", " ", "with", " ", "a", " ", "5", "th", " ", "order", " ", 
      "series", " ", "expansion"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"isvalidapprox", " ", "=", " ", 
    RowBox[{"Lxtal", " ", "*", 
     RowBox[{"Sqrt", "[", 
      RowBox[{"Abs", "[", "AAtest", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"NN", " ", ":=", " ", 
    RowBox[{
     RowBox[{"xconsts", "*", "yconsts"}], " ", "//.", "rulessamle"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"rulessub", " ", ":=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"R", " ", "\[Rule]", "AAtest"}], ",", " ", 
      RowBox[{"S", " ", "\[Rule]", " ", "BBtest"}], ",", " ", 
      RowBox[{"T", " ", "\[Rule]", " ", "CCtest"}], ",", " ", 
      RowBox[{"L", " ", "\[Rule]", " ", "Lxtal"}], ",", " ", 
      RowBox[{"N", " ", "\[Rule]", " ", "1"}]}], "}"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"InE", "=", " ", 
     RowBox[{"IntResultExact", " ", "//.", " ", "rulessub"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"InE", " ", "/", " ", "Lxtal"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"diff1", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"100", "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"IntResult1", "-", "InE"}], ")"}], "/", "InE"}]}], " ", "//.", 
       RowBox[{
       "rulessub", "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
        "diff3"}]}], "=", " ", 
      RowBox[{
       RowBox[{"100", "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"IntResult3", "-", "InE"}], ")"}], " ", "/", "InE"}]}], " ",
        "//.", " ", "rulessub"}]}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"diff5", "=", " ", 
     RowBox[{
      RowBox[{"100", "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"IntResult5", "-", "InE"}], ")"}], " ", "/", "InE"}]}], "//.",
       " ", "rulessub"}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"diff7", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"100", "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"IntResult7", "-", "InE"}], ")"}], " ", "/", "InE"}]}], "//.",
        " ", 
       RowBox[{"rulessub", "\[IndentingNewLine]", "diff9"}]}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"100", "*", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"IntResult9", "-", "InE"}], ")"}], " ", "/", "InE"}]}], "//.",
         " ", 
        RowBox[{"rulessub", "\[IndentingNewLine]", "diff15"}]}], "=", 
       RowBox[{
        RowBox[{"100", "*", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"IntResult15", "-", "InE"}], ")"}], " ", "/", "InE"}]}], "//.",
         " ", "rulessub"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Eff1", " ", "=", " ", 
     RowBox[{"Eff", "//.", " ", "rulessamle"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Eff1", " ", "//.", " ", 
    RowBox[{"{", " ", 
     RowBox[{"L", " ", "\[Rule]", " ", "Lxtal"}], "}"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["n", "s"], "*", 
       SubscriptBox["n", "i"], "*", 
       SubscriptBox["n", "p"], "*", "xconst", " ", "*", " ", 
       RowBox[{"yconst", " ", "/", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["n", "s"], "*", 
          SubscriptBox["n", "p"], "*", "xconsts", " ", "*", " ", "yconsts"}], 
         ")"}]}]}], " ", "//.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[Theta]", "s"], "\[Rule]", "0"}], ",", " ", 
        RowBox[{
         SubscriptBox["\[Theta]", "i"], "\[Rule]", "0"}]}], "}"}]}], "]"}], 
    " ", "//.", "rulessamle"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"diff7", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"IntResult7", "-", "IntResult15"}], ")"}], " ", "/", 
         "IntResult15"}], "/", "L"}], " ", "//.", " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"R", " ", "\[Rule]", "AAtest"}], ",", " ", 
          RowBox[{"S", " ", "\[Rule]", " ", "BBtest"}], ",", " ", 
          RowBox[{"T", " ", "\[Rule]", " ", "CCtest"}], ",", " ", 
          RowBox[{"L", " ", "\[Rule]", " ", "0.001"}]}], "}"}], 
        "\[IndentingNewLine]", "diff9"}]}], "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"IntResult9", "-", "IntResult15"}], ")"}], " ", "/", 
         "IntResult15"}], "/", "L"}], " ", "//.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"R", " ", "\[Rule]", "AAtest"}], ",", " ", 
         RowBox[{"S", " ", "\[Rule]", " ", "BBtest"}], ",", " ", 
         RowBox[{"T", " ", "\[Rule]", " ", "CCtest"}], ",", " ", 
         RowBox[{"L", " ", "\[Rule]", " ", "0.001"}]}], "}"}]}]}]}], 
    "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.582570147920722*^9, 3.582570195741336*^9}, {
   3.5825702266473207`*^9, 3.582570352770815*^9}, {3.582570389152195*^9, 
   3.582570829808344*^9}, {3.5825708774230013`*^9, 3.58257102271488*^9}, {
   3.58257108718158*^9, 3.5825710876703444`*^9}, {3.5825711378520947`*^9, 
   3.582571194081362*^9}, {3.5825713211028957`*^9, 3.582571372749744*^9}, {
   3.5825714424096603`*^9, 3.582571461090166*^9}, {3.582571582032125*^9, 
   3.5825715845259132`*^9}, {3.582571654423809*^9, 3.5825716965358133`*^9}, 
   3.582571742091448*^9, {3.582571805219578*^9, 3.582571810611225*^9}, {
   3.582571855855719*^9, 3.582571869979395*^9}, {3.5825719294603567`*^9, 
   3.582571935293085*^9}, {3.582571976150963*^9, 3.582571978900481*^9}, {
   3.5825720142934093`*^9, 3.5825720378953953`*^9}, {3.582572069752479*^9, 
   3.582572092116683*^9}, {3.582572138326789*^9, 3.5825721680930433`*^9}, {
   3.5825722010110197`*^9, 3.582572272679966*^9}, {3.582572322893197*^9, 
   3.582572323053734*^9}, {3.582572386711502*^9, 3.5825724191907997`*^9}, {
   3.582572476653902*^9, 3.582572531114415*^9}, {3.582572563448111*^9, 
   3.582572597284574*^9}, 3.582572641775893*^9, {3.582572724360796*^9, 
   3.58257274159832*^9}, {3.582572790372628*^9, 3.582572822861246*^9}, {
   3.582573085488145*^9, 3.58257314104458*^9}, {3.582573177702846*^9, 
   3.582573191653015*^9}, {3.58257322478185*^9, 3.582573239973515*^9}, {
   3.582573273300521*^9, 3.58257328128799*^9}, {3.582573315689685*^9, 
   3.582573349042635*^9}, {3.582573385841503*^9, 3.58257345374396*^9}, {
   3.582573554499343*^9, 3.58257358045148*^9}, {3.5825736478524446`*^9, 
   3.582573663924012*^9}, {3.582574224783668*^9, 3.582574226260107*^9}, {
   3.582575527216473*^9, 3.58257553416681*^9}, 3.582575613021126*^9, {
   3.5825757339284153`*^9, 3.582575736659645*^9}, {3.582575769237528*^9, 
   3.582575878597967*^9}, {3.582576011241189*^9, 3.58257603819661*^9}, {
   3.582576139818922*^9, 3.582576163767682*^9}, {3.582576451830208*^9, 
   3.5825765756405077`*^9}, {3.582576619437772*^9, 3.582576746994718*^9}, {
   3.582576801086635*^9, 3.582576864601396*^9}, {3.582576967220229*^9, 
   3.582576972890451*^9}, {3.582577032137899*^9, 3.582577035976838*^9}, {
   3.582577370329324*^9, 3.5825774899346857`*^9}, 3.5825775241645203`*^9, {
   3.5825779855988417`*^9, 3.582578051825473*^9}, {3.582578097861334*^9, 
   3.582578101350016*^9}, 3.582578196413332*^9, {3.582578418547887*^9, 
   3.582578477190527*^9}, {3.58258138558496*^9, 3.582581416914439*^9}, {
   3.5825815036507807`*^9, 3.5825816333940077`*^9}, {3.582599949146933*^9, 
   3.582599965336502*^9}, {3.582600044394148*^9, 3.5826000807046623`*^9}, {
   3.582600116461185*^9, 3.5826001495913153`*^9}, {3.582602884138761*^9, 
   3.582602947869776*^9}, {3.582603087199744*^9, 3.5826030907698936`*^9}, {
   3.5826031999940653`*^9, 3.5826032359815407`*^9}, 3.582603296793651*^9, {
   3.582603458919821*^9, 3.5826034789806757`*^9}, {3.582603511056388*^9, 
   3.582603688543826*^9}, {3.582604584019965*^9, 3.5826045870444508`*^9}, {
   3.582604621354341*^9, 3.5826046446333017`*^9}, {3.582604788564949*^9, 
   3.5826047890544662`*^9}, {3.582604995006014*^9, 3.582605000751871*^9}, {
   3.582605031409931*^9, 3.582605311859332*^9}, {3.582673091236546*^9, 
   3.582673100783592*^9}, {3.582673132544013*^9, 3.582673258871689*^9}, {
   3.5826732951300783`*^9, 3.58267332418362*^9}, {3.582673517296598*^9, 
   3.582673523285928*^9}, {3.582673559825186*^9, 3.58267357808424*^9}, 
   3.5826737173027153`*^9, {3.582673799568041*^9, 3.5826738831694098`*^9}, 
   3.582674198046418*^9, {3.582674342546062*^9, 3.582674389475952*^9}, {
   3.582674452403171*^9, 3.582674540487863*^9}, 3.582674855781835*^9, {
   3.58267489572344*^9, 3.582674909054782*^9}, {3.582674948260013*^9, 
   3.582675028787796*^9}, {3.582676748612762*^9, 3.582676765579796*^9}, {
   3.582676872504282*^9, 3.582676934474944*^9}, {3.5826769747436237`*^9, 
   3.582677005626507*^9}, {3.5826770854932203`*^9, 3.582677116111795*^9}}],

Cell[BoxData["0.17365819648896164`"], "Output",
 CellChangeTimes->{
  3.582570354675662*^9, {3.582570412892651*^9, 3.5825705070930767`*^9}, {
   3.5825707993471746`*^9, 3.582570831099833*^9}, {3.5825708853568373`*^9, 
   3.582570912662923*^9}, {3.5825709435644817`*^9, 3.582570990021791*^9}, 
   3.582571052480253*^9, {3.58257112250749*^9, 3.58257114444281*^9}, {
   3.582571184314925*^9, 3.5825712056016417`*^9}, 3.582571377425086*^9, 
   3.582571469189785*^9, {3.5825716784297*^9, 3.582571705456757*^9}, 
   3.5825717504233103`*^9, 3.582571818752297*^9, 3.582571879328162*^9, 
   3.582571947429248*^9, 3.582571988272751*^9, 3.582572022961047*^9, 
   3.582572054226696*^9, 3.582572084265986*^9, {3.582572123408226*^9, 
   3.582572171305771*^9}, 3.582572224717298*^9, {3.5825722555345984`*^9, 
   3.582572283296073*^9}, 3.582572328078795*^9, {3.582572407866276*^9, 
   3.582572432729871*^9}, 3.582572502218058*^9, {3.582572539075816*^9, 
   3.582572568463833*^9}, 3.582572602334427*^9, 3.582572646066882*^9, 
   3.582572742409411*^9, 3.5825728271277103`*^9, 3.582573017565977*^9, {
   3.582573116435288*^9, 3.5825731927514677`*^9}, 3.582573241338683*^9, 
   3.582573282262253*^9, {3.582573324050943*^9, 3.582573349703813*^9}, {
   3.5825734385329313`*^9, 3.582573454587653*^9}, {3.582573555248148*^9, 
   3.582573581395072*^9}, {3.582573649773149*^9, 3.582573664648636*^9}, 
   3.582574227243372*^9, 3.582574817922513*^9, 3.582574917204378*^9, 
   3.582574971843677*^9, 3.58257500614922*^9, 3.582575535622246*^9, 
   3.5825756160359497`*^9, 3.582575662027115*^9, 3.582575696111742*^9, 
   3.582575737386883*^9, {3.5825757716913443`*^9, 3.582575909109335*^9}, {
   3.582576012559394*^9, 3.582576038911334*^9}, {3.582576124972093*^9, 
   3.582576164266121*^9}, {3.582576416776258*^9, 3.582576429815349*^9}, {
   3.582576540680245*^9, 3.582576576170599*^9}, 3.582576633464937*^9, 
   3.582576679387883*^9, {3.582576714472907*^9, 3.5825767478617163`*^9}, {
   3.582576817604088*^9, 3.582576866295888*^9}, 3.582576973394332*^9, 
   3.582577036435896*^9, 3.582577076537312*^9, {3.58257739156997*^9, 
   3.5825774189902973`*^9}, {3.582577450542364*^9, 3.5825774905511312`*^9}, 
   3.582577524670574*^9, {3.582577914107471*^9, 3.582577943464239*^9}, {
   3.582577988503026*^9, 3.582578052289804*^9}, {3.582578085212595*^9, 
   3.582578101868338*^9}, {3.582578134639304*^9, 3.582578145323916*^9}, {
   3.582578185980248*^9, 3.582578214597104*^9}, 3.582578255170326*^9, 
   3.582578288379747*^9, {3.5825783316809196`*^9, 3.582578358219714*^9}, {
   3.582578401324769*^9, 3.58257841974798*^9}, 3.5825784780871143`*^9, {
   3.582581389152919*^9, 3.582581417485889*^9}, {3.582581505400469*^9, 
   3.58258157392414*^9}, 3.582599899469202*^9, {3.5825999545420227`*^9, 
   3.582599965878004*^9}, {3.582600029795919*^9, 3.582600081275715*^9}, {
   3.582600117150275*^9, 3.582600150185759*^9}, 3.582602852969859*^9, 
   3.582602897146101*^9, {3.582602938263441*^9, 3.582602948510491*^9}, 
   3.58260309231872*^9, 3.582603133450769*^9, {3.582603200875477*^9, 
   3.582603236569487*^9}, {3.582603284050592*^9, 3.582603297907217*^9}, {
   3.5826034596327057`*^9, 3.582603480632607*^9}, {3.5826035124673853`*^9, 
   3.5826036892784433`*^9}, {3.582604599820034*^9, 3.582604621722224*^9}, {
   3.5826047013385763`*^9, 3.582604731145252*^9}, 3.582604790062847*^9, 
   3.58260482610839*^9, {3.582604862120905*^9, 3.5826048868338947`*^9}, 
   3.582604931084442*^9, {3.582604974186823*^9, 3.5826050020246077`*^9}, {
   3.5826050476663027`*^9, 3.5826052586076317`*^9}, {3.582605288769253*^9, 
   3.582605342303894*^9}, {3.582673091743375*^9, 3.582673101452018*^9}, {
   3.582673133510056*^9, 3.5826731835311327`*^9}, {3.582673228048522*^9, 
   3.582673260498645*^9}, {3.582673298519442*^9, 3.5826733251556787`*^9}, {
   3.582673372581572*^9, 3.582673382220293*^9}, {3.582673514645578*^9, 
   3.582673541778823*^9}, 3.582673579210895*^9, 3.582673646431975*^9, 
   3.582673718178657*^9, {3.5826738095673122`*^9, 3.582673883794237*^9}, {
   3.5826741794681177`*^9, 3.582674240855329*^9}, {3.582674327983241*^9, 
   3.582674357309519*^9}, 3.5826743899452353`*^9, {3.5826744560500507`*^9, 
   3.582674541561887*^9}, 3.582674856227171*^9, {3.5826748976557817`*^9, 
   3.5826749097802153`*^9}, {3.582674973947782*^9, 3.582675020359582*^9}, 
   3.582676609493137*^9, 3.582676751292325*^9, 3.5826768022830276`*^9, 
   3.58267688935161*^9, {3.582676921726454*^9, 3.582676935269238*^9}, {
   3.58267697825287*^9, 3.582677006003625*^9}, {3.58267706489953*^9, 
   3.5826771164698973`*^9}}],

Cell[BoxData[
 RowBox[{"0.9900379065460136`", "\[VeryThinSpace]", "+", 
  RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]], "Output",
 CellChangeTimes->{
  3.582570354675662*^9, {3.582570412892651*^9, 3.5825705070930767`*^9}, {
   3.5825707993471746`*^9, 3.582570831099833*^9}, {3.5825708853568373`*^9, 
   3.582570912662923*^9}, {3.5825709435644817`*^9, 3.582570990021791*^9}, 
   3.582571052480253*^9, {3.58257112250749*^9, 3.58257114444281*^9}, {
   3.582571184314925*^9, 3.5825712056016417`*^9}, 3.582571377425086*^9, 
   3.582571469189785*^9, {3.5825716784297*^9, 3.582571705456757*^9}, 
   3.5825717504233103`*^9, 3.582571818752297*^9, 3.582571879328162*^9, 
   3.582571947429248*^9, 3.582571988272751*^9, 3.582572022961047*^9, 
   3.582572054226696*^9, 3.582572084265986*^9, {3.582572123408226*^9, 
   3.582572171305771*^9}, 3.582572224717298*^9, {3.5825722555345984`*^9, 
   3.582572283296073*^9}, 3.582572328078795*^9, {3.582572407866276*^9, 
   3.582572432729871*^9}, 3.582572502218058*^9, {3.582572539075816*^9, 
   3.582572568463833*^9}, 3.582572602334427*^9, 3.582572646066882*^9, 
   3.582572742409411*^9, 3.5825728271277103`*^9, 3.582573017565977*^9, {
   3.582573116435288*^9, 3.5825731927514677`*^9}, 3.582573241338683*^9, 
   3.582573282262253*^9, {3.582573324050943*^9, 3.582573349703813*^9}, {
   3.5825734385329313`*^9, 3.582573454587653*^9}, {3.582573555248148*^9, 
   3.582573581395072*^9}, {3.582573649773149*^9, 3.582573664648636*^9}, 
   3.582574227243372*^9, 3.582574817922513*^9, 3.582574917204378*^9, 
   3.582574971843677*^9, 3.58257500614922*^9, 3.582575535622246*^9, 
   3.5825756160359497`*^9, 3.582575662027115*^9, 3.582575696111742*^9, 
   3.582575737386883*^9, {3.5825757716913443`*^9, 3.582575909109335*^9}, {
   3.582576012559394*^9, 3.582576038911334*^9}, {3.582576124972093*^9, 
   3.582576164266121*^9}, {3.582576416776258*^9, 3.582576429815349*^9}, {
   3.582576540680245*^9, 3.582576576170599*^9}, 3.582576633464937*^9, 
   3.582576679387883*^9, {3.582576714472907*^9, 3.5825767478617163`*^9}, {
   3.582576817604088*^9, 3.582576866295888*^9}, 3.582576973394332*^9, 
   3.582577036435896*^9, 3.582577076537312*^9, {3.58257739156997*^9, 
   3.5825774189902973`*^9}, {3.582577450542364*^9, 3.5825774905511312`*^9}, 
   3.582577524670574*^9, {3.582577914107471*^9, 3.582577943464239*^9}, {
   3.582577988503026*^9, 3.582578052289804*^9}, {3.582578085212595*^9, 
   3.582578101868338*^9}, {3.582578134639304*^9, 3.582578145323916*^9}, {
   3.582578185980248*^9, 3.582578214597104*^9}, 3.582578255170326*^9, 
   3.582578288379747*^9, {3.5825783316809196`*^9, 3.582578358219714*^9}, {
   3.582578401324769*^9, 3.58257841974798*^9}, 3.5825784780871143`*^9, {
   3.582581389152919*^9, 3.582581417485889*^9}, {3.582581505400469*^9, 
   3.58258157392414*^9}, 3.582599899469202*^9, {3.5825999545420227`*^9, 
   3.582599965878004*^9}, {3.582600029795919*^9, 3.582600081275715*^9}, {
   3.582600117150275*^9, 3.582600150185759*^9}, 3.582602852969859*^9, 
   3.582602897146101*^9, {3.582602938263441*^9, 3.582602948510491*^9}, 
   3.58260309231872*^9, 3.582603133450769*^9, {3.582603200875477*^9, 
   3.582603236569487*^9}, {3.582603284050592*^9, 3.582603297907217*^9}, {
   3.5826034596327057`*^9, 3.582603480632607*^9}, {3.5826035124673853`*^9, 
   3.5826036892784433`*^9}, {3.582604599820034*^9, 3.582604621722224*^9}, {
   3.5826047013385763`*^9, 3.582604731145252*^9}, 3.582604790062847*^9, 
   3.58260482610839*^9, {3.582604862120905*^9, 3.5826048868338947`*^9}, 
   3.582604931084442*^9, {3.582604974186823*^9, 3.5826050020246077`*^9}, {
   3.5826050476663027`*^9, 3.5826052586076317`*^9}, {3.582605288769253*^9, 
   3.582605342303894*^9}, {3.582673091743375*^9, 3.582673101452018*^9}, {
   3.582673133510056*^9, 3.5826731835311327`*^9}, {3.582673228048522*^9, 
   3.582673260498645*^9}, {3.582673298519442*^9, 3.5826733251556787`*^9}, {
   3.582673372581572*^9, 3.582673382220293*^9}, {3.582673514645578*^9, 
   3.582673541778823*^9}, 3.582673579210895*^9, 3.582673646431975*^9, 
   3.582673718178657*^9, {3.5826738095673122`*^9, 3.582673883794237*^9}, {
   3.5826741794681177`*^9, 3.582674240855329*^9}, {3.582674327983241*^9, 
   3.582674357309519*^9}, 3.5826743899452353`*^9, {3.5826744560500507`*^9, 
   3.582674541561887*^9}, 3.582674856227171*^9, {3.5826748976557817`*^9, 
   3.5826749097802153`*^9}, {3.582674973947782*^9, 3.582675020359582*^9}, 
   3.582676609493137*^9, 3.582676751292325*^9, 3.5826768022830276`*^9, 
   3.58267688935161*^9, {3.582676921726454*^9, 3.582676935269238*^9}, {
   3.58267697825287*^9, 3.582677006003625*^9}, {3.58267706489953*^9, 
   3.5826771164721737`*^9}}],

Cell[BoxData["0.9902525066366521`"], "Output",
 CellChangeTimes->{
  3.582570354675662*^9, {3.582570412892651*^9, 3.5825705070930767`*^9}, {
   3.5825707993471746`*^9, 3.582570831099833*^9}, {3.5825708853568373`*^9, 
   3.582570912662923*^9}, {3.5825709435644817`*^9, 3.582570990021791*^9}, 
   3.582571052480253*^9, {3.58257112250749*^9, 3.58257114444281*^9}, {
   3.582571184314925*^9, 3.5825712056016417`*^9}, 3.582571377425086*^9, 
   3.582571469189785*^9, {3.5825716784297*^9, 3.582571705456757*^9}, 
   3.5825717504233103`*^9, 3.582571818752297*^9, 3.582571879328162*^9, 
   3.582571947429248*^9, 3.582571988272751*^9, 3.582572022961047*^9, 
   3.582572054226696*^9, 3.582572084265986*^9, {3.582572123408226*^9, 
   3.582572171305771*^9}, 3.582572224717298*^9, {3.5825722555345984`*^9, 
   3.582572283296073*^9}, 3.582572328078795*^9, {3.582572407866276*^9, 
   3.582572432729871*^9}, 3.582572502218058*^9, {3.582572539075816*^9, 
   3.582572568463833*^9}, 3.582572602334427*^9, 3.582572646066882*^9, 
   3.582572742409411*^9, 3.5825728271277103`*^9, 3.582573017565977*^9, {
   3.582573116435288*^9, 3.5825731927514677`*^9}, 3.582573241338683*^9, 
   3.582573282262253*^9, {3.582573324050943*^9, 3.582573349703813*^9}, {
   3.5825734385329313`*^9, 3.582573454587653*^9}, {3.582573555248148*^9, 
   3.582573581395072*^9}, {3.582573649773149*^9, 3.582573664648636*^9}, 
   3.582574227243372*^9, 3.582574817922513*^9, 3.582574917204378*^9, 
   3.582574971843677*^9, 3.58257500614922*^9, 3.582575535622246*^9, 
   3.5825756160359497`*^9, 3.582575662027115*^9, 3.582575696111742*^9, 
   3.582575737386883*^9, {3.5825757716913443`*^9, 3.582575909109335*^9}, {
   3.582576012559394*^9, 3.582576038911334*^9}, {3.582576124972093*^9, 
   3.582576164266121*^9}, {3.582576416776258*^9, 3.582576429815349*^9}, {
   3.582576540680245*^9, 3.582576576170599*^9}, 3.582576633464937*^9, 
   3.582576679387883*^9, {3.582576714472907*^9, 3.5825767478617163`*^9}, {
   3.582576817604088*^9, 3.582576866295888*^9}, 3.582576973394332*^9, 
   3.582577036435896*^9, 3.582577076537312*^9, {3.58257739156997*^9, 
   3.5825774189902973`*^9}, {3.582577450542364*^9, 3.5825774905511312`*^9}, 
   3.582577524670574*^9, {3.582577914107471*^9, 3.582577943464239*^9}, {
   3.582577988503026*^9, 3.582578052289804*^9}, {3.582578085212595*^9, 
   3.582578101868338*^9}, {3.582578134639304*^9, 3.582578145323916*^9}, {
   3.582578185980248*^9, 3.582578214597104*^9}, 3.582578255170326*^9, 
   3.582578288379747*^9, {3.5825783316809196`*^9, 3.582578358219714*^9}, {
   3.582578401324769*^9, 3.58257841974798*^9}, 3.5825784780871143`*^9, {
   3.582581389152919*^9, 3.582581417485889*^9}, {3.582581505400469*^9, 
   3.58258157392414*^9}, 3.582599899469202*^9, {3.5825999545420227`*^9, 
   3.582599965878004*^9}, {3.582600029795919*^9, 3.582600081275715*^9}, {
   3.582600117150275*^9, 3.582600150185759*^9}, 3.582602852969859*^9, 
   3.582602897146101*^9, {3.582602938263441*^9, 3.582602948510491*^9}, 
   3.58260309231872*^9, 3.582603133450769*^9, {3.582603200875477*^9, 
   3.582603236569487*^9}, {3.582603284050592*^9, 3.582603297907217*^9}, {
   3.5826034596327057`*^9, 3.582603480632607*^9}, {3.5826035124673853`*^9, 
   3.5826036892784433`*^9}, {3.582604599820034*^9, 3.582604621722224*^9}, {
   3.5826047013385763`*^9, 3.582604731145252*^9}, 3.582604790062847*^9, 
   3.58260482610839*^9, {3.582604862120905*^9, 3.5826048868338947`*^9}, 
   3.582604931084442*^9, {3.582604974186823*^9, 3.5826050020246077`*^9}, {
   3.5826050476663027`*^9, 3.5826052586076317`*^9}, {3.582605288769253*^9, 
   3.582605342303894*^9}, {3.582673091743375*^9, 3.582673101452018*^9}, {
   3.582673133510056*^9, 3.5826731835311327`*^9}, {3.582673228048522*^9, 
   3.582673260498645*^9}, {3.582673298519442*^9, 3.5826733251556787`*^9}, {
   3.582673372581572*^9, 3.582673382220293*^9}, {3.582673514645578*^9, 
   3.582673541778823*^9}, 3.582673579210895*^9, 3.582673646431975*^9, 
   3.582673718178657*^9, {3.5826738095673122`*^9, 3.582673883794237*^9}, {
   3.5826741794681177`*^9, 3.582674240855329*^9}, {3.582674327983241*^9, 
   3.582674357309519*^9}, 3.5826743899452353`*^9, {3.5826744560500507`*^9, 
   3.582674541561887*^9}, 3.582674856227171*^9, {3.5826748976557817`*^9, 
   3.5826749097802153`*^9}, {3.582674973947782*^9, 3.582675020359582*^9}, 
   3.582676609493137*^9, 3.582676751292325*^9, 3.5826768022830276`*^9, 
   3.58267688935161*^9, {3.582676921726454*^9, 3.582676935269238*^9}, {
   3.58267697825287*^9, 3.582677006003625*^9}, {3.58267706489953*^9, 
   3.582677116474163*^9}}],

Cell[BoxData["1.549141496368501`*^-6"], "Output",
 CellChangeTimes->{
  3.582570354675662*^9, {3.582570412892651*^9, 3.5825705070930767`*^9}, {
   3.5825707993471746`*^9, 3.582570831099833*^9}, {3.5825708853568373`*^9, 
   3.582570912662923*^9}, {3.5825709435644817`*^9, 3.582570990021791*^9}, 
   3.582571052480253*^9, {3.58257112250749*^9, 3.58257114444281*^9}, {
   3.582571184314925*^9, 3.5825712056016417`*^9}, 3.582571377425086*^9, 
   3.582571469189785*^9, {3.5825716784297*^9, 3.582571705456757*^9}, 
   3.5825717504233103`*^9, 3.582571818752297*^9, 3.582571879328162*^9, 
   3.582571947429248*^9, 3.582571988272751*^9, 3.582572022961047*^9, 
   3.582572054226696*^9, 3.582572084265986*^9, {3.582572123408226*^9, 
   3.582572171305771*^9}, 3.582572224717298*^9, {3.5825722555345984`*^9, 
   3.582572283296073*^9}, 3.582572328078795*^9, {3.582572407866276*^9, 
   3.582572432729871*^9}, 3.582572502218058*^9, {3.582572539075816*^9, 
   3.582572568463833*^9}, 3.582572602334427*^9, 3.582572646066882*^9, 
   3.582572742409411*^9, 3.5825728271277103`*^9, 3.582573017565977*^9, {
   3.582573116435288*^9, 3.5825731927514677`*^9}, 3.582573241338683*^9, 
   3.582573282262253*^9, {3.582573324050943*^9, 3.582573349703813*^9}, {
   3.5825734385329313`*^9, 3.582573454587653*^9}, {3.582573555248148*^9, 
   3.582573581395072*^9}, {3.582573649773149*^9, 3.582573664648636*^9}, 
   3.582574227243372*^9, 3.582574817922513*^9, 3.582574917204378*^9, 
   3.582574971843677*^9, 3.58257500614922*^9, 3.582575535622246*^9, 
   3.5825756160359497`*^9, 3.582575662027115*^9, 3.582575696111742*^9, 
   3.582575737386883*^9, {3.5825757716913443`*^9, 3.582575909109335*^9}, {
   3.582576012559394*^9, 3.582576038911334*^9}, {3.582576124972093*^9, 
   3.582576164266121*^9}, {3.582576416776258*^9, 3.582576429815349*^9}, {
   3.582576540680245*^9, 3.582576576170599*^9}, 3.582576633464937*^9, 
   3.582576679387883*^9, {3.582576714472907*^9, 3.5825767478617163`*^9}, {
   3.582576817604088*^9, 3.582576866295888*^9}, 3.582576973394332*^9, 
   3.582577036435896*^9, 3.582577076537312*^9, {3.58257739156997*^9, 
   3.5825774189902973`*^9}, {3.582577450542364*^9, 3.5825774905511312`*^9}, 
   3.582577524670574*^9, {3.582577914107471*^9, 3.582577943464239*^9}, {
   3.582577988503026*^9, 3.582578052289804*^9}, {3.582578085212595*^9, 
   3.582578101868338*^9}, {3.582578134639304*^9, 3.582578145323916*^9}, {
   3.582578185980248*^9, 3.582578214597104*^9}, 3.582578255170326*^9, 
   3.582578288379747*^9, {3.5825783316809196`*^9, 3.582578358219714*^9}, {
   3.582578401324769*^9, 3.58257841974798*^9}, 3.5825784780871143`*^9, {
   3.582581389152919*^9, 3.582581417485889*^9}, {3.582581505400469*^9, 
   3.58258157392414*^9}, 3.582599899469202*^9, {3.5825999545420227`*^9, 
   3.582599965878004*^9}, {3.582600029795919*^9, 3.582600081275715*^9}, {
   3.582600117150275*^9, 3.582600150185759*^9}, 3.582602852969859*^9, 
   3.582602897146101*^9, {3.582602938263441*^9, 3.582602948510491*^9}, 
   3.58260309231872*^9, 3.582603133450769*^9, {3.582603200875477*^9, 
   3.582603236569487*^9}, {3.582603284050592*^9, 3.582603297907217*^9}, {
   3.5826034596327057`*^9, 3.582603480632607*^9}, {3.5826035124673853`*^9, 
   3.5826036892784433`*^9}, {3.582604599820034*^9, 3.582604621722224*^9}, {
   3.5826047013385763`*^9, 3.582604731145252*^9}, 3.582604790062847*^9, 
   3.58260482610839*^9, {3.582604862120905*^9, 3.5826048868338947`*^9}, 
   3.582604931084442*^9, {3.582604974186823*^9, 3.5826050020246077`*^9}, {
   3.5826050476663027`*^9, 3.5826052586076317`*^9}, {3.582605288769253*^9, 
   3.582605342303894*^9}, {3.582673091743375*^9, 3.582673101452018*^9}, {
   3.582673133510056*^9, 3.5826731835311327`*^9}, {3.582673228048522*^9, 
   3.582673260498645*^9}, {3.582673298519442*^9, 3.5826733251556787`*^9}, {
   3.582673372581572*^9, 3.582673382220293*^9}, {3.582673514645578*^9, 
   3.582673541778823*^9}, 3.582673579210895*^9, 3.582673646431975*^9, 
   3.582673718178657*^9, {3.5826738095673122`*^9, 3.582673883794237*^9}, {
   3.5826741794681177`*^9, 3.582674240855329*^9}, {3.582674327983241*^9, 
   3.582674357309519*^9}, 3.5826743899452353`*^9, {3.5826744560500507`*^9, 
   3.582674541561887*^9}, 3.582674856227171*^9, {3.5826748976557817`*^9, 
   3.5826749097802153`*^9}, {3.582674973947782*^9, 3.582675020359582*^9}, 
   3.582676609493137*^9, 3.582676751292325*^9, 3.5826768022830276`*^9, 
   3.58267688935161*^9, {3.582676921726454*^9, 3.582676935269238*^9}, {
   3.58267697825287*^9, 3.582677006003625*^9}, {3.58267706489953*^9, 
   3.582677116475563*^9}}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.582677107278851*^9, 3.5826771085437727`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.582604717680066*^9, 3.5826047176921797`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Now", " ", 
     RowBox[{"let", "'"}], "s", " ", "try", " ", "to", " ", "plot", " ", 
     "the", " ", "error", " ", "for", " ", "5", "th", " ", "order", " ", 
     "expansion", " ", "as", " ", "a", " ", "function", " ", "of", " ", "L", 
     "*", 
     RowBox[{"R", ".", " ", "When"}], " ", "there", " ", "is", " ", "perfect",
      " ", "phasematching"}], ",", " ", 
    RowBox[{
     RowBox[{
     "then", " ", "S", " ", "and", " ", "T", " ", "go", " ", "to", " ", "0.", 
      " ", "I", " ", "am", " ", "also", " ", "setting", " ", "L"}], "=", 
     RowBox[{
     "1", " ", "to", " ", "get", " ", "a", " ", "feel", " ", "for", " ", 
      "how", " ", "things", " ", 
      RowBox[{"scale", ".", " ", "It"}], " ", "should", " ", "really", " ", 
      "be", " ", "L", "*", "sqrt", 
      RowBox[{"(", "R", ")"}], " ", "that", " ", "I", " ", 
      RowBox[{"investigate", "."}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{"rulesplot", " ", ":=", 
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{"S", " ", "\[Rule]", " ", "0"}], ",", " ", 
      RowBox[{"T", " ", "\[Rule]", " ", "0"}], ",", 
      RowBox[{"L", "\[Rule]", "1"}], ",", "  ", 
      RowBox[{"N", " ", "\[Rule]", " ", "1"}]}], "}"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"IE", ":=", 
    RowBox[{"IntResultExact", " ", "//.", "rulesplot"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"diff5plot", " ", ":=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"IntResult9", "-", "IE"}], ")"}], "/", "IE"}], " ", "//.", 
     "rulesplot"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"data", " ", "=", " ", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"diff3plot", "*", "100"}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"R", ",", ".1", ",", " ", "1", ",", " ", ".3"}], "}"}], ",", 
        " ", 
        RowBox[{"{", 
         RowBox[{"L", ",", "1", ",", " ", "2", ",", ".5"}], "}"}]}], "]"}], 
      "\[IndentingNewLine]", 
      RowBox[{"ListDensityPlot", "[", "data", "]"}]}]}], 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{",", "  ", 
       RowBox[{"DataRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{".1", ",", "1"}], "}"}]}]}], "]"}], "*)"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"data", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"diff5plot", "*", "100"}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"R", ",", ".1", ",", " ", "2", ",", " ", ".4"}], "}"}]}], 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{"data", ",", " ", 
     RowBox[{"DataRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{".1", ",", "1"}], "}"}]}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"diff3plot", "*", "100"}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"R", ",", " ", ".1", ",", " ", "2"}], "}"}]}], "]"}], "*)"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.582571514461753*^9, 3.582571551456332*^9}, {
   3.582578503345278*^9, 3.58257872440841*^9}, {3.582578780921651*^9, 
   3.582578883845438*^9}, {3.582578970661623*^9, 3.5825789710615797`*^9}, {
   3.582579131654023*^9, 3.582579200204801*^9}, {3.582579243741954*^9, 
   3.5825792459243107`*^9}, {3.5825793019633627`*^9, 3.582579371951651*^9}, {
   3.582579457175651*^9, 3.5825794845162363`*^9}, {3.582579540760523*^9, 
   3.582579570935811*^9}, {3.582579607016583*^9, 3.5825796095915947`*^9}, {
   3.582579643985656*^9, 3.5825796473228292`*^9}, {3.582579712051264*^9, 
   3.58257971848114*^9}, {3.5825797686854067`*^9, 3.5825798082418137`*^9}, {
   3.582579873379818*^9, 3.582579903872665*^9}, {3.582580063163332*^9, 
   3.582580068888425*^9}, {3.582580160070561*^9, 3.582580310148143*^9}, {
   3.5825803507792*^9, 3.582580379041741*^9}, 3.582580457517507*^9, {
   3.582580497564616*^9, 3.5825805027078733`*^9}, {3.582580538025709*^9, 
   3.5825805902668457`*^9}, {3.582580630656403*^9, 3.582580655723983*^9}, 
   3.5825808355668917`*^9, {3.582580875974682*^9, 3.582580933715579*^9}, {
   3.582580993168611*^9, 3.5825810254619913`*^9}, {3.582581096198348*^9, 
   3.582581198438293*^9}, {3.582581299535063*^9, 3.5825813460732594`*^9}, 
   3.582600172444182*^9, {3.5826038389114437`*^9, 3.582603839741509*^9}, {
   3.582603984803568*^9, 3.582603990923452*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "7.720022800021627`*^-7", ",", "0.002583238282527788`", ",", 
   "0.051718892688958636`", ",", "0.341339804640379`", ",", 
   "1.3587832203137025`"}], "}"}]], "Output",
 CellChangeTimes->{{3.5825810991036158`*^9, 3.5825811058004313`*^9}, {
   3.582581136013298*^9, 3.582581164420209*^9}, 3.582581203090735*^9, 
   3.582600158676648*^9, 3.5826001916288757`*^9, 3.58260379195722*^9, 
   3.582603895092568*^9, 3.58260401860787*^9, 3.582673541566701*^9}],

Cell[BoxData[
 GraphicsBox[{{}, {}, 
   {Hue[0.67, 0.6, 0.6], 
    LineBox[{{0.1, 7.720022800021627*^-7}, {0.325, 0.002583238282527788}, {
     0.55, 0.051718892688958636`}, {0.775, 0.341339804640379}, {1., 
     1.3587832203137025`}}]}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesOrigin->{0, 0},
  PlotRange->{{0., 1.}, {0., 1.3587832203137025`}},
  PlotRangeClipping->True,
  PlotRangePadding->{
    Scaled[0.02], 
    Scaled[0.02]}]], "Output",
 CellChangeTimes->{{3.5825810991036158`*^9, 3.5825811058004313`*^9}, {
   3.582581136013298*^9, 3.582581164420209*^9}, 3.582581203090735*^9, 
   3.582600158676648*^9, 3.5826001916288757`*^9, 3.58260379195722*^9, 
   3.582603895092568*^9, 3.58260401860787*^9, 3.582673541568326*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.582579558603568*^9, 3.582579564021964*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "So", " ", "it", " ", "looks", " ", "like", " ", "the", " ", "5", "th", " ",
    "order", " ", "expansion", " ", "is", " ", "fine", " ", "as", " ", "long",
    " ", "as", " ", "L", "*", 
   RowBox[{"R", "^", "0.5"}], " ", 
   RowBox[{"<<", " ", "1."}], " ", "Is", " ", "there", " ", "a", " ", 
   "better", " ", "way", " ", "to", " ", "expand", " ", "this", " ", 
   "without", " ", "needing", " ", "to", " ", "go", " ", "to", " ", "a", " ", 
   "ton", " ", "of", " ", 
   RowBox[{"terms", "?", " ", "I"}], " ", "tried", " ", "it", " ", "with", 
   " ", "the", " ", "third", " ", "order", " ", "expansion", " ", "and", " ", 
   "9", "th", " ", "order", " ", 
   RowBox[{"expansion", "."}]}], " ", "\[IndentingNewLine]", "*)"}]], "Input",\

 CellChangeTimes->{{3.5825812218049498`*^9, 3.582581286524527*^9}, {
  3.5825813519982986`*^9, 3.582581365413608*^9}}],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{{3.5825793967420473`*^9, 3.5825794457035847`*^9}, 
   3.582581214804072*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.582581217412138*^9, 3.582581217435742*^9}}]
},
WindowSize->{1323, 797},
WindowMargins->{{Automatic, 44}, {20, Automatic}},
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (October 5, \
2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 6878, 162, 303, "Input"],
Cell[7460, 186, 1927, 41, 27, "Output"],
Cell[9390, 229, 1926, 41, 27, "Output"],
Cell[11319, 272, 2103, 47, 34, "Output"]
}, Open  ]],
Cell[13437, 322, 10375, 269, 566, "Input"],
Cell[23815, 593, 1514, 45, 124, "Input"],
Cell[CellGroupData[{
Cell[25354, 642, 2332, 65, 79, "Input"],
Cell[27689, 709, 1734, 53, 56, "Output"]
}, Open  ]],
Cell[29438, 765, 957, 28, 73, "Input"],
Cell[CellGroupData[{
Cell[30420, 797, 654, 14, 58, "Input"],
Cell[31077, 813, 4105, 124, 83, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35219, 942, 5029, 131, 227, "Input"],
Cell[40251, 1075, 5356, 160, 137, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45644, 1240, 1369, 36, 71, "Input"],
Cell[47016, 1278, 854, 22, 73, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47907, 1305, 4106, 112, 124, "Input"],
Cell[52016, 1419, 7561, 247, 107, "Output"]
}, Open  ]],
Cell[59592, 1669, 94, 1, 27, "Input"],
Cell[59689, 1672, 94, 1, 27, "Input"],
Cell[CellGroupData[{
Cell[59808, 1677, 2379, 50, 173, "Input"],
Cell[62190, 1729, 6926, 224, 107, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[69153, 1958, 233, 6, 43, "Input"],
Cell[69389, 1966, 8295, 233, 163, "Output"]
}, Open  ]],
Cell[77699, 2202, 2039, 48, 77, "Input"],
Cell[CellGroupData[{
Cell[79763, 2254, 10519, 265, 245, "Input"],
Cell[90285, 2521, 1488, 43, 59, "Output"],
Cell[91776, 2566, 3976, 113, 59, "Output"],
Cell[95755, 2681, 1689, 48, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[97481, 2734, 2507, 58, 73, "Input"],
Cell[99991, 2794, 1886, 56, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[101914, 2855, 3698, 83, 178, "Input"],
Cell[105615, 2940, 1289, 38, 59, "Output"],
Cell[106907, 2980, 3205, 94, 61, "Output"],
Cell[110115, 3076, 1358, 38, 59, "Output"]
}, Open  ]],
Cell[111488, 3117, 4775, 124, 175, "Input"],
Cell[116266, 3243, 91, 1, 27, "Input"],
Cell[CellGroupData[{
Cell[116382, 3248, 2142, 55, 109, "Input"],
Cell[118527, 3305, 2711, 85, 83, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[121275, 3395, 2514, 73, 143, "Input"],
Cell[123792, 3470, 3467, 104, 83, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[127296, 3579, 4289, 114, 262, "Input"],
Cell[131588, 3695, 2714, 84, 58, "Output"],
Cell[134305, 3781, 3116, 93, 58, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[137458, 3879, 4478, 119, 235, "Input"],
Cell[141939, 4000, 551, 15, 56, "Output"],
Cell[142493, 4017, 1132, 31, 59, "Output"],
Cell[143628, 4050, 853, 23, 59, "Output"]
}, Open  ]],
Cell[144496, 4076, 1455, 34, 139, "Input"],
Cell[145954, 4112, 92, 1, 27, InheritFromParent],
Cell[146049, 4115, 4565, 117, 235, "Input"],
Cell[CellGroupData[{
Cell[150639, 4236, 9185, 234, 264, "Input"],
Cell[159827, 4472, 1975, 43, 72, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[161839, 4520, 11605, 254, 589, "Input"],
Cell[173447, 4776, 4547, 63, 27, "Output"],
Cell[177997, 4841, 4625, 65, 27, "Output"],
Cell[182625, 4908, 4544, 63, 27, "Output"],
Cell[187172, 4973, 4547, 63, 30, "Output"]
}, Open  ]],
Cell[191734, 5039, 94, 1, 27, "Input"],
Cell[191831, 5042, 94, 1, 27, InheritFromParent],
Cell[CellGroupData[{
Cell[191950, 5047, 4596, 102, 223, "Input"],
Cell[196549, 5151, 492, 9, 33, "Output"],
Cell[197044, 5162, 768, 17, 242, "Output"]
}, Open  ]],
Cell[197827, 5182, 92, 1, 27, "Input"],
Cell[197922, 5185, 906, 17, 58, "Input"],
Cell[198831, 5204, 141, 2, 43, "Input"],
Cell[198975, 5208, 92, 1, 27, "Input"]
}
]
*)

(* End of internal cache information *)
